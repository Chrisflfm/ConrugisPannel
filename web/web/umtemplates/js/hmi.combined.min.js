/*
 version 4.0.0.100, Copyright (c) 2014, Exor International SpA., http://www.jmobile.net
*/
'use strict';var $hmi=function(){function Pa(){}function ma(){this.cache.tags={};this.cache.props={}}function Qa(){this.date=moment();this.start()}function B(b,a,c,e,h){this.setState(b,a,c,e,h)}function na(b,a){this.name=b;this.value=a}function V(b,a,c,e){this.setState(b,a,c,e)}function Kb(){}function ha(b,a,c,e,h,d,g){this.id=b;this.Name=a;this.Status=c;this.RecipeSetList=e;this.selSet=h;this.lastSet=d;g&&(this.rcList=g)}function oa(b,a,c,e){this.id=b;this.Name=a;this.Value=c;this.elemList=e}function ta(b,
a,c){this.id=b;this.Name=a;this.Value=c}function x(b){b&&(this.code=this.status[b])}function rc(){}function Z(b){var a=new XMLHttpRequest;if(b.headers)for(var c in b.headers)xhr.setRequestHeader(c,b.headers[c]);b.asycn=!1;b=sc(b);a.open(b.type,b.url,b.async);var e,h,d=!1;a.onload=function(){e=a.status;h=a.responseText};a.ontimeout=function(){e=a.status;h=a.responseText;d=!0};a.onerror=function(){e=a.status;h=a.responseText};"GET"===b.type?a.send():a.send(b.search);return{status:e,data:h,timeout:d}}
function tc(b){this.idSeed=0;this.resolves={};this.rejects={};this.worker=b;var a=this;this.worker.addEventListener("message",function(c){var e=c.data;if(e&&"API"==e.e){c=e.id;var b=e.err,e=e.data;b?(e=a.rejects[c])&&e(b):(b=a.resolves[c])&&b(e);delete a.resolves[c];delete a.rejects[c]}})}function uc(b){var a="top:"+window.innerHeight/2+"px;left:"+window.innerWidth/2+"px;",c=f.getActiveProject().getNode("container"),e=document.createElement("div");e.setAttribute("style",a);e.setAttribute("class",
"jm-errLoadPage");e.textContent=b;c.appendChild(e);setTimeout(function(){var c=document.getElementsByClassName(".jm-errLoadPage");0<c.length&&c[0].parentNode.removeChild(c[0])},2E3)}function vc(b){var a=b[0][0],c=b[1][0],e=b[0][1],h=b[1][1],d=b[0][2];b=b[1][2];var g=a*h-c*e;return[[h/g,-e/g,(e*b-h*d)/g],[-c/g,a/g,-(a*b-c*d)/g],[0,0,1]]}function Ka(b,a){for(var c=[[1,0,0],[0,1,0],[0,0,1]],e=0,h=b.length;e<h;e++)for(var d=0,g=a[0].length;d<g;d++){for(var k=0,f=0,m=b[0].length;f<m;f++)k+=b[e][f]*a[f][d];
c[e][d]=k}return c}function wc(b){if(b&&-1!=b.indexOf("matrix")){var a=b.indexOf("("),c=b.indexOf(")");b=b.substring(a+1,c).split(",");return[[parseFloat(b[0]),parseFloat(b[2]),parseFloat(b[4])],[parseFloat(b[1]),parseFloat(b[3]),parseFloat(b[5])],[0,0,1]]}return[[1,0,0],[0,1,0],[0,0,1]]}function Ha(b){return"matrix("+b[0][0]+","+b[1][0]+","+b[0][1]+","+b[1][1]+","+b[0][2]+","+b[1][2]+")"}function xc(b){var a=[],c=null,e=null,c=b;b=f.getFocusPage().getWidget(b.id);var h=!0;do if((e=b)?a.push(e.getTransformMatrix()):
a.push(wc($(c).css("transform"))),c=c.parentElement,e&&(b=e.parentWidget),e.constructor==I||e.constructor==Ra)h=!1;while(h);e=[[1,0,0],[0,1,0],[0,0,1]];for(c=a.length-1;0<=c;c--)e=Ka(e,a[c]);return e}function Wb(b){for(var a=[[1,0,0],[0,1,0],[0,0,1]],c=0;c<b.length;c++)for(var e=0;e<b[c].length;e++)if(b[c][e]!=a[c][e])return!1;return!0}function Sa(b,a){b&&(b.style.transition=a,b.style["-webkit-transition"]=a,b.style["-ms-transition"]=a,b.style["-moz-transition"]=a)}function da(b,a){b&&(b.style.transform=
a,b.style["-webkit-transform"]=a,b.style["-ms-transform"]=a,b.style["-moz-transform"]=a)}function yc(b,a){b&&(b.style["-webkit-transform"]=a,b.style["-moz-transform"]=a,b.style["-ms-transform"]=a,b.style.transform=a)}function Ca(b,a,c){b&&(b.style["webkit"+a]=c,b.style["moz"+a]=c,b.style["ms"+a]=c,b.style["o"+a]=c)}function La(b,a){b&&(b.style.transformOrigin=a,b.style["-webkit-transform-origin"]=a,b.style["-ms-transform-origin"]=a,b.style["-moz-transform-origin"]=a)}function Ta(){window.Scrollbar.ScrollbarPlugin.apply(this,
arguments)}function Xb(b){return 1===b[0][0]&&0===b[0][1]&&0===b[0][2]&&0===b[0][0]&&1===b[0][1]&&0===b[0][2]&&0===b[0][0]&&0===b[0][1]&&1===b[0][2]}function ia(b,a){return[[b[0][0]*a[0][0]+b[0][1]*a[1][0]+b[0][2]*a[2][0],b[0][0]*a[0][1]+b[0][1]*a[1][1]+b[0][2]*a[2][1],b[0][0]*a[0][2]+b[0][1]*a[1][2]+b[0][2]*a[2][2]],[b[1][0]*a[0][0]+b[1][1]*a[1][0]+b[1][2]*a[2][0],b[1][0]*a[0][1]+b[1][1]*a[1][1]+b[1][2]*a[2][1],b[1][0]*a[0][2]+b[1][1]*a[1][2]+b[1][2]*a[2][2]],[b[2][0]*a[0][0]+b[2][1]*a[1][0]+b[2][2]*
a[2][0],b[2][0]*a[0][1]+b[2][1]*a[1][1]+b[2][2]*a[2][1],b[2][0]*a[0][2]+b[2][1]*a[1][2]+b[2][2]*a[2][2]]]}function zc(b){this.size=b;this.root3x1={m:[[0],[0],[0]],prev:null,next:null};this.root3={m:[[0,0,0],[0,0,0],[0,0,0]],prev:null,next:null};this.tail3x1=this.root3x1;this.tail3=this.root3;for(b=1;b<this.size;b++){var a={m:[[0],[0],[0]],prev:this.tail3x1,next:null};this.tail3x1=this.tail3x1.next=a;a={m:[[0,0,0],[0,0,0],[0,0,0]],prev:this.tail3,next:null};this.tail3=this.tail3.next=a}}function E(b,
a,c){this.canvas=b;this.ctx=b.getContext("2d");this.strWidth=a.strokeWidth;""!==a.stroke&&(this.strStyle=a.stroke);this.wSize={width:a.width||300,height:a.height||250};this.pathLimitBuffer=100>this.wSize.width?Math.floor(this.wSize/2):100;this.xSize={min:a.minX,max:a.maxX};this.ySize={min:a.minY,max:a.maxY};this._drawable=this._isNativeCompatible=!0;b=navigator.userAgent;if(-1!=b.indexOf("iPhone")||-1!=b.indexOf("iPad")||-1!=b.indexOf("WebKit/534")||-1!=b.indexOf("Safari")&&-1==b.indexOf("Chrome"))this._isNativeCompatible=
!1;this.drawStatus={brushType:E.BrushType.LINE,prevPoint:{x:void 0,y:void 0},currPoint:{x:void 0,y:void 0,selected:!1},lineBufferSize:0,operation:0};this.curveWgt=c}function P(b,a){this.canvas=b;this.ctx=b.getContext("2d");this.strokeColor=a.cursorColor;this.strokeWidth=a.cursorWidth;this.xCursorShow=a.xCursorShow;this.yCursorShow=a.yCursorShow;this._xSize={};this._ySize={};this._wSize={width:a.width||300,height:a.height||250};this._pos={x:this._wSize.width/2,y:a.yCursorPos||this._wSize.height}}function W(b,
a){P.call(this,b,a)}function Da(b,a){this.ctx=document.getElementById(b).getContext("2d");this.id=b;this.wSize={width:a.width||300,height:a.height||250};this.xSize={min:a.minX||0,max:a.maxX||1};this.ySize={min:a.minY||0,max:a.maxY||1};this.bands=a.bands}function ja(b,a){this.canvas=b;this.ctx=b.getContext("2d");this.gridX=a.gridX;this.gridY=a.gridY;this.colorX=a.colorX;this.colorY=a.colorY;this.xanchor=a.xanchor;this.yanchor=a.yanchor;this.xspacing=a.xspacing;this.yspacing=a.yspacing;this.wSize={width:a.width||
300,height:a.height||250};this.xSize={min:a.minX,max:a.maxX};this.ySize={min:a.minY,max:a.maxY}}function Lb(b){var a=document.createElement("div"),c=document.createElement("div"),e=document.createElement("a"),h=document.createTextNode("X");a.setAttribute("class","jm-hmi-button-close jm-hacklayer");c.setAttribute("class","jm-round-button-rect");e.appendChild(h);c.appendChild(e);a.appendChild(c);this.baseWgt=b;this.elem=a}function L(b){this.initEmptyElem=!1;this.isBaseMsgTextWgt="MsgTextWgt"===b.getJMType();
this.baseParentPage=b.parentPage;this.baseParentWidget=b.parentWidget;this.select=b.select;this.frame=!0===b.frame;this.frameSize=this.isBaseMsgTextWgt?this.frame?b.frameSize:0:0;this.baseWgt=b;this.updateOffsets();this.init()}function q(b,a,c,e,h){var d=null;null!=b&&(d=b.wgtId);l.call(this,d,null,c,e,h);this.event=a;this.parentWidget&&this.parentWidget.addAction(a,this)}function fb(b,a,c,e,h){q.call(this,b,a,c,e,h)}function gb(b,a,c,e,h){q.call(this,b,a,c,e,h)}function Ua(b,a,c,e,h){q.call(this,
b,a,c,e,h);this.select=!1}function hb(b,a,c,e,h){q.call(this,b,a,c,e,h)}function ib(b,a,c,e,h){q.call(this,b,a,c,e,h)}function jb(b,a,c,e,h){q.call(this,b,a,c,e,h)}function kb(b,a,c,e,h){q.call(this,b,a,c,e,h)}function lb(b,a,c,e,h){q.call(this,b,a,c,e,h)}function mb(b,a,c,e,h){q.call(this,b,a,c,e,h)}function nb(b,a,c,e,h){q.call(this,b,a,c,e,h)}function ob(b,a,c,e,h){q.call(this,b,a,c,e,h)}function pb(b,a,c,e,h){q.call(this,b,a,c,e,h)}function qb(b,a,c,e,h){q.call(this,b,a,c,e,h)}function rb(b,a,
c,e,h){q.call(this,b,a,c,e,h)}function sb(b,a,c,e,h){q.call(this,b,a,c,e,h)}function tb(b,a,c,e,h){q.call(this,b,a,c,e,h)}function ub(b,a,c,e,h){q.call(this,b,a,c,e,h)}function vb(b,a,c,e,h){q.call(this,b,a,c,e,h)}function wb(b,a,c,e,h){q.call(this,b,a,c,e,h)}function xb(b,a,c,e,h){q.call(this,b,a,c,e,h)}function yb(b,a,c,e,h){q.call(this,b,a,c,e,h)}function zb(b,a,c,e,h){q.call(this,b,a,c,e,h)}function Ab(b,a,c,e,h){q.call(this,b,a,c,e,h)}function l(b,a,c,e,h){this.wgtId=b;this.studioId=a;this.parentPage=
e;this.wgtsOrder=this.wgts=null;this.js=this;this.initInvMtxChain=this.isWgtActive=!1;this.enableRendering=!0;this.dataSourceProps=[];this.mapId={};h&&(this.parentWidget=h);c&&this.setOptions(c);this.isClone?(this.elem=Mb.getFragmentById(b),this.updateCloneMLIds()):this.elem=document.getElementById(b);this.parentPage||(this.parentPage=null);if(this.elem){null==this.mtx&&(this.mtx=[[1,0,0],[0,1,0],[0,0,1]]);this.cx=parseFloat(this.elem.getAttribute("data-cx"));this.cy=parseFloat(this.elem.getAttribute("data-cy"));
if(void 0===this.left||isNaN(this.left))this.x=this.left=0;if(void 0===this.top||isNaN(this.top))this.y=this.top=0;this.parentPage&&(this.hideQualityIcon(),this.qualityIcon=-1);this.elem.getAttribute("class")&&-1!=this.elem.getAttribute("class").indexOf("jm-blink")&&(this.blink=1)}if(this.parentWidget){if(this.parentWidget.constructor==Ea&&!this.isClone||0==this.parentWidget.enableRendering&&!this.isClone)this.enableRendering=!1;this.isClone&&this.parentWidget.isClone&&this.parentWidget.addWidget(this.wgtId,
this);this.isClone||this.parentWidget.isClone||(this.parentWidget.addWidget(this.wgtId,this),this.parentWidget!==this.parentPage&&this.parentPage.addWidget(this.wgtId,this));this.parentWidget.isModuleInstance()?this.module=this.parentWidget:this.module=this.parentWidget.getModule()}else f.addWidget(this.wgtId,this);if((b=this.project=f.activeProject)&&null!=this.elem){this.umgr=b.getWidget("_UserGroupMgr",!0);var d;this.umgr&&this.getAuthorizations()==this.umgr.getWidgetAuthorizationCodes().HIDE?
this.constructor==I?(this.elem.style.backgroundImage=null,d=!0):d=!1:"none"==this.elem.style.display&&1==this.visible?d=!0:"none"!=this.elem.style.display&&0==this.visible&&(d=!1);null!=d&&(this.setVisibility(d),this._baseRenderMask|=this._baseRenderFlags.VISIBLE,f.addToRender(this))}this._subscriptions={};this._eQueue=[];this._eStatus=0;this.adIconVisible=this.ml=this.destroyed=!1;this.core=f}function Va(b,a){this.w=b;this.cb=[a]}function J(b,a,c,e,h){l.call(this,b.wgtId,a,c,e,h);this.trnWndId&&
(this.trnWnd=this.parentWidget.getWidgetByClass(Nb),this.trnWnd.subscribeWgt(this,function(){}));f.cache.hasWgtProps(this.elem.id)&&(b=f.cache.getWgtProp(this.elem.id,"crsVisible"),this.yCursorPos=f.cache.getWgtProp(this.elem.id,"yCursorPos"),this.xCursorShow=b);this._initXCursor=!1;this._initObjects();this._renderMask=this._renderFlags.GRID;f.addToRender(this)}function aa(b,a,c,e,h){this.curState=0;l.call(this,b.wgtId,a,c,e,h);this.setValue("value",this.curState,null)}function y(b,a,c,e,h){l.call(this,
b.wgtId,a,c,e,h);this.image=this.elem.querySelector("[data-widget='ImageWgt']");this.draggingTimeOut=null;this.writeTagDelay=180;1==this.wrMode&&(this.ndlToolTip=document.getElementById(this.parentPage.wgtId+"_ndltooltip"),this.ndlToolTip||(this._renderMask|=this._renderFlags.CREATETOOLTIP));this._currMouseAction=-1;this.authCode=this.getAuthorizations();this.image&&(this.imageW=parseFloat(this.image.style.width),this.imageH=parseFloat(this.image.style.height),this.imageX=parseFloat(this.image.style.left),
this.imageY=parseFloat(this.image.style.top));this.imageRot=0;if(b=this.image.getAttribute("rot"))this.imageRot=parseFloat(b);this.range=this.max-this.min;this.type="vertical"==this.form?1:"horizontal"==this.form?2:0;"vertical"==this.form?(this.offset=Math.floor(this.imageH/2),this.length=this.height-2*this.offset):"horizontal"==this.form?(this.offset=Math.floor(this.imageW/2),this.length=this.width-2*this.offset):this.type=0;this.value>this.max?this.value=this.max:this.value<this.min&&(this.value=
this.min);c.acceptClick&&(this.disabled=!1);c.disabled&&(this.disabled=c.disabled);this.handleEvent();this._renderMask|=this._renderFlags.VALUE;f.addToRender(this)}function F(b,a,c,e,h){l.call(this,b.wgtId,a,c,e,h);this.trnWndId&&(this.trnWnd=this.parentWidget.getWidgetByClass(Nb),this.trnWnd.subscribeWgt(this,function(){}),this.cursorTs=this.trnWnd.getValue("cursor-timestamp"),this.curveType=this.trnWnd.getTrendType(),this.width=this.trnWnd.width,this.height=this.trnWnd.height);this.currPageDuration=
this.trnWnd.xPageSize;this.getLineChartObj(this.parentWidget.elem.querySelector(".jm-trend_crv"));this.trnWnd&&this.trnWnd.isScatter()&&(this.graph.isScatter=!0);if(f.getEventMgr()){var d=this;this.deactivateHandler=function(){d.executeDeactivationCallback()&&(d.unload(),d.isWgtActive=!1)};this.bindEvents({unloadWgt:this.deactivateHandler})}}function S(b,a,c,e,h){F.call(this,b,a,c,e,h);b=[];b.push(this.xTag);b.push(this.yTag);this.value=Array(this.maxLimit);if(f.getEventMgr()){var d=this;this.activateHandler=
function(){l.prototype.executeActivationCallback.call(d)&&(d.load(),d.isWgtActive=!0)};l.prototype.bindEvents.call(this,{loadWgt:this.activateHandler})}this.srv=f.activeProject.getCommunticationObj();this.srv.subscribeTags(b,function(c){})}function Ia(b,a,c,e,h){l.call(this,b.wgtId,a,c,e,h)}function N(b){this.wgt=b;var a=this.wgt.getInvokablePropsList();if(a)for(b=0;b<a.length;b++)Object.defineProperty(this,a[b],this._generateGetterAndSetter(a[b]));if(a=this.wgt.getInvokableFunList())for(b=0;b<a.length;b++){var c=
a[b];this[c]=this._generateFun(c)}}function X(b,a){N.call(this,b);this._timeoutIDs={};this.isTemplate=a}function K(b){X.call(this,b);this.wgt=b}Pa.prototype.modulesMap={};Pa.prototype.addModule=Pa.prototype.export=function(b,a){this.modulesMap[b]=a};Pa.prototype.getModule=Pa.prototype.import=function(b){return this.modulesMap[b]};var u=new Pa;ma.prototype.constructor=ma;ma.prototype.cache={};ma.prototype.updateTag=function(b,a){var c=this.cache.tags[b];if(null==c)return this.cache.tags[b]=new ua(a.n,
-1,a.v.v,"S_OK",a.v.q,a.v.ts,a.v.t),!0;if(a.constructor===ua){if(a.ts<c.ts||a.isQualityGood()&&c.isQualityGood()&&a.value==c.value&&null!=c.ts)return!1;this.cache.tags[b]=a}else{if(a.v.ts<c.ts||va.isQualityGood(a.v.q)&&c.isQualityGood()&&a.v.v==c.value&&null!=c.ts)return!1;this.cache.tags[b].setState(a.n,-1,a.v.v,"S_OK",a.v.q,a.v.ts)}return!0};ma.prototype.getTag=function(b){return this.cache.tags[b]};ma.prototype.clone=function(){var b={};if(this.cache)for(var a in this.cache.tags)b[a]=this.cache.tags[a].clone();
return b};ma.prototype.setWgtProp=function(b,a,c){this.cache.props[b]||(this.cache.props[b]={});this.cache.props[b][a]=c};ma.prototype.getWgtProp=function(b,a){if(this.cache.props[b])return this.cache.props[b][a]};ma.prototype.hasWgtProps=function(b){return this.cache.props[b]?!0:!1};ma.prototype.clear=function(){this.cache.tags={};this.cache.props={}};var Wa;(function(b){b[b.QUALITY_BAD=0]="QUALITY_BAD";b[b.QUALITY_UNCERTAIN=1]="QUALITY_UNCERTAIN";b[b.QUALITY_GOOD=3]="QUALITY_GOOD"})(Wa||(Wa={}));
var Ac;(function(b){b[b.SUBSTATUS_NON_SPECIFIC=0]="SUBSTATUS_NON_SPECIFIC";b[b.SUBSTATUS_CONFIGURATION_ERROR=1]="SUBSTATUS_CONFIGURATION_ERROR";b[b.SUBSTATUS_NOT_CONNECTED=2]="SUBSTATUS_NOT_CONNECTED";b[b.SUBSTATUS_DEVICE_FAILURE=3]="SUBSTATUS_DEVICE_FAILURE";b[b.SUBSTATUS_TIMEOUT_FAILURE=4]="SUBSTATUS_TIMEOUT_FAILURE";b[b.SUBSTATUS_COMMUNICATION_FAILURE=6]="SUBSTATUS_COMMUNICATION_FAILURE";b[b.SUBSTATUS_NOBOUNDS=7]="SUBSTATUS_NOBOUNDS";b[b.SUBSTATUS_NODATA=8]="SUBSTATUS_NODATA"})(Ac||(Ac={}));var Bc;
(function(b){b[b.SUBSTATUS_ENGINEERING_UNITS_EXCEEDED=5]="SUBSTATUS_ENGINEERING_UNITS_EXCEEDED"})(Bc||(Bc={}));var Cc;(function(b){b[b.LT_NOT_LIMITED=0]="LT_NOT_LIMITED";b[b.LT_LOW_LIMITED=1]="LT_LOW_LIMITED";b[b.LT_HIGH_LIMITED=2]="LT_HIGH_LIMITED";b[b.LT_CONSTANT=3]="LT_CONSTANT"})(Cc||(Cc={}));var va=function(){function b(a){a&&(this.qual=(a&b.MASKQUALITY)>>6,this.substatus=(a&b.MASKSUBSTATUS)>>2,this.limit=a&b.MASKLIMITS)}b.prototype.getStatus=function(){return this.qual};b.prototype.setState=
function(a){this.qual=(a&b.MASKQUALITY)>>6;this.substatus=(a&b.MASKSUBSTATUS)>>2;this.limit=a&b.MASKLIMITS};b.prototype.setStatus=function(a){this.qual=a};b.prototype.clone=function(){var a=new b;a.qual=this.qual;a.substatus=this.substatus;a.limit=this.limit;return a};b.prototype.toString=function(){return new String(this.qual<<6|this.substatus<<2|this.limit)};b.prototype.isQualityGood=function(){return this.qual==Wa.QUALITY_GOOD};b.isQualityGood=function(a){return(a&b.MASKQUALITY)>>6==Wa.QUALITY_GOOD};
b.prototype.isQualityUncertain=function(){return this.qual==Wa.QUALITY_UNCERTAIN};b.prototype.isQualityBad=function(){return this.qual==Wa.QUALITY_BAD};b.MASKQUALITY=192;b.MASKSUBSTATUS=60;b.MASKLIMITS=3;return b}();u.addModule("Quality",va);var w;(function(b){b[b.EMPTY=-1]="EMPTY";b[b.BOOLEAN=0]="BOOLEAN";b[b.BYTE=1]="BYTE";b[b.SHORT=2]="SHORT";b[b.INT=3]="INT";b[b.UNSIGNEDBYTE=4]="UNSIGNEDBYTE";b[b.UNSIGNEDSHORT=5]="UNSIGNEDSHORT";b[b.UNSIGNEDINT=6]="UNSIGNEDINT";b[b.FLOAT=7]="FLOAT";b[b.DOUBLE=
8]="DOUBLE";b[b.STRING=9]="STRING";b[b.BINARY=10]="BINARY";b[b.TIME=11]="TIME";b[b.INT64=12]="INT64";b[b.UINT64=13]="UINT64";b[b.INT64A=14]="INT64A";b[b.UINT64A=15]="UINT64A"})(w||(w={}));var Xa;(function(b){b[b.EMPTY=0]="EMPTY";b[b.BIT=1]="BIT";b[b.BYTE=2]="BYTE";b[b.SHORT=3]="SHORT";b[b.INT=4]="INT";b[b.UNSIGNED_BYTE=5]="UNSIGNED_BYTE";b[b.UNSIGNED_SHORT=6]="UNSIGNED_SHORT";b[b.UNSIGNED_INT=7]="UNSIGNED_INT";b[b.FLOAT=8]="FLOAT";b[b.DOUBLE=9]="DOUBLE";b[b.STRING=10]="STRING";b[b.BINARY=11]="BINARY";
b[b.TIME=12]="TIME";b[b.ARRAY_BIT=13]="ARRAY_BIT";b[b.ARRAY_BYTE=14]="ARRAY_BYTE";b[b.ARRAY_SHORT=15]="ARRAY_SHORT";b[b.ARRAY_INT=16]="ARRAY_INT";b[b.ARRAY_UNSIGNED_BYTE=17]="ARRAY_UNSIGNED_BYTE";b[b.ARRAY_UNSIGNED_SHORT=18]="ARRAY_UNSIGNED_SHORT";b[b.ARRAY_UNSIGNED_INT=19]="ARRAY_UNSIGNED_INT";b[b.ARRAY_FLOAT=20]="ARRAY_FLOAT";b[b.ARRAY_DOUBLE=21]="ARRAY_DOUBLE";b[b.ARRAY_TIME=22]="ARRAY_TIME";b[b.UINT64=23]="UINT64";b[b.INT64=24]="INT64";b[b.ARRAY_UINT64=25]="ARRAY_UINT64";b[b.ARRAY_INT64=26]="ARRAY_INT64";
b[b.OBJECT=27]="OBJECT"})(Xa||(Xa={}));var ua=function(){function b(a,c,e,b,d,g,k){this._isArray=!1;this.name="";this.valueType=void 0!==this.valueType?this.valueType:0;this.index=-1;this.ts=this.value=this.quality=this.code=null;this.setState(a,c,e,b,d,g)}b.prototype.getQuality=function(){return this.quality};b.getNumberOfBits=function(a){switch(a){case w.BOOLEAN:return 1;case w.UNSIGNEDBYTE:case w.BYTE:return 8;case w.UNSIGNEDSHORT:case w.SHORT:return 16;case w.DOUBLE:case w.UINT64:return 64;case w.STRING:case w.BINARY:case w.TIME:return 0;
case w.INT64:case w.UINT64:case w.INT64A:case w.UINT64A:return 64}return 32};b.prototype.getValueType=function(){return this.valueType};b.prototype.getTagType=function(){return this.type};b.prototype.isArrayTag=function(){return this._isArray};b.getTypeRange=function(a){switch(a){case w.BOOLEAN:return{min:0,max:1};case w.BYTE:return{min:-128,max:127};case w.SHORT:return{min:-32768,max:32767};case w.INT:return{min:-21E8,max:21E8};case w.UNSIGNEDBYTE:return{min:0,max:255};case w.UNSIGNEDSHORT:return{min:0,
max:65535};case w.UNSIGNEDINT:return{min:0,max:42E8};case w.FLOAT:return{min:-3.4E38,max:3.4E38};case w.DOUBLE:return{min:-1.79E308,max:1.79E308};case w.STRING:case w.BINARY:case w.TIME:return null;case w.INT64A:case w.INT64:return{min:-Math.pow(2,63),max:Math.pow(2,63)-1};case w.UINT64A:case w.UINT64:return{min:0,max:Math.pow(2,64)-1}}return{min:NaN,max:NaN}};b.prototype.is64Bit=function(a){return w.INT64==a||w.INT64A==a||w.UINT64==a||w.UINT64A==a};b.prototype.is32Bit=function(a){switch(a){case w.BOOLEAN:case w.BYTE:case w.SHORT:case w.INT:case w.UNSIGNEDBYTE:case w.UNSIGNEDSHORT:case w.UNSIGNEDINT:case w.FLOAT:case w.DOUBLE:return!0;
default:return!1}};b.prototype.toLong=function(a,c){return c===w.UINT64?fromString(a,!0,10):fromString(a)};b.prototype.setQuality=function(a){this.quality=a};b.prototype.manageTagType=function(a,c){var e=f.getActiveProject().getTagMgr();if(e){var h=e.getTagInfo(a);h&&(e=h.t,h=h.s,this.type=e,this._stringTagType=b.enumTypeName[e],-1!=h&&(this._isArray=!0,this._stringTagType+="-"+h),e==w.TIME&&"string"==typeof c&&(this.value=(new Date(c)).getTime()/1E3))}};b.prototype.setState=function(a,c,e,b,d,g){this.name=
a;this.index=c;this.value=e;this.manageTagType(a,e);null!=this.code?this.code.setState(b):this.code=new x(b);null!=this.quality?this.quality.setState(d):this.quality=new va(d);this.ts=g;return this};b.prototype.clone=function(a){var c=this.value;this.value instanceof Array&&(c=void 0==a||a?c.slice():this.value);a=new b;a.name=this.name;a.index=this.index;a.value=c;a.code=this.code.clone();a.quality=this.quality.clone();return a};b.prototype.getState=function(a){return new B(this.quality,this.getValue(a),
"",this.code,this.ts)};b.prototype.getMessageStatus=function(){return this.code};b.prototype.getTimestamp=function(){return this.ts};b.prototype.getValue=function(a){return Array.isArray(this.value)&&0<=a?this.value[a]:this.value};b.prototype.getStringTagType=function(){return this._stringTagType};b.prototype.setValue=function(a){this.value=a};b.prototype.isQualityGood=function(){return this.quality.isQualityGood()};b.prototype.compareTo=function(a){return a.value===this.value?0:-1};b.QUALITY_GOOD=
new va(192);b.QUALITY_UNCERTAIN=new va(64);b.enumTypeName={0:"boolean",1:"byte",2:"short",3:"int",4:"unsignedByte",5:"unsignedShort",6:"unsignedInt",7:"float",8:"double",9:"string",10:"binary",11:"time",12:"int64",13:"uint64"};return b}();u.addModule("Tag",ua);var Bb=function(){function b(){this.tags=this.info=null;this.nTags=0}b.prototype.setState=function(a,c,e){this.info={name:a,code:new x(c)};if(e instanceof Array)for(this.tags={},this.nTags=e.length,a=0,c=e.length;a<c;a++){var b=e[a];this.tags[b.name]=
(new ua).setState(b.name,-1,b.value,b.code,b.quality)}else null!=e&&(this.tags=e,this.nTags=Object.keys(this.tags).length);return this};b.prototype.getTag=function(a){for(var c in this.tags)if(c==a)return this.tags[c].value};b.prototype.getCount=function(){return this.nTags};b.prototype.getTags=function(){var a=[],c;for(c in this.tags)a.push(this.tags[c].name);return a};b.prototype.getTagArray=function(){var a=[],c;for(c in this.tags)a.push(this.tags[c]);return a};b.prototype.getTagsMap=function(){return this.tags};
b.prototype.getMessageStatus=function(){return this.info.code};return b}();u.addModule("Group",Bb);var M;(function(b){b[b.INT=0]="INT";b[b.FLOAT=1]="FLOAT";b[b.HEXL=2]="HEXL";b[b.HEXU=3]="HEXU";b[b.EXP=4]="EXP";b[b.EXPD=5]="EXPD";b[b.THOUSAND=6]="THOUSAND"})(M||(M={}));var R;(function(b){b[b.TEXT=0]="TEXT";b[b.NUMBER=1]="NUMBER";b[b.DATETIME=2]="DATETIME"})(R||(R={}));var Ob;(function(b){b[b.TIME_ONLY=0]="TIME_ONLY";b[b.DATE_ONLY=1]="DATE_ONLY";b[b.DATE_SEP_TIME=2]="DATE_SEP_TIME";b[b.TIME_SEP_DATE=
3]="TIME_SEP_DATE"})(Ob||(Ob={}));var Ya=function(){function b(a,c,e){this.date=void 0!==a?a:new Date;this.format=c;this.configuration=e;void 0!==this.format&&(this.options=u["import"]("TextFormatUtil").parseDateTimeFormat(c,e))}b.prototype.setDate=function(a){this.date=new Date(a)};b.prototype.setFormat=function(a,c){this.format=a;this.options=u["import"]("TextFormatUtil").parseDateTimeFormat(a,void 0!==c?c:this.configuration);this.configuration=c};b.prototype.setConfiguration=function(a){var c=
!1;this.configuration.longDateFormat!=a.longDateFormat&&(this.configuration.longDateFormat=a.longDateFormat,c=!0);this.configuration.shortDateFormat!=a.shortDateFormat&&(this.configuration.shortDateFormat=a.shortDateFormat,c=!0);this.configuration.serverOffset!=a.serverOffset&&(this.configuration.longDateFormat=a.longDateFormat,c=!0);c&&(this.options=u["import"]("TextFormatUtil").parseDateTimeFormat(this.format,this.configuration));return c};b.prototype.showMilliSeconds=function(){this.options.milliseconds=
!0};b.prototype.getSeparator=function(){return this.options.sep};b.prototype.getOrder=function(){return this.options.order};b.prototype.splitFormat=function(a){for(var c=-1,e=-1,b=-1,d=-1,g=-1,k=-1,f=0,m=a.length;f<m;f++){var r=a.charAt(f),v="M"==r||"d"==r||"D"==r||"y"==r||"Y"==r,r="s"==r||"h"==r||"H"==r||"m"==r||"A"==r||"P"==r;-1==c&&v&&(-1!=d&&(g=f-1),c=f);-1==d&&r&&(-1!=c&&(e=f-1),d=f);v&&(b=f);r&&(k=f)}-1!=c&&-1==e&&(e=a.length);-1!=d&&-1==g&&(g=a.length);return[-1!=c&&-1!=e?a.substring(c,b+1):
"",-1!=d&&-1!=g?a.substring(d,k+1):""]};b.prototype.formatDateTimeAndSplit=function(a,c){if(void 0===this.format)return[];var e=this.splitFormat(this.options.format),b=this.options.format;this.options.format=e[0];var d=u["import"]("TextFormatUtil").formatDateTime(this.date,a,this.options,c?c:this.configuration);this.options.format=e[1];e=u["import"]("TextFormatUtil").formatDateTime(this.date,a,this.options,c?c:this.configuration);this.options.format=b;return[d,e]};b.prototype.formatDateTime=function(a,
c){return void 0===this.format?"":u["import"]("TextFormatUtil").formatDateTime(this.date,a,this.options,c?c:this.configuration)};b.prototype.formatDateTimeValue=function(){var a=this.format,c=!1;a.match(/(ap|a)/i)&&(c=!0);c=this.computeTimeParams(c);a=a.replace(/(ap|a)/i,c.amPm);a=a.replace(/MMM/,c.months[c.dt.getMonth()]);a=a.replace(/DD/,c.cdate);a=a.replace(/YYYY/,c.cyear4);a=a.replace(/YY/,c.cyear2);a=a.replace(/MM/,c.cmonth);a=a.replace(/(hh|h)/,c.hrs);a=a.replace(/mm/,c.mts);a=a.replace(/ss/,
c.sec);return a.trim()};b.prototype.computeTimeParams=function(a){var c={months:"Jan Feb Mar Apr May June July Aug Sep Oct Nov Dec".split(" ")};if(!(this.date instanceof Date))return null;c.dt=this.date;c.cdate=10>this.date.getDate()?"0"+this.date.getDate().toString():this.date.getDate().toString();c.cmonth=10>this.date.getMonth()+1?"0"+(this.date.getMonth()+1).toString():(this.date.getMonth()+1).toString();c.cyear2=this.date.getFullYear().toString().slice(2);c.cyear4=this.date.getFullYear().toString();
c.hrs=10>this.date.getHours()?"0"+this.date.getHours().toString():this.date.getHours().toString();c.mts=10>this.date.getMinutes()?"0"+this.date.getMinutes():this.date.getMinutes().toString();c.sec=10>this.date.getSeconds()?"0"+this.date.getSeconds():this.date.getSeconds().toString();a&&(c.amPm=12>parseInt(c.hrs)?"AM":"PM",c.hrs=13>parseInt(c.hrs)?c.hrs:10>parseInt(c.hrs)-12?"0"+(parseInt(c.hrs)-12).toString():(parseInt(c.hrs)-12).toString());return c};return b}(),Ad=function(){function b(a,c,e,b,
d,g){this.setState(a,c,e,b,d,g)}b.prototype.setState=function(a,c,e,b,d,g){this.type=a;this.subtype=c;this.evtType=e;this.time=b;this.data=d;this.code=new x(g);return this};b.prototype.getMessageStatus=function(){return this.code};b.prototype.setData=function(a){this.data=a};b.prototype.isAlarmEvent=function(){return 14==this.type&&(1==this.evtType||4==this.evtType)};b.prototype.getType=function(){return this.type};b.prototype.getSubtype=function(){return this.subtype};b.prototype.getEvtType=function(){return this.evtType};
b.prototype.getTime=function(){return this.time};b.prototype.getData=function(){return this.data};b.prototype.getCode=function(){return this.code};return b}();u.addModule("IDALEvent",Ad);var wa;(function(b){b[b.AL_EVENT_TRIGGERED=1]="AL_EVENT_TRIGGERED";b[b.AL_EVENT_NOT_TRIGGERED=2]="AL_EVENT_NOT_TRIGGERED";b[b.AL_EVENT_ACKED=4]="AL_EVENT_ACKED";b[b.AL_EVENT_RESET=8]="AL_EVENT_RESET";b[b.AL_EVENT_ENABLED=16]="AL_EVENT_ENABLED";b[b.AL_EVENT_DISABLED=32]="AL_EVENT_DISABLED";b[b.AL_EVENT_BOTH=64]="AL_EVENT_BOTH"})(wa||
(wa={}));var Bd=function(){function b(a,c,e,h,d,g,k,f){this.dirty=!1;this.alDescription=this.alDate=this.alTime=this.alDateTime="";this.alEnable=!1;this.alName="";this.alSelect=!1;this.alState=b.stateType.STATE_DISABLED;this.alGroups=this.comment=this.alValue="";this.xmlOrder=0;this.toggleShowAlarm=!0;this.blinkTimer=null;this.blinkInterval=1E3;this.usrActs=[];this.acts=[];this.setState(a,c,e,h,d,g,k,f);this.setDefaultColors()}b.prototype.setDefaultColors=function(){var a=f.activeProject.getAlarmsMgr().getAlarmsConfiguration(),
c=a.defaultColors;this.aBG=(a=a.alarms[this.alName])&&a.aBG||c.aBG;this.aTC=a&&a.aTC||c.aTC;this.dBG=a&&a.dBG||c.dBG;this.dTC=a&&a.dTC||c.dTC;this.tABG=a&&a.tABG||c.tABG;this.tATC=a&&a.tATC||c.tATC;this.nTNABG=a&&a.nTNABG||c.nTNABG;this.nTNATC=a&&a.nTNATC||c.nTNATC;this.nTABC=a&&a.nTABC||c.nTABC;this.nTATC=a&&a.nTATC||c.nTATC;this.tNABC=a&&a.tNABC||c.tNABC;this.tNATC=a&&a.tNATC||c.tNATC;this.tBG=a&&a.tBG||c.tBG;this.tTC=a&&a.tTC||c.tTC;this.nTBC=a&&a.nTBC||c.nTBC;this.nTTC=a&&a.nTTC||c.nTTC;this.BGColor=
this.dBG;this.FGColor=this.dTC};b.prototype.stateToString=function(a){switch(a){case b.stateType.STATE_NOT_TRIGGERED:return"Not Triggered";case b.stateType.STATE_TRIGGERED:return"Triggered";case b.stateType.STATE_TRIGGERED_NOT_ACKED:return"Triggered Not Acked";case b.stateType.STATE_NOT_TRIGGERED_ACKED:return"Not Triggered Acked";case b.stateType.STATE_NOT_TRIGGERED_NOT_ACKED:return"Not Triggered Not Acked";case b.stateType.STATE_TRIGGERED_ACKED:return"Triggered Acked";default:return"Disabled"}};
b.prototype.getColorsByStateCode=function(a){switch(a){case b.stateType.STATE_NOT_TRIGGERED:return{bg:this.nTBC,fg:this.nTTC};case b.stateType.STATE_TRIGGERED:return{bg:this.tBG,fg:this.tTC};case b.stateType.STATE_TRIGGERED_NOT_ACKED:return{bg:this.tNABC,fg:this.tNATC};case b.stateType.STATE_NOT_TRIGGERED_ACKED:return{bg:this.nTABC,fg:this.nTATC};case b.stateType.STATE_NOT_TRIGGERED_NOT_ACKED:return{bg:this.nTNABG,fg:this.nTNATC};case b.stateType.STATE_TRIGGERED_ACKED:return{bg:this.tABG,fg:this.tATC};
default:return{bg:this.dBG,fg:this.dTC}}};b.prototype.setColorsByState=function(){switch(this.alState){case b.stateType.STATE_NOT_TRIGGERED:this.BGColor=this.nTBC;this.FGColor=this.nTTC;break;case b.stateType.STATE_TRIGGERED:this.BGColor=this.tBG;this.FGColor=this.tTC;break;case b.stateType.STATE_TRIGGERED_NOT_ACKED:this.BGColor=this.tNABC;this.FGColor=this.tNATC;break;case b.stateType.STATE_NOT_TRIGGERED_ACKED:this.BGColor=this.nTABC;this.FGColor=this.nTATC;break;case b.stateType.STATE_NOT_TRIGGERED_NOT_ACKED:this.BGColor=
this.nTNABG;this.FGColor=this.nTNATC;break;case b.stateType.STATE_TRIGGERED_ACKED:this.BGColor=this.tABG;this.FGColor=this.tATC;break;default:this.BGColor=this.dBG,this.FGColor=this.dTC}};b.prototype.isTriggered=function(){return this.alState===b.stateType.STATE_TRIGGERED||this.alState===b.stateType.STATE_TRIGGERED_ACKED||this.alState===b.stateType.STATE_TRIGGERED_NOT_ACKED};b.prototype.isAcked=function(){return this.alState!==b.stateType.STATE_NOT_TRIGGERED_NOT_ACKED&&this.alState!==b.stateType.STATE_TRIGGERED_NOT_ACKED};
b.prototype.isPrevStateTriggered=function(){return this.prevState===b.stateType.STATE_TRIGGERED||this.prevState===b.stateType.STATE_TRIGGERED_ACKED||this.prevState===b.stateType.STATE_TRIGGERED_NOT_ACKED};b.prototype.isPrevStateAcked=function(){return this.prevState!==b.stateType.STATE_NOT_TRIGGERED_NOT_ACKED&&this.prevState!==b.stateType.STATE_TRIGGERED_NOT_ACKED};b.prototype.setState=function(a,c,e,h,d,g,k,f){this.alName=a;void 0!==c&&null!==c&&(this.alState=c);void 0!==e&&null!==e&&(this.alValue=
e);this.alEnable=this.alState==b.stateType.STATE_DISABLED?!1:!0;h&&(this.alDateTime=h,this.alDate=d,this.alTime=g);this.code=new x(k);this.liveTags=f;return this};b.prototype.startBlinking=function(){var a=this;null===this.blinkTimer&&(this.blinkTimer=setInterval(function(){f.activeProject.getAlarmsMgr().setValue("fill",a.toggleShowAlarm?a.FGColor:a.BGColor,null,0,!0,a.alName);a.toggleShowAlarm=!a.toggleShowAlarm},this.blinkInterval))};b.prototype.stopBlinking=function(){clearInterval(this.blinkTimer);
f.activeProject.getAlarmsMgr().setValue("fill",this.FGColor,null,0,!0,this.alName);this.blinkTimer=null;this.toggleShowAlarm=!0};b.prototype.update=function(a){var c=!1;this.alEnable!==a.alEnable&&(this.alEnable=a.alEnable,this.checkIfEnableTriggerAction()&&this.doActions(),c=!0);this.alState!==a.alState&&(this.prevState=this.alState,this.alState=a.alState,this.setColorsByState(),this.checkIfStateTriggerAction()&&this.doActions(),this.isBlinkEnabled()&&(this.isAcked()?this.stopBlinking():this.startBlinking()),
c=!0);this.alValue!==a.alValue&&(this.alValue=a.alValue,c=!0);this.alDateTime!==a.alDateTime&&(this.alDateTime=a.alDateTime,this.alDate=a.alDate,this.alTime=a.alTime,c=!0);if(this.liveTags)for(var e in this.liveTags)if(this.liveTags[e]!==a.liveTags[e]){c=!0;break}this.liveTags=a.liveTags;return c};b.prototype.updateProperty=function(a,c){return"undefined"!=typeof this[a]&&this[a]!=c?(this[a]=c,!0):!1};b.prototype.getMessageStatus=function(){return this.code};b.prototype.isDirty=function(a){return null!=
this.dirtyState&&null!=this.dirtyState[a]};b.prototype.setDirty=function(a,c){null==this.dirtyState&&(this.dirtyState={});this.dirty=this.dirtyState[a]=c};b.prototype.getDirtyValue=function(a){return null!=this.dirtyState?this.dirtyState[a]:this[a]};b.prototype.getValue=function(a){return this[a]};b.prototype.getDescriptionTags=function(){var a=this.liveData.d[this.getCurrentLanguage()];return a instanceof Array?a:this.liveData.d[a]};b.prototype.getCustomField1Tags=function(){var a=this.liveData.cF1[this.getCurrentLanguage()];
return a instanceof Array?a:this.liveData.cF1[a]};b.prototype.getCustomField2Tags=function(){var a=this.liveData.cF2[this.getCurrentLanguage()];return a instanceof Array?a:this.liveData.cF2[a]};b.prototype.getText=function(a){var c=this.getMLTexts();return a&&c[a]?c[a][this.getCurrentLanguage()]:""};b.prototype.getDescriptionText=function(){var a=this.getConfiguration().d;return this.getText(a)};b.prototype.getCustomField1Text=function(){var a=this.getConfiguration().cF1;return this.getText(a)};b.prototype.getCustomField2Text=
function(){var a=this.getConfiguration().cF2;return this.getText(a)};b.prototype.commitDirtyValue=function(a){this[a]=this.dirtyState[a];this.dirtyState[a]=null};b.prototype.addAction=function(a){this.acts.push(a)};b.prototype.addUserAction=function(a){this.usrActs.push(a)};b.prototype.doActions=function(){for(var a=0;a<this.acts.length;a++)f.doAction(f.activeProject.getAlarmsMgr().wgtId,this.acts[a])};b.prototype.doUserActions=function(){for(var a=0;a<this.usrActs.length;a++)f.doAction(f.activeProject.getAlarmsMgr().wgtId,
this.usrActs[a])};b.prototype.getConfiguration=function(){return f.activeProject.getAlarmsMgr().getAlarmsConfiguration().alarms[this.alName]};b.prototype.getCurrentLanguage=function(){return f.activeProject.getAlarmsMgr().getCurrentLanguage()};b.prototype.getMLTexts=function(){return f.activeProject.getAlarmsMgr().getAlarmsConfiguration().mlTexts};b.prototype.isBlinkEnabled=function(){return this.getConfiguration().blinkTxt};b.prototype.setActionMask=function(a){this.actionMask=a};b.prototype.checkIfStateTriggerAction=
function(){var a=this.isTriggered()&&!this.isPrevStateTriggered(),c=!this.isTriggered()&&this.isPrevStateTriggered(),e=this.isAcked()&&!this.isPrevStateAcked(),b=!1;this.actionMask&wa.AL_EVENT_TRIGGERED&&a&&(b=!0);this.actionMask&wa.AL_EVENT_NOT_TRIGGERED&&c&&(b=!0);this.actionMask&wa.AL_EVENT_ACKED&&e&&(b=!0);this.actionMask&wa.AL_EVENT_BOTH&&(a||c)&&(b=!0);return b};b.prototype.checkIfEnableTriggerAction=function(){return this.actionMask&wa.AL_EVENT_ENABLED?1==this.alEnable:this.actionMask&wa.AL_EVENT_DISABLED?
0==this.alEnable:!1};b.prototype.checkIfResetTriggerAction=function(){return this.actionMask&wa.AL_EVENT_RESET?!0:!1};b.prototype.reset=function(){this.actionMask&wa.AL_EVENT_RESET&&this.doActions()};b.stateType={STATE_NOT_TRIGGERED:0,STATE_DISABLED:1,STATE_TRIGGERED:2,STATE_TRIGGERED_NOT_ACKED:3,STATE_NOT_TRIGGERED_ACKED:4,STATE_NOT_TRIGGERED_NOT_ACKED:5,STATE_TRIGGERED_ACKED:6,STATE_ALARM_MAX:7};return b}();u["export"]("Alarm",Bd);var Cd=function(){function b(){}b.applyPadding=function(a,c){if(!a.isPadding)return c;
var e=!1;"-"==c.charAt(0)&&(e=!0,c=c.substring(1));for(var b=c.indexOf("."),b=-1!=b?b:-1!=a.ePos?c.indexOf(a.eSymbol):c.length,b=a.leadingDigits-b,d=0;d<b;d++)"0"==a.format.charAt(d)&&"0"!=c.charAt(d)&&(c="0"+c);return e?"-"+c:c};b.formatINTValue=function(a,c,e,b){if(null!=c)return""===c?c:"string"==typeof c||"object"==typeof c?this.applyStyle(this.applyPadding(a,c),e,b):this.applyStyle(this.applyPadding(a,Math.round(c)+""),e,b)};b.applyStyle=function(a,c,e){if(c){var b="."!=c.decimalSymbol&&""!=
c.decimalSymbol;if(!b&&!e)return a;var d=a.indexOf("."),g=a;if(e)for(var g="",k=-1!=d?a.substring(0,d):a,f=k.length-1,m=f;0<=m;m--){var r=k.charAt(m);e&&m<f&&0==(f-m)%c.digitsGrouping&&(g=c.thousandSymbol+g);g=r+g}return-1!=d?b?e?g+c.decimalSymbol+a.substring(d+1):a.replace(".",c.decimalSymbol):e?g+a.substring(d):a:g}return a};b.formatDecimalPlaces=function(a,c){var e=a.optionalDecimals,b=a.decimalPlaces;if(0==c%1&&b==e)return c.toString();if(0!=e)for(var d=c*Math.pow(10,b),g=!1,k=1;k<=e&&!g;k++)0==
d%Math.pow(10,k)?b--:g=!0;return c.toFixed(b)};b.formatFLOATValue=function(a,c,e,b){return null!=c?("number"!=typeof c&&(c=parseFloat(c)),this.applyStyle(this.applyPadding(a,this.formatDecimalPlaces(a,c)),e,b)):""};b.formatHexadecimalValue=function(a,c){var e=a.numericFormat==M.HEXL,b=parseInt(c),d=0>b?!0:!1,b=0>b?0xfffffffffffff+b+1:b,b=e?b.toString(16):b.toString(16).toUpperCase();if(d&&16>b.length)for(var d=16-b.length,g=0;g<d;g++)b=e?"f"+b:"F"+b;return this.applyPadding(a,b)};b.formatExponentialValue=
function(a,c,e,h,d){c=b.scientificNotation(c,a.decimalPlaces,a.magnitudeDegree,e);0<a.format.indexOf("E")&&(c=c.replace("e","E"));return this.applyStyle(this.applyPadding(a,c),h,d)};b.scientificNotation=function(a,c,e,b){var d=1==e?10:Math.pow(10,e),g=0,k=0<=a?1:-1;a*=k;for(var f=0<a&&1>a?1/d:d;(1>a||a>=d)&&0!==a;)a/=f,g+=e;return(k*a).toFixed(c)+"e"+(f==d?"+":"-")+(0<b?"0":"")+g};b.formatText=function(a,c,e,b){switch(a.numericFormat){case M.INT:a=this.formatINTValue(a,c,e,b);break;case M.FLOAT:a=
this.formatFLOATValue(a,c,e,b);break;case M.HEXL:a=this.formatHexadecimalValue(a,c);break;case M.HEXU:a=this.formatHexadecimalValue(a,c);break;case M.EXP:a=this.formatExponentialValue(a,c,0,e,b);break;case M.EXPD:a=this.formatExponentialValue(a,c,1,e,b);break;default:a=this.applyPadding(a,c+"")}return a};b.getIndexesOfSeparators=function(a){for(var c={e:-1,E:-1,"+":-1,"-":-1,",":-1,h:-1,H:-1,".":-1,0:-1,"#":-1},e=0,b=a.length;e<b;e++){var d=a.charAt(e);switch(d){case "e":case "E":case "+":case "-":case ",":case "h":case "H":case ".":case "0":case "#":c[d]=
e}}return c};b.countOptionalDecimalDigits=function(a,c){for(var e=0,b=!1,d=a.length-1;d>c&&!b;d--)"#"==a.charAt(d)?e++:b=!0;return e};b.parseFormat=function(a){var c=R.NUMBER,e=M.INT,h=0,d=0,g=0,k=-1,f=1,m="",r=-1,v="0"==a.charAt(0)&&0<=a.lastIndexOf("#"),l=-1;if("none"==a.toLowerCase())c=R.TEXT;else{var C=b.getIndexesOfSeparators(a),p=-1!=C.e?C.e:C.E;-1!=p?(m=-1!=C.e?"e":"E",e=M.EXP,-1!=C["."]?(f=k=C["."],h=p-k-1,g=C["."]):(f=p,h=0,g=p),f=0<f?f:1,-1!=C["+"]&&2<=a.length-1-C["+"]&&(e=M.EXPD)):-1!=
C["."]?(e=M.FLOAT,k=C["."],h=a.length-1-k,d=b.countOptionalDecimalDigits(a,k),g=k):-1!=C.h||-1!=C.H?(e=-1!=C.h?M.HEXL:M.HEXU,g=r=-1!=C.h?C.h:C.H):-1!=C["#"]||C["0"]?(e=M.INT,g=a.length,-1!=C[","]&&(l=a.length-1-C[","])):c=R.TEXT}return{format:a,formatType:c,numericFormat:e,decimalPlaces:h,isPadding:v,magnitudeDegree:f,dotPos:k,leadingDigits:g,hPos:r,ePos:-1,eSymbol:m,oldDigitsGrouping:l,optionalDecimals:d}};b.format=function(a,c,e,h){return b.formatText(a,c,e,h)};b.addDecimalDigitsToFormat=function(a,
c){a+=".";for(var e=0;e<c;e++)a+="0";return a};b.addLeadingDigitsToFormat=function(a,c){for(var e=1;e<c;e++)a="0"+a;return a};b.generateDynamicFormat=function(a){var c=a.format,c=0<=c.indexOf("h")?"#h":0<=c.indexOf("H")?"#H":"#";void 0!==a.decimalPlaces&&"#"===c&&0<a.decimalPlaces&&(c=b.addDecimalDigitsToFormat(c,a.decimalPlaces));void 0!==a.leadingDigits&&0<a.leadingDigits&&(c=this.addLeadingDigitsToFormat(c,a.leadingDigits));return c};b.containsD=function(a,c){var e=c.length,b=a.indexOf(c);if(-1!=
b){var d=a.length;return(0<b-1&&"d"!=a.charAt(b-1)||-1==b-1)&&(b+e<d-e&&"d"!=a.charAt(b+e)||b+e==d)}return!1};b.parseDateTimeFormat=function(a,c){"LONG-DATE"==a?a=void 0!=c.longDateFormat?c.longDateFormat:a:"SHORT-DATE"==a&&(a=void 0!=c.shortDateFormat?c.shortDateFormat:a);var e={format:a,formatType:R.DATETIME},h=e.format.indexOf("AP"),d=e.format.indexOf("ap");-1!=h||-1!=d?(e.format=-1!=h?e.format.replace("AP","A"):e.format.replace("ap","a"),e.format=e.format.replace("HH","hh")):e.format=e.format.replace("hh",
"HH");e.format=e.format.replace(/y/g,"Y");if(b.containsD(e.format,"dd")||b.containsD(e.format,"d"))e.format=e.format.replace(/d/g,"D");e.format=e.format.replace(/m{4}/,"MMMM");e.format=e.format.replace(/D{4}/,"dddd");e.format=e.format.replace(/D{3}/,"ddd");return e};b.formatDateTime=function(a,c,e,b){a=moment(a);switch(c){case "global":a.utcOffset(0);break;case "server":void 0!==b.serverOffset?(c=b.serverOffset,720<c&&(c-=65536)):c=0,a.utcOffset(c)}c=e.format;e.milliseconds&&(c=e.format.replace(/ss/i,
"ss.SSS"));return a.format(c)};b.timeFormatValidator=/(((\s*h+\s*:\s*mm\s*:s+\s*)|(\s*mm\s*:s+\s*)|(\s*h+\s*:\s*mm\s*)|(\s*s+\s*)|(\s*mm^m\s*)|(\s*h+\s*))((AP\s*|A\s*|ap\s*|a\s*)?))/g;b.dateFormatValidator=/(((M+|mmmm)(.+)?(D+|d+)(.+)?(Y+|y+)(\s+)?)|((D+|d+)(.+)?(M+|mmmm)(.+)?(Y+|y+)(\s+)?)|((D+|d+)(.+)?(Y+|y+)(.+)?(M+|mmmm)(\s+)?)|((M+|mmmm)(.+)?(Y+|y+)(.+)?(D+|d+)(\s+)?)|((Y+|y+)(.+)?(M+|mmmm)(.+)?(D+|d+)(\s+)?)|((Y+|y+)(.+)?(D+|d+)(.+)?(M+|mmmm)(\s+)?)|((M+|mmmm)(.+)?(D+|d+)?(.+)?(Y+|y+)?(\s+)?)|((Y+|y+)(.+)?(D+|d+)?(.+)?(M+|mmmm)?(\s+)?)|((D+|d+)(.+)?(M+|mmmm)?(.+)?(Y+|y+)?(\s+)?))/g;
return b}();u.addModule("TextFormatUtil",Cd);Qa.prototype.setTime=function(b,a){this.date.hour(b);this.date.minutes(a)};Qa.prototype.setDate=function(b,a,c){this.date.dates(b);this.date.month(a);this.date.year(c)};Qa.prototype.getValue=function(b,a,c){return this.date.clone().toDate()};Qa.prototype.getUTCValue=function(b,a,c){return this.date.clone().utc().toDate()};Qa.prototype.start=function(){var b=this;this.interval=setInterval(function(){b.date.add(1,"s")},1E3)};Qa.prototype.stop=function(){clearInterval(this.interval)};
B.prototype.constructor="State";B.prototype.timestamp=null;B.prototype.value=null;B.prototype.quality=null;B.prototype.type=null;B.prototype.setState=function(b,a,c,e,h){this.quality=b&&b.constructor==va?b:new va(b);this.value=void 0;this.quality.isQualityGood()&&(this.value=a);this.type=c;this.ts=new Date(h);this.code=new x(e);return this};B.prototype.setValue=function(b){this.value=b};B.prototype.getValue=function(){return this.value};B.prototype.getQuality=function(){return this.quality};B.prototype.getTimestamp=
function(){return this.ts.getTime()};B.prototype.setTimestamp=function(b){this.ts=new Date(b)};B.prototype.isQualityGood=function(){return this.quality.isQualityGood()};B.prototype.setQualityStatus=function(b){if(this.quality)this.quality.setStatus(b);else{var a=new va;a.setStatus(b);this.quality=a}};B.prototype.getQualityBits=function(){return this.quality.qual<<6|this.quality.substatus<<2|this.quality.limit};B.prototype.setMessageCode=function(b){"string"==typeof b?this.code=new x(b):"number"==
typeof b?(this.code=new x,this.code.setValue(b)):this.code=new x};B.prototype.getMessageStatus=function(){return this.code};u.addModule("State",B);na.prototype.name=null;na.prototype.value=null;na.prototype.setState=function(b,a,c){this.name=b;this.value=a;this.code=new x(c);return this};na.prototype.getMessageStatus=function(){return this.code};na.prototype.getValue=function(){return this.value};na.prototype.constructor=na;V.prototype.x=null;V.prototype.q=null;V.prototype.y=null;V.prototype.selected=
!1;V.prototype.drw=!0;V.prototype.setState=function(b,a,c){this.x=b;this.y=a;this.q=c;return this};V.prototype.setDrawable=function(b){this.drw=b};V.prototype.select=function(b){this.selected=b};V.prototype.getValue=function(){return this.y};V.prototype.setValue=function(b){this.y=b};V.prototype.constructor=V;ha.prototype=Object.create(Kb.prototype);ha.prototype.Name=null;ha.prototype.Status=null;ha.prototype.RecipeSetList=null;ha.prototype.selSet=null;ha.prototype.lastSet=null;ha.prototype.rcList=
null;ha.prototype.constructor=ha;oa.prototype=Object.create(Kb.prototype);oa.prototype.id=null;oa.prototype.Name=null;oa.prototype.Value=null;oa.prototype.elemList=null;oa.prototype.constructor=oa;ta.prototype=Object.create(Kb.prototype);ta.prototype.id=null;ta.prototype.Name=null;ta.prototype.Value=null;ta.prototype.constructor=ta;x.prototype.code=null;x.prototype.status=x.status={E_FAIL:0,S_OK:1,E_INVALIDARG:-2,E_NO_SESSION_EXIST:-3,E_NEED_LOGIN:-4,E_UNKNOWNGROUP:-5,E_INACTIVEGROUP:-6,E_PROPERTY_NOT_MAPPED:-7,
E_RESOURCE_LOCATOR_NOT_FOUND:-8,E_CONFIG_FILE_NOT_FOUND:-9,E_INVALID_PROPERTY:-10,E_READ_FORBIDDEN:-11,E_INACTIVETAG:-12,E_NOT_BINDED_TO_PROTOCOL:-13,E_UNKNOWNTAG:-14,E_TIMEOUT:-15,E_INIT:-16,E_WRITE_FORBIDDEN:-18};x.status=x.prototype.status;x.prototype.setState=function(b){this.code=this.status[b]};x.getCode=function(b){return x.status[b]};x.prototype.toString=function(){switch(this.code){case this.status.E_FAIL:return"Request Failed";case this.status.S_OK:return"Success";case this.status.E_INVALIDARG:return"Invalid Arguments";
case this.status.E_NO_SESSION_EXIST:return"No Session Exists";case this.status.E_NEED_LOGIN:return"Need New Login";case this.status.E_UNKNOWNGROUP:return"Unknown Group";case this.status.E_INACTIVEGROUP:return"Inactive Group";case this.status.E_PROPERTY_NOT_MAPPED:return"Property Not Mapped";case this.status.E_RESOURCE_LOCATOR_NOT_FOUND:return"Resource Not Found";case this.status.E_CONFIG_FILE_NOT_FOUND:return"Configuration File Not Found";case this.status.E_INVALID_PROPERTY:return"Invalid Property";
case this.status.E_READ_FORBIDDEN:return"Read Forbidden";case this.status.E_INACTIVETAG:return"Tag is not active";case this.status.E_NOT_BINDED_TO_PROTOCOL:return"Protocol is not binded";case this.status.E_UNKNOWNTAG:return"Tag Name Is Not Known";case this.status.E_TIMEOUT:return"Timeout Request";case this.status.E_INIT:return"Error on Initialization"}};x.prototype.setValue=function(b){this.code=b};x.prototype.getValue=function(){return this.code};x.prototype.clone=function(){var b=new x;b.code=this.code;
return b};rc.prototype.createServer=function(b){switch(b.active){case "PollingInterface":this.serverClass=PollingInterface;break;case "SSEInterface":this.serverClass=Dc;break;case "offline":this.serverClass=Dc}return new this.serverClass(b)};var sc=function(b){var a={type:b.type,url:b.url,async:!1===b.asycn?!1:!0,search:""},c=b.data;if(c&&"string"==typeof c)a.search=c;else if(c&&"object"==typeof c){var e=[],h;for(h in c)e.push(encodeURIComponent(h)+"="+encodeURIComponent(c[h]));a.search=e.join("&")}a.search=
b.nocache?""==a.search?a.search+"nocache=1":a.search+"&nocache=1":""==a.search?a.search+(new Date).getTime():a.search+("&"+(new Date).getTime());a.type=void 0===a.type?"GET":a.type;b="";"GET"===a.type&&a.search&&(b=-1!=a.url.indexOf("?")?"&"+a.search:"?"+a.search);a.url+=b;return a},A=function(b){return new Promise(function(a,c){var e=new XMLHttpRequest;if(b.headers)for(var h in b.headers)xhr.setRequestHeader(h,b.headers[h]);h=sc(b);e.open(h.type,h.url,h.async);b.async&&(e.timeout="4000");e.onload=
function(){200<=e.status&&400>e.status?a(e.responseText):c(e.responseText);e.abort()};e.ontimeout=function(){c(e.responseText);e.abort()};e.onerror=function(){c(e.responseText);e.abort()};"GET"===h.type?e.send():e.send(h.search)})},p=this&&this.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,a){c.__proto__=a}||function(c,a){for(var b in a)a.hasOwnProperty(b)&&(c[b]=a[b])};return b(a,c)};return function(a,c){function e(){this.constructor=
a}b(a,c);a.prototype=null===c?Object.create(c):(e.prototype=c.prototype,new e)}}(),Yb=function(){function b(a){this.getRecipesConf=function(){return this._getConf("recipes.json")};this.getTableDataSource=function(c){return $.ajax({type:"GET",dataType:"json",url:this.webProjectUrl+"/datasources/"+c})};this.configuration={};this.defConf=null;this.projectPath="";this.loginStatus=!1;this.conf={exception:{ipad1:!1},ssemode:0};this.url=window.location.protocol+"//"+window.location.host;this.pathName=window.location.pathname;
this.projectName=a.projectName;var c=-1,c=this.pathName.indexOf("/web/web/pages");-1==c&&(c=this.pathName.indexOf("/web/web/umtemplates"));-1==c&&(c=this.pathName.indexOf("/web/web/_"));this.endpoint="";-1<c&&(c=this.pathName.substring(0,c).split("/"),this.endpoint=c.slice(0,c.length-1).join("/"),this.url+=this.endpoint);for(var e in a)this[e]=a[e]}b.prototype.loadLoginUI=function(a,c){location.href=this.url+"/index.html"+(a?"?denyDefUser=true":"?denyDefUser=false")+(c?"&forceLogin=true":"&forceLogin=false")};
b.prototype.loadIndex=function(){location.href=this.url+"/index.html"};b.prototype.getProjectInformation=function(){var a=this;return-1!=this[this.active].status?this.getProperty("projectRelativePath",!1).then(function(c){var e=c.getMessageStatus().getValue();e==x.status.S_OK?(a.projectPath=c.getValue().substring(10),a.webProjectUrl=a.url+"/"+a.projectPath+"/web/web",a.loginStatus=!0):e==x.status.E_PROPERTY_NOT_MAPPED&&(a.webProjectUrl=a.url+"/web",a.loginStatus=!0)},function(c){c.getMessageStatus().getValue()==
x.status.E_NEED_LOGIN&&(location.href=a.url+a.getLoginRoute())}):Promise.resolve(void 0)};b.prototype.getOptions=function(){return this.conf};b.prototype.setUrl=function(a){this.url=a};b.prototype.isLogged=function(){return this.loginStatus};b.prototype.getProperty=function(a,c){return A({url:this.url+"/cgi/getProperties",data:"n=1&it1="+a,async:!c,cache:!1}).then(function(c){var a=new na;c=c.split("\t");var b=c[1].trim();return"S_OK"==b?a.setState(c[0],c[2],b):a.setState(c[0],null,b)},function(c){var a=
new na;return c.responseText?a.setState(null,null,c.responseText.trim().replace("#","")):a.setState(null,null,"E_TIMEOUT")})};b.prototype.activateTag=function(a,c,e){return A({type:"POST",url:this.url+"/cgi/"+(c?"":"de")+"activateTags",data:"n=1&t1="+a,async:e})};b.prototype.activateTagSync=function(a,c){return Z({type:"GET",url:this.url+"/cgi/"+(c?"":"de")+"activateTags",data:"n=1&t1="+a,cache:!1})};b.prototype.requestConf=function(){this.defConf=A({type:"GET",url:this.webProjectUrl+"/config/conf.json",
cache:!1}).then(function(a){return a?JSON.parse(a):{}})};b.prototype.getConf=function(){return this.defConf};b.prototype.getAlarmConf=function(){return A({type:"GET",url:this.webProjectUrl+"/config/alarms.json",cache:!1}).then(function(a){return null!=a?JSON.parse(a):{}},function(){return{}})};b.prototype._getConf=function(a){return A({type:"GET",url:this.webProjectUrl+"/config/"+a,cache:!1}).then(function(c){return c?JSON.parse(c):{}})};b.prototype.getPropsMap=function(){return this._getConf("propsMap.json")};
b.prototype.getGroupsConf=function(){return this._getConf("groups.json")};b.prototype.getTagsConf=function(){return this._getConf("tags.json")};b.prototype.getTrendsConf=function(){return this._getConf("trends.json")};b.prototype.readTags=function(a,c){for(var e="",b=a.length,d=0;d<b;d++)e+="&t"+(d+1)+"="+a[d];var e="n="+b+e+"&nocache=1",g=this,k=u.getModule("Tag");return this.activateTags(a,c).then(function(a){if(0<=a.indexOf("S_OK"))return $.ajax({type:"POST",dataType:"json",url:g.url+"/cgi/readTags.json",
data:e,async:!c})}).then(function(c){var a=[];if(null!=c)for(var e=0;e<c.tgs.length;e++){var b=c.tgs[e];a.push((new k).setState(b.name,-1,b.value,b.code,b.quality))}return a})["catch"](function(c){return[]})};b.prototype.activateTags=function(a,c){return this._activateTags(a,!0,c)};b.prototype.deactivateTags=function(a,c){return this._activateTags(a,!1,c)};b.prototype._activateTags=function(a,c,e){for(var b="",d=a.length,g=0;g<d;g++)b+="&t"+(g+1)+"="+a[g];return A({type:"POST",url:this.url+"/cgi/"+
(c?"":"de")+"activateTags",data:"n="+d+b,async:!e})};b.prototype.readTag=function(a){return this._readTagsJsonAsynch(a.name,a.index)};b.prototype.readTagSync=function(a){return this._readTagsJsonSync(a.name,a.index)};b.prototype._readTagsJsonSync=function(a,c){var e=this.url+"/cgi/readTags.json",b="returnType=true&returnTS=true&n=1&t1="+encodeURIComponent(a)+"."+c+"&nocache=1",d=new B,g=this.activateTagSync(a,!0);200<=g.status&&400>g.status?(g=g.data,0<=g.indexOf("S_OK")?(e=Z({url:e,data:b}),200<=
e.status&&400>e.status?(e=e.data,null!=e?(e=JSON.parse(e).tgs[0],d.setState(e.quality,e.value,e.type,e.code,e.ts),this.activateTag(a,!1,!0)):d.setMessageCode(x.status.E_FAIL)):d.setMessageCode(x.status.E_TIMEOUT)):0<=g.indexOf("E_UNKNOWNTAG")?d.setMessageCode(x.status.E_UNKNOWNTAG):d.setMessageCode(x.status.E_FAIL)):d.setMessageCode(x.status.E_TIMEOUT);return d};b.prototype._readTagsJsonAsynch=function(a,c){var e=this.url+"/cgi/readTags.json",b="returnType=true&returnTS=true&n=1&t1="+encodeURIComponent(a)+
"."+c+"&nocache=1",d=this;return this.activateTag(a,!0,!0).then(function(c){if(0<=c.indexOf("S_OK"))return $.getJSON(e,b);if(0<=c.indexOf("E_UNKNOWNTAG")){c=c.split("\t");var a=new x("E_UNKNOWNTAG");f.showErrorMessage("ServerInterface","ActivateTag",a.toString()+": "+c[0])}return null}).then(function(c){var e=new B;null!=c&&(c=c.tgs[0],e.setState(c.quality,c.value,c.type,c.code,c.ts),d.activateTag(a,!1,!0));return e})["catch"](function(){var c=new B;c.setMessageCode(x.status.E_TIMEOUT);return c})};
b.prototype.writeTag=function(a,c,e,b){return b?this._writeTagSync(a,c,e):this._writeTagAsync(a,c,e)};b.prototype._writeTagAsync=function(a,c,e){a="n=1&t1="+encodeURIComponent(a.name)+"."+a.index+"&v1="+encodeURIComponent(c)+"&nocache=1";return A({type:"POST",url:this.url+"/cgi/writeTags.json",data:a,timeout:3E4,async:!0}).then(function(c){if(null!=c){var a=JSON.parse(c);e.setState(a.tgs[0])}return a})};b.prototype._writeTagSync=function(a,c,e){e=this.url+"/cgi/writeTags.json";c="n=1&t1="+encodeURIComponent(a.name)+
"."+a.index+"&v1="+encodeURIComponent(c)+"&nocache=1";a=new B;e=Z({url:e,data:c});200<=e.status&&400>e.status?(e=e.data,null!=e?(e=JSON.parse(e).tgs[0],a.setState(e.quality,e.value,e.type,e.code,e.ts)):a.setMessageCode(x.status.E_FAIL)):a.setMessageCode(x.status.E_TIMEOUT);return a};b.prototype.readGroup=function(a,c,e){return e?this.readGroupJsonSync(a,c):this.readGroupJsonAsync(a,c)};b.prototype.readGroupJsonAsync=function(a,c){return A({type:"GET",url:this.url+"/cgi/readGroups.json",data:"n=1&gr1="+
encodeURIComponent(a),cache:!1,timeout:12E3}).then(function(a){return a?(a=JSON.parse(a).gs[0],c.setState(a.g.name,a.g.code,a.tgs),c):{}})};b.prototype.readGroupJsonSync=function(a,c){return $.ajax({type:"GET",dataType:"JSON",url:this.url+"/cgi/readGroups.json",data:"n=1&gr1="+encodeURIComponent(a),cache:!1,timeout:12E3,async:!1}).then(function(a){if(a){a=JSON.parse(a);var b=a.gs[0];c.setState(b.g.name,b.g.code,b.tgs);return a}return{}})};b.prototype.readGroups=function(a,c,e){return e?this.readGroupsSync(a,
c):this.readGroupsAsync(a,c)};b.prototype.readGroupsSync=function(a,c){for(var e=this,b=a.length,d="",g=1;g<=b;g++)d+="gr"+g+"="+a[g-1],g!=b&&(d+="&");return $.ajax({type:"GET",dataType:"JSON",url:this.url+"/cgi/readGroups.json",data:"n="+b+"&"+encodeURIComponent(d),cache:!1,timeout:12E3,async:!1}).then(function(a){a&&e.consumeReadGroups(a,c);return c})};b.prototype.readGroupsAsync=function(a,c){for(var e=this,b=a.length,d="",g=1;g<=b;g++)d+="gr"+g+"="+a[g-1],g!=b&&(d+="&");return A({type:"GET",url:this.url+
"/cgi/readGroups.json",data:"n="+b+"&"+encodeURIComponent(d),cache:!1,async:!0,timeout:12E3}).then(function(a){a&&(a=JSON.parse(a),e.consumeReadGroups(a,c));return c})};b.prototype.consumeReadGroups=function(a,c){for(var e=u.getModule("Tag"),b=0;b<a.gs.length;b++){var d=a.gs[b],g=[];if(d.tgs)for(var k=d.tgs.length,f=0;f<k;f++){var m=d.tgs[f];g.push((new e).setState(m.name,-1,m.value,m.code,m.quality))}c[b].setState(d.g.name,d.g.code,g)}};b.prototype.activateGroup=function(a,c,e){return e?this._activateGroupsJsonSync([a],
[c],!0):this._activateGroupsJsonAsync([a],[c],!0)};b.prototype.deactivateGroup=function(a,c,e){return e?this._activateGroupsJsonSync([a],[c],!1):this._activateGroupsJsonAsync([a],[c],!1)};b.prototype.activateGroups=function(a,c,e){return e?this._activateGroupsJsonSync(a,c,!0):this._activateGroupsJsonAsync(a,c,!0)};b.prototype.deactivateGroups=function(a,c,e){return e?this._activateGroupsJsonSync(a,c,!1):this._activateGroupsJsonAsync(a,c,!1)};b.prototype._activateGroupsJsonAsync=function(a,c,e){for(var b=
this,d=this.url,g=a.length,k="",f=1;f<=g;f++)k+="gr"+f+"="+a[f-1],f!=g&&(k+="&");return A({type:"GET",url:e?d+"/cgi/activateGroups.json":d+"/cgi/deactivateGroups.json",data:"n="+g+"&"+encodeURIComponent(k),async:!0}).then(function(a){a&&(a=JSON.parse(a),b.consumeActivateGroupResponse(a,e,c));return c})};b.prototype._activateGroupsJsonSync=function(a,c,e){for(var b=this,d=this.url,g=a.length,k="",f=1;f<=g;f++)k+="gr"+f+"="+a[f-1],f!=g&&(k+="&");return $.ajax({type:"GET",dataType:"JSON",url:e?d+"/cgi/activateGroups.json":
d+"/cgi/deactivateGroups.json",data:"n="+g+"&"+encodeURIComponent(k),cache:!1,timeout:12E3,async:!1}).then(function(a){b.consumeActivateGroupResponse(a,e,c);return c})};b.prototype.consumeActivateGroupResponse=function(a,c,e){if(a)for(var b=0;b<a.gs.length;b++){var d=a.gs[b];c&&e[b].setState(d.name,d.code,null)}};b.prototype.getDLSSettings=function(a){return A({type:"GET",url:this.url+"/cgi/getDLSSettings",async:!a}).then(function(c){c=c.split("\n");var a={};"#S_OK"==c[0]?(a.status=c[0],a.stdoff=
parseFloat(c[1]),a.stdw=parseFloat(c[2]),a.stdd=parseFloat(c[3]),a.stdm=parseFloat(c[4]),a.stdhh=parseFloat(c[5]),a.stdmm=parseFloat(c[6]),a.dlsoff=parseFloat(c[7]),a.dlsw=parseFloat(c[8]),a.dlsd=parseFloat(c[9]),a.dlsm=parseFloat(c[10]),a.dlshh=parseFloat(c[11]),a.dlsmm=parseFloat(c[12]),a.mode=parseFloat(c[13])):a.status=c[0];return a})};b.prototype.getLocalTime=function(a){return A({type:"GET",url:this.url+"/cgi/getLocalTime",async:!a}).then(function(c){c=c.split("\n");var a={};"#S_OK"==c[0]?(a.status=
c[0],a.time=c[1]):a.status=c[0];return a})};b.prototype.setLocalTime=function(a,c,e,b,d,g,k){return A({type:"GET",url:this.url+"/cgi/setLocalTime",data:"sec="+a+"&min="+c+"&hour="+e+"&day="+b+"&month="+d+"&year="+g,async:!k}).then(function(c){return{status:c}})};b.prototype.getTime=function(a){return A({type:"GET",url:this.url+"/cgi/getTime?nocache=1",async:!a}).then(function(c){c=c.split("\n");var a={};"#S_OK"==c[0]?(a.status=c[0],a.time=1E3*parseFloat(c[1])):a.status=c[0];return a})};b.prototype.setTime=
function(a,c){return A({type:"GET",url:this.url+"/cgi/setTime",data:"time="+a,async:!c}).then(function(c){return{status:c}})};b.prototype.readAlarms=function(a,c){for(var e="",b=0,d=a.length,g=0;g<d;g++)e+="&al"+ ++b+"="+a[g];return A({type:"POST",url:this.url+"/cgi/readAlarms",data:"n="+b+e,timeout:12E3,async:!c}).then(function(c){return c})};b.prototype.resetAlarms=function(a,c){for(var e="",b=0,d=a.length,g=0;g<d;g++)e+="&al"+ ++b+"="+a[g];return A({type:"POST",url:this.url+"/cgi/resetAlarms",
data:"n="+b+e,async:!c})};b.prototype.acknowledgeAlarms=function(a,c){for(var e="",b=0,d=a.length,g=0;g<d;g++)e+="&al"+ ++b+"="+a[g];return A({type:"POST",url:this.url+"/cgi/acknowledgeAlarms",data:"n="+b+e,async:!c})};b.prototype.enableAlarms=function(a,c,e){for(var b="",d=0,g=a.length,k=0;k<g;k++)b+="&al"+ ++d+"="+a[k];return A({type:"POST",url:this.url+"/cgi/enableAlarms",data:"n="+d+b+"&enableflag="+c,async:!e})};b.prototype.saveConfiguration=function(a){return A({type:"GET",url:this.url+"/cgi/saveConfiguration",
cache:!1,async:!a})};b.prototype.readEvent=function(a,c){return this._GET(this.url+"/cgi/readEvent.json",a.toURL(),!1)};b.prototype.getLoginRoute=function(){var a="_web";/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)?a="_mobi":/iPad|RIM Tablet OS/i.test(navigator.userAgent)&&(a="_tablet");return"/public/"+a+"login.html?_="+(new Date).getTime()};b.prototype.deleteEventArchive=function(a){return A({type:"GET",url:this.url+"/cgi/deleteEventArchive",data:"archive="+a,timeout:12E3})};
b.prototype.deleteTrend=function(a,c){return this._GET(this.url+"/cgi/deleteTrendFile.json","tr="+encodeURIComponent(a),c)};b.prototype.dumpTrend=function(a,c){var e=this.url+"/cgi/dumpTrendFile.json",b="tr="+encodeURIComponent(a.n)+"&folder="+a.f+"&dformat="+a.fmt+"&dtPrefix="+a.dt+"&localTs="+a.dts;a.fnformat&&(b+="&fformat="+encodeURIComponent(a.fnformat));a.csvfields&&(b+="&csvfields="+a.csvfields);a.csvlogs&&(b+="&csvlogs="+a.csvlogs);a.dtformat&&(b+="&dtformat="+a.dtformat);a.langcode&&(b+=
"&lang="+a.langcode);return this._POST(e,b,c)};b.prototype.readTrend=function(a,c,e,b,d){a="tr="+encodeURIComponent(a)+"&returnTS=true&returnRT=false&startTime="+parseInt((c/1E3).toString())+"&endTime="+parseInt((e/1E3).toString());a=b?a+("&nSamples="+b):a+"&nSamples=0";a=(d?a+("&deltaTime="+d):a+"&deltaTime=0")+"&bounds=true";var g=u.getModule("Quality");return A({type:"GET",url:this.url+"/cgi/readTrend.json",data:a,timeout:12E3}).then(function(c){c=JSON.parse(c);var a={n:c.n,d:null};if("S_OK"==
c.code||"S_MOREDATA"==c.code){var e=c.d.length;a.d=Array(e);for(var b=0;b<e;b++){var h=c.d[b],d=new g(h.q);d.isQualityBad()&&(h.v=void 0);a.d[b]=new V(1E3*h.rts,h.v,d)}}return{s:a,c:c.code}})};b.prototype._GET=function(a,c,e){return this._request("GET",a,c,e)};b.prototype._POST=function(a,c,e){return this._request("POST",a,c,e)};b.prototype._request=function(a,c,e,b){return A({type:a,url:c,data:e,cache:!1,timeout:12E3,async:!b}).then(function(c){return JSON.parse(c)})};b.prototype._GET_SYNC=function(a,
c){var e=Z({type:"GET",url:a,data:c,cache:!1,timeout:12E3});return JSON.parse(e.data)};b.prototype.downloadRecipe=function(a,c,e){return this._GET(this.url+"/cgi/downloadRecipe.json","rc="+a+"&st="+c,e)};b.prototype.uploadRecipe=function(a,c,e){return this._GET(this.url+"/cgi/uploadRecipe.json","rc="+a+"&st="+c,e)};b.prototype.setCurrentRecipe=function(a,c,e){var b=this.url+"/cgi/setCurrRecipe.json";a="rc="+a;null!==c&&void 0!==c&&(a+="&st="+c);return this._GET(b,a,e)};b.prototype.setRecipeSet=function(a,
c,e){return this._GET(this.url+"/cgi/setRecipeSet.json","rc="+a+"&st="+c,e)};b.prototype.resetRecipe=function(a,c){return this._GET(this.url+"/cgi/resetRecipe.json","rc="+a,c)};b.prototype.getRecipeList=function(a){return this._GET(this.url+"/cgi/getRecipeList.json","",a).then(function(c){return"S_OK"==c.code?c.rc:null})};b.prototype.addRecipeDataSet=function(a,c,e,b,d){return this._GET(this.url+"/cgi/addRecipeDataSet.json","rc="+a+"&cp="+c+"&ns="+e+"&nt="+b,d)};b.prototype.delRecipeDataSet=function(a,
c,e){return this._GET(this.url+"/cgi/delRecipeDataSet.json","rc="+a+"&s="+c,e)};b.prototype.dumpRecipeData=function(a,c,e,b,d,g,k,f){var m=this.url+"/cgi/dumpRecipe.json";a="rc="+a+"&ds="+c+"&path="+encodeURIComponent(e)+"&fname="+encodeURIComponent(b)+"&dt="+g+"&ts="+k;void 0!=d&&(a+="&tname="+d);return this._GET(m,a,f)};b.prototype.restoreRecipeData=function(a,c,e,b,d,g,k,f){var m=this.url+"/cgi/restoreRecipe.json";a="rc="+a+"&st="+c+"&path="+encodeURIComponent(e)+"&fname="+encodeURIComponent(b)+
"&rt="+k+"&browse="+g;void 0!=d&&(a+="&tname="+d);return this._GET(m,a,f)};b.prototype.getRecipeSetList=function(a,c){return this._GET(this.url+"/cgi/getRecipeSets.json","rc="+a,c)};b.prototype._decodeRecipe=function(a){var c;a.p&&a.p.s&&a.p.s.el?c=new ta(a.p.s.el.id,a.p.s.el.n,a.p.s.el.v):a.p&&a.p.s?c=new oa(a.p.s.id,a.p.s.n,a.p.s.v):a.p&&(c=new ha(a.p.id,a.p.n,a.p.status,a.p.slist,a.p.selset,a.p.lastset));return c};b.prototype.getRecipeParams=function(a,c,e){var b=this.url+"/cgi/getRecipeParams.json",
d="";"all"==c&&(d="rc="+a+"&getid=true&getlastdwnset=true&getselset=true&getstatus=true&getsetlist=true");var g=this;return this._GET(b,d,e).then(function(c){if("S_OK"==c.code)return g._decodeRecipe(c)})};b.prototype.setRecipeParam=function(a,c,e){return this._GET(this.url+"/cgi/setRecipeParam.json","rc="+a+"&v="+c,e)};b.prototype.setRecipeSetParam=function(a,c,e,b,d){return this._GET(this.url+"/cgi/setRecipeSetParam.json","rc="+a+"&s="+c+"&a="+e+"&v="+b,d)};b.prototype.setRecipeElemParam=function(a,
c,e,b,d,g){return this._GET(this.url+"/cgi/setRecipeElemParam.json","rc="+a+"&s="+c+"&e="+e+"&a="+b+"&v="+d,g)};b.prototype._getRFlag=function(a){var c="";a=a.toLowerCase();"name"==a?c+="&getname=true":"status"==a?c+="&getstatus=true":"value"==a&&(c+="&getvalue=true");return c};b.prototype.getRecipeParam=function(a,c,e){var b=this,d=this.url+"/cgi/getRecipeParams.json",g="&getid=true"+this._getRFlag(c);return e?(a=this._GET_SYNC(d,"rc="+a+g))&&"S_OK"==a.code?{v:this._decodeRecipe(a)[c]}:{err:a.code}:
this._GET(d,"rc="+a+g,e).then(function(a){return a&&"S_OK"==a.code?{v:b._decodeRecipe(a)[c]}:{err:a.code}})};b.prototype.getRecipeSetParam=function(a,c,e,b){var d=this,g=this.url+"/cgi/getRecipeSetsParams.json",k="&getid=true"+this._getRFlag(e);return b?(a=this._GET_SYNC(g,"rc="+a+"&st="+c+k))&&"S_OK"==a.code?{v:this._decodeRecipe(a)[e]}:{err:a.code}:this._GET(g,"rc="+a+"&st="+c+k,!1).then(function(c){return c&&"S_OK"==c.code?{v:d._decodeRecipe(c)[e]}:{err:c.code}})};b.prototype.getRecipeElemParam=
function(a,c,e,b){var d=this.url+"/cgi/getRecipeSetsParams.json",g="&getid=true&getelems=true"+this._getRFlag(b);return(a=this._GET_SYNC(d,"rc="+a+"&st="+c+"&i="+e+g))&&"S_OK"==a.code?{v:this._decodeRecipe(a)[b]}:{err:a.code}};b.prototype.changePwd=function(a,c,e,b){return this._GET(this.url+"/cgi/changePassword","username="+a+"&oldpswd="+c+"&newpswd="+e,b)};b.prototype.logOut=function(){this.loginStatus=!1;return $.ajax({type:"GET",url:this.url+"/cgi/logout",cache:!1})};b.prototype.getResource=function(a){return A({type:"GET",
url:"../modules/resources/"+a,cache:!1})};b.prototype.getPrecachedPages=function(){var a=window.location.href.substring(0,window.location.href.lastIndexOf("/")+1);return A({type:"GET",url:a+"precached.html",cache:!1}).then(function(c){var a=document.createElement("div");a.innerHTML=c;return a})};b.formatTagOperationRequest=function(a){var c=Array(a.length+1);c[0]="n="+a.length;return a.reduce(function(c,a,b){b+=1;c[b]="t"+b+"="+a.name;void 0!==a.arrayIndex&&(c[b]+="."+a.arrayIndex);a=a.params;for(var g in a)c[b]+=
"&"+g+b+"="+a[g];return c},c).join("&")};b.prototype.stepTags=function(a){a=b.formatTagOperationRequest(a);return A({type:"POST",url:this.url+"/cgi/stepTags.json",data:a,timeout:3E4,async:!0}).then(function(c){return null!=c?JSON.parse(c):null})};b.prototype.stepTagsSync=function(a){a=b.formatTagOperationRequest(a);a=Z({type:"POST",url:this.url+"/cgi/stepTags.json",data:a});return a.data?JSON.parse(a.data):null};b.prototype.setBitTags=function(a){a=b.formatTagOperationRequest(a);return A({type:"POST",
url:this.url+"/cgi/setBitTags.json",data:a,timeout:3E4,async:!0}).then(function(c){return null!=c?JSON.parse(c):null})};b.prototype.setBitTagsSync=function(a){a=b.formatTagOperationRequest(a);a=Z({type:"POST",url:this.url+"/cgi/setBitTags.json",data:a});return a.data?JSON.parse(a.data):null};b.prototype.resetBitTags=function(a){a=b.formatTagOperationRequest(a);return A({type:"POST",url:this.url+"/cgi/resetBitTags.json",data:a,timeout:3E4,async:!0}).then(function(c){return null!=c?JSON.parse(c):null})};
b.prototype.resetBitTagsSync=function(a){a=b.formatTagOperationRequest(a);a=Z({type:"POST",url:this.url+"/cgi/resetBitTags.json",data:a});return a.data?JSON.parse(a.data):null};b.prototype.toggleBitTags=function(a){a=b.formatTagOperationRequest(a);return A({type:"POST",url:this.url+"/cgi/toggleBitTags.json",data:a,timeout:3E4,async:!0}).then(function(c){return null!=c?JSON.parse(c):null})};b.prototype.toggleBitTagsSync=function(a){a=b.formatTagOperationRequest(a);a=Z({type:"POST",url:this.url+"/cgi/toggleBitTags.json",
data:a});return a.data?JSON.parse(a.data):null};b.prototype.getClientID=function(){return A({type:"GET",url:this.url+"/cgi/getClientID.json"}).then(function(a){return null!=a?JSON.parse(a):null})};b.prototype.subscribeNotification=function(a,c){return null};b.prototype.unsubscribeNotification=function(a,c){};b.prototype.subscribeAlarms=function(a,c){return null};b.prototype.subscribeEvent=function(a,c){return null};b.prototype.unsubscribeEvent=function(a){};b.prototype.subscribeGroups=function(a,
c){return null};b.prototype.unsubscribeGroups=function(a){};b.prototype.subscribeTags=function(a,c){return null};b.prototype.unsubscribeTags=function(a){};b.prototype.subscribeRecipe=function(a,c){return null};b.prototype.subscribeRecipeSetList=function(a,c){return null};b.prototype.subscribeRecipeSet=function(a,c,e){return null};b.prototype.subscribeRecipeSetElem=function(a,c,e,b){return null};b.prototype.isSessionAlive=function(){return null};b.prototype.getConnectionStatus=function(){return null};
b.prototype.onConnectionReady=function(a){};b.prototype.enableOption=function(a){};b.prototype.subscribeTrend=function(a,c){return null};b.prototype.unsubscribeTrend=function(a,c){return null};b.prototype.readSubTrends=function(a,c){};b.prototype.updateTrendSubscription=function(a){};b.prototype.unsubscribeRecipeSetList=function(a){};b.prototype.unsubscribeRecipe=function(a){};b.prototype.unsubscribeRecipeSet=function(a,c){};b.prototype.unsubscribeRecipeSetElem=function(a,c,e){};b.prototype.setRecipeNotificationRate=
function(a){};return b}(),Dc=function(b){function a(c){var e=b.call(this,c)||this;e.resetSubscriptions=function(){this.resetTagsSubscriptions();this.resetGroupsSubscriptions();this.resetAlarmsSubscriptions()};e._sendMessage=function(c){0==this.connSatus?this.rQueue.push(c):this.sseWorker.postMessage(c)};e.updateTrendSubscription=function(c){this.ttObj.id=c.wgtId;this.ttObj.start=c.hStartTime;this.ttObj.end=c.hEndTime;this.ttObj.trendName=c.hTrendName;this.ttObj.maxSamp=c.hMaxNSamples;this.ttObj.delta=
c.deltaTime;this._sendMessage(this.ttObj)};e.clientId=null;e.maxSize=1024;e.minPeriod=1E3;e.communicationWorker=null;e.tagsCallbacks={};e.recipeCb={};e.trendCb={};e.ttObj={c:a.WORKER_MSG_CODE.UPTRENDDATA,id:"",start:0,end:0,trendName:"",maxSamp:0,delta:0};if(-1!=c[c.active].status){var h=e.projectName.split("/");e.currPrjName=h[h.length-1];e.projectPath=h.slice(0,h.length-1).join("/");e.lastConnStatus=1;e.event={};e.clientId=(new Date).getTime()+""+Math.floor(1E3*Math.random());e.sseRoute=e.url+"/cgi/sse";
e.minPeriod=e.SSEInterface.pollRate;e.conf.exception.ipad1=-1!=navigator.userAgent.indexOf("AppleWebKit/534")&&-1!=navigator.userAgent.indexOf("Safari")&&-1!=navigator.userAgent.indexOf("iPad;")&&-1!=navigator.userAgent.indexOf("Mac OS X")&&-1!=navigator.userAgent.indexOf("7534");var h=e.pathName.split("/"),d=void 0,d="web"==h[h.length-2]?"js/comWorker.min.js":"../js/comWorker.min.js";e.sseWorker=window.MSInputMethodContext&&document.documentMode?new PseudoWorker(d):new Worker(d);e.communicationWorker=
e.sseWorker;e.RESTWorker=null;e.rQueue=[];e.connReadyQueue=[];e.connSatus=0;e.workerInit=!1;e.bIsWorkerReady=!1;e.subscriptions={notifications:{},tags:{},groups:{},alarms:{}};e.sseWorker.addEventListener("message",function(a){a=a.data;if("ready"==a.e)if(e.bIsWorkerReady||(e.addTagListener(),e.addAlarmsListener(),e.addEventBufferListener(),e.addRecipeListener(),e.addTrendListener(),e.addSubTrendsListener(),e.RESTWorker=new tc(e.sseWorker)),e.sseWorker.postMessage({c:1}),e.conf.ssemode=a.data.mode,
e.keepConnectionAlive(),e.bIsWorkerReady=!0,1==e.connSatus)e.resetSubscriptions();else{e.connSatus=1;a=0;for(var b=e.rQueue.length;a<b;a++)e._sendMessage(e.rQueue[a]);a=0;for(b=e.connReadyQueue.length;a<b;a++)e.connReadyQueue[a]()}else"bootstrap"==a.e&&(e.sseWorker.postMessage({c:0,url:e.url,pollRate:e.minPeriod,ttl:e.ttl,maxBandwidth:c.maxBandwidth,connectionMode:c.connectionMode}),e.workerInit=!0)})}return e}p(a,b);a.prototype.systemReadyForData=function(){null!==this.communicationWorker&&this.workerInit&&
this.communicationWorker.postMessage({c:4})};a.prototype.onConnectionReady=function(c){"function"==typeof c&&this.connReadyQueue.push(c)};a.prototype.getConnectionStatus=function(){return this.connSatus};a.prototype.resetTagsSubscriptions=function(){var c=this.subscriptions.tags,a;for(a in c)c=a.split(";"),0<c.length&&this._sendMessage({c:8,tags:c})};a.prototype.resetGroupsSubscriptions=function(){var c=this.subscriptions.groups,a=[],b;for(b in c)a.push(b);this._sendMessage({c:2,groups:a})};a.prototype.resetAlarmsSubscriptions=
function(){var c=this.subscriptions.alarms,a;for(a in c)this._sendMessage({c:5,alarms:a})};a.prototype.addTagListener=function(){var c=this.subscriptions.tags,a=this.subscriptions.groups,b=this.subscriptions.notifications;this.sseWorker.addEventListener("message",function(d){d=d.data;if("tags"==d.e){for(var g in b)if("function"==typeof b[g])b[g](d.data);for(g in c)if("function"==typeof c[g])c[g](d.data);for(g in a)if("function"==typeof a[g])a[g](d.data)}})};a.prototype.addAlarmsListener=function(){var c=
this,a=this.subscriptions.alarms;this.sseWorker.addEventListener("message",function(b){b=b.data;if("alarms"==b.e){b=c.decodeAlarms(b.data);for(var d in a)a[d](b)}})};a.prototype.addTrendListener=function(){var c=this;this.sseWorker.addEventListener("message",function(a){a=a.data;if("trend"==a.e&&"function"==typeof c.trendCb[a.id])c.trendCb[a.id](a.id,a.data)})};a.prototype.addSubTrendsListener=function(){var c=this;this.sseWorker.addEventListener("message",function(a){a=a.data;if("subTrends"==a.e){for(var b=
a.data,d=0;d<b.length;d++)b[d].n=b[d].n.split(".")[1];if("function"==typeof c.trendCb[a.id])c.trendCb[a.id](a.id,b)}})};a.prototype.addRecipeListener=function(){var c=this;this.sseWorker.addEventListener("message",function(e){e=e.data;if("recipe"==e.e){e=JSON.parse(e.data);var b=e.data,d=!1,g;if(b.p&&b.p.s&&b.p.s.el)g=new ta(b.p.s.el.id,b.p.s.el.n,b.p.s.el.v);else if(b.p&&b.p.s)g=new oa(b.p.s.id,b.p.s.n,b.p.s.v);else if(b.p)g=new ha(b.p.id,b.p.n,b.p.status,b.p.slist,b.p.selset,b.p.lastset,b.p.rclist),
d=b.p.c;else return;d&&c.recipeCb.curRecipe.cb("curRecipe",g);for(var k in c.recipeCb)if("function"==typeof c.recipeCb[k].cb&&e.id==k){switch(c.recipeCb[k].type){case a.RCP_CB_TYPE.RC:c.recipeCb[k].cb(k+".Name",g);c.recipeCb[k].cb(k+".Status",g);break;case a.RCP_CB_TYPE.RC_LST:c.recipeCb[k].cb(k,g);break;case a.RCP_CB_TYPE.RC_SET:case a.RCP_CB_TYPE.RC_EL:c.recipeCb[k].cb(k+".Name",g),c.recipeCb[k].cb(k+".Value",g)}break}}})};a.prototype.keepConnectionAlive=function(){var c=this;this.sseWorker.postMessage({c:9});
this.bIsWorkerReady||this.sseWorker.addEventListener("message",function(a){a=a.data;"connection"==a.e&&(c.lastConnStatus=a.data.status,a.data.prjName&&(c.currPrjName=a.data.prjName))})};a.prototype.decodeTags=function(c){for(var a=u.getModule("Tag"),b=[],d=0,g=c.length;d<g;d++){var k=c[d];b.push(new a(k.n,-1,k.v.v,"S_OK",k.v.q,k.v.ts))}return b};a.prototype.decodeAlarms=function(c){for(var a=[],b=u.getModule("Alarm"),d=0,g=c.length;d<g;d++){var k=c[d];a.push(new b(k.n,k.v.st,k.v.v1,k.v.dtt,k.v.dt,
k.v.tm,"S_OK",k.v.d))}return a};a.prototype.subscribeTags=function(c,a){var b=c.join(";");this.subscriptions.tags[b]=a;0<c.length&&this._sendMessage({c:8,tags:c});return b};a.prototype.unsubscribeTags=function(c){var a=c.join(";");this.subscriptions.tags[a]&&delete this.subscriptions.tags[a];0<c.length&&this._sendMessage({c:19,tags:c})};a.prototype.subscribeNotification=function(c,a){var b;if("tags"==c){var d=this.subscriptions.notifications;do b=(new Date).getTime();while(d[b]);d[b]=a}return b};
a.prototype.unsubscribeNotification=function(c,a){"tags"==c&&delete this.subscriptions.notifications[a]};a.prototype.subscribeGroups=function(c,a){if(0==c.length)return["-1"];for(var b=this.subscriptions.groups,d=0,g=c.length;d<g;d++)a&&"function"==typeof a[d]?b[c[d]]=a[d]:null===a&&(b[c[d]]=null);this._sendMessage({c:2,groups:c,callbacks:a});return c};a.prototype.unsubscribeGroups=function(c){if(null!=c&&0!=c.length){for(var a=this.subscriptions.groups,b=0,d=c.length;b<d;b++)delete a[c[b]];this._sendMessage({c:3,
groups:c})}};a.prototype.subscribeAlarms=function(c,a){this.subscriptions.alarms[c]=a;this._sendMessage({c:5,alarms:c});return c};a.prototype.subscribeEvent=function(c,a){var b=c.getId();this.event[b]||(this.event[b]=[]);this.event[b].push({ref:c.getBufferId(),cb:a});this.sseWorker.postMessage({c:6,id:b,request:c.toURL()});return b};a.prototype.addEventBufferListener=function(){var c=this,a=u.getModule("IDALEvent");this.sseWorker.addEventListener("message",function(b){if("events"==b.data.e){b=JSON.parse(b.data.data);
var d=b.data,g=[];if("S_NODATA"!=d.st)for(var d=d.data,k=0,f=d.length;k<f;k++){var m=d[k];g.push(new a(m.t,m.s,m.at,m.ts,m.v))}for(var r in c.event)if(r==b.id)for(k=0,f=c.event[r].length;k<f;k++)c.event[r][k].cb(g)}})};a.prototype.unsubscribeEvent=function(c){var a=c.getId();if(this.event[a]){this.sseWorker.postMessage({c:7,id:a});for(var b=0,d=this.event[a].length;b<d;b++)if(this.event[a][b].ref==c.getBufferId()){this.event[a].splice(b,1);break}0==this.event[a].length&&delete this.event[a]}};a.prototype.isSessionAlive=
function(){return{status:this.lastConnStatus,projectName:this.projectPath+"/"+this.currPrjName}};a.prototype.enableOption=function(c){"ipad1fix"==c&&this.sseWorker.postMessage({c:10})};a.prototype.setRecipeNotificationRate=function(c){this._sendMessage({c:a.WORKER_MSG_CODE.RCPRATE,r:c})};a.prototype.subscribeRecipe=function(c,e){if(!this.recipeCb[c])return this.recipeCb[c]={cb:e,type:a.RCP_CB_TYPE.RC},this._sendMessage({c:a.WORKER_MSG_CODE.SBSRCP,en:!0,rc:c}),c};a.prototype.subscribeRecipeSetList=
function(c,e){var b=c+".RecipeSetList";if(this.recipeCb[b])return null;this.recipeCb[b]={cb:e,type:a.RCP_CB_TYPE.RC_LST};this._sendMessage({c:14,en:!0,rc:c});return b};a.prototype.subscribeRecipeSet=function(c,e,b){var d=c+"."+e;if(this.recipeCb[d])return null;this.recipeCb[d]={cb:b,type:a.RCP_CB_TYPE.RC_SET};this._sendMessage({c:12,en:!0,rc:c,st:e});return d};a.prototype.subscribeRecipeSetElem=function(c,e,b,d){var g=c+"."+e+"."+b;if(this.recipeCb[g])return null;this.recipeCb[g]={cb:d,type:a.RCP_CB_TYPE.RC_EL};
this._sendMessage({c:13,en:!0,rc:c,set:e,el:b});return g};a.prototype.unsubscribeRecipe=function(c){this._sendMessage({c:11,en:!1,rc:c});delete this.recipeCb[c];return c};a.prototype.unsubscribeRecipeSetList=function(c){this._sendMessage({c:14,en:!1,rc:c});delete this.recipeCb[c+".RecipeSetList"];return c};a.prototype.unsubscribeRecipeSet=function(c,a){var b=c+"."+a;this._sendMessage({c:12,en:!1,rc:c,st:a});delete this.recipeCb[b];return b};a.prototype.unsubscribeRecipeSetElem=function(c,a,b){var d=
c+"."+a+"."+b;this._sendMessage({c:13,en:!1,rc:c,set:a,el:b});delete this.recipeCb[d];return d};a.prototype.subscribeTrend=function(c,e){if(this.trendCb[c.wgtId])return!1;this.trendCb[c.wgtId]=e;this._sendMessage({c:a.WORKER_MSG_CODE.SBSTRENDDATA,id:c.wgtId,start:c.getStartTime(),end:c.getStopTime(),trendName:c.getTrendName(),maxSamp:c.getMaxSamplesNum(),delta:c.getDeltaTime()});return c.wgtId};a.prototype.unsubscribeTrend=function(c,e){this._sendMessage({c:a.WORKER_MSG_CODE.USBSTRENDDATA,id:c.wgtId});
delete this.trendCb[c.wgtId];return c.wgtId};a.prototype.readSubTrends=function(c,e){this.trendCb[c.wgtId]=e;var b=c.getStartTime(),d=c.getStopTime();"TableTrendSrcWgt"===c.getJMType()&&1===c.getTSSortingMode()&&(b=c.getStopTime(),d=c.getStartTime());this._sendMessage({c:a.WORKER_MSG_CODE.READSUBTRENDS,id:c.wgtId,start:b,end:d,trendName:c.getTrendName(),maxSamp:c.getMaxSamplesNum(),delta:c.getDeltaTime(),bounds:c.getBoundsValue()});return c.wgtId};a.prototype._readTagsJsonAsynch=function(c,a){return this.RESTWorker?
this.RESTWorker.postMessage({id:0,c:20,tagName:c,index:a}).then(function(c){var a=new B;null!=c&&(c=JSON.parse(c).tgs[0],a.setState(c.quality,c.value,c.type,c.code,c.ts));return a})["catch"](function(c){c=new B;c.setMessageCode(x.status.E_TIMEOUT);return c}):b.prototype._readTagsJsonAsynch.call(this,c,a)};a.prototype.writeTag=function(c,a,h,d){a=a!==a?"nan":a==Number.POSITIVE_INFINITY?"inf":a==Number.NEGATIVE_INFINITY?"-inf":a;return!this.RESTWorker||d?b.prototype.writeTag.call(this,c,a,h,d):this.RESTWorker.postMessage({id:0,
c:21,name:encodeURIComponent(c.name),index:c.index,value:a,sync:d}).then(function(c){if(null!=c)try{var a=JSON.parse(c),e={};a&&(e=JSON.parse(c).tgs[0]);h.setState(e);return a}catch(b){return null}else return null})};a.prototype.stepTags=function(c){return this.RESTWorker?this.RESTWorker.postMessage({id:0,c:24,params:c}).then(function(c){try{return JSON.parse(c)}catch(a){return null}}):b.prototype.stepTags.call(this,c)};a.prototype.toggleBitTags=function(c){return this.RESTWorker?this.RESTWorker.postMessage({id:0,
c:25,params:c}).then(function(c){try{return JSON.parse(c)}catch(a){return null}}):b.prototype.toggleBitTags.call(this,c)};a.prototype.setBitTags=function(c){return this.RESTWorker?this.RESTWorker.postMessage({id:0,c:26,params:c}).then(function(c){try{return JSON.parse(c)}catch(a){return null}}):b.prototype.setBitTags.call(this,c)};a.prototype.resetBitTags=function(c){return this.RESTWorker?this.RESTWorker.postMessage({id:0,c:27,params:c}).then(function(c){try{return JSON.parse(c)}catch(a){return null}}):
b.prototype.resetBitTags.call(this,c)};a.prototype.getTime=function(c){return!this.RESTWorker||c?b.prototype.getTime.call(this,c):this.RESTWorker.postMessage({id:0,c:22})};a.prototype.getPrecachedPages=function(){if(this.RESTWorker){var c=window.location.href.substring(0,window.location.href.lastIndexOf("/")+1)+"precached.html";return this.RESTWorker.postMessage({id:23,c:23,url:c}).then(function(c){if(null!=c){var a=document.createElement("div");a.innerHTML=c;return a}return null})}return b.prototype.getPrecachedPages.call(this)};
a.WORKER_MSG_CODE={INIT:0,START:1,SBSGROUP:2,USBSGROUP:3,GETDATA:4,SBSALARMS:5,ADDEVTBUFFLST:6,RMEVTBUFFLST:7,SBSTAGS:8,ALIVE:9,RSTSSE:10,SBSRCP:11,SBSRCPSET:12,SBSRCPSETEL:13,SBSRCPLST:14,RCPRATE:15,SBSTRENDDATA:16,UPTRENDDATA:17,USBSTRENDDATA:18,READSUBTRENDS:28};a.RCP_CB_TYPE={RC:0,RC_LST:1,RC_SET:2,RC_EL:3};return a}(Yb);tc.prototype.postMessage=function(b){var a=this.idSeed++;b.id=a;var c=this;return new Promise(function(e,h){c.rejects[a]=h;c.resolves[a]=e;c.worker.postMessage(b)})};var f=function(b){return new f.fn.instantiate(b)};
f.activeProject=null;f.projectInterface=null;f.currentPage=null;f.prevPage=null;f.prevPageID=null;f.pagesBlock="hmi-pages-container";f.dlgsBlock="hmi-dlgs-container";f.pageNavigationOptions={pageToLeave:null,pageToLoad:null};f.isProjectReady=!1;f.fristPageLoaded=!1;f.isChangingPage=!1;f.EVENTS={PAGE:{BEFORE_CHANGE:"hmibeforechange",CONTENT_LOAD:"hmicontentload",PAGE_CHANGE:"hmichange",AFTER_CHANGE:"hmiafterchange",ERROR_LOADING:"hmiloadingerror"}};f.globalMouse=!1;f.mouseInitX=0;f.mouseInitY=0;f.mode=
0;f.cache=new ma;f.wgts=null;f.mapId={};f.isInited=!1;f.inActivity={timer:null,interval:6E5,callback:null};f.serverInterface=null;f.xforms={};f.initPageLogic=!1;f.renderingQueue={};f.globaID=0;f.debugMode=!1;f.defs={};f.cwJS={};f.urlParameters={usr:"",g:"",ot:"",token:""};f.dataLinkSeed=0;f.modules=u;f.browserUserAgent=window.navigator.userAgent;f.browserWindow={width:window.innerWidth,height:window.innerHeight};f.browserOptimizations={nativeRenderLoop:!0,forceLayers:!0};f.initServerInterface=function(b){f.isTestModeActive()||
(f.serverInterface=(new rc).createServer(b))};f.fps=10;f.then=Date.now();f.interval=1E3/f.fps;f.renderingStatus=0;f.rQueueLen=0;f.timerData=null;f.enablePjctWidgetServerReq=!0;f.umTemplates=["changepassword"];f.testModeActive=!1;f.Tag=ua;f.Quality=va;f.ServerJMobile=Yb;f.activateTestMode=function(){this.testModeActive=!0};f.disableTestMode=function(){this.testModeActive=!1};f.toggleTestMode=function(){this.testModeActive=!this.testModeActive};f.isTestModeActive=function(){return this.testModeActive};
f.setCurrentPage=function(b){this.currentPage=this};f.setProjectReady=function(){this.isProjectReady=!0};f.isFristPageLoaded=function(){return this.fristPageLoaded};f.setFristPageLoaded=function(){this.fristPageLoaded=!0};f.getWidgets=function(){return this.wgts};f.setUserAgent=function(b){this.testModeActive&&(f.browserUserAgent=b)};f.getUserAgent=function(){return this.browserUserAgent};f.getBrowserWindowSize=function(){return{width:f.browserWindow.width,height:f.browserWindow.height}};f.setBrowserWindowSize=
function(b,a){f.browserWindow.width=b;f.browserWindow.height=a};f.render=function(){var b=f.renderingQueue,a;for(a in b){var c=b[a];c.v&&(c.w.render(),c.v=0,f.rQueueLen--)}};f.getData=function(){f.isTestModeActive()||f.activeProject.srv.systemReadyForData()};f.disableData=function(){clearTimeout(f.timerData);f.timerData=null};f.renderingCycle=function(b){f.render();f.actionMgr.doActions();0<f.rQueueLen?f.globaID=requestAnimationFrame(f.renderingCycle):f.renderingStatus=0};f.clearRenderingQueue=function(){this.renderingQueue=
{}};f.renderingCycleFixed=function(b){f.now=Date.now();f.delta=f.now-f.then;f.delta>f.interval&&(f.then=f.now,f.render(),f.actionMgr.doActions());0<f.rQueueLen?f.globaID=requestAnimationFrame(f.renderingCycleFixed):f.renderingStatus=0};f.addToRender=function(b){if(0!=b.enableRendering){var a=f.renderingQueue[b.wgtId];void 0===a?(f.renderingQueue[b.wgtId]={w:b,v:1},f.rQueueLen++):0==a.v&&(a.v=1,f.rQueueLen++);0===f.renderingStatus&&f.enableRendering()}};f.clearRenderingQueue=function(){f.renderingQueue=
{};f.rQueueLen=0;f.disableRendering()};f.enableRendering=function(){0===f.renderingStatus&&(f.renderingStatus=1,f.globaID=requestAnimationFrame(f.browserOptimizations.nativeRenderLoop?f.renderingCycle:f.renderingCycleFixed))};f.disableRendering=function(){f.renderingStatus=0;window.cancelAnimationFrame(f.globaID)};f.init=function(b){0==f.mode?(!1===this.isInited&&(this.mouseMgr.init(),this.mouseMgr.enableMouse(),this.globalMouse=!0,document.documentElement.style.webkitTapHighlightColor="rgba( 0,0,0,0 )",
document.documentElement.style.webkitTouchCallout="none",document.documentElement.style.webkitUserSelect="none",this.isInited=!0),$(window).error(function(a){f.showErrorMessage("Unkown","General","<br>"+a.originalEvent.message+"<br>url: "+a.originalEvent.filename+"<br>line: "+a.originalEvent.lineno+"<br>line: "+a.originalEvent.lineNumber+"<br>stack: "+a.originalEvent.stack)})):(this.mouseMgr.init(b),this.mouseMgr.enableMouse(),this.globalMouse=!1,this.isInited=!0)};f.getWidget=function(b,a){var c=
null;null!==this.getFocusPage()&&null!==this.getActivePage()&&(c=this.getFocusPage().getWidget(b,a),null===c&&null!==this.getActivePage()&&this.getFocusPage().wgtId!==this.getActivePage().wgtId&&(c=this.getActivePage().getWidget(b,a)));null===c&&null!==f.activeProject&&(c=f.activeProject.getWidget(b,a));a&&(b=this.mapId[b]);null===c&&this.wgts&&(c=this.wgts[b]);return c};f.addWidget=function(b,a){a&&a.wgtPage?a.wgtPage.addWidget(b,a):(null===this.wgts&&(this.wgts={}),this.wgts[b]=a);this.mapId[a.studioId]=
b};f.setActivePage=function(b){var a;this.activeProject&&(a=this.activeProject.getPageMgr())&&a.setActivePage(b)};f.getActivePage=function(){var b;return this.activeProject&&(b=this.activeProject.getPageMgr())?b.getActivePage():f.enablePjctWidgetServerReq?this.activeProject:f.changePasswordPage};f.getInputManager=function(){return this.mouseMgr};f.setFocusPage=function(b){var a;this.activeProject&&(a=this.activeProject.getPageMgr())&&a.setFocusPage(b);f.enablePjctWidgetServerReq||(f.changePasswordPage=
b)};f.getFocusPage=function(){var b;return this.activeProject&&(b=this.activeProject.getPageMgr())?b.getFocusPage():f.enablePjctWidgetServerReq?this.activeProject:f.changePasswordPage};f.getPage=function(b){return this.wgts[b]};f.getActiveProject=function(){return this.activeProject};f.startInActivityTimer=function(b,a){0<b&&(this.inActivity.callback=a,this.inActivity.interval=b,this.inActivity.timer=setTimeout(a,b))};f.resetInActivityTimer=function(){this.inActivity.timer&&(clearTimeout(this.inActivity.timer),
this.inActivity.timer=setTimeout(this.inActivity.callback,this.inActivity.interval))};f.initWidgetEngine=function(b,a,c){if(f.enablePjctWidgetServerReq){var e=f.getPageInitFunction("_ProjectPage")(),h=e.getWidget("_UserGroupMgr",!0);a&&h.setClientID(a.cID);a=null;null!=b&&(h.isUMTemplate(b)?a=b:(h=e.getPageMgr(),a=h.getWebPage(b.toLowerCase()),!a&&h.hasWebPage(b)&&(a=b)));e.loadHomePage(a,c)}else this.initOfflineUMPage()};f.initOfflineUMPage=function(){var b=new Za({wgtId:"chPrj0"},f.urlParameters.pname,
{prefix:"p0",projectName:f.urlParameters.ppath,timeout:6E5,pollRate:100,maxBandwidth:0,modernBrowser:!0,optimizations:{nativeRenderCycle:!0,forceLayers:!0},connectionMode:null,hT:2E3,aRT:250,webSysIconDelay:0}),a=new Pb({wgtId:"chWgt0"},"_UserGroupMgr",{},b,b);new Cb({wgtId:"chWgt1"},"_TagMgr",{},b,b);null!=f.urlParameters.usr&&a.setCurrentUser(f.urlParameters.usr);b=b.getNode("container");a={prevPage:null,errorMessage:null,activePage:"changepassword",toPage:"changepassword"};f.evtMgr.trigger(b,"hmichange",
a);f.evtMgr.trigger(b,"hmiafterchange",a)};f.scrubId=function(b){var a=b;0==b.indexOf("#")&&(a=b.substring(1,b.length));return a};f.wgtPagePos=function(b){var a=0,c=0;do a+=b.offsetLeft,c+=b.offsetTop,b=b.offsetParent;while(b&&"BODY"!=b.nodeName);return{left:a,top:c}};f.addWidgetDefinition=function(b,a){this.defs[b]=a};f.getWidgetDefinition=function(b){return this.defs[b]};f.addAction=function(b,a){this.actionMgr.addActionDefinition(b,a)};f.getAction=function(b){return this.actionMgr.getActionInstance(b)};
f.doAction=function(b,a,c){var e=this.actionMgr.enActionType.NORMAL;"undefined"!=typeof a.t&&(e=a.t);var h=a.c,d=a.p;if(null!=h){var g="";e==this.actionMgr.enActionType.JS?(g=this.actionMgr.getActionInstance("hmiActionJS"))&&this.actionMgr.execute(g,d,b,h,c):this.actionMgr.execute(a,d,b,h)}};f.createDataLink=function(b,a,c){b=new Qb(this.dataLinkSeed,b,a,c);this.dataLinkSeed++;return b};f.addPagePrefixId=function(b){this.getActivePage()&&(b=this.getActivePage()+"_"+b);return b};f.fn=f.prototype={constructor:f,
widget:function(){return this.hmiWgt},hmiAttachAlias:function(b,a,c){this.hmiWgt.dataLinks&&(b=this.hmiWgt.getDatalink(b))&&f.hmiAttach(f.getWidget(a),b.dataSrcId,{tag:b.tag,rw:b.rw,attr:c})},hmiSubscribeGroup:function(b,a){f.getActiveProject().getWidget("_TagMgr",!0).subscribeGroup(b,a)}};f.hmiAttach=function(b,a,c,e){if(null!=c){if(void 0==b||b instanceof HTMLElement)return null;var h=null;0==c.wT?a=this.activeProject.getWidget(a):(h=b.getGraphicModule(),a="*"==a.charAt(0)&&null!=h?h.getWidget(a.replace("*.",
h.wgtId+".")):b.parentPage.getWidget(a));return this.createAndMountDataLink(b,a,c,e)}return null};f.createAndMountDataLink=function(b,a,c,e){var h=!1;c.xforms&&1==c.xforms.length&&(h="FormulaXForm"==c.xforms[0].className);return(a||h)&&b?(b=this.createDataLink(b,a,c),1!==e&&b.update(),b.mount(),b):null};f.hmiSubscribeGroup=function(b,a,c){var e=f.activeProject;if(e){var h=e.getTagMgr(),d=1!==c;h?h.subscribeGroup(b,a,d):e.getTagMgrInstance().then(function(c){c.subscribeGroup(b,a,d)})}};f._calculateOffsetMargin=
function(b,a){var c={left:0,top:0},e;if(b.css("margin")){if(e=b.css("margin-left"))c.left=parseFloat(e.split("px")[0]);if(e=b.css("margin-top"))c.top=parseFloat(e.split("px")[0])}else{if(0==a.top&&b[0].parentNode==b[0].offsetParent)c.top=b[0].offsetTop;else if(e=b.css("margin-top"))c.top=parseFloat(e.split("px")[0]);if(0==a.left&&b[0].parentNode==b[0].offsetParent)c.left=b[0].offsetLeft;else if(e=b.css("margin-left"))c.left=parseFloat(e.split("px")[0])}return c};f._getPointInWidgetCoordinateSystem=
function(b,a,c){if(!b)return null;var e=[],h={chain:[],offset:[],pos:[]},d=null,g=b,k=f.computeGroupsScrollOffset(b,a,c);a+=k.x;c+=k.y;if(b&&!b.initInvMtxChain){do d=g,e.push(d),g=d.getParentWgt();while(!d.isRoot())}k=c;if(b.initInvMtxChain)for(c=0;c<b.invMtxChain.length;c++)e=b.wgtPos[c],g=b.wgtOffset[c],a-=e.left+g.left,k-=e.top+g.top,d=b.invMtxChain[c],k=Ka(d,[[a],[k],[1]]),a=k[0][0],k=k[1][0];else{for(c=e.length-1;0<=c;c--){var d=e[c],n=e[c].getTransformMatrix(),m=d.left,r=d.top,g={},g="TableGroupWgt"==
d.getJMType()&&b.isInHeader?{left:d.getOffsetLeft(),top:0}:{left:d.getOffsetLeft(),top:d.getOffsetTop()};a-=m+g.left;var k=k-(r+g.top),d=n[0][0],v=n[1][0],l=n[0][1],C=n[1][1],p=n[0][2],n=n[1][2],q=d*C-v*l,d=[[C/q,-l/q,(l*n-C*p)/q],[-v/q,d/q,-(d*n-v*p)/q],[0,0,1]],k=Ka(d,[[a],[k],[1]]);a=k[0][0];k=k[1][0];h.chain.push(d);h.offset.push(g);h.pos.push({left:m,top:r})}b.saveInvMtxChain(h)}return{x:a,y:k}};f.computeGroupsScrollOffset=function(b,a,c){if(!b)return null;var e,h=b;c=a=0;e=!0;do{if(e=h){if("unknown"==
e.getJMType()){e=!1;continue}"GroupWgt"!=e.getJMType()&&"TableGroupWgt"!=e.getJMType()||!e.hasGridLayout()||(h=e.getScrollbarOffsets(),a+=h.left,b.isInHeader||(c+=h.top))}h=e.parentWidget;e=!(e instanceof I)}while(e);return{x:a,y:c}};f.isPointInsideWidget=function(b,a,c){var e=b.elem.style.width.split("px")[0],h=b.elem.style.height.split("px")[0];return(b=this._getPointInWidgetCoordinateSystem(b,a,c))&&0<=b.x&&b.x<=e&&0<=b.y&&b.y<=h?!0:!1};f.isPointInsideBoundingRect=function(b,a,c){if(!b)return!1;
a-=window.pageXOffset;c-=window.pageYOffset;b=b.getBoundingClientRect();return a>=b.left&&a<=b.left+b.width&&c>=b.top&&c<=b.top+b.height};f.updateTagsCache=function(b,a){return this.cache.updateTag(b,a)};f.getTagFromCache=function(b){return this.cache.getTag(b)};f.clearCache=function(){this.cache.clearTags()};f.cloneCache=function(){return this.cache.clone()};f.getDialog=function(b){return f.getActiveProject()&&f.getActiveProject().isActiveDialog(b)?this.getWidget(b):null};f.showErrorMessage=function(b,
a,c){var e=f.activeProject;if(!e||e.isDebugMode()){var h="<p>Source:"+b+"</p><p>Type:"+a+"</p><p>Details:"+c+"</p>";f.getAction("hmiActionShowMessage").execute(null,{msg:h,format:"html"},1)}e&&e.getValue("webDebugLogs")&&e.jmLog("Source: "+b+" Type: "+a+" Details: "+c)};f.showMessage=function(b,a){var c="<p style='font-weight: bold;'>"+b+"</p><br>"+a;f.getAction("hmiActionShowMessage").execute(null,{msg:c,format:"html"},0);(c=f.activeProject)&&c.getValue("webDebugLogs")&&c.jmLog(b+a)};f.isCoreWidgetsReady=
function(){var b=this.activeProject,a=[b.getWidget("_AlarmsMgr",!0).waitWgtReady(),b.getWidget("_TagMgr",!0).waitWgtReady(),b.getWidget("_UserGroupMgr",!0).waitWgtReady(),b.waitWgtReady().then(function(){return b.getCWidgetMgr()?b.getCWidgetMgr().waitWgtReady():Promise.resolve()})];return Promise.all(a)};f.notifyWarning=function(b,a){var c=b+" : "+a;f.getAction("hmiActionShowMessage").execute(null,{msg:c},3);(c=f.activeProject)&&c.getValue("webDebugLogs")&&c.jmLog(b+a)};f.getServerInterface=function(){return this.serverInterface};
f.getEventMgr=function(){return this.evtMgr};f.getServerConf=function(){var b=window.location.href.substring(0,window.location.href.lastIndexOf("/web/")+5);return A({type:"GET",url:b+"config/server.json",cache:!1,notimestamp:!0}).then(function(a){return a?JSON.parse(a):{}},function(a){return{active:"offline",offline:{pollRate:"0",status:-1}}})};f.pagesAllocator={};f.addPageInitFunction=function(b,a){f.pagesAllocator[b]=a};f.getPageInitFunction=function(b){return f.pagesAllocator[b]};f.removePageInitFunction=
function(b){f.pagesAllocator[b]=null};f.addPagesScript=function(b){f.scripts=b};f.getPagesScript=function(){return f.scripts};f.getProjectInterface=function(){return f.projectInterface};f.setProjectInterface=function(b){f.projectInterface=b};f.registerPlugin=function(b,a){this.plugins||(this.plugins={});this.plugins[b]=a(this)};f.plugin=function(b){return this.plugins[b]};f.addJSModule=f.export=function(b,a){this.modules.addModule(b,a)};f.getJSModule=f.import=function(b){return this.modules.getModule(b)};
f.setDefaultAlert=function(b){this.defaulAlterAction=b};(f.fn.instantiate=function(b){void 0!=b&&(b.wgtId?(this.wgtId=b.wgtId,this.hmiWgt=b):(this.wgtId=f.scrubId(b),this.hmiWgt=f.getWidget(this.wgtId)),this.hmiElem=null)}).prototype=f.fn;window.hmiMgr=window.$hmi=f;f.hmiActivatePage=function(b){b.execTemplateJS();b.tOnActivateActions();b&&b.load();b.execJS()};f.attachPageEvents=function(){var b;b=this.activeProject?this.activeProject.getNode("container"):document.getElementById("jm-container");$(b);
var a=this;this.evtMgr.on(b,"hmibeforechange",function(c){if(f.getActivePage()&&f.getActivePage().wgtId==f.pageNavigationOptions.pageToLeave){for(var e=document.getElementsByClassName("jm-bad");0<e.length;)c=e.item(0),c.parentNode.removeChild(c);for(e=document.getElementsByClassName("hmi-access-denied");0<e.length;)c=e.item(0),c.parentNode.removeChild(c);f.activeProject.unsubscribeDynamicTags();f.getActivePage();f.getActivePage().unload();a.evtMgr.trigger(f.getActivePage().elem,"unloadWgt")}});this.evtMgr.on(b,
"hmicontentload",function(c){c=c.detail.activePage;""!=c&&(c=f.getNextPageId(f.pageNavigationOptions.pageToLoad?f.pageNavigationOptions.pageToLoad:c),null==document.querySelector("link[rel='stylesheet'][href='"+c+".css']")&&$("head").append($("<link rel='stylesheet' href='"+c+".css'>")))});this.evtMgr.on(b,"hmipageremoved",function(c){c=c.detail;c.removedPage&&$('link[rel=stylesheet][href="../css/pages/_'+c.removedPage+'.css"]').remove()});this.evtMgr.on(b,"hmichange",function(c){c=c.detail;var e=
c.prevPage;e&&e!=c.toPage&&(f.prevPageID=e);c.prevPage&&f.getActivePage().hidePageContainer();e=document.getElementById("kpd");null!=e&&e.parentNode.removeChild(e);f.initPageLogic=!0;var e=c.activePage,b="_"+e;c.cachedPage?(c=f.getPage(e),f.setActivePage(c),f.setFocusPage(c),c.setCached(!0)):(c=f.getPageInitFunction(b)(),c.setCached(!1),c.bindCWJSClass(),f.activeProject.subscribeDynamicTags());c.show();a.evtMgr.trigger(c.elem,"loadWgt");f.activeProject.hideLoadingPage();f.initPageLogic=!1});this.evtMgr.on(b,
"hmiafterchange",function(c){c=c.detail;f.activeProject&&f.activeProject.srv&&0==f.activeProject.srv.getOptions().ssemode&&f.activeProject.srv.getOptions().exception.ipad1&&f.activeProject.srv.enableOption("ipda1fix");var a=f.getPage(c.activePage);f.activeProject.isProjectReady()?f.hmiActivatePage(a):f.enablePjctWidgetServerReq?f.isCoreWidgetsReady().then(function(){f.hmiActivatePage(a)}):f.hmiActivatePage(a);setTimeout(function(){f.enablePjctWidgetServerReq&&requestAnimationFrame(function(){f.activeProject.showSpinner(!1);
f.isFristPageLoaded()||(f.setFristPageLoaded(),f.getActiveProject().getPageMgr().loadPrecache().then(function(){f.getActiveProject().triggerEvent("precacheend")}))})},0)})};f.loadLoginPage=function(){f.getFocusPage()&&$(f.getFocusPage().elem).trigger("pagestop");var b="_web";/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)?b="_mobi":/iPad|RIM Tablet OS/i.test(navigator.userAgent)&&(b="_tablet");location.href="/public/"+b+"login.html?_="+(new Date).getTime()};f.getNextPageId=function(b){var a=
f.activeProject.getWidget("_UserGroupMgr",!0);b instanceof Array&&(b=b[0]);a&&a.isUMTemplate(b)?(b=b.split("/"),b=b[b.length-1],a="../css/umtemplates/"):a="../css/pages/";return a+"_"+b};var p=this&&this.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,a){c.__proto__=a}||function(c,a){for(var b in a)a.hasOwnProperty(b)&&(c[b]=a[b])};return b(a,c)};return function(a,c){function e(){this.constructor=a}b(a,c);a.prototype=null===c?Object.create(c):
(e.prototype=c.prototype,new e)}}(),Db;(function(b){b[b.LOCAL=0]="LOCAL";b[b.REMOTE=1]="REMOTE"})(Db||(Db={}));var $a;(function(b){b[b.READY=0]="READY";b[b.CONFIRM=1]="CONFIRM";b[b.HEART=2]="HEART";b[b.BEAT=3]="BEAT";b[b.LOG=4]="LOG"})($a||($a={}));var Dd=function(){function b(a){void 0===a&&(this.mode=Db.LOCAL);this.queue=[];this.idxMsg=0;this.mode=a;this.remote={address:"",port:"",socket:null,id:null};this.connectionReady=!1}b.prototype.log=function(a){switch(this.mode){case Db.LOCAL:this.localLog(a);
break;case Db.REMOTE:this.remtoteLog(a)}};b.prototype.setMode=function(a){this.mode=a};b.prototype.getMode=function(){return this.mode};b.prototype.getAddress=function(){return this.remote.address};b.prototype.getPort=function(){return this.remote.port};b.prototype.localLog=function(a){console.log(a)};b.prototype.remtoteLog=function(a){this.connectionReady?this.sendMessage({code:$a.LOG,id:this.remote.id,payload:a}):20>this.idxMsg&&(this.queue.push(a),this.idxMsg++)};b.prototype.setConnectionParameters=
function(a,c){this.remote.address=a;this.remote.port=c};b.prototype.openConnection=function(){var a=this;if(""!=this.remote.address&&""!=this.remote.port)try{var c=this.remote.socket=new WebSocket("ws://"+this.remote.address+":"+this.remote.port,"jm-console");c.addEventListener("open",function(){return a.handleConnectionOpen()});c.addEventListener("message",function(c){return a.handleMessage(c)});c.addEventListener("close",function(){a.handleConnectionClose()})}catch(e){window.setTimeout(function(){return a.openConnection()},
1E3)}};b.prototype.handleConnectionOpen=function(){};b.prototype.handleMessage=function(a){a=JSON.parse(a.data);switch(a.code){case $a.READY:this.sendConfirm(a),this.connectionReady=!0,this.flushQueue()}};b.prototype.sendMessage=function(a){var c=this.remote.socket;c&&1==c.readyState&&c.send(JSON.stringify(a))};b.prototype.sendConfirm=function(a){this.remote.id=a.id;this.sendMessage({code:$a.CONFIRM,id:this.remote.id,payload:""})};b.prototype.flushQueue=function(){if(0<this.queue.length){for(var a=
0,c=this.queue;a<c.length;a++)this.sendMessage({code:$a.LOG,id:this.remote.id,payload:c[a]});this.queue=[];this.idxMsg=0}};b.prototype.handleConnectionClose=function(){this.connectionReady=!1;this.openConnection()};return b}();u.addModule("JMVirtualConsole",Dd);var pa=null,Ec={},Mb=function(){function b(){}b.setFragment=function(a){pa=a};b.setGeometries=function(a){Ec=a};b.getFragment=function(){return pa};b.getGeometries=function(){return Ec};b.changeFragmentIds=function(a,c){var e=null;c&&(e=pa.id);
pa.id+=null==a?"":"."+a;for(var b=pa.querySelectorAll(".jm-wgt, .jm-hmi-col, canvas"),d=0,g=b.length;d<g;d++){var k=b[d];k.id=c?k.id.replace(e,null==a?e:e+"."+a):k.id+(null==a?"":"."+a)}};b.getFragmentById=function(a){return null==pa?null:pa.id==a?pa:pa.querySelector("#"+CSS.escape(a))};b.resetFragment=function(){pa=null};return b}();$.fn.onAvailable=function(b){var a=this.selector,c;0<this.length?b.call(this):c=setInterval(function(){0<$(a).length&&(b.call($(a)),clearInterval(c))},50)};f.changePage=
function(b,a){var c=this;if(c.isChangingPage)return!1;c.isChangingPage=!0;c.render();c.clearRenderingQueue();c.getInputManager().disableMouse();var e=c.getActiveProject(),h=e.getPageMgr(),d=h.getActivePage(),g=null,k=!1,n=f.EVENTS.PAGE,m={activePage:null,prevPage:null,toPage:null,errorMessage:null,cachedPage:!1},r=h.getPagesContainer(),v=h.getLastPageInDOM();if(d.getId()==e.getId())if(h.isDOMEmpty())if(e=b&&b.split("/"))m.activePage=e[e.length-1].split(".html")[0];else return c.getInputManager().enableMouse(),
m.errorMessage="Cannot load page. Please verify your project configuration.",c.evtMgr.trigger(r,n.BEFORE_CHANGE,m),!1;else m.activePage=v.getAttribute("id").substr(1),m.activePage==a.dst&&(v.setAttribute("data-url",b),k=!0);if(k)return c.evtMgr.trigger(r,n.BEFORE_CHANGE,m),c.evtMgr.trigger(r,n.CONTENT_LOAD,m),h.addLoadedPage(m.activePage),v=h.getLastPageInDOM(),null!=a.beautify&&a.beautify(v),c.evtMgr.trigger(r,n.PAGE_CHANGE,m),c.isChangingPage=!1,c.evtMgr.trigger(r,n.AFTER_CHANGE,m),c.getInputManager().enableMouse(),
!0;if(c.getActivePage().getId()==a.dst)return c.isChangingPage=!1,c.getInputManager().enableMouse(),!1;c.evtMgr.trigger(r,n.BEFORE_CHANGE,m);k=document.querySelector("div[data-url='"+b+"']");if(null!=k)m.activePage=k.getAttribute("id").substr(1),m.prevPage=d.getId(),m.toPage=m.activePage,m.cachedPage=!0,window.history.replaceState("state",document.title,b),c.evtMgr.trigger(r,n.CONTENT_LOAD,m),c.evtMgr.trigger(r,n.PAGE_CHANGE,m),c.isChangingPage=!1,c.evtMgr.trigger(r,n.AFTER_CHANGE,m),c.getInputManager().enableMouse();
else if(h.isPageInFragment(a.dst))k=h.loadPageFromFragment(a.dst),m.activePage=k.getAttribute("id").substr(1),m.prevPage=d.getId(),m.toPage=m.activePage,m.cachedPage=!0,window.history.replaceState("state",document.title,b),c.evtMgr.trigger(r,n.CONTENT_LOAD,m),a.src&&h.movePageToFragment(a.src),c.evtMgr.trigger(r,n.PAGE_CHANGE,m),c.isChangingPage=!1,c.evtMgr.trigger(r,n.AFTER_CHANGE,m),c.getInputManager().enableMouse();else A({type:"GET",url:b}).then(function(e){window.history.replaceState("state",
document.title,b);c.evtMgr.trigger(r,n.CONTENT_LOAD,m);var k=document.createElement("div");k.innerHTML=e;e=k.querySelector("div[data-role='page']");g=a.dst;for(var k=k.getElementsByTagName("script"),f,v,l=0,p=k.length;l<p;l++){var q=k[l].id;"hmi-page"===q?f=k[l].textContent:"hmi-init"===q&&(v=k[l].textContent)}e.setAttribute("data-url",b);null!=v&&eval(v);null!=a.beautify&&a.beautify(e);r.appendChild(e);null!=f&&eval(f);m.activePage=g;m.prevPage=d.getId();m.toPage=g;h.addLoadedPage(g);f=h.pagesGC(g,
m);0!=f.length&&-1!=f.indexOf(m.prevPage)||h.movePageToFragment(m.prevPage);m.activePage=g;m.prevPage=d.getId();m.toPage=g;c.evtMgr.trigger(r,n.PAGE_CHANGE,m);c.isChangingPage=!1;c.evtMgr.trigger(r,n.AFTER_CHANGE,m);c.getInputManager().enableMouse()})["catch"](function(){c.getInputManager().enableMouse();m.errorMessage="Cannot load page. Please verify your project configuration.";c.evtMgr.trigger(r,n.ERROR_LOADING,m)});return!0};$("#jm-container").on("hmiloadingerror",function(b){b.detail?uc(b.detail.errorMessage):
uc("Error")});var Zb=function(){function b(){this.dataLinks=null}b.prototype.addDataLink=function(a){this.parentPage?this.parentPage.registerLink(a):this.registerLink&&this.registerLink(a);this.subscribeDataLink(a)};b.prototype.subscribeDataLink=function(a){void 0==this.dataLinks&&(this.dataLinks={});this.dataLinks[a.getId()]=a};b.prototype.removeDataLink=function(a){delete this.dataLinks[a.getId()]};b.prototype.registerLink=function(a){};b.prototype.getWidget=function(a,c,e){return null};b.prototype.setProperty=
function(a,c){var e=u.getModule("Tag");this.setValue(a,c,e.QUALITY_GOOD)};b.prototype.setValue=function(a,c,e,b,d){};b.prototype.getValue=function(a){return null};b.prototype.getId=function(){return""};b.prototype.destroy=function(){for(var a in this.dataLinks){var c=this.dataLinks[a];c.dataSrc.getId()!=this.getId()?c.dataSrc.removeDataLink(c):c.tgtWgt.getId()!=this.getId()&&c.tgtWgt.removeDataLink(c)}};b.prototype.unmountLinks=function(){for(var a in this.dataLinks)this.dataLinks[a].unmount()};b.prototype.mountLinks=
function(){for(var a in this.dataLinks)this.dataLinks[a].mount(),this.dataLinks[a].update()};return b}(),Ed=function(){function b(){this.enActionType={NORMAL:0,JS:1};this.defs={};this.queue=[];this.executionStatus=0}b.prototype.isActionAllowed=function(a,c,e){if(!this.umgr&&(this.umgr=f.activeProject.getWidget("_UserGroupMgr",!0),!this.umgr))return!0;var b;b=f.getFocusPage();b.getId()!=a&&(b=f.getFocusPage().getWidget(a),null===b&&(b=f.getActiveProject().getWidget(a)));return(this.umgr.isSecurityEnabled()?
this.umgr.getActionTreeAuthorizations(b,c+"Action",e.actID):this.umgr.getWidgetAuthorizationCodes().DEFAULT)==this.umgr.getActionAuthorizationCodes().NOTALLOWED?!1:!0};b.prototype.execute=function(a,c,e,b,d){var g=this,k={type:a.getJMType(),execute:function(){a.addActionListener(g);g.isActionAllowed(e,b,c)?a.execute(e,c,b,d):a.done()}},n=this.queue.length;"LoadPageAction"==a.getJMType()&&0<n?"LoadPageAction"==this.queue[n-1].type?this.queue[n-1]=k:this.queue.push(k):this.queue.push(k);f.enableRendering()};
b.prototype.doActions=function(){0<this.queue.length&&0==this.executionStatus&&(this.executionStatus=1,this.queue.shift().execute())};b.prototype.done=function(){0<this.queue.length&&1==this.executionStatus?this.queue.shift().execute():this.executionStatus=0};b.prototype.addActionDefinition=function(a,c){this.defs[a]=c};b.prototype.getActionDefinition=function(a){return this.defs[a]};b.prototype.getActionInstance=function(a){return new this.defs[a]};return b}();f.actionMgr=new Ed;var Fd=function(){function b(){this.startY=
this.startX=0;this.oneTouch=!1;this.mouseWgt=null;this.wgtPagePos={left:0,top:0};this.mouseDisable=this.holdIsFired=this.wgtIsMouseDown=!1}b.prototype.init=function(a){var c=this;"ontouchstart"in window&&"ontouchend"in document?this.bindTouchEvents(a):this.bindMouseEvents(a);a=/firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";$(document).bind(a,function(a){c.doMouseScroll(a)})};b.prototype.disableMouse=function(){this.mouseDisable=!0};b.prototype.enableMouse=function(){this.mouseDisable=
!1};b.prototype.isMouseEnabled=function(){return!this.mouseDisable};b.prototype.bindMouseEvents=function(a){void 0===a&&(a=document);var c=this;$(a).mousedown(function(a){c.doMouseDown(a)});$(a).mouseup(function(a){c.doMouseUp(a)});$(a).mousemove(function(a){c.doMouseMove(a)})};b.prototype.bindTouchEvents=function(a){void 0===a&&(a=document);var c=this;$(a).on("touchstart mousedown",function(a){"touchstart"==a.type?(c.oneTouch=!0,c.doMouseDown(a)):(c.oneTouch||c.doMouseDown(a),c.oneTouch=!1)});$(a).on("touchend mouseup",
function(a){"touchend"==a.type?(c.oneTouch=!0,c.doMouseUp(a)):(c.oneTouch||c.doMouseUp(a),c.oneTouch=!1);c.doMouseUp(a)});$(a).on("touchcancel",function(a){c.doMouseUp(a)});$(a).on("touchmove",function(a){c.doMouseMove(a)});$(a).mousemove(function(a){c.doMouseMove(a)})};b.prototype.getTargetOfParentWidget=function(a){for(a=a.parentElement;a;){if(null!=a.getAttribute("data-widget"))return a;a=a.parentElement}return null};b.prototype.identifyWhoCatchTheEvent=function(a,c,e,b,d){if(null==a&&null==b||
d&&d==a)return null;var g=null!=a?a.events:null;if(g&&(g.mousedown||g.touchstart))return a;d=!1;null!=a?b=a.parentWidget:d=!0;if(null!=b&&void 0!==b.getChildrendNumber)for(var k=b.getChildrendNumber()-1;0<=k;k--){var n=b.getChild(k);if(d){if(f.isPointInsideBoundingRect(n.elem,c,e)){if("GroupWgt"==n.getJMType()&&(g=n.getChild(n.getChildrendNumber()-1),g=this.identifyWhoCatchTheEvent(g,c,e,null,n)))return g;if((g=n?n.events:null)&&(g.mousedown||g.touchstart)&&f.isPointInsideWidget(n,c,e))return n}}else n==
a&&(d=!0)}return null==a?null:this.identifyWhoCatchTheEvent(a.parentWidget,c,e,null)};b.prototype.doMouseDown=function(a){if(!this.mouseDisable){this.holdIsFired=!1;var c;a&&a.originalEvent&&"object"===typeof a.originalEvent.touches?0<a.originalEvent.touches.length&&(c=a.originalEvent.touches[0]):c=a||event;var e=a.target;this.startY=c.pageY;this.startX=c.pageX;if(!this.mouseWgt&&null!=e){var b=null,d=null;if(e!=document){var g=e.getAttribute("data-widget");void 0!==e.id&&null!=g?(b=f.getFocusPage().getWidget(e.id),
null===b&&(e=this.getTargetOfParentWidget(e),null!=e&&(d=f.getFocusPage().getWidget(e.id)))):(e=this.getTargetOfParentWidget(e),null!=e&&(b=f.getFocusPage().getWidget(e.id)))}var k=this.mouseWgt=this.identifyWhoCatchTheEvent(b,c.pageX,c.pageY,d);this.wgtIsMouseDown=!0;if(null!=k){f.setFocusPage(k.parentPage);a&&a.preventDefault&&k.isWgtEventsPreventDefault()&&a.preventDefault();var n;if(k.doMouseDown)if(c=this.wgtEventInfo(k,a),f.mouseInitX=c.x,f.mouseInitY=c.y,c){if(0==k.doMouseDown(c,a))return}else return;
var m=k.getAutoRepeatMode(),r=k.getAutoRepeatPeriod();k.onMousePress&&(c=this.wgtEventInfo(k,a),n=this.jsEventInfo(c),this.doWidgetActions(k,"onMousePress",n));var v=this,b=k.getHoldTime();c=this.wgtEventInfo(k,a);n=this.jsEventInfo(c);this.holdTimer=window.setTimeout(function(){v.holdIsFired=!0;k.onMouseHold&&(v.doWidgetActions(k,"onMouseHold",n),2==m&&k.onMouseHoldRepeat&&v.doMouseRepeat(k,m,r,n))},b);1==m&&k.onMousePressRepeat&&(c=this.wgtEventInfo(k,a),n=this.jsEventInfo(c),this.doMouseRepeat(k,
m,r,n))}}}};b.prototype.doMouseRepeat=function(a,c,e,b){var d=this;this.repeatTimer=window.setTimeout(function(){var g;1==c?g="onMousePressRepeat":2==c&&(g="onMouseHoldRepeat");d.doWidgetActions(a,g,b);d.doMouseRepeat(a,c,e,b)},e)};b.prototype.loseFocus=function(){clearTimeout(this.holdTimer);clearTimeout(this.repeatTimer);null!=this.mouseWgt&&this.mouseWgt.doMouseUp(null,null)};b.prototype.doWidgetActions=function(a,c,e){c=a[c];for(var b=0;b<c.length;b++)f.doAction(a.wgtId,c[b],e)};b.prototype.doMouseUp=
function(a){a&&a.stopPropagation();this.wgtIsMouseDown=!1;clearTimeout(this.holdTimer);clearTimeout(this.repeatTimer);if(null!=this.mouseWgt){var c=this.mouseWgt;this.mouseWgt=null;var e,b;if(c.doMouseUp)if(e=this.wgtEventInfo(c,a),f.mouseInitX=0,f.mouseInitY=0,e){if(0==c.doMouseUp(e,a))return}else return;c.isClone&&(e=this.wgtEventInfo(c.tableGroupWgt,a),c.tableGroupWgt.doMouseUp(e,a));if(null!=c.onMouseClick||null!=c.onMouseRelease)e=this.wgtEventInfo(c,a),b=this.jsEventInfo(e);null==c.onMouseClick||
this.holdIsFired||this.doWidgetActions(c,"onMouseClick",b);null!=c.onMouseRelease&&this.doWidgetActions(c,"onMouseRelease",b)}f.resetInActivityTimer();this.umgr||(this.umgr=f.activeProject.getWidget("_UserGroupMgr",!0));this.umgr&&this.umgr.resetTimer()};b.prototype.doMouseMove=function(a){var c=!1;if(this.mouseDisable)return c;var e=this.mouseWgt;if(null!=e){if(a&&a.originalEvent&&"object"===typeof a.originalEvent.touches&&0>=a.originalEvent.touches.length)return c;a&&a.preventDefault&&a.preventDefault();
var b;if(e.doMouseMove){var d=!1;if(b=this.wgtEventInfo(e,a))0==e.doMouseMove(b,a)&&(d=!0),c=!0;else return c}if(e&&e.onMouseDrag&&!d)for(d=e.onMouseDrag,b=this.wgtEventInfo(e,a),a=this.jsEventInfo(b),b=0;b<d.length;b++)f.doAction(e.wgtId,d[b],a)}return c};b.prototype.doMouseScroll=function(a){f.resetInActivityTimer();this.umgr||(this.umgr=f.activeProject.getWidget("_UserGroupMgr",!0));this.umgr&&this.umgr.resetTimer()};b.prototype.wgtEventInfo=function(a,c){var e=!0,b,d,g,k={};if(c&&c.originalEvent&&
"object"===typeof c.originalEvent.touches){g=c.originalEvent.touches.length;2<g&&(g=2);if(0<g){switch(g){case 1:k["0"]=c.originalEvent.touches[0];break;case 2:k["0"]=c.originalEvent.touches[0],k["1"]=c.originalEvent.touches[1]}b=k}e=!1}else g=1,b=c||event;var n=0,m=0;if(b){for(var r=!1,v=0;v<g;v++){e||(b=k[v],r=1==v?!0:!1);n=b.pageX+document.body.scrollLeft+document.documentElement.scrollLeft;m=b.pageY+document.body.scrollTop+document.documentElement.scrollTop;if(!a||!a.elem)return null;var l=f._getPointInWidgetCoordinateSystem(a,
n,m),C=l.x-f.mouseInitX,p=l.y-f.mouseInitY;r?d.nxtPoints={x:l.x,y:l.y}:d={wgt:a,isMouseDown:this.wgtIsMouseDown,pageX:n,pageY:m,x:l.x,y:l.y,deltaX:C,deltaY:p}}return d}return{wgt:a,noInfo:!0}};b.prototype.jsEventInfo=function(a){return{posX:Math.floor(a.x),posY:Math.floor(a.y),pagePosX:Math.floor(a.pageX),pagePosY:Math.floor(a.pageY),wheelDelta:null}};return b}();f.mouseMgr=new Fd;var O;(function(b){b[b.NONE=0]="NONE";b[b.FITSIZE=1]="FITSIZE";b[b.FITPAGETOSCREENSIZE=2]="FITPAGETOSCREENSIZE"})(O||
(O={}));var ka;(function(b){b[b.NORMAL=0]="NORMAL";b[b.PRECACHE=1]="PRECACHE"})(ka||(ka={}));var I=function(b){function a(c,e,h,d){e=b.call(this,c.wgtId,e,h,null,null)||this;e.setDefaultState();e.isCached=!1;e.invokablePropsList=["id","Id"];e.dialog=0;e.sFactor=0;e.callbacks={};e.loadMode=1===d?ka.PRECACHE:ka.NORMAL;e.constructor==a&&(f.setProjectReady(),f.setCurrentPage(e),(d=f.getActiveProject().getPageMgr())&&e.loadMode==ka.NORMAL&&(f.setActivePage(e),d&&!d.isCurrentPageDefined()&&d.setCurrentPageFromName(e.wgtId)));
e.project=f.getActiveProject();f.addWidget(c.wgtId,e);e.elem&&null!=e.project&&(c=e.elem.style.backgroundColor,e.backgroundColor=c,2==e.project.getValue("bgColorOption")&&e.getId()==f.getActivePage().getId()&&(d=u.getModule("Quality"),e.project.setValue("color",c,new d(192))));e.templateWebId&&(e.templatePagePrefix=e.templateWebId.split("_")[0]);e.cntMtx=[[1,0,0],[0,1,0],[0,0,1]];e.left=0;e.top=0;e.mtx||(e.mtx=[[1,0,0],[0,1,0],[0,0,1]]);0==f.mode&&e.constructor==a&&e.executeOnDemandFitToScreenSizeModality();
e.elem&&e.loadFontsFace();f.activeProject&&(e.sysVars=f.activeProject.getWidget("_SysPropMgr",!0));e.ml=!0;e.linksList={};e.loadMode==ka.NORMAL&&(f.setFocusPage(e),f.mouseMgr.loseFocus());return e}p(a,b);a.prototype.setDefaultState=function(){this.visible=void 0!==this.visible?this.visible:!1;this.fitCssTransform=void 0!==this.fitCssTransform?this.fitCssTransform:"";this.bgColor=void 0!==this.bgColor?this.bgColor:"";this.xPageOffset=void 0!==this.xPageOffset?this.xPageOffset:0;this.yPageOffset=void 0!==
this.yPageOffset?this.yPageOffset:0;this.resizeTimer=void 0!==this.resizeTimer?this.resizeTimer:null;this.resizeDialogTimer=void 0!==this.resizeDialogTimer?this.resizeDialogTimer:null;this.templateWebId=void 0!==this.templateWebId?this.templateWebId:null;this.backgroundColor=void 0!==this.backgroundColor?this.backgroundColor:null;this.mlPage=void 0!==this.mlPage?this.mlPage:null;this.exportedLang=void 0!==this.exportedLang?this.exportedLang:this.project.getMultiLanguageMgr().getCurrentLanguage()};
a.prototype.pageactivate=function(){this.onActivateActions();if(this.constructor==a&&(this.isCached&&f.activeProject.getWidget("_TagMgr",!0).subscribePageGroups(f.getActivePage().wgtId),this.isCached&&this.constructor==a&&this.executeOnDemandFitToScreenSizeModality(),"changepassword"==this.studioId)){var c=f.activeProject.getWidget("_UserGroupMgr",!0);c.clearAll();c.checkMessages()}if(this.isCached){for(var e in this.linksList)this.linksList[e].update(),this.linksList[e].mount();this.project.subscribeDynamicTags()}this.constructor==
a&&f.activeProject.activateDialogs()};a.prototype.load=function(){this.pageactivate()};a.prototype.pagedeactivate=function(){var c=f.activeProject.getWidget("_IndexedTagSetMgr",!0);f.activeProject.getWidget("_TagMgr",!0).unsubscribePageGroups(this.wgtId);null!=c&&c.unsubscribePageGroups(this.wgtId);f.activeProject.off("resize.page");this.unmountDataLinks();this.visible=!1;this.tOnDeActivateActions();this.onDeActivateActions();this.executeActions()};a.prototype.unload=function(){this.pagedeactivate()};
a.prototype.registerLink=function(c){this.isCached||(this.linksList[c.getId()]=c)};a.prototype.unregisterLink=function(c){delete this.linksList[c.getId()]};a.prototype.unmountDataLink=function(c){this.linksList[c.getId()].unmount()};a.prototype.unmountDataLinks=function(){for(var c in this.linksList)this.linksList[c].unmount()};a.prototype.destroy=function(){b.prototype.destroy.call(this);clearTimeout(this.resizeTimer);this.mlPage=this.mlTemplate=null;f.getWidgets()[this.wgtId]=null;this.project.removeGroupedButton(this.wgtId);
this.linksList=null;return!0};a.prototype.render=function(){if(!b.prototype.render.call(this))return this._renderMask=0,!1;if(this._renderMask&a._renderFlags.VISIBLE){var c=document.getElementById("_"+this.wgtId);this.visible?(Ca(c,"Transform",this.fitCssTransform),Ca(c,"TransformOrigin","0px 0px")):Ca(c,"Transform","translateZ(0)scale(0)")}if(this._renderMask&a._renderFlags.REDRAW){switch(this.fitsize){case O.FITPAGETOSCREENSIZE:this.executeFitPageToScreenSize();break;case O.FITSIZE:case O.NONE:this.executeFitToSize(),
this.project.updateStatusBarPosition(this.yPageOffset)}this.forceRedraw=!1}this._renderMask&a._renderFlags.BGCOLOR&&(this.elem.style.backgroundColor=this.bgColor);this._renderMask=0;return!0};a.prototype.executeOnDemandFitToScreenSizeModality=function(){this.fitsize==O.FITSIZE&&(this.bgColor=this.elem.style.backgroundColor,this._renderMask|=a._renderFlags.BGCOLOR);if(this.fitsize==O.FITSIZE||this.fitsize==O.FITPAGETOSCREENSIZE){var c=f.getBrowserWindowSize();this.adaptToBrowserViewport(c.width,c.height)}else this.sFactor=
1,this._renderMask|=a._renderFlags.REDRAW,f.addToRender(this);this.bindResizeEvent();this.project.getValue("enableFitToScreenTransition")&&Sa(this.elem,"none")};a.prototype.executeFitToSize=function(){var c=document.getElementById("_"+this.wgtId),a=f.getBrowserWindowSize(),b=(a.width-this.width*this.sFactor)/2,a=(a.height-this.height*this.sFactor)/2;.1>b&&(b=0);.1>a&&(a=0);this.xPageOffset=b;this.yPageOffset=a;this.fitCssTransform="translateY( "+a+"px ) translateX( "+b+"px ) scale( "+this.sFactor+
" )";this.cntMtx[0][0]=this.cntMtx[1][1]=this.sFactor;this.cntMtx[0][2]=b;this.cntMtx[1][2]=a;null!=c&&(this.visible&&(La(c,"left top"),da(c,this.fitCssTransform)),c.style.position="absolute",c.style.left="0px",c.style.top="0px",this.executeGroupGridLayout())};a.prototype.executeFitPageToScreenSize=function(){var c=document.getElementById("_"+this.wgtId);c.style.width=this.elem.style.width=this.width+"px";c.style.height=this.elem.style.height=this.height+"px";for(var a in this.wgts)if(c=this.wgts[a],
c.elem&&c.parentWidget==this){var b=c.getParentBounds(this);c.setParentBounds(b.x*this.xScale,b.y*this.yScale,b.width*this.xScale,b.height*this.yScale,this)}};a.prototype.executeGroupGridLayout=function(){for(var c in this.wgts){var a=this.wgts[c];a.elem&&a.parentWidget==this&&a.hasGridLayout()&&a.executeGridLayout()}};a.prototype.bindResizeEvent=function(){var c=this;this.forceRedraw=!1;this.invalidateMtxChain();f.activeProject.on("resize.page",function(a){clearTimeout(c.resizeTimer);c.resizeTimer=
window.setTimeout(function(a,e){c.project.getValue("enableFitToScreenTransition")?Sa(c.elem,"0.3s"):Sa(c.elem,"none");c.adaptToBrowserViewport(a,e);c.invalidateMtxChain()},300,a.width,a.height)})};a.prototype.adaptToBrowserViewport=function(c,e){var b=this.getRatio(c,e);this.fitsize==O.FITSIZE?this.sFactor=Math.min(b.x,b.y):this.fitsize==O.FITPAGETOSCREENSIZE&&(this.width=c,this.height=e,this.xScale=b.x,this.yScale=b.y);this.forceRedraw=!0;this._renderMask|=a._renderFlags.REDRAW;f.addToRender(this)};
a.prototype.getRatio=function(c,a){return{x:0==this.width?0==c?1:c/1E-6:c/this.width,y:0==this.height?0==a?1:a/1E-6:a/this.height}};a.prototype.getScaleFactors=function(){var c={x:1,y:1};this.sFactor&&(c.x=c.y=this.sFactor);this.xScale&&this.yScale&&(c.x=this.xScale,c.y=this.yScale);return c};a.prototype.isFitToSizeEnable=function(){return this.fitsize==O.FITSIZE?!0:!1};a.prototype.isFitPageToScreenSizeEnable=function(){return this.fitsize==O.FITPAGETOSCREENSIZE?!0:!1};a.prototype.loadFontsFace=function(){void 0!=
this.fonts&&0<this.fonts.length&&WebFont.load({custom:{families:this.fonts,urls:["../css/fonts.css"]}})};a.prototype.onActivateActions=function(){if(this.onActivate)for(var c=this.onActivate,a=0;a<c.length;a++)f.doAction(this.wgtId,c[a])};a.prototype.tOnActivateActions=function(){if(this.tonActivate)for(var c=this.tonActivate,a=0;a<c.length;a++)f.doAction(this.wgtId,c[a])};a.prototype.executeActions=function(){f.actionMgr.doActions()};a.prototype.onDeActivateActions=function(){if(this.onDeactivate)for(var c=
this.onDeactivate,a=0;a<c.length;a++)f.doAction(this.wgtId,c[a])};a.prototype.tOnDeActivateActions=function(){if(this.tonDeactivate)for(var c=this.tonDeactivate,a=0;a<c.length;a++)f.doAction(this.wgtId,c[a])};a.prototype.setDialogElem=function(){this.dialog=(this.elem=document.getElementById(this.wgtId+"Dialog"))?1:0};a.prototype.getEventWidgets=function(){var c=[],a;for(a in this.wgts)"EventBufferWgt"==this.wgts[a].getJMType()&&c.push(this.wgts[a]);return c};a.prototype.initialUpdate=function(){for(var c in this.wgts){var a=
this.wgts[c].getDataLinks();if(a)for(var b in a){var d=a[b],g=d.dataSrc.getValue(d.tag);"object"!=typeof g&&0<=d.rw.indexOf("r")&&d.tgtWgt.setValue(d.attr,g,void 0)}}};a.prototype.bindCWCallbacks=function(){for(var c in this.callbacks){var a=this.callbacks[c],b=a.callbackString.indexOf(".");-1!=b&&"this"==a.callbackString.substring(0,b)&&(a.fn=a.wgt.findJSFunction(a.callbackString.substring(b+1)))}};a.prototype.bindJSCallback=function(c){for(var e in this.callbacks){var b=this.callbacks[e];if(b.wgt.constructor==
a||c==b.wgt.isTemplateWgt){var d=b.callbackString.indexOf(".");if(-1!=d)if("this"==b.callbackString.substring(0,d))b.fn=b.wgt.findJSFunction(b.callbackString.substring(d+1));else try{b.fn=this.__eval__(b.callbackString)}catch(g){}else try{b.fn=this.__eval__(b.callbackString)}catch(k){}}}};a.prototype.__eval__=function(c){};a.prototype.registerPageCallback=function(c,a){var b=c;a&&0==c.indexOf("this.")?b=a.isClone?":"+a.protoWgtId+":"+c:":"+a.wgtId+":"+c:a.isTemplateWgt&&(b=this.templatePagePrefix+
b);this.callbacks[b]||(this.callbacks[b]={callbackString:c,fn:null,wgt:a});return b};a.prototype.bindCWJSClass=function(){var c=f.getActiveProject().getCWidgetMgr();c&&c.bindCWLogicClass(this)};a.prototype.setValue=function(c,e,b,d){d=!1;if(null!=this.elem)switch(c){case "color":c="rgb(0,0,0)";isNaN(e)&&!this.isBadValue(e,!0,b)&&this.backgroundColor!=e&&(/^rgb\(\s*\d+,\s*\d+\s*,\s*\d+\s*\)$/.test(e)?c=e:e&&0==e.indexOf("#")&&1<e.length&&8>=e.length&&(c=e));this.backgroundColor!=c&&(this.backgroundColor=
c,2==this.project.getValue("bgColorOption")&&this.project.setValue("color",c,b));break;case "visibility":case "visible":this.visible!=e&&(this._renderMask|=a._renderFlags.VISIBLE,this.forceRedraw&&(this._renderMask|=a._renderFlags.REDRAW),this.visible=e,d=!0);default:l.prototype.setValue.call(this,c,e,b)}d&&f.addToRender(this);return!0};a.prototype.getValue=function(c){return"backgroundColor"==c?this.backgroundColor:"id"==c||"Id"==c?this.studioId:l.prototype.getValue.call(this,c)};a.prototype.addWidget=
function(c,a){b.prototype.addWidget.call(this,c,a);"PageMLTextMgrWgt"==a.getJMType()&&(a.isTemplateWgt?this.mlTemplate=a:this.mlPage=a)};a.prototype.getPageMLTextMgr=function(){return this.mlPage};a.prototype.getTemplateMLTextMgr=function(){return this.mlTemplate};a.prototype.execTemplateJS=function(){if("undefined"!=typeof f.getPagesScript()){var c=this.templateWebId;if(c&&(c=f.getPagesScript()[c]))try{c()}catch(a){f.showErrorMessage(this.studioId,"Initialization",a.message)}}};a.prototype.execJS=
function(){if(this.project.isProjectReady()){if("undefined"!=typeof f.getPagesScript()){var c=f.getPagesScript()[this.wgtId];if(c)try{c()}catch(a){f.showErrorMessage(this.studioId,"Initialization",a.message)}}}else{var b=this;setTimeout(function(){b.execJS()},100)}};a.prototype.show=function(){this.setValue("visibility",1,null)};a.prototype.setCached=function(c){this.isCached=c};a.prototype.getProject=function(){return this.project};a.prototype.getTransformMatrix=function(){return this.cntMtx};a.prototype.isPageCached=
function(){return this.isCached};a.prototype.hidePageContainer=function(){var c=this;requestAnimationFrame(function(){Ca(document.getElementById("_"+c.wgtId),"Transform","translateZ(0)scale(0)");c.visible=!1})};a.prototype.getPrefix=function(){return this.prefix};a.prototype.getLoadingMode=function(){return this.loadMode};a.prototype.isRoot=function(){return!0};a.prototype.getExportedLanguage=function(){return this.exportedLang};a.prototype.getWidgets=function(){return this.wgts};a.prototype.getCallbacks=
function(){return this.callbacks};a.jmType="PageWgt";a._renderMask=0;a._renderFlags={VISIBLE:1,REDRAW:2,BGCOLOR:4,REDRAWDLG:8,UPDATEPOS:16,APPLYMASK:32,APPLYDLGPARAMS:64,APPLYDLGHDR:128,APPLYFITTOSCREENSIZE:256};return a}(l);Object.defineProperty(I.prototype,"backgroundColor",{get:function(){return this.elem?this.elem.style.backgroundColor:""},set:function(b){this.bgColor=b;this._renderMask|=I._renderFlags.BGCOLOR;f.addToRender(this)}});f.fn.hmiPage=function(b,a,c,e){return new I(this,b,a,e)};f.addWidgetDefinition("hmiPage",
I);var xa;(function(b){b[b.INIT_PRM=0]="INIT_PRM"})(xa||(xa={}));var $b=function(){function b(){this._prmWgtReady=null}b.prototype.resolveWgtReady=function(a){throw xa.INIT_PRM;};b.prototype.rejectWgtReady=function(a){throw xa.INIT_PRM;};b.prototype.initPromiseReady=function(){var a=this;this._prmWgtReady=new Promise(function(c,e){a.resolveWgtReady=c;a.rejectWgtReady=e})};b.prototype.waitWgtReady=function(){if(this._prmWgtReady)return this._prmWgtReady;throw xa.INIT_PRM;};return b}(),ya;(function(b){b[b.NORMAL=
0]="NORMAL";b[b.TEMPLATE=1]="TEMPLATE"})(ya||(ya={}));var Ma=function(b){function a(c){var a=b.call(this)||this;a.project=c;a.cwgts={};a.instancesMap={};a.HTMLTemplatePolyfillEnabled=HTMLTemplateElement.bootstrap instanceof Function;c=document.getElementById("hmi-templates");var h=!1;a.initPromiseReady();c&&(h=0!=c.childNodes.length);if(f.isTestModeActive())a.resolveWgtReady(!0);else if(h)a.resolveWgtReady(!0);else a.project.getCommunticationObj().getResource("templates.xml").then(function(c){document.getElementById("hmi-templates").innerHTML=
c;a.HTMLTemplatePolyfillEnabled&&HTMLTemplateElement.bootstrap(document);a.resolveWgtReady(!0)})["catch"](function(){a.resolveWgtReady(!1)});return a}p(a,b);a.prototype.setCWMap=function(c,a){null==this.instancesMap[c]&&(this.instancesMap[c]=a)};a.prototype.getCWMap=function(c){c=this.instancesMap[c];return void 0!=c?c:null};a.prototype.freeCWInstances=function(c){delete this.instancesMap[c]};a.prototype.getAttributeLink=function(c,a){c=c.toLowerCase();return void 0!==this.cwgts[c]&&null!==this.cwgts[c].props?
this.cwgts[c].props.attr[a]:[]};a.prototype.hasAttribute=function(c,a){c=c.toLowerCase();return void 0!==this.cwgts[c]&&null!==this.cwgts[c].props};a.prototype.getParameters=function(c){c=c.toLowerCase();return void 0!==this.cwgts[c]&&null!==this.cwgts[c].props?this.cwgts[c].props.par:[]};a.prototype.isRegisteredModule=function(c){c=c.toLowerCase();return void 0!==this.cwgts[c]};a.prototype.hasGfxInheritance=function(c){c=c.toLowerCase();c=this.cwgts[c];return null!=c&&null!=c.conf&&null!=c.conf.w};
a.prototype.findCustomWidget=function(c,a){var b=null,d=null;void 0!=a&&(d=this.getCWMap(a));for(var g=c.querySelectorAll("[data-ctype]"),k=0,f=g.length;k<f;k++){var m=g[k],r=m.getAttribute("data-ctype"),v="1"==m.getAttribute("data-tmpl");this.isRegisteredModule(r)&&(null===b&&(b={p:[],t:[]}),m={webId:m.getAttribute("id"),studioId:m.getAttribute("data-sid"),moduleName:r},v?(b.t.push(m),null!=d&&d.t.push(m)):(b.p.push(m),null!=d&&d.p.push(m)))}return b};a.prototype.addModule=function(c){this.cwgts[c.name]=
c};a.prototype.injectCWTemplates=function(c,a){var b=this.getCWMap(a),d=c.getAttribute("id")!=a;if(null==b||d){b=this.findCustomWidget(c,a);if(null==b)return;d||this.setCWMap(a,b)}this.injectCW(c,b.t,a,ya.TEMPLATE);this.injectCW(c,b.p,a,ya.NORMAL)};a.prototype.injectCW=function(c,a,b,d){if(void 0!==a)for(var g=0,k=a.length;g<k;g++){var f=a[g].webId,m=a[g].studioId,r=a[g].moduleName.toLowerCase(),v=this.cwgts[r];if(void 0!==v){null===v.template&&(v.template=document.getElementById(r));v=v.template;
r=c.querySelector("#"+CSS.escape(f));null!=v&&null!=r&&(v instanceof HTMLTemplateElement?r.appendChild(v.content.cloneNode(!0)):v instanceof DocumentFragment&&r.appendChild(v.cloneNode(!0)));for(var v=r.querySelectorAll(".jm-wgt, .jm-wgt>div, .jm-hmi-col, canvas"),l=0,C=v.length;l<C;l++){var p=v[l];if("*"===p.id.charAt(0)&&"."===p.id.charAt(1)){p.id=p.id.replace("*",f);var q=p.getAttribute("data-sid");null!=q&&p.setAttribute("data-sid",q.replace("*",m))}d==ya.TEMPLATE&&p.setAttribute("data-tmpl",
"1")}this.injectCWTemplates(r,b)}}};a.prototype.instantiateCW=function(c,a){var b;a=a.toLowerCase();var d=this.cwgts[a],g=this.project.getWidgetDefinitions(),k=this.project.getActionMgr(),n=(b={},b[a]=c,b);if(null!=d&&null!=d.conf&&null!=d.conf.w){c.setModule();d.conf.grid&&c.setGridLayout(d.conf.grid);b=d.conf.w;for(var m=0,r=b.length;m<r;m++){var v=b[m],l=v.w.replace("*",c.wgtId),C=this.deepClonePlainObject(v.p),p=void 0,p=void 0!==v.s?v.s.replace("*",c.studioId):l,q=n[v.f.toLowerCase()];-1!=v.t.indexOf("hmiAction")?
(C.module=c,p=k.getActionDefinition(v.t),n[v.w]=new p({wgtId:l},v.e,C,this.project.getFocusPage(),q)):"hmiAttach"===v.t?f.hmiAttach(n[v.w],v.s,C):(C.isTemplateWgt=c.isTemplateWgt,C.module=c,c.isClone&&(C.isClone=c.isClone,C.protoWgtId=c.protoWgtId+"."+v.w.substring(2),C.tableGroupWgt=c.tableGroupWgt,C.ext=c.ext),"hmiCWMLTextMgr"==v.t&&d.tr&&this.applyMLPatch(C.texts,d.tr),void 0===q&&(q=c),n[v.w]=new g[v.t]({wgtId:l},p,C,this.project.getFocusPage(),q))}this.subscribeAttributeLinks(d,c);k=g=void 0;
Wb(c.mtx)?(g=c.width,k=c.height):(k=c._map(c.mtx,{x:c.width,y:c.height}),g=k.x,k=k.y);n=c.left;b=c.top;c.width=d.conf.br.width;c.height=d.conf.br.height;c.left=0;c.top=0;n==c.left&&c.top==b&&c.width==g&&c.height==k||c.setParentBounds(n,b,g,k,c.parentWidget);this.bindJSClass(c)}};a.prototype.subscribeAttributeLinks=function(c,a){if(null!==c.props&&null!==c.props.attr)for(var b in c.props.attr){var d=c.props.attr[b];if(0<d.length)for(var g=0,k=d.length;g<k;g++){var f=d[g].lastIndexOf("."),m=d[g].substring(0,
f),f=a.getWidget(m,!0,a.isTemplateWgt);if(null==f){var r=m.replace(/[0-9]/g,""),m=parseInt(m.substring(r.length));isNaN(m)&&(m=1);var v=[];a.getWidgetsByJMClass(r,m,v);v.length==m&&(f=v[m-1])}null!=f&&f.subscribeWgt(a,function(c,a){return function(e,b){"mdup"==e&&c.sendUpdate(a,b.v,b.q)}}(a,b))}}};a.prototype.applyMLPatch=function(c,a){for(var b in a){var d=c[b],g=a[b],k;for(k in g)d[k]=g[k]}};a.prototype.bindJSClass=function(c){var a=this.cwgts[c.ctype.toLowerCase()];void 0!==a&&null!=a.js&&a.js.call(c,
c)};a.prototype.bindCWLogicClass=function(c,a){var b=this.getCWMap(a?a:"_"+c.wgtId);if(null!==b){for(var d=b.t,g=0,k=d.length;g<k;g++){var f=d[g];this.hasGfxInheritance(f.moduleName)||(f=c.getWidget(f.webId),this.subscribeAttributeLinks(this.cwgts[f.ctype.toLowerCase()],f),this.bindJSClass(f))}d=b.p;g=0;for(k=d.length;g<k;g++)f=d[g],this.hasGfxInheritance(f.moduleName)||(f=c.getWidget(f.webId),this.subscribeAttributeLinks(this.cwgts[f.ctype.toLowerCase()],f),this.bindJSClass(f));(0<b.t.length||0<
b.p.length)&&c.bindCWCallbacks()}};a.prototype.deepCloneArray=function(c){for(var a=c.length,b=Array(a),d=0;d<a;d++){var g=c[d],k=typeof g;b[d]="number"==k||"boolean"==k?g:this.deepClonePlainObject(g)}return b};a.prototype.deepClonePlainObject=function(c){if(null===c)return null;switch(typeof c){case "string":return c.slice(0);case "object":if(Array.isArray(c))return this.deepCloneArray(c);var a={},b;for(b in c){var d=c[b];if(Array.isArray(d))a[b]=this.deepCloneArray(d);else{var g=typeof d;a[b]="number"==
g||"boolean"==g?d:this.deepClonePlainObject(d)}}return a;default:return c}};return a}($b),Gd=function(){function b(){}b.trigger=function(a,c,e){c=new CustomEvent(c,{detail:e});null!=a&&a.dispatchEvent(c)};b.on=function(a,c,e){null!=a&&a.addEventListener(c,e)};b.off=function(a,c,e){null!=a&&a.removeEventListener(c,e)};return b}();f.evtMgr=Gd;(function(b){b[b.EMPTY=-1]="EMPTY";b[b.BOOLEAN=0]="BOOLEAN";b[b.BYTE=1]="BYTE";b[b.SHORT=2]="SHORT";b[b.INT=3]="INT";b[b.UNSIGNEDBYTE=4]="UNSIGNEDBYTE";b[b.UNSIGNEDSHORT=
5]="UNSIGNEDSHORT";b[b.UNSIGNEDINT=6]="UNSIGNEDINT";b[b.FLOAT=7]="FLOAT";b[b.DOUBLE=8]="DOUBLE";b[b.STRING=9]="STRING";b[b.BINARY=10]="BINARY";b[b.TIME=11]="TIME";b[b.INT64=12]="INT64";b[b.UINT64=13]="UINT64";b[b.INT64A=14]="INT64A";b[b.UINT64A=15]="UINT64A"})(w||(w={}));(function(b){b[b.EMPTY=0]="EMPTY";b[b.BIT=1]="BIT";b[b.BYTE=2]="BYTE";b[b.SHORT=3]="SHORT";b[b.INT=4]="INT";b[b.UNSIGNED_BYTE=5]="UNSIGNED_BYTE";b[b.UNSIGNED_SHORT=6]="UNSIGNED_SHORT";b[b.UNSIGNED_INT=7]="UNSIGNED_INT";b[b.FLOAT=
8]="FLOAT";b[b.DOUBLE=9]="DOUBLE";b[b.STRING=10]="STRING";b[b.BINARY=11]="BINARY";b[b.TIME=12]="TIME";b[b.ARRAY_BIT=13]="ARRAY_BIT";b[b.ARRAY_BYTE=14]="ARRAY_BYTE";b[b.ARRAY_SHORT=15]="ARRAY_SHORT";b[b.ARRAY_INT=16]="ARRAY_INT";b[b.ARRAY_UNSIGNED_BYTE=17]="ARRAY_UNSIGNED_BYTE";b[b.ARRAY_UNSIGNED_SHORT=18]="ARRAY_UNSIGNED_SHORT";b[b.ARRAY_UNSIGNED_INT=19]="ARRAY_UNSIGNED_INT";b[b.ARRAY_FLOAT=20]="ARRAY_FLOAT";b[b.ARRAY_DOUBLE=21]="ARRAY_DOUBLE";b[b.ARRAY_TIME=22]="ARRAY_TIME";b[b.UINT64=23]="UINT64";
b[b.INT64=24]="INT64";b[b.ARRAY_UINT64=25]="ARRAY_UINT64";b[b.ARRAY_INT64=26]="ARRAY_INT64";b[b.OBJECT=27]="OBJECT"})(Xa||(Xa={}));var qa;(function(b){b[b.AL_EVENT_TRIGGERED=1]="AL_EVENT_TRIGGERED";b[b.AL_EVENT_NOT_TRIGGERED=2]="AL_EVENT_NOT_TRIGGERED";b[b.AL_EVENT_ACKED=4]="AL_EVENT_ACKED";b[b.AL_EVENT_RESET=8]="AL_EVENT_RESET";b[b.AL_EVENT_ENABLED=16]="AL_EVENT_ENABLED";b[b.AL_EVENT_DISABLED=32]="AL_EVENT_DISABLED";b[b.AL_FLAG_TRIGGER_CONDITION_CHANGED=64]="AL_FLAG_TRIGGER_CONDITION_CHANGED"})(qa||
(qa={}));var Fc=function(b){function a(c,a,h,d,g){var k=b.call(this,c.wgtId,a,h,d,g)||this;k.toggleSelectAll=!1;k.alarmCount=0;k.nDisabled=0;k.nRemoteEn=0;k.remoteEnReqBufferSize=100;k.alarmsConf={defaultColors:{},alarms:{},mlTexts:{}};k.alarmsBuffer={};k._nInitilizedAlarm=0;k._isAlarmsInitialized=!1;k.alarmNumber=h.alarmNumber;k.alarmCache={alDate:Array(k.alarmNumber),alDateTime:Array(k.alarmNumber),alDescription:Array(k.alarmNumber),alEnable:Array(k.alarmNumber),alName:Array(k.alarmNumber),alSelect:Array(k.alarmNumber),
alSeverity:Array(k.alarmNumber),alState:Array(k.alarmNumber),alTime:Array(k.alarmNumber),alValue:Array(k.alarmNumber),alUserAction:Array(k.alarmNumber),comment:Array(k.alarmNumber),BGColor:Array(k.alarmNumber),FGColor:Array(k.alarmNumber),blink:Array(k.alarmNumber),alGroups:Array(k.alarmNumber),alarmCount:0,alTriggeredList:[]};k.dataLinks={};k.mapDataLinkToVar={};k.mapAlarmId={};k.enableTags={};k.rmEnableAl=[];k.currLang=k.parentPage.getWidget("_MultiLangMgr",!0).curLangId;k.initPromiseReady();f.isTestModeActive()?
k.resolveWgtReady(!0):k.parentWidget.waitWgtReady().then(function(){k.srv=f.getActiveProject().getCommunticationObj();var c=f.getActiveProject().getTagMgr();c.isReady()?k._initAlarmConfiguration():c.subscribeWgt(k,function(c,a){k.trigger(c,a)})});k.ml=!0;return k}p(a,b);a.prototype.trigger=function(c,a){"tagmgrready"==c&&this._initAlarmConfiguration()};a.prototype._initAlarmConfiguration=function(){var c=this;this.srv.getConf().then(function(a){c.alarmsConf=a["alarms.json"];c.initAlarmBuffer();c.subscribeTagsForRemoteEnable();
a=f.getActiveProject().getTagMgr();if(a.getGroupInfo("AlarmEnableTags@$AlarmMgrWgt@$0")){a.subscribeGroup("AlarmEnableTags@$AlarmMgrWgt@$0",c.parentPage);for(var b in c.enableTags)f.hmiAttach(c,a.wgtId,{tag:b,srcType:"Tag",rw:"r",attr:"__rmen__"+b,tagType:""})}c.srv.subscribeAlarms("*",function(a){c.onDataReady(a)});setTimeout(function(){c._isAlarmsInitialized=!0;c.resolveWgtReady(!0)},1E3)})["catch"](function(){f.getAction("hmiActionShowMessage").execute(null,{msg:"Error loading alarms configuration. Reloading..."},
3);setTimeout(function(){c.project.getCommunticationObj().loadIndex()},2E3)})};a.prototype.isDataReady=function(){return this._isAlarmsInitialized};a.prototype.updateTables=function(){var c=this.getAllSubscriptions();if(c)for(var a in c)c[a].getWidget().isTableDataSource||c[a].getWidget().updateData()};a.prototype.updateAlarmCache=function(c){var a=u["import"]("Alarm"),b=c.cacheIndex;c=c.al;var d=c.alName,g=c.alState;this.alarmCache.alState[b]=c.stateToString(g);this.alarmCache.alEnable[b]=c.alEnable;
this.alarmCache.alValue[b]=c.alValue;this.alarmCache.alDateTime[b]=c.alDateTime;this.alarmCache.alDate[b]=c.alDate;this.alarmCache.alTime[b]=c.alTime;this.alarmCache.BGColor[b]=c.BGColor;this.alarmCache.FGColor[b]=c.FGColor;this.alarmCache.blink[b]=g==a.stateType.STATE_TRIGGERED_NOT_ACKED||g==a.stateType.STATE_NOT_TRIGGERED_NOT_ACKED?this.alarmsConf.alarms[d].blinkTxt?!0:!1:!1;c.isTriggered()&&!c.isPrevStateTriggered()?(this.alarmCache.alTriggeredList.push(b),this.alarmCache.alTriggeredList.sort()):
!c.isTriggered()&&c.isPrevStateTriggered()&&this.alarmCache.alTriggeredList.splice(this.alarmCache.alTriggeredList.indexOf(b),1)};a.prototype.subscribeDataLink=function(c){b.prototype.subscribeDataLink.call(this,c);this.mapDataLinkToVar[c.tag]?this.mapDataLinkToVar[c.tag].splice(0,1,c):(this.mapDataLinkToVar[c.tag]=[],this.mapDataLinkToVar[c.tag].push(c))};a.prototype.getAlarmName=function(c){return this.alarmCache.alName[c]};a.prototype.getDataValues=function(c){return this.alarmCache[c]};a.prototype.getDataValuesQuality=
function(c){if("alEnable"==c){c={};for(var a=0,b=this.rmEnableAl.length;a<b;a++){var d=this.alarmsBuffer[this.rmEnableAl[a]],g=d.al.alRemoteEnable,k=f.getTagFromCache(g);void 0===k?(k=new B,this.parentWidget.getTag(g,k,-1,!0),c[d.cacheIndex]=k.quality):c[d.cacheIndex]=k.getQuality()}return c}return null};a.prototype.updateAlarmDataSources=function(){for(var c in this._subscriptions)if(this._subscriptions[c].getWidget().isTableDataSource)this._subscriptions[c].getCallbacks()[0]()};a.prototype.onDataReady=
function(c){for(var a=[],b=!1,d=0,g=c.length;d<g;d++){var k=c[d].alName,f=this.alarmsBuffer[k],m=f.al.update(c[d]);this._isAlarmsInitialized||this.alarmsBuffer[k].isInitialized||this._nInitilizedAlarm++;m&&(this.updateAlarmCache(f),a.push(k),!b&&m&&(b=!0))}this._isAlarmsInitialized&&b&&(this.sendUpdate(a),this.updateAlarmDataSources());this._nInitilizedAlarm>=this.alarmCount-this.nDisabled-this.nRemoteEn&&(this._isAlarmsInitialized=!0,this.resolveWgtReady(!0))};a.prototype.getDefaultColors=function(){return this.alarmsConf.defaultColors};
a.prototype.getAlarmsConfiguration=function(){return this.alarmsConf};a.prototype.getAlarmsCache=function(){return this.alarmCache};a.prototype.getAlarmsBuffer=function(){return this.alarmsBuffer};a.prototype.createAlarm=function(c){var a=new (f["import"]("Alarm"))(c),b=this.alarmCache.alarmCount;this.alarmsBuffer[c]={al:a,isInitialized:!1,cacheIndex:b};var d=this.alarmsConf.alarms[c];a.index=b;a.alDescription=this.getAlarmProperty(c,"d");a.xmlOrder=parseFloat(d.xO);a.alGroups=void 0!==d.gr?d.gr:
"";a.alSeverity=this.getAlarmServerity(c);a.alarmId=d.id;a.liveData=d.lD;a.userActions=d.usrActs;a.actions=d.acts;a.setActionMask(d.aM);this.mapAlarmId[a.alarmId]=a.alName;this.alarmCache.alName[b]=c;this.alarmCache.alSeverity[b]=a.alSeverity;this.alarmCache.alValue[b]=this.getAlarmProperty(c,"sourcevalue");this.alarmCache.BGColor[b]=this.getAlarmProperty(c,"nTBC");this.alarmCache.FGColor[b]=this.getAlarmProperty(c,"nTTC");this.alarmCache.comment[b]=this.getAlarmProperty(c,"comment");this.alarmCache.blink[b]=
this.getAlarmProperty(c,"blinkTxt");this.alarmCache.alGroups[b]=this.getAlarmProperty(c,"gr");this.alarmCache.alUserAction[b]=void 0!=this.getAlarmProperty(c,"usrActs")?1:0;this.alarmCache.alSelect[b]=!1;this.alarmCache.alDateTime[b]="1970/01/01 00:00:00";this.alarmCache.alDate[b]="1970/01/01";this.alarmCache.alTime[b]="00:00:00";this.alarmCache.alState[b]="Disabled";var g=!1,d=d.eT;if(null!=d){this.rmEnableAl.push(c);a.alRemoteEnable=d;if(this.enableTags[d])this.enableTags[d].al.push(c);else{var k=
u.getModule("Quality");this.enableTags[d]={al:[c],status:new k(192)}}this.nRemoteEn++;(c=f.getTagFromCache(d))&&c.isQualityGood()&&(g=c.getValue()?!0:!1)}(this.alarmCache.alEnable[b]=g)||this.nDisabled++;"undefined"!=typeof this.alarmsConf.mlTexts[a.alDescription]&&(this.alarmCache.alDescription[b]=this.alarmsConf.mlTexts[a.alDescription][this.currLang]);b=[];if(a.userActions)for(var n in a.userActions)g=a.userActions[n],g.t===f.actionMgr.enActionType.JS&&(a.alAction=!0,b.push(g)),a.addUserAction(new f.actionMgr.defs[g.jsC]({wgtId:n},
"onMouseRelease",{t:0,c:g.c,p:g.p},f.getFocusPage(),this));if(a.actions)for(var m in a.actions)g=a.actions[m],g.t===f.actionMgr.enActionType.JS&&(g.alAction=!0,b.push(g)),a.addAction(new f.actionMgr.defs[g.jsC]({wgtId:m},"onMouseRelease",{t:0,c:g.c,p:g.p},f.getFocusPage(),this));this._registerJSAction(b);this.alarmCount=++this.alarmCache.alarmCount};a.prototype.getAlarmServerity=function(c){c=this.alarmsConf.alarms[c];var a="";switch(c.sv){case 0:a="-not important";break;case 1:a="-low";break;case 2:a=
"-below normal";break;case 3:a="-normal";break;case 4:a="-above normal";break;case 5:a="-high";break;case 6:a="-critical";break;default:a=""}return c.sv+a};a.prototype.getAlarmProperty=function(c,a){var b=this.alarmsConf.alarms[c];return void 0!=b[a]?b[a]:this.alarmsConf.defaultColors[a]};a.prototype.initAlarmBuffer=function(){for(var c in this.alarmsConf.alarms)this.createAlarm(c)};a.prototype.subscribeTagsForRemoteEnable=function(){var c=this.enableTags,a=this.project.getTagMgr(),b=this.remoteEnReqBufferSize,
d=Math.ceil(this.nRemoteEn/b),g=0,k=Array(1<d?b:this.nRemoteEn),f;for(f in c)g<b?(k[g]=f,g++):(a.subscribeForTagsNotification(k),d--,k=Array(1<d?b:this.nRemoteEn%b),k[0]=f,g=1);a.subscribeForTagsNotification(k)};a.prototype.sendUpdate=function(c,a,b){var d=!0,g;for(g in this.dataLinks){var k=this.dataLinks[g],f=k.tag,m=this.alarmCache[f];if(m instanceof Array){for(var r=0;r<c.length;r++){var v=this.alarmsBuffer[c[r]].cacheIndex,l=k.tagIndex;!a&&"alSelect"==f||-1!==l&&v!==k.tagIndex||(k.setWgtValue(m[v],
v,b),d=!0)}k.initialized=!1}}d&&this.updateTables()};a.prototype.setProperty=function(c,a,b){var d=u.getModule("Tag");this.setValue(c,a,d.QUALITY_GOOD,b)};a.prototype.setValue=function(c,a,b,d,g,k){var f,m=!1;void 0===k&&void 0!==d&&0<=d&&d<this.alarmCache.alarmCount&&(k=this.alarmCache.alName[d]);"undefined"!=typeof k&&(f=this.alarmsBuffer[k].al,"alEnable"==c?(f.isDirty("alEnable")?f.getDirtyValue("alEnable"):f.getValue("alEnable"))!=a&&(f.setDirty("alEnable",a),m=!0):"alSelect"==c?(f.alSelect=a,
m=!0):"alUserAction"==c?(f.alUserAction=a,f.doUserActions(),m=!0):m="fill"==c?!0:f.updateProperty(c,a));-1!=c.indexOf("__rmen__")&&(d=c.split("__rmen__")[1],this.checkEnableTagQuality(d,b));m&&(b=c,"fill"===c&&(b="FGColor"),this.alarmCache[b][this.alarmsBuffer[k].cacheIndex]=a,this.sendUpdate([f.alName],g))};a.prototype.getValue=function(c,a){return this._isAlarmsInitialized&&void 0!==this.alarmCache[c]?void 0!==a&&this.alarmCache[c]instanceof Array?this.alarmCache[c][a]:this.alarmCache[c]:b.prototype.getValue.call(this,
c)};a.prototype.checkEnableTagQuality=function(c,a){var b=this.enableTags[c],d=!1;if(b&&a){for(var g=a.isQualityGood(),k=0,n=b.al.length;k<n;k++){var m=this.alarmsBuffer[b.al[k]],r=m.al,m=m.cacheIndex;if(g){b.status||(d=!0);var v=f.getTagFromCache(c).getValue();if(this.alarmCache.alEnable[m]!=v){d=this.getAlarmProperty(r.alName,"notifyMask");if(d&qa.AL_EVENT_ENABLED||d&qa.AL_EVENT_DISABLED)r.alEnable=v,this.alarmCache.alEnable[m]=v;d=!0}}else d=!0}b.status=a.isQualityGood();d&&this.sendUpdate(b.al,
!0,a)}};a.prototype.updateAlarmByIndex=function(c,a,b){var d=this.alarmCache.alName[c];return d&&(d=this.alarmsBuffer[d].al,void 0!==d[a])?(d[a]=b,this.alarmCache[a][c]=b,!0):!1};a.prototype.setSelectAlarm=function(c,a){this.setValue("alSelect",a,null,0,!0,c)};a.prototype.setEnableAlarm=function(c,a){this.setValue("alEnable",a,null,0,!0,c)};a.prototype.selectAllAlarms=function(c){for(var a=!1,b=0;b<this.alarmCount;b++)this.alarmCache.alSelect[b]=c;for(var d in this.alarmsBuffer)this.alarmsBuffer[d].al.alSelect=
c;if(c=this.mapDataLinkToVar.alSelect)for(b=0;b<c.length;b++)c[b].setWgtValue(this.alarmCache.alSelect,-1),a=!0;a&&this.updateTables()};a.prototype.doSelectAlarms=function(c,a){void 0===a&&(a=this.getSelectedToggleStatus());c||(c=this.alarmCache.alName);for(var b=0,d=c.length;b<d;b++){var g=u.getModule("Quality");this.setValue("alSelect",a?1:0,new g(0),null,!0,c[b])}};a.prototype.getSelectAlarmsByFilter=function(c,a,b,d){var g=[],k;for(k in this.alarmsBuffer){var f=this.alarmsBuffer[k].al,m="alState"==
c?f.stateToString(f.alState):f[c],r="alState"==b?f.stateToString(f.alState):f[b];m&&r&&a&&d?a.test(m)&&d.test(r)&&g.push(f.alName):m&&a?a.test(m)&&g.push(f.alName):r&&d?d.test(r)&&g.push(f.alName):g.push(f.alName)}return g};a.prototype.getEventTypeString=function(c){switch(c){case qa.AL_EVENT_TRIGGERED:return"Triggered";case qa.AL_EVENT_NOT_TRIGGERED:return"Not Triggered";case qa.AL_EVENT_ACKED:return"Acked";case qa.AL_EVENT_RESET:return"Reset";case qa.AL_EVENT_ENABLED:return"Enabled";case qa.AL_EVENT_DISABLED:return"Disabled";
case qa.AL_FLAG_TRIGGER_CONDITION_CHANGED:return"Flag Trigger Condition Changed";default:return""}};a.prototype.getTextFromAlarmProp=function(c,a){var b=this.getAlarmsConfiguration(),d=b.mlTexts;return(b=(b=b.alarms[c])&&b[a])&&d[b]?d[b][this.currLang]:""};a.prototype.getAlarmProp=function(c,a){var b=this.getAlarmsConfiguration().alarms[c];return(b=b&&b[a])?b:""};a.prototype.getAlarmNameById=function(c){return this.getAlarmById(c.toString()).alName};a.prototype.getAlarmById=function(c){c=this.mapAlarmId[c];
return void 0!==c?this.alarmsBuffer[c].al:null};a.prototype.getAlarmByName=function(c){return this.alarmsBuffer[c].al};a.prototype.getAlarmByIndex=function(c){return this.alarmsBuffer[this.alarmCache.alName[c]].al};a.prototype.getAlarmNameByIndex=function(c){return this.alarmCache.alName[c]};a.prototype.getUnorderedPosition=function(c){return this.getAlarmByIndex(c).xmlOrder};a.prototype.getIndexOfAlarm=function(c){return this.alarmsBuffer[c].cacheIndex};a.prototype.isAlarmSelected=function(c){return this.alarmsBuffer[c].al.alSelect};
a.prototype.getSelectedToggleStatus=function(){return this.toggleSelectAll=!this.toggleSelectAll};a.prototype.getSelectedAlarms=function(){for(var c=[],a=this.alarmCache.alSelect,b=this.alarmCache.alName,d=this.alarmCache.alSelect.length,g=0;g<d;g++)a[g]&&c.push(b[g]);return c};a.prototype.resetSelectedAlarms=function(){for(var c=[],a=this.alarmCache.alSelect,b=this.alarmCache.alName,d=this.alarmCache.alSelect.length,g=0;g<d;g++)a[g]&&c.push(b[g]);this.srv.resetAlarms(c,!1);for(a=0;a<c.length;a++)this.alarmsBuffer[c[a]].al.reset()};
a.prototype._getAlarmsEnableStatus=function(){for(var c={enabled:[],disabled:[]},a={},b=0,d=this.alarmCache.alEnable.length;b<d;b++){var g=this.alarmCache.alName[b],k=this.alarmsBuffer[g].al;if(k.isDirty("alEnable")){var f=this.alarmCache.alEnable[b];null!=k.alRemoteEnable?a[k.alRemoteEnable]?(a[k.alRemoteEnable].list.push(g),a[k.alRemoteEnable].status&&!f&&(a[k.alRemoteEnable].status=!1)):a[k.alRemoteEnable]={list:[g],status:f}:f?c.enabled.push(g):c.disabled.push(g);k.commitDirtyValue("alEnable")}}for(var m in a)b=
a[m],b.status?c.enabled=c.enabled.concat(b.list):c.disabled=c.disabled.concat(b.list);return c};a.prototype.ackSelectedAlarms=function(){var c=this.getSelectedAlarms();0<c.length&&this.srv.acknowledgeAlarms(c,!1)};a.prototype.ackSpecificAlarm=function(c){this.srv.acknowledgeAlarms([c],!1)};a.prototype.enableAlarms=function(){var c=this._getAlarmsEnableStatus();0<c.enabled.length&&this.srv.enableAlarms(c.enabled,!0,!1);0<c.disabled.length&&this.srv.enableAlarms(c.disabled,!1,!1);this.updateTables()};
a.prototype.saveConfiguration=function(){this.srv.saveConfiguration(!1)};a.prototype.updateLanguage=function(){var c=this.getPageMLTextMgr().getCurrentLanguage();if(c!=this.currLang){var a=[],b;for(b in this.alarmsBuffer){var d=this.alarmsBuffer[b];this.alarmCache.alDescription[d.cacheIndex]=this.alarmsConf.mlTexts[d.al.alDescription][c];a.push(b)}this.sendUpdate(a);this.currLang=c}};a.prototype.getCurrentLanguage=function(){return this.currLang};a.prototype.applyTrasformation=function(c,a){var b=
u["import"]("TextFormatUtil"),d=a.indexOf("("),g=a.indexOf(")");if(-1!=d&&-1!=g){var k=a.substring(0,d),d=a.substring(d+2,g-1);"format"==k&&(c=b.format(b.parseFormat(d),c,null,!1))}else-1!=a.indexOf("#")&&(c=b.format(b.parseFormat(a),c,null,!1));return c};a.prototype.formatValue=function(c,a){var b=f["import"]("hmiDataLink").parseString(a);"nan"!==c&&(0!=b.elemList.length||isNaN(c)||0==c%1||(b.elemList=['format("#.000000")']),c=b.elemList.reduce(this.applyTrasformation,c));return c};a.prototype.replaceHistLiveTags=
function(c,a,b){if(!a||!b)return c;for(var d=b.length,g=0,k=a.length;g<k;g++){var f=new RegExp("\\[\\$"+g+"\\:[-]?\\d*\\]","g"),m=-1,r=c.search(f);if(-1!=r)var m=c.indexOf(":"),v=c.indexOf("]"),m=parseInt(c.substring(m+1,v));v="";-1!=r&&g<d&&(v=""===b[g]&&m!=w.STRING?"nan":b[g]);c=c.replace(f,this.formatValue(v,a[g]))}return c};a.prototype.destroy=function(){var c=this.getAlarmsBuffer(),a;for(a in c)c[a].al.stopBlinking();return b.prototype.destroy.call(this)};a.jmType="AlarmsMgrWgt";return a}(l);
f.fn.hmiAlarmsMgr=function(b,a,c,e){return new Fc(this,b,a,c,e)};f.addWidgetDefinition("hmiAlarmsMgr",Fc);var Gc;(function(b){b[b.LOCAL=1]="LOCAL";b[b.CLIENT=2]="CLIENT";b[b.WEB=4]="WEB"})(Gc||(Gc={}));var la;(function(b){b[b.INFINITE=-1]="INFINITE"})(la||(la={}));var Hc=function(b){function a(c,a,h,d,g){var k=b.call(this,c.wgtId,a,h,d,g)||this;k.currentPage=null;k.invokableFunList=["getCurrentPageName","hasPage"];k.core=f;k.project=k.core.getActiveProject();k.container=k.project.getNode("container");
k.loadedPages=[];k.precaching=!1;k.docFragment=document.createDocumentFragment();k.docFragmentLimit=5;k.userAgent=k.getDevice();k.currentCategory=k.resolveCurrentCategory();k.invalidateMtxChain();k.project.on("resize.pagemgr",function(c){k.project.waitWgtReady().then(function(){var c=k.currentCategory,a=k.resolveCurrentCategory();if(a&&!c||a&&a.name!=c.name)k.currentCategory=a,c=k.core.getActivePage(),c.getUserId()!=a.home&&k.project.changePage(c.getId(),k.getWebPage(a.home.toLowerCase()))})});return k}
p(a,b);a.prototype.getDevice=function(){return/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)?"mobi":/iPad|RIM Tablet OS/i.test(navigator.userAgent)?"tablet":"web"};a.prototype.getHomePageId=function(){return this.currentCategory.home};a.prototype.setCurrentPageFromName=function(c){this.currentPage=c};a.prototype.isCurrentPageDefined=function(){return null!=this.currentPage};a.prototype.getCurrentPageName=function(){return this.core.getActivePage().getUserId()};a.prototype.getCurrentPageId=
function(){return this.core.getActivePage().getId()};a.prototype.hasPage=function(c){return c.toLowerCase()in this.map};a.prototype.hasWebPage=function(c){return this.currentCategory&&-1!=this.currentCategory.pages.indexOf(c)};a.prototype.getWebPage=function(c){return this.map[c]};a.prototype.getPageStudioId=function(c){for(var a in this.map)if(this.map[a]==c)return a;return null};a.prototype.length=function(){var c=this.getCurrentCategory();return c?c.pages.length:0};a.prototype.parsePage=function(c,
a){for(var b=c.querySelector("#_"+a),d=b.getElementsByTagName("script"),g,k,f=0,m=d.length;f<m;f++){var r=d[f].id;"hmi-page"===r?g=d[f].textContent:"hmi-init"===r&&(k=d[f].textContent)}return{element:b,scripts:{init:k,logic:g}}};a.prototype.loadPrecache=function(){var c=this;this.precaching=!0;var a=this.getCurrentCategory(),b=this.precached.filter(function(c){return-1!=a.pages.indexOf(c)});this.precache=new Promise(function(a,e){c.precached?(c.queue=b.slice(),c.project.getCommunticationObj().getPrecachedPages().then(function(e){c._loadPages(e,
a)})["catch"](function(){e()})):a()});this.precache.then(function(){for(var a=function(){var a=b[e];if(c.activePage.getId()!=a){var d=f.getPage(a),a=u.getModule("Tag");d.setValue("visibility",!1,a.QUALITY_GOOD);requestAnimationFrame(function(){d.elem.parentElement.parentElement.style.top="0px";d.elem.parentElement.parentElement.style.left="0px"})}},e=0,k=b.length;e<k;e++)a();c.precaching=!1});this.precache["catch"](function(a){c.precaching=!1;throw a;});return this.precache};a.prototype.isPrecaching=
function(){return this.precaching};a.prototype.waitPrecacheEnd=function(){return this.precache};a.prototype._loadPages=function(c,a){var b=this;if(0<this.queue.length){var d=this.queue.shift();if(this.activePage.getId()==d)requestAnimationFrame(function(){b._loadPages(c,a)});else{var g=this.parsePage(c,d);this.project.injectCWTemplatesToDOM(g.element);g.element.setAttribute("data-url",this.project.getPageUrl(d)+d+".html");this.container.appendChild(g.element);d=this.core.getNextPageId(d);if(null==
document.querySelector("link[rel='stylesheet'][href='"+d+".css']")){var k=document.createElement("link");k.setAttribute("rel","stylesheet");k.setAttribute("href",d+".css");document.querySelector("head").appendChild(k)}null!=g.scripts&&null!=g.scripts.logic&&eval(g.scripts.logic);var n=f.getPageInitFunction(g.element.getAttribute("id"))(1);this.addLoadedPage(n.getId());n.render();g.element.style.top=f.browserWindow.height-2+"px";g.element.style.left=f.browserWindow.width-2+"px";f.getActiveProject().triggerEvent("precacheprogess",
{totPages:this.precached.length,nPage:this.precached.length-this.queue.length});requestAnimationFrame(function(){b.project.onPageChange({recipes:!0});n.unmountDataLinks();b.movePageToFragment(n.getId());b._loadPages(c,a)})}}else a()};a.prototype.isPagePrecached=function(c){return-1!=this.precached.indexOf(c)};a.prototype.setActivePage=function(c){this.activePage=c};a.prototype.getActivePage=function(){return null!=this.activePage?this.activePage:this.project};a.prototype.setFocusPage=function(c){this.focusPage=
c};a.prototype.getFocusPage=function(){return null!=this.focusPage?this.focusPage:this.getActivePage()};a.prototype.addLoadedPage=function(c){this.loadedPages.push(c)};a.prototype.removeLoadedPage=function(c){this.loadedPages.slice(this.loadedPages.indexOf(c),1)};a.prototype.isCached=function(c){return-1!==this.loadedPages.indexOf(c)};a.prototype.getPagesElement=function(){return this.container.querySelectorAll("div[data-role='page']")};a.prototype.getLastPageInDOM=function(){var c=this.container.querySelectorAll("div[data-role='page']");
return c[c.length-1]};a.prototype.isDOMEmpty=function(){return null==this.container.querySelector("div[data-role='page']")};a.prototype.getPagesContainer=function(){return this.container};a.prototype.isPageInFragment=function(c){return null!=this.docFragment.querySelector("#_"+c)};a.prototype.movePageToFragment=function(c){(c=document.getElementById("_"+c))&&this.docFragment.appendChild(c);return c};a.prototype.loadPageFromFragment=function(c){(c=this.docFragment.querySelector("#_"+c))&&this.container.appendChild(c);
return c};a.prototype.removePageFromFragment=function(c){return(c=this.docFragment.querySelector("#_"+c))?(c.parentNode.removeChild(c),!0):!1};a.prototype.pagesGC=function(c,a){var b=this.project.getValue("pagesCacheSize"),d=1,g=0,k=Array(d),n=this.loadedPages.length;if(n>b||!this.project.checkAvailableMemory()){for(b=0;b<n&&0!==d;b++)if(this.loadedPages[b]!=c){var m=this.loadedPages[b];f.getPage(m).destroy();a.removedPage=k[g++]=m;f.evtMgr.trigger(this.project.getNode("container"),"hmipageremoved",
a);var r="_"+m;f.removePageInitFunction(r);this.project.getCWidgetMgr().freeCWInstances(r);(r=document.getElementById(r))?r.parentNode.removeChild(r):this.isPageInFragment(m)&&this.removePageFromFragment(m);d--}if(0===d){d=0;for(g=k.length;d<g;d++)n=this.loadedPages.indexOf(k[d]),this.loadedPages.splice(n,1);return k}}return[]};a.prototype.triggerBeforeChangeEvent=function(c){f.evtMgr.trigger(this.container,f.EVENTS.PAGE.BEFORE_CHANGE,c)};a.prototype.triggerBeforeContentLoaded=function(c){f.evtMgr.trigger(this.container,
f.EVENTS.PAGE.CONTENT_LOAD,c)};a.prototype.triggerPageChange=function(c){f.evtMgr.trigger(this.container,f.EVENTS.PAGE.PAGE_CHANGE,c)};a.prototype.triggerAfterChange=function(c){f.evtMgr.trigger(this.container,f.EVENTS.PAGE.AFTER_CHANGE,c)};a.prototype.triggerErrorLoading=function(c){f.evtMgr.trigger(this.container,f.EVENTS.PAGE.ERROR_LOADING,c)};a.prototype.getPages=function(){var c=this.getCurrentCategory();return c?c.pages:[]};a.prototype.maxValues=function(c,a,b){null==c.indexes?(c.max=a,c.indexes=
[b]):a>c.max?(c.max=a,c.indexes=[b]):a==c.max&&c.indexes.push(b);return c};a.prototype.minValues=function(c,a,b){null==c.indexes?(c.min=a,c.indexes=[b]):a<c.min?(c.min=a,c.indexes=[b]):a==c.min&&c.indexes.push(b);return c};a.prototype.getCurrentCategory=function(){if(!this.categories)return null;this.currentCategory||(this.currentCategory=this.resolveCurrentCategory());return this.currentCategory};a.prototype.filterByUserAgent=function(c){for(var a=f.getUserAgent(),b=[],d=[],g=0,k=0;k<c.length;k++){var n=
c[k];if(".*"==n.useragent||"*"==n.useragent)b.push(n);else{var m=n.useragent.split("|").reduce(function(c,b){return-1!=a.indexOf(b)?++c:c},0);0==d.length?(d.push(n),g=m):m>g?(d=[],d.push(n),g=m):m==g&&d.push(n)}}return 0!=g?d:b};a.prototype.isCategoryContainedInViewportSize=function(c){var a=f.browserWindow.width,b=f.browserWindow.height,d=c.minSize,g=d[1],k=c.maxSize;c=k[0];k=k[1];d=d[0]<=a&&g<=b;return c==la.INFINITE&&k==la.INFINITE?d:d&&(a<=c||c==la.INFINITE)&&(b<=k||k==la.INFINITE)};a.prototype.resolveCurrentCategory=
function(){var c=this.categories,a=f.browserWindow.width,b=f.browserWindow.height,d=[],g=[],k;for(k in c){var n=c[k];0==n.minSize[0]&&0==n.minSize[1]&&n.maxSize[0]==la.INFINITE&&n.maxSize[1]==la.INFINITE?g.push(n):d.push(n)}if(1==d.length&&this.isCategoryContainedInViewportSize(d[0]))return d[0];d=this.filterByUserAgent(d);d=d.filter(this.isCategoryContainedInViewportSize);if(1==d.length)return d[0];k=d.map(function(c){var d=c.minSize,g=d[0],d=d[1],k=c.maxSize;c=k[0];k=k[1];c==la.INFINITE&&(c=a);
k==la.INFINITE&&(k=b);return(c-g)*(k-d)/(a*b)}).reduce(this.minValues,{min:-1,indexes:null});if(-1!=k.min){if(1==k.indexes.length)return d[k.indexes[0]];for(var c=Array(k.indexes.length),n=0,m=k.indexes.length;n<m;n++)c[n]=d[k.indexes[n]];d=c.map(function(c){var d=c.maxSize[0];if(d==la.INFINITE||d>a)d=c.minSize[0];var g=c.maxSize[1];if(g==la.INFINITE||g>a)g=c.minSize[1];c=b-g;var k=a-d;c<=k?(c=g+c,k=d/g*c):(k=d+k,c=g/d*k);return k*c/(b*b)}).reduce(this.minValues,{min:-1,indexes:null});if(0<d.indexes.length)return c[d.indexes[0]]}g=
this.filterByUserAgent(g);return 0<g.length?g[0]:null};a.prototype.setLastVisitedPage=function(c){-1!=this.currentCategory.pages.indexOf(c)&&(this.lastVisitedPage=c)};a.prototype.getLastVisitedPage=function(){return this.lastVisitedPage&&-1!=this.currentCategory.pages.indexOf(this.lastVisitedPage)?this.lastVisitedPage:this.currentPage};a.prototype.isUserManagmentPage=function(c){return this.currentCategory?-1!=this.currentCategory.umpages.indexOf(c.toLowerCase()):!1};return a}(l);f.fn.hmiPageMgr=
function(b,a,c,e){return new Hc(this,b,a,c,e)};f.addWidgetDefinition("hmiPageMgr",Hc);var ab=function(b,a,c,e,h){h=h*Math.PI/180;return{x:b-c*Math.cos(h),y:a-e*Math.sin(h)}},ac=function(b,a,c,e,h,d){var g=ab(b,a,c,e,d);b=ab(b,a,c,e,h);return["M",g.x,g.y,"A",c,e,0,180>=d-h?"0":"1",0,b.x,b.y].join(" ")};Element.prototype.appendAfter=function(b){b.parentNode.insertBefore(this,b.nextSibling)};Element.prototype.appendBefore=function(b){b.parentNode.insertBefore(this,b)};Ta.prototype=Object.create(window.Scrollbar.ScrollbarPlugin.prototype);
Ta.prototype.transformDelta=function(b){this.options.direction&&(b[this.options.direction]=0);return b};Ta.pluginName="disableScroll";Ta.defaultOptions={direction:null};f.resetViewport=function(){};f.parseRequest=function(){var b={};if(window.location.search)for(var a=window.location.search.substring(1).split("&"),c=0,e=a.length;c<e;c++){var h=a[c].split("=");b[decodeURIComponent(h[0])]=decodeURIComponent(h[1])}return b};zc.prototype={getMatrix3x1:function(b,a,c){var e=this.tail3x1;e.m[0][0]=b;e.m[1][0]=
a;e.m[2][0]=c;null!=e.prev&&(e.prev.next=null,this.tail3x1=e.prev,e.prev=null);return e},free3x1:function(b){b.prev=this.tail3x1;this.tail3x1=this.tail3x1.next=b},getMatrix3:function(b,a,c,e,h,d,g,k,f){var m=this.tail3;m.m[0][0]=b;m.m[0][1]=a;m.m[0][2]=c;m.m[1][0]=e;m.m[1][1]=h;m.m[1][2]=d;m.m[2][0]=g;m.m[2][1]=k;m.m[2][2]=f;null!=m.prev&&(m.prev.next=null,this.tail3=m.prev,m.prev=null);return m},free3:function(b){b.prev=this.tail3;this.tail3=this.tail3.next=b}};f.matrixPool=new zc(5);E.prototype.strStyle=
"rgb(0,0,0)";E.prototype.lineCap="butt";E.prototype.lineJoin="bevel";E.prototype.TYPE={STEP:1,LINE:0};E.prototype.pathLimitBuffer=100;E.prototype.curveWgt=null;E.prototype.setXRange=function(b,a){this.curveXRange={min:b,max:a}};E.prototype.setYRange=function(b,a){this.curveYRange={min:b,max:a}};E.prototype.mapToCoordinatesSystem=function(b){b.x=b.x;b.y=this.wSize.height-b.y};E.prototype.mapToRange=function(b,a,c){b.x=(a-this.curveXRange.min)*this.wSize.width/(this.curveXRange.max-this.curveXRange.min);
b.y=(c-this.curveYRange.min)*this.wSize.height/(this.curveYRange.max-this.curveYRange.min)};E.prototype.updateCurve=function(b,a,c){this.data=b;this.type=a;this._drawable=c};E.BrushType={LINE:0,DASHED:1};E.prototype._resetDrawStatus=function(){this.drawStatus.prevPoint.x=void 0;this.drawStatus.prevPoint.y=void 0;this.drawStatus.currPoint.x=void 0;this.drawStatus.currPoint.y=void 0;this._isNativeCompatible&&this.drawStatus.brushType!=E.BrushType.LINE&&this.ctx.setLineDash([0,0]);this.drawStatus.brushType=
E.BrushType.LINE};E.prototype.drawCurve=function(){if(null!=this.curveWgt){var b=this.data;if(this._drawable&&b){this.ctx.lineWidth=this.strWidth;this.ctx.strokeStyle=this.strStyle;this.ctx.lineCap=this.lineCap;this.ctx.lineJoin=this.lineJoin;this.drawStatus.lineBufferSize=this.pathLimitBuffer;for(var a=this.drawStatus.prevPoint,c=this.drawStatus.currPoint,e=this.drawStatus.brushType,h=this.curveWgt.getValue("cursor-ts"),d=b.length-1,g=0,k=b.length;g<k;g++)if(0==this.drawStatus.lineBufferSize&&this.endLine(),
void 0!==b[g]&&b[g].q.isQualityGood()){"string"===typeof b[g].getValue()&&b[g].setValue(0);if(g<k-1&&void 0!==b[g+1]){var f=b[g+1].x;h>=b[g].x&&h<=f&&this.curveWgt.setValue("cursor-value",b[g].y,null)}c.selected=b[g].selected;this.mapToRange(c,b[g].x,b[g].y);this.mapToCoordinatesSystem(c);0>c.x&&!this.isScatter?(this.isOutFromBounds(c)&&!this.isScatter?(this.moveToBoundary(c),e=E.BrushType.DASHED):e=E.BrushType.LINE,a.x=c.x,a.y=c.y,a.selected=c.selected):(void 0!=a.x&&void 0!=c.x&&(this.isOutFromBounds(c)&&
!this.isScatter?(this.moveToBoundary(c),e==E.BrushType.LINE&&(this.endLine(),e=E.BrushType.DASHED,this.beginLine(a,e)),0==this.drawStatus.operation&&this.beginLine(a,e),this.appendSegment(a,c)):e==E.BrushType.DASHED?(this.appendSegment(a,c),this.endLine(),e=E.BrushType.LINE,this.beginLine(c,e)):(0==this.drawStatus.operation&&this.beginLine(a,e),this.appendSegment(a,c))),a.x=c.x,a.y=c.y,a.selected=c.selected,this.isOutFromBounds(a)&&!this.isScatter&&(e=E.BrushType.DASHED),g==d&&this.endLine())}else this.endLine(),
a.x=a.y=void 0,e=E.BrushType.LINE;this._resetDrawStatus()}}};E.prototype.isOutFromBounds=function(b){return 0>b.y||b.y>this.wSize.height?!0:!1};E.prototype.moveToBoundary=function(b){var a=0;0>b.y&&(b.y=0,a=-1);b.y>this.wSize.height&&(b.y=this.wSize.height,a=1);return a};E.prototype.beginLine=function(b,a){1==this.drawStatus.operation&&(this.ctx.stroke(),this.drawStatus.lineBufferSize=this.pathLimitBuffer);if(this._isNativeCompatible&&a!=this.drawStatus.brushType)if(a==E.BrushType.LINE)this.ctx.setLineDash([0,
0]);else if(a==E.BrushType.DASHED){var c=this.ctx.lineWidth;this.ctx.setLineDash([2*c,3*c])}this.drawStatus.brushType=a;b.selected&&this.drawBigPoint(b);this.ctx.beginPath();this.ctx.moveTo(b.x,b.y);this.drawStatus.operation=1};E.prototype.appendSegment=function(b,a){0==this.drawStatus.lineBufferSize&&(this.ctx.stroke(),this.drawStatus.lineBufferSize=this.pathLimitBuffer,b.selected&&this.drawBigPoint(b),this.ctx.beginPath(),this.ctx.moveTo(b.x,b.y));this.drawStatus.brushType==E.BrushType.LINE?(this.type==
this.TYPE.STEP&&b.x!=a.x&&this.ctx.lineTo(a.x,b.y),this.ctx.lineTo(a.x,a.y)):this.drawStatus.brushType==E.BrushType.DASHED&&(this._isNativeCompatible?(this.type==this.TYPE.STEP&&b.x!=a.x&&this.ctx.lineTo(a.x,b.y),this.ctx.lineTo(a.x,a.y)):(this.type==this.TYPE.STEP&&b.x!=a.x&&this.dashedLine(b.x,b.y,a.x,a.y),this.dashedLine(b.x,b.y,a.x,a.y)));this.drawStatus.lineBufferSize--;a.selected&&(this.ctx.stroke(),this.drawBigPoint(a),this.drawStatus.lineBufferSize=this.pathLimitBuffer,this.ctx.beginPath(),
this.ctx.moveTo(a.x,a.y))};E.prototype.endLine=function(){1==this.drawStatus.operation&&(this.ctx.stroke(),this.ctx.closePath(),this.drawStatus.operation=0)};E.prototype.drawBigPoint=function(b){this.ctx.beginPath();this.ctx.fillStyle=this.strStyle;this.ctx.arc(b.x,b.y,2.5*this.strWidth,0,2*Math.PI);this.ctx.fill();this.ctx.stroke()};E.prototype.dashedLine=function(b,a,c,e){for(var h=this.ctx.lineWidth+2,d=c-b,g=e-a,h=Math.floor(Math.sqrt(d*d+g*g)/h),d=d/h,g=g/h,k=0;k<h;)b+=d,a+=g,this.ctx[0==k%2?
"moveTo":"lineTo"](b,a),k++;this.ctx[0==k%2?"moveTo":"lineTo"](c,e)};E.prototype.enableDrawing=function(b){this._drawable=b};E.prototype.clearCanvasContext=function(){this.ctx.clearRect(0,0,this.wSize.width+5,this.wSize.height+5)};E.prototype.clearData=function(){this.data=null};E.prototype.updateCanvasContainerSize=function(b){var a=this.canvas.parentNode;a.style.width=b.width+"px";a.style.height=b.height+"px";a.style.left=b.x+"px";a.style.top=b.y+"px"};E.prototype.updateSize=function(b,a){this.canvas.width=
b;this.canvas.height=a;this.wSize.width=b;this.wSize.height=a};E.prototype.destroy=function(){this.ctx.clearRect(0,0,this.wSize.width,this.wSize.height);this.curveWgt=null};P.prototype.constructor=P;P.prototype.isVisible=!1;P.prototype.getLinePoints=function(b,a){var c=[];c.push({x:b,y:0});c.push({x:b,y:this._wSize.height});c.push({x:0,y:a});c.push({x:this._wSize.width,y:a});return c};P.prototype.mapToCoordinatesSystem=function(b,a,c){b.x=a;b.y=this._wSize.height-c};P.prototype.mapToRange=function(b,
a,c){b.x=Math.floor((a-this._xSize.min)*this._wSize.width/(this._xSize.max-this._xSize.min));b.y=Math.floor((c-this._ySize.min)*this._wSize.height/(this._ySize.max-this._ySize.min))};P.prototype.drawCursor=function(b){var a={x:0,y:0};b?a={x:this._pos.x,y:this._pos.y}:(this.mapToRange(a,this._pos.x,this._pos.y),this.mapToCoordinatesSystem(a,a.x,a.y));if(!this.xCursorShow&&!this.yCursorShow)return this.isVisible&&(this.ctx.clearRect(0,0,this._wSize.width,this._wSize.height),this.isVisible=!1),!1;this.isVisible=
!0;b=this.getLinePoints(a.x,a.y);this.ctx.clearRect(0,0,this._wSize.width,this._wSize.height);this.ctx.beginPath();this.xCursorShow&&(this.ctx.moveTo(b[0].x,b[0].y),this.ctx.lineTo(b[1].x,b[1].y));this.yCursorShow&&(this.ctx.moveTo(b[2].x,b[2].y),this.ctx.lineTo(b[3].x,b[3].y));this.ctx.lineWidth=this.strokeWidth;this.ctx.strokeStyle=this.strokeColor;this.ctx.stroke();this.ctx.closePath()};P.prototype._getValidValue=function(b){var a=null;if(b<this._xSize.min||b>this._xSize.max){if(this._pos.x<this._xSize.min||
this._pos.x>this._xSize.max)b=(this._xSize.max-this._xSize.min)/2,a=this._xSize.max-b}else a=b;return a};P.prototype.setXCursorPos=function(b){b=this._getValidValue(b);null!=b&&(this._pos.x=b)};P.prototype.setYCursorPos=function(b){this._pos.y=b};P.prototype.setCursorVisibility=function(b){this.xCursorShow=b};P.prototype.setXMin=function(b){this._xSize.min=b};P.prototype.setXMax=function(b){this._xSize.max=b};P.prototype.setYMin=function(b){this._ySize.min=b};P.prototype.setYMax=function(b){this._ySize.max=
b};P.prototype.getXPosition=function(){if(this._pos)return this._pos.x};P.prototype.getYPosition=function(){if(this._pos)return this._pos.y};P.prototype.isCursorVisible=function(){return this.xCursorShow};P.prototype.clearCanvasContext=function(){this.ctx.clearRect(0,0,this._wSize.width+5,this._wSize.height+5)};P.prototype.updateSize=function(b,a){this.canvas.width=b;this.canvas.height=a;this._wSize.width=b;this._wSize.height=a};W.prototype=Object.create(P.prototype);W.prototype.constructor=W;W.prototype.xyGrid=
null;W.prototype.xyIdx=null;W.prototype.lowerSnap=null;W.prototype.upperSnap=null;W.prototype.isOnTheGrid=!1;W.prototype.stepXY=function(b,a){b=0==b?1:-1;var c=this._pos.x,e;if(this.isOnTheGrid)e=this.xyIdx;else{--a;var h=!1;1===b?c>this.xyGrid[this.xyGrid.length-1]?h=!0:e=this.xyGrid.indexOf(this.upperSnap):-1===b&&(c<this.xyGrid[0]?h=!0:e=this.xyGrid.lastIndexOf(this.lowerSnap));if(h)return{xvalue:"",yoccurence:0}}c=e+a*b;c>=this.xyGrid.length?c=this.xyGrid.length-1:0>c&&(c=0);this.xyIdx=c;this.isOnTheGrid=
!0;c=this.xyGrid[c];this._pos.x=c;e=this.xyGrid.indexOf(c);e=0<this.xyGrid.lastIndexOf(c)-e?this.xyIdx-e:0;return{xvalue:c,yoccurence:e}};W.prototype.updateXYGrid=function(b){this.xyGrid=[];for(var a={},c=0,e=b.length;c<e;c++){var h=b[c].xvalue;if(void 0!==h)for(var d=0,g=h.length;d<g;d++){var k=h[d];if(h.indexOf(k)!=d){var f=b[c].wgtId;void 0===a[k]&&(a[k]={},a[k][f]=0);a[k][f]++}else this.insert(k),this.updateLowerUpperSnap(k)}}for(var m in a){c=a[m];b=0;for(f in c)c[f]>b&&(b=c[f]);for(c=0;c<b;c++)this.xyGrid.splice(this.xyGrid.indexOf(parseFloat(m)),
0,parseFloat(m))}this.isOnTheGrid&&(this.xyIdx=this.xyGrid.indexOf(this._pos.x))};W.prototype.insert=function(b){if(-1==this.xyGrid.indexOf(b)){for(var a=this.xyGrid.length,c=0;c<a&&this.xyGrid[c]<b;)c++;this.xyGrid.splice(c,0,b);return c}return-1};W.prototype.updateLowerUpperSnap=function(b){if(!this.isOnTheGrid){var a=this._pos.x;a===b?this.isOnTheGrid=!0:null===this.lowerSnap&&a>b?this.lowerSnap=b:null===this.upperSnap&&a<b?this.upperSnap=b:a>b&&Math.abs(a-b)<Math.abs(a-this.lowerSnap)?this.lowerSnap=
b:a<b&&Math.abs(a-b)<Math.abs(a-this.upperSnap)&&(this.upperSnap=b)}};W.prototype.resetXYCursor=function(){if(null!==this.xyGrid){var b=this.xyGrid.indexOf(this._pos.x);this.xyIdx=(this.isOnTheGrid=-1!==this.xyGrid.indexOf(this._pos.x))?b:null}for(var b=0,a=this.xyGrid.length;b<a;b++)this.updateLowerUpperSnap(this.xyGrid[b])};W.prototype.getValueXY=function(){return this.xyGrid[this.xyIdx]};W.prototype.getOccurenceXY=function(){var b=this.xyGrid[this.xyIdx];if(void 0!==b){var a=this.xyGrid.indexOf(b);
return 0<this.xyGrid.lastIndexOf(b)-a?this.xyIdx-a:0}return 0};W.prototype.getXPosition=function(){return null!==this.xyGrid&&null!==this.xyIdx?this.xyGrid[this.xyIdx]:""};Da.prototype.setXRange=function(b,a){this.xSize.min=b;this.xSize.max=a};Da.prototype.setYRange=function(b,a){this.ySize.min=b;this.ySize.max=a};Da.prototype.mapToRange=function(b,a){return Math.floor((b-a)*this.wSize.width/(this.xSize.max-this.xSize.min))};Da.prototype.drawBands=function(){var b=new Date(this.xSize.max),a=new Date(this.xSize.min),
c=this.getPointsInWindow(a,b);this.ctx.clearRect(0,0,this.wSize.width,this.wSize.height);var e;if(0==c.length)e=a.getDay(),a=a.getHours(),this.draw(0,this.wSize.width,e,a-2);else{for(var h=0,d=0,g=0;g<c.length;g++)h=c[g].x-d,e=c[g].d,a=c[g].h,this.draw(d,h,e,a-2),d=c[g].x;h=this.wSize.width-d;e=b.getDay();a=b.getHours();this.draw(d,h,e,a-1)}};Da.prototype.getPointsInWindow=function(b,a){for(var c=[],e=new Date(b.getFullYear(),b.getMonth(),b.getDate(),b.getHours()+1,0);e<=a;)c.push({x:this.mapToRange(e,
b),d:e.getDay(),h:e.getHours()}),e=new Date(e.getTime()+36E5);return c};Da.prototype.draw=function(b,a,c,e){if(c=this.bands.clrs[this.bands.tmtx[c][e]])this.ctx.beginPath(),this.ctx.rect(b,0,a,this.wSize.height),this.ctx.fillStyle=c,this.ctx.fill()};Da.prototype.clearCanvasContext=function(){this.ctx.clearRect(0,0,this.wSize.width+5,this.wSize.height+5)};Da.prototype.updateSize=function(b,a){var c=document.getElementById(this.id);c.width=b;c.height=a;this.wSize.width=b;this.wSize.height=a};ja.prototype.drawBGGrid=
function(){var b=1,a=1;this.ctx.clearRect(0,0,this.wSize.width,this.wSize.height);this.ctx.beginPath();this.ctx.fillStyle=this.colorX;for(var c=Math.ceil(this.wSize.width/(this.gridX+1-2)),e=Math.ceil(this.wSize.height/(this.gridY+1-2)),h=c,d=0;b<this.gridX-1;)this.ctx.fillRect(h,0,1,this.wSize.height),h+=c,b++;this.ctx.beginPath();for(this.ctx.fillStyle=this.colorY;a<this.gridY;)this.ctx.fillRect(0,d,this.wSize.width,1),d+=e,a++;this.ctx.closePath()};ja.prototype.setGridX=function(b){this.gridX=
b};ja.prototype.setGridY=function(b){this.gridY=b};ja.prototype.setColorX=function(b){this.colorX=b};ja.prototype.setColorY=function(b){this.colorY=b};ja.prototype.setXAnchor=function(b){this.xanchor=b};ja.prototype.setYAnchor=function(b){this.yanchor=b};ja.prototype.setXSpacing=function(b){this.xspacing=b};ja.prototype.setYSpacing=function(b){this.yspacing=b};ja.prototype.clearCanvasContext=function(){this.ctx.clearRect(0,0,this.wSize.width+5,this.wSize.height+5)};ja.prototype.updateSize=function(b,
a){this.canvas.width=b;this.canvas.height=a;this.wSize.width=b;this.wSize.height=a};Lb.prototype.constructor=Lb;Lb.prototype.updateBounds=function(){var b=this.baseWgt.left-30,a=this.baseWgt.top,c=!0===this.baseWgt.frame,c="MsgTextWgt"===this.baseWgt.getJMType()?c?this.baseWgt.frameSize:0:0;0>b&&(b=this.baseWgt.left+this.baseWgt.width+2*c);this.elem.style.left=b+"px";this.elem.style.top=a+"px"};L.prototype.constructor=L;L.prototype.init=function(){var b,a,c,e,h=this.baseWgt.elem;b=this.baseWgt.height;
a=this.baseWgt.elem.style.fontFamily;c=parseFloat(this.baseWgt.elem.style.fontSize);e="line-height:"+90*b/100+"px;";this.isBaseMsgTextWgt&&(e+="color:black");b=document.createElement("div");b.style.fontFamily=a;b.style.fontSize=c+"px";b.style.width=this.baseWgt.width+"px";b.style.height=this.baseWgt.height+"px";b.style.boxSizing="border-box";b.style.border=this.frame?"none":"1px solid";b.style.boxSizing="border-box";b.classList+="selectric";a=document.createElement("p");a.classList+="label";a.setAttribute("style",
e);c=document.createElement("b");c.classList+="button";e=document.createTextNode("");a.appendChild(e);b.appendChild(a);b.appendChild(c);this.select.style.display="none";$(h).prepend(b);this.lbl=a;this.sel=b;this.clone=h.cloneNode(!1)};L.prototype.cloneCombobox=function(){this.setMaxSelectricHeight();this.hasEmptyElem();this.clone.hasChildNodes()&&$(this.clone).children().remove();this.updateCloneStyles();this.clSelect=this.select.cloneNode(!0);this.clSelect.selectedIndex=this.select.selectedIndex;
this.clone.appendChild(this.clSelect);var b=this;$(this.clSelect).selectric({nativeOnMobile:!1,disableOnMobile:!1,onClose:function(){b.baseWgt.onClose()},onChange:function(){b.baseWgt.onChange(b.clSelect.selectedIndex)}});this.selectric=$(this.clSelect).data("selectric");this.appendCustomSelectricStyles();this.open()};L.prototype.updateCloneStyles=function(){this.updateOffsets(this.baseParentWidget);this.clone.style.fontFamily=this.baseWgt.elem.style.fontFamily;this.clone.style.fontSize=parseFloat(this.baseWgt.elem.style.fontSize);
this.clone.style.width=this.baseWgt.width+"px";this.clone.style.height=this.baseWgt.height+"px";this.clone.style.left=this.offsets.l+"px";this.clone.style.top=this.offsets.t+"px";this.clone.style.overflow="visible";this._isMsgTextWgt&&(this.clone.style.border="none",this.clone.style.overflow="visible",this.clone.style.backgroundColor="white",this.clone.style.color="black")};L.prototype.open=function(){this.selectric.open();this.updateCloneStyles(this.baseWgt);this.baseParentPage.elem.appendChild(this.clone);
"GroupWgt"!==this.baseParentWidget.getJMType()&&"TableGroupWgt"!==this.baseParentWidget.getJMType()||this.baseParentWidget.addActiveElement(this.clone)};L.prototype.hasEmptyElem=function(){"empty"===this.select.firstChild.getAttribute("value")&&(this.initEmptyElem=!0)};L.prototype.appendCustomSelectricStyles=function(){$(".label",this.clone).css("line-height",90*this.baseWgt.height/100+"px");$(".selectric-items",this.clone).css({width:"100%",boxSizing:"border-box"});$(".selectric",this.clone).css({boxSizing:"border-box",
border:this.frame?"none":"1px solid"});this.upDir&&$(".selectric-items",this.clone).css("top",-this.maxH+"px");this.initEmptyElem&&($(".selectric-scroll",this.clone).children()[0].firstChild.style.display="none",this.initEmptyElem=!1)};L.prototype.setMaxSelectricHeight=function(){var b=parseFloat(this.baseWgt.elem.style.fontSize),a=this.baseParentPage.height-(this.offsets.t+this.baseWgt.height)-1,b=b+2,c=this.select.childNodes.length;this.baseParentPage.constructor==Ra&&(a-=this.baseParentPage.hdrHeight);
"empty"==this.select.firstChild.getAttribute("value")&&--c;c*=b;c>10*b&&(c=10*b);this.offsets.t+(this.baseWgt.height+c)>this.baseParentPage.height&&(a>2*b?(this.upDir=!1,c=a):(this.upDir=!0,c>this.offsets.t&&(c=0)));this.maxH=c};L.prototype.updateOffsets=function(){var b,a,c,e,h=this.baseParentWidget,d=this.baseWgt.left,g=this.baseWgt.top;b=a=c=e=0;isNaN(d)&&(d=0);isNaN(g)&&(g=0);h.constructor==Ia&&(isNaN(h.left)||(a=h.left),isNaN(h.top)||(e=h.top),h=h.parentWidget);for(;h!=I&&null!=h;){if("GroupWgt"==
h.getJMType()||"TableGroupWgt"==h.getJMType())isNaN(h.left)||(b+=h.left),isNaN(h.top)||(c+=h.top),"TableGroupWgt"==h.getJMType()&&h.hasHeader()&&!this.baseWgt.isInHeader&&(c+=h.getHeaderHeight()),h.hasScrollbar()&&(b-=h.getXScrollPosition(),this.baseWgt.isInHeader||(c-=h.getYScrollPosition()));h=h.parentWidget}this.baseParentWidget.constructor==Ia?(b=d+b+a,c=g+c+e):(b=d+b,c=g+c);this.offsets={l:b,t:c}};L.prototype.updateCustomSelectricSize=function(){this.sel.style.width=this.baseWgt.width+"px";this.sel.style.height=
this.baseWgt.height+"px"};L.prototype.updateCloneBounds=function(){this.updateCloneStyles();this.refresh()};L.prototype.update=function(b){this.lbl.textContent=null==this.select.options[b]?"":this.select.options[b].textContent};L.prototype.updateFont=function(b){this.sel.style.fontFamily=b};L.prototype.bindEvents=function(){var b=this;$(this.sel).bind("touchstart click",function(a){a.preventDefault();a.stopPropagation();b.cloneCombobox()})};L.prototype.refresh=function(){this.selectric&&this.selectric.refresh()};
L.prototype.unbindEvents=function(){$(this.sel).off()};L.prototype.showWrapper=function(){this.sel.style.display="block"};L.prototype.hideWrapper=function(){this.sel.style.display="none"};L.prototype.removeWrapper=function(){$(this.sel).remove()};L.prototype.detachClone=function(){this.clone&&$(this.clone).detach()};L.prototype.removeClone=function(){this.clone&&$(this.clone).remove()};L.prototype.removeObjects=function(){this.removeClone();this.removeWrapper();this.unbindEvents();this.selectric&&
this.selectric.destroy()};L.prototype.getOffsets=function(){return this.offsets};var Ic=function(){function b(a,c){this._scrollbar=window.Scrollbar.use(Ta);this._scrollbar=window.Scrollbar.init(a,c.lib);c.ext.disableX&&this.disableXScroll();c.ext.disableY&&this.disableYScroll();c.ext.bgColor&&this.setBgColor(c.ext.bgColor);c.ext.color&&this.setColor(c.ext.color)}b.prototype.addListener=function(a){this._callback=a;this._scrollbar.addListener(a)};b.prototype.removeListener=function(){this._scrollbar.removeListener(this._callback)};
b.prototype.enableXScroll=function(){this._scrollbar.containerEl.appendChild(this._scrollbar.track.xAxis.element);this._scrollbar.options.plugins.disableScroll.direction=null};b.prototype.enableYScroll=function(){this._scrollbar.containerEl.appendChild(this._scrollbar.track.yAxis.element);this._scrollbar.options.plugins.disableScroll.direction=null};b.prototype.disableXScroll=function(){this._scrollbar.track.xAxis.element.remove();this._scrollbar.options.plugins.disableScroll.direction="x"};b.prototype.disableYScroll=
function(){this._scrollbar.track.yAxis.element.remove();this._scrollbar.options.plugins.disableScroll.direction="y"};b.prototype.setPosition=function(a,c){this._scrollbar.setPosition(a,c)};b.prototype.setContentSize=function(a){this._scrollbar.setContentSize(a)};b.prototype.setBgColor=function(a){this._scrollbar.setXAxisColor(a);this._scrollbar.setYAxisColor(a)};b.prototype.setColor=function(a){this._scrollbar.setXThumbColor(a);this._scrollbar.setYThumbColor(a)};b.prototype.setSize=function(a){this._scrollbar.setXAxisSize(a);
this._scrollbar.setYAxisSize(a)};b.prototype.setAlwaysShowTracks=function(a){this._scrollbar.options.alwaysShowTracks=a};b.prototype.getContainerSize=function(){return this._scrollbar.getSize().container};b.prototype.getContentSize=function(){return this._scrollbar.getSize().content};b.prototype.getLimit=function(){return this._scrollbar.limit};b.prototype.scrollTo=function(a,c){this._scrollbar.scrollTo(a,c)};b.prototype.update=function(){this._scrollbar.update()};b.prototype.getOffset=function(){return this._scrollbar.offset};
b.prototype.getContentEl=function(){return this._scrollbar.contentEl};b.prototype.getContainerEl=function(){return this._scrollbar.containerEl};b.prototype.getScrollTop=function(){return this._scrollbar.scrollTop};b.prototype.getScrollLeft=function(){return this._scrollbar.scrollLeft};b.prototype.destroy=function(){this._scrollbar.destroy()};return b}(),T;(function(b){b[b.ALL=0]="ALL";b[b.TOP=1]="TOP";b[b.BOTTOM=2]="BOTTOM";b[b.LEFT=3]="LEFT";b[b.RIGHT=4]="RIGHT"})(T||(T={}));var Hd=function(){function b(){}
b.prototype.createTableRowElement=function(a,c){var e=document.createElement("div"),b=a.getGLColProps(),d=a.getGridColsNumber(),g=a.getGridSize(),g=c.getWidgetsInColsIdx(g),k=a.getRowProps(c.getType()).minHeight,f=0,m=0;e.classList.add("jm-gr-row");e.style.width="100%";e.style.height=k+"px";for(e.style.backgroundColor=c.getBgColor();f<d;){var k=g[f+1],r=a.getGridSize(),v=void 0!==k?k.getColSpan(r):1,r=void 0!==k?k.getGridPosition(r).cOcc:f+1,l=b[r-1+v].colPos-b[r-1].colPos,C=document.createElement("div");
C.classList.add("jm-gr-cell");C.dataset.colStart=String(r);C.dataset.colEnd=String(r+v-1);C.style.left=m+"px";C.style.width=l+"px";C.style.height="100%";k&&(C.style.backgroundColor=k.getLayout().lBgColor);e.appendChild(C);f+=k?v:1;m+=l}return e};b.prototype.applyRowElementStyles=function(a,c){var e=c.getGraphicGridRow(),b=c.getTStroke(),d=c.getBStroke(),g=c.getTStrokeColor(),k=c.getBStrokeColor(),f=a.currSelRow,m=c.getBgColor();c.getIndex()===f&&(m=c.getSelBgColor());e.style.backgroundColor="none"==
m?c.getBgColor():m;e.style.top=c.getGeometryTop()+"px";for(m=0;m<e.children.length;m++){var r=e.children[m],v=Number(r.dataset.colStart)-1,l=Number(r.dataset.colEnd)-1,v=a.getGLColProps()[v],l=a.getGLColProps()[l];r.style.borderTop=b+"px solid "+g;r.style.borderBottom=d+"px solid "+k;r.style.borderLeft=v.lStroke+"px solid "+v.lStkColor;r.style.borderRight=l.rStroke+"px solid "+l.rStkColor}-1!==f&&(c.getIndex()===f?this.changeStrokeColor(c,T.ALL,c.getSelStkColor()):c.getIndex()===f-1&&a.isGlobalStrokeCollaptionActive()?
this.changeStrokeColor(c,T.BOTTOM):c.getIndex()===f+1&&a.isGlobalStrokeCollaptionActive()&&this.changeStrokeColor(c,T.TOP))};b.prototype.applyExternalBorderStyles=function(a){var c=a.getGridProperties();a.setTableBorder(c.grGStkWidth+"px solid "+c.grGStkColor)};b.prototype.changeStrokeColor=function(a,c,e){for(var b=a.getGraphicGridRow(),d=0;d<b.children.length;d++){var g=b.children[d];switch(c){case T.ALL:case T.TOP:g.style.borderTopColor=null==e?a.getTStrokeColor():e;case T.ALL:case T.BOTTOM:g.style.borderBottomColor=
null==e?a.getBStrokeColor():e;case T.ALL:case T.LEFT:0==d&&(g.style.borderLeftColor=null==e?a.getLStrokeColor():e);case T.ALL:case T.RIGHT:d==b.children.length-1&&(g.style.borderRightColor=null==e?a.getRStrokeColor():e)}}};b.prototype.applySelectionColor=function(a,c,e){if(e){c.getGraphicGridRow().style.backgroundColor=e;for(var b=0;b<c.getGraphicGridRow().children.length;b++)c.getGraphicGridRow().children[b].style.backgroundColor=e}else for(c.getGraphicGridRow().style.backgroundColor="none"==c.getBgColor()?
"transparent":c.getBgColor(),b=0;b<c.getGraphicGridRow().children.length;b++){e=c.getGraphicGridRow().children[b];var d=c.getWidgetsInColsIdx(a.getGridSize())[Number(e.dataset.colStart)];e.style.backgroundColor=d&&d.getLayout().lBgColor?d.getLayout().lBgColor:"transparent"}};b.prototype.changeRowBackgroundColor=function(a){var c=a.getSelRowIndex(),e=a.getPrevSelRowIndex(),b=a.getRowAtIndex(e),d=a.getRowAtIndex(c),g=a.getRowAtIndex(c-1),k=a.getRowAtIndex(c+1),f=a.getRowAtIndex(e-1),m=a.getRowAtIndex(e+
1);c!=e&&(null!=d&&(this.applySelectionColor(a,d,d.getSelBgColor()),this.changeStrokeColor(d,T.ALL,d.getSelStkColor())),null!=b&&(this.applySelectionColor(a,b),this.changeStrokeColor(b,T.ALL),null!=d&&a.isGlobalStrokeCollaptionActive()&&(f&&f.getIndex()!=d.getIndex()&&this.changeStrokeColor(f,T.BOTTOM),m&&m.getIndex()!=d.getIndex()&&this.changeStrokeColor(m,T.TOP))),a.isGlobalStrokeCollaptionActive()&&(g&&this.changeStrokeColor(g,T.BOTTOM),k&&this.changeStrokeColor(k,T.TOP)))};return b}();f["export"]("DynamicTableGrid",
Hd);var bc=function(){function b(){this._row=0;this._rowWidgets=[];this._graphicGridRow=null;this._rStrokeWidth=this._lStrokeWidth=this._bStrokeHeight=this._tStrokeHeight=0;this._rStrokeColor=this._lStrokeColor=this._bStrokeColor=this._tStrokeColor="";this._rowType=-1;this._protoRStroke=this._protoLStroke=this._protoBStroke=this._protoTStroke=0;this._protoRStrokeColor=this._protoLStrokeColor=this._protoBStrokeColor=this._protoTStrokeColor="";this._rowGeometryHeight=this._height=this._rowGeometryTop=
this._top=0;this._selStkColor=this._selFgColor=this._selBgColor=this._bgColor="";this._fgSelectionRow=this._bgSelectionRow=null;this._dynamicLinks=[];this._dynamicXForms=[];this.isHeader=this.isGridInDOM=this.isWgtsInDOM=!1;this.isFree=!0}b.prototype.setIndex=function(a){this._row=a};b.prototype.setWidgets=function(a){this._rowWidgets=a};b.prototype.setType=function(a){this._rowType=a};b.prototype.setGraphicGridRow=function(a){this._graphicGridRow=a};b.prototype.setBgRowSelection=function(a){this._bgSelectionRow=
a};b.prototype.setFgRowSelection=function(a){this._fgSelectionRow=a};b.prototype.setTStroke=function(a){this._tStrokeHeight=a};b.prototype.setBStroke=function(a){this._bStrokeHeight=a};b.prototype.setLStroke=function(a){this._lStrokeWidth=a};b.prototype.setRStroke=function(a){this._rStrokeWidth=a};b.prototype.setTStrokeColor=function(a){this._tStrokeColor=a};b.prototype.setBStrokeColor=function(a){this._bStrokeColor=a};b.prototype.setLStrokeColor=function(a){this._lStrokeColor=a};b.prototype.setRStrokeColor=
function(a){this._rStrokeColor=a};b.prototype.setTop=function(a){this._top=a};b.prototype.setGeometryTop=function(a){this._rowGeometryTop=a};b.prototype.setHeight=function(a){this._height=a};b.prototype.setGeometryHeight=function(a){this._rowGeometryHeight=a};b.prototype.setAsHeader=function(a){this.isHeader=a};b.prototype.setDynamicLinks=function(a){this._dynamicLinks=a};b.prototype.setDynamicXForms=function(a){this._dynamicXForms=a};b.prototype.setBgColor=function(a,c){this._bgColor=c?c:a.getGridRowsProps()[this.getType()].bgColor};
b.prototype.setSelBgColor=function(a){this._selBgColor=a.getGridRowsProps()[this.getType()].selBgColor};b.prototype.setSelFgColor=function(a){this._selFgColor=a.getGridRowsProps()[this.getType()].selFgColor};b.prototype.setSelStrokeColor=function(a){this._selStkColor=a.getGridRowsProps()[this.getType()].selStkColor};b.prototype.setStrokes=function(a){var c=a.getGridRowsProps()[this.getType()],e=c.tStroke,c=c.bStroke,b=a.getGridColsProps(),d=a.getGridColsNumber();a=b[0].lStroke;b=b[d-1].rStroke;this._protoTStroke=
e;this._protoBStroke=c;this._protoLStroke=a;this._protoRStroke=b;this.setTStroke(e);this.setBStroke(c);this.setLStroke(a);this.setRStroke(b)};b.prototype.setStrokesColors=function(a){var c=a.getGridRowsProps()[this.getType()],e=c.tStkColor,c=c.bStkColor,b=a.getGridColsProps(),d=a.getGridColsNumber();a=b[0].lStkColor;b=b[d-1].rStkColor;this._protoTStrokeColor=e;this._protoBStrokeColor=c;this._protoLStrokeColor=a;this._protoRStrokeColor=b;this.setTStrokeColor(e);this.setBStrokeColor(c);this.setLStrokeColor(a);
this.setRStrokeColor(b)};b.prototype.getIndex=function(){return this._row};b.prototype.getWidgets=function(){return this._rowWidgets};b.prototype.getType=function(){return this._rowType};b.prototype.getGraphicGridRow=function(){return this._graphicGridRow};b.prototype.getBgSelectionRow=function(){return this._bgSelectionRow};b.prototype.getFgSelectionRow=function(){return this._fgSelectionRow};b.prototype.getTStroke=function(){return this._tStrokeHeight};b.prototype.getBStroke=function(){return this._bStrokeHeight};
b.prototype.getLStroke=function(){return this._lStrokeWidth};b.prototype.getRStroke=function(){return this._rStrokeWidth};b.prototype.getProtoTStroke=function(){return this._protoTStroke};b.prototype.getProtoBStroke=function(){return this._protoBStroke};b.prototype.getProtoLStroke=function(){return this._protoLStroke};b.prototype.getProtoRStroke=function(){return this._protoRStroke};b.prototype.getTStrokeColor=function(){return this._tStrokeColor};b.prototype.getBStrokeColor=function(){return this._bStrokeColor};
b.prototype.getLStrokeColor=function(){return this._lStrokeColor};b.prototype.getRStrokeColor=function(){return this._rStrokeColor};b.prototype.getProtoTStrokeColor=function(){return this._protoTStrokeColor};b.prototype.getProtoBStrokeColor=function(){return this._protoBStrokeColor};b.prototype.getProtoLStrokeColor=function(){return this._protoLStrokeColor};b.prototype.getProtoRStrokeColor=function(){return this._protoRStrokeColor};b.prototype.getTop=function(){return this._top};b.prototype.getGeometryTop=
function(){return this._rowGeometryTop};b.prototype.getHeight=function(){return this._height};b.prototype.getGeometryHeight=function(){return this._rowGeometryHeight};b.prototype.getSelBgColor=function(){return this._selBgColor};b.prototype.getSelFgColor=function(){return this._selFgColor};b.prototype.getSelStkColor=function(){return this._selStkColor};b.prototype.getBgColor=function(){return this._bgColor};b.prototype.getDynamicLinks=function(){return this._dynamicLinks};b.prototype.getDynamicXForms=
function(){return this._dynamicXForms};b.prototype.getWidgetsInColsIdx=function(a){for(var c={},e=0,b=this.getWidgets();e<b.length;e++){var d=b[e];c[d.getGridPosition(a).cOcc]=d}return c};b.prototype.pushDynamicLink=function(a){this._dynamicLinks.push(a)};b.prototype.pushDynamicXForms=function(a){this._dynamicXForms.push(a)};return b}(),Id=function(){function b(){this._rows=[];this._iteratorIndex=0}b.prototype.incrementIterator=function(){this._iteratorIndex+=1};b.prototype.resetIterator=function(){this._iteratorIndex=
0};b.prototype.getCurrentRow=function(){return this._rows[this._iteratorIndex]};b.prototype.getPreviousRow=function(){return this._rows[this._iteratorIndex-1]};b.prototype.getNextRow=function(){return this._rows[this._iteratorIndex+1]};b.prototype.getRows=function(){return this._rows};b.prototype.getRowsLen=function(){return this._rows.length};b.prototype.getIteratorIndex=function(){return this._iteratorIndex};b.prototype.appendRow=function(a){this._rows.push(a)};b.prototype.insertRow=function(a){this._rows.push(a);
this._iteratorIndex=this._rows.length-1};b.prototype.swapRow=function(a){this.spliceRow(this._iteratorIndex,0,a);this._rows.pop()};b.prototype.spliceRow=function(a,c,e){null==e?this._rows.splice(a,c):this._rows.splice(a,c,e)};return b}(),Q=new (function(){function b(){}b.prototype.getPropertyPathInfos=function(a,c){if(null!=a){var e=null,b=a.split("."),d=b[b.length-1];b.pop();b=b.join(".");""===b?e=c:"GroupWgt"==c.getJMType()&&(e="."==b[0]||"*"==b[0]?c.findWgt(c,b):c.findWgt(c,c.studioId+"."+b));
return{w:e,p:d}}return null};b.prototype.createDataLink=function(a,c,e,b,d,g,k){g.isTagString()?(a=f.createDataLink(c,null,{attr:d}),a.readFromString(g.getStringTagValue())):a=f.createDataLink(c,e,b);a.update();a.mount();a.dataSrc&&"TagMgrWgt"==a.dataSrc.getJMType()&&a.dataSrc.subscribeForTagsNotification([a.tag]);return a};b.prototype.generateDataLink=function(a,c,e,b,d){var g=null,k=null;b.isTagString()||(g=b.getSourceWgt(),k={rw:b.getMode(),attr:e,tag:b.getTagName(),srcType:f.activeProject.getSrcType(g),
dataSource:g.studioId,tagIndex:b.getTagIndex(),xforms:[],wT:"Project"==g.getWidgetType()?0:1});return this.createDataLink(a,c,g,k,e,b,d)};b.prototype.setWgtValue=function(a,c,e){a.setValue(c,e.getValue(),null,null)};b.prototype.getWgtValue=function(a,c){return a.getValue(c)};b.prototype.getWgtTextIds=function(a){return a.getCloneTextIds()};b.prototype.setWgtTextIds=function(a,c){a.setCloneTextIds(c)};b.prototype.updateWgtLanguage=function(a,c){a.updateLanguage(c)};b.prototype.clonePrototypes=function(a,
c,e){c.resetRowMaps();a.setOutOfViewPrototypes(c,e);a.setViewMap({});var b=e.endIndex;for(e=e.startIndex;e<b;e++){a.updateRowPrototypes(c,e);var d=a.getRowType(e+1),d=a.getRowPrototypesByRowType(d),g=d.getCurrentRow();if(g.isFree){var k=c.hasHeader()?e+2:e+1;a.setPreviousRow(k);a.setNextRow(k);a.addNewRow(c,g,e)}a.updateViewMap(g);e===a.getRowsNumber()-1&&(c.finishedCloning=!0);d.incrementIterator()}c.renderView();c.activateDelegates();c.invalidateMtxChain()};b.prototype.cloneWgt=function(a,c){return a.clone(c)};
b.prototype.destroyWgt=function(a){a.destroy()};b.prototype.getSourceWgt=function(a,c){return a.getProject().getWidget(c,!0)};b.prototype.getXFormById=function(a){return f.getFocusPage().getXForm(a)};b.prototype.registerXForm=function(a,c){a.pushDynamicXForms(c);if(c.dataLinks)for(var e in c.dataLinks)a.pushDynamicLink(c.dataLinks[e])};b.prototype.registerLink=function(a,c){a.pushDynamicLink(c);if(c.xforms)for(var e in c.xforms)this.registerXForm(a,c.xforms[e])};b.prototype.destroyDynamicData=function(a){for(var c=
a.getDynamicLinks(),e=a.getDynamicXForms(),b=f.getFocusPage(),d=[],g=0;g<c.length;g++){var k=c[g];k.dataSrc&&"TagMgrWgt"==k.dataSrc.getJMType()&&d.push(k.tag);k.unmount();b.unregisterLink(k)}for(c=0;c<e.length;c++)e[c].destroy();a.setDynamicLinks([]);a.setDynamicXForms([]);f.activeProject.getTagMgr().unsubscribeForTagsNotification(d)};b.prototype.hasPropInDatalinks=function(a,c){for(var e=0,b=["Text"];e<b.length;e++){var d=b[e];c["has"+d+"PropInDatalinks"]&&(c["has"+d+"PropInDatalinks"]=!1)}};b.prototype.changeMLTextIds=
function(a){a.changeMLTextIds()};b.prototype.getLiveTagsVariables=function(a){a=a.getDataLinks();for(var c in a){var e=a[c],b=e.dataSrc;if(null!==b&&"TableTrendSrcWgt"===b.getJMType())return b.getSubTrendMLVariables(e.tag)}return null};b.prototype.getCurrentLangId=function(){return f.activeProject.getWidget("_MultiLangMgr",!0).getCurrentLanguage()};b.prototype.getCurrentLangCode=function(){return f.activeProject.getWidget("_MultiLangMgr",!0).getCurrentLangCode()};b.prototype.hasListProperty=function(a){return"MsgTextWgt"===
a.getJMType()};return b}()),Jd=function(){function b(){this._rows=[]}b.prototype.setRowTop=function(a,c){a.top=c};b.prototype.setRowHeight=function(a,c){a.height=c};b.prototype.getRowTop=function(a){return this._rows[a]?this._rows[a].top:null};b.prototype.getRowHeight=function(a){return this._rows[a]?this._rows[a].height:null};b.prototype.getRows=function(){return this._rows};b.prototype.pushRow=function(a){this._rows.push(a)};b.prototype.clear=function(){this._rows=[]};return b}(),Kd=function(){function b(a,
c){this._isJSONObject=this._isTagString=!1;if(c instanceof Object){this._isTagString=c.v?!0:!1;this._isJSONObject=!0;switch(c._c){case "dl":this._type=0;break;case "f":this._type=1;break;case "ml":this._type=2}this._isTagString?this._stringTagValue=c.v:(this._mltext=c.mltext,this._tagName=c.a,this._tagIndex=c.i,this._mode=2!=c.m?0==c.m?"r":"w":"rw",this._sourceWgt=Q.getSourceWgt(a,c.s),this._xForm=c.xForm)}else this._value=c}b.prototype.isTagString=function(){return this._isTagString};b.prototype.isJSONObject=
function(){return this._isJSONObject};b.prototype.getTagName=function(){return this._tagName};b.prototype.getTagIndex=function(){return this._tagIndex};b.prototype.getMode=function(){return this._mode};b.prototype.getSourceWgt=function(){return this._sourceWgt};b.prototype.getStringTagValue=function(){return this._stringTagValue};b.prototype.getValue=function(){return this._value};b.prototype.getType=function(){return this._type};b.prototype.getMlText=function(){return this._mltext};b.prototype.getXForm=
function(){return this._xForm};return b}(),Rb;(function(b){b[b.DATALINK=0]="DATALINK";b[b.FILTER=1]="FILTER";b[b.MULTILANGUAGE=2]="MULTILANGUAGE"})(Rb||(Rb={}));var Ld=function(){function b(){this._model=[];this._tableHeaderHeight=0;this._rowPrototypes=[];this._m_rowPrototypes=[];this._viewMap={};this._header=null;this._texts={};this._endIndex=this._startIndex=this._totalHeight=0;this._nextRowInView=this._previousRowInView=null;this.freeRows=[];this._m_table=new Jd}b.prototype.setViewMap=function(a){this._viewMap=
a};b.prototype.getMinRowsIndex=function(){return 0};b.prototype.getMaxRowsIndex=function(){return this.hasHeader()?this._model.length-2:this._model.length-1};b.prototype.getStartIndex=function(){return this._startIndex};b.prototype.getEndIndex=function(){return this._endIndex};b.prototype.getTotalHeight=function(){return this._totalHeight};b.prototype.getViewMap=function(){return this._viewMap};b.prototype.getTableGeometryMap=function(){return this._m_table};b.prototype.getRowIndexByRowYPosition=
function(a){return this.lowerBound({type:null,top:a,height:0})-1};b.prototype.getRowPrototypesByRowType=function(a){return this._m_rowPrototypes[a]};b.prototype.getText=function(a,c){if(this.hasDataSourceML(a,c))return this._texts[a.wgtId][c][Q.getCurrentLangId()]};b.prototype.getRowAtIndex=function(a){var c=this.getViewMap();return null!=c[a]?c[a]:null};b.prototype.getRowsNumber=function(){return this._m_table.getRows().length};b.prototype.getHeader=function(){return this._header};b.prototype.getHeaderHeight=
function(){return this._tableHeaderHeight};b.prototype.setNewHeader=function(a){this._model[1]=a;this._header=null};b.prototype.hasHeader=function(){return null==this._model[1]?!1:this._model[1]._h};b.prototype.getRowType=function(a){this.hasHeader()&&(a+=1);if(null==this._model[a])throw b.ERROR_MSGS.MODEL_ROW_IDX_ERROR;if(null==this._model[a]._t)throw b.ERROR_MSGS.MODEL_ROW_KEY_ERROR;return this._model[a]._t};b.prototype.getRowValue=function(a){this.hasHeader()&&(a+=1);if(null==this._model[a])throw b.ERROR_MSGS.MODEL_ROW_IDX_ERROR;
if(null==this._model[a]._v)throw b.ERROR_MSGS.MODEL_ROW_KEY_ERROR;return this._model[a]._v};b.prototype.getRowBgColor=function(a){this.hasHeader()&&(a+=1);if(null==this._model[a])throw b.ERROR_MSGS.MODEL_ROW_IDX_ERROR;return this._model[a]._bg};b.prototype.getRowPropsHeader=function(){if(null==this._model[0])throw b.ERROR_MSGS.MODEL_ROW_IDX_ERROR;if(null==this._model[0]._h)throw b.ERROR_MSGS.MODEL_ROW_KEY_ERROR;return this._model[0]._h};b.prototype.getHeaderRowType=function(){return this._model[1]._t};
b.prototype.getHeaderRowValue=function(){return this._model[1]._v};b.prototype.getHeaderRowBgColor=function(){return this._model[1]._bg};b.prototype.getDynamicGridRow=function(a,c){return a.getDynamicGrid().createTableRowElement(a,c)};b.prototype.initNewPrototypes=function(a){var c=a.getGridRowsNumber();this._m_rowPrototypes=[];this._rowPrototypes=[];for(var e=0;e<c;e++){var b=new bc,d=new Id,g=a.getWidgetsOfRow(e+1);this._m_rowPrototypes[e]=d;b.isFree=!0;b.setIndex(-1);b.setWidgets(g);b.setType(e);
b.setStrokes(a);b.setStrokesColors(a);b.setBgColor(a);b.setSelBgColor(a);b.setSelFgColor(a);b.setSelStrokeColor(a);b.setGraphicGridRow(this.getDynamicGridRow(a,b));g=this.cloneRow(a,b,0);d.appendRow(g);this._rowPrototypes.push(b)}};b.prototype.getRowPrototypesHeights=function(a){a=a.getGridRowsProps();var c=[],e;for(e in a)c.push(a[e].minHeight);return c};b.prototype.getRowPrototypeHeight=function(a,c){return this.getRowPrototypesHeights(a)[c]};b.prototype.defineNewGeometry=function(a){a.getGLColProps();
a.getGridColsNumber();var c=0,e=this.getRowPrototypesHeights(a);this._model=a.getProxyModel();this._totalHeight=0;this._m_table.clear();var b=this._model.slice();this.hasHeader()&&(this._tableHeaderHeight=e[this.getHeaderRowType()],b.splice(1,1));for(var d=0,b=b.length;d<b-1;d++){var g=this.getRowType(d+1),g={type:g,top:c,height:e[g]};this._m_table.pushRow(g);c+=this.hasHeader()?g.height:g.height+this._tableHeaderHeight;this._totalHeight+=g.height}a.setScrollContentSize(null,this._totalHeight)};b.prototype.setLastRowStrokesProperties=
function(a,c){var e=a.getGlobalStrokeWidth(),b=a.getGlobalStrokeColor(),d=a.isGlobalStrokeModeFixed(),g=c.getProtoBStroke(),d=d?g:Math.max(g,e)/2,k=c.getProtoBStrokeColor();c.setBStroke(Math.floor(d));e>=g?c.setBStrokeColor(b):c.setBStrokeColor(k)};b.prototype.setFirstRowStrokesProperties=function(a,c){var e=a.getGlobalStrokeWidth(),b=a.getGlobalStrokeColor(),d=a.isGlobalStrokeModeFixed(),g=c.getProtoTStroke(),d=d?g:Math.max(g,e)/2,k=c.getProtoTStrokeColor();c.setTStroke(Math.ceil(d));e>=g?c.setTStrokeColor(b):
c.setTStrokeColor(k)};b.prototype.setInTheMiddleRowStrokesProperties=function(a,c,e,b){var d=c.getProtoTStroke(),g=c.getProtoBStroke(),k=!1,f=!1;if(null!=e){var m=e.getProtoBStroke(),r=e.getBStroke(),v=Math.max(d,m)/2;r!=v&&(e.setBStroke(Math.floor(v)),k||(k=!0));d!=v&&c.setTStroke(Math.ceil(v));r=c.getProtoTStrokeColor();v=e.getProtoBStrokeColor();m>d?(c.setTStrokeColor(v),e.setBStrokeColor(v)):(e.setBStrokeColor(r),c.setTStrokeColor(r),k||(k=!0))}null!=b&&(d=b.getProtoTStroke(),m=b.getTStroke(),
r=Math.max(g,d)/2,m!=r&&(b.setTStroke(Math.ceil(r)),f||(f=!0)),g!=r&&c.setBStroke(Math.floor(r)),m=c.getProtoBStrokeColor(),r=b.getProtoTStrokeColor(),d>g?(c.setBStrokeColor(r),b.setTStrokeColor(r)):(b.setTStrokeColor(m),c.setBStrokeColor(m),f||(f=!0)));k&&a.addTableRow(e);f&&a.addTableRow(b)};b.prototype.setRowStrokesProperties=function(a,c,e,b){var d=this._m_table.getRows().length-1,g=c.getIndex();0==g&&this.setFirstRowStrokesProperties(a,c);g==d&&this.setLastRowStrokesProperties(a,c);this.setInTheMiddleRowStrokesProperties(a,
c,e,b)};b.prototype.rectifyRowBounds=function(a,c){var e=c.isHeader?null:this._previousRowInView,b=c.isHeader?null:this._nextRowInView;a.isGlobalStrokeCollaptionActive()&&this.setRowStrokesProperties(a,c,e,b)};b.prototype.setRowBgColor=function(a,c,e){(e?this.getHeaderRowBgColor():this.getRowBgColor(c.getIndex()+1))?e?c.setBgColor(a,this.getHeaderRowBgColor()):c.setBgColor(a,this.getRowBgColor(c.getIndex()+1)):c.setBgColor(a,c.getBgColor())};b.prototype.lowerBound=function(a){for(var c=this._m_table.getRows(),
e=0;e<c.length&&!(c[e].top>a.top);e++);return e};b.prototype.getMinMaxIndex=function(a,c){for(var e=this.lowerBound({type:null,top:a,height:0}),b=e,d=this._m_table.getRows();b<d.length&&this._m_table.getRowTop(b)<c;b++);e=Math.max(e-1,0);return{startIndex:e,endIndex:b}};b.prototype.getComputedIndexes=function(a,c){var e=a.getPrecachedPages(),b=Q.getWgtValue(a,"height"),d=a.getGlobalStrokeWidth(),e=.5*e*b;return this.getMinMaxIndex(c-d-e,c+(b-this._tableHeaderHeight)+e+d)};b.prototype.setOutOfViewPrototypes=
function(a,c){for(var e=c.startIndex,b=c.endIndex,d=0;d<this._m_rowPrototypes.length;d++){for(var g=this._m_rowPrototypes[d],k=g.getRows(),f=0;f<g.getRowsLen();){var m=k[f],r=m.getIndex();if(m.isFree)break;if(r<e)m.isFree=!0,m.setIndex(-1),this.removeRowWgtsTextIds(m),g.appendRow(m),g.spliceRow(f,1),a.removeTableRow(m);else{if(r>=b){for(;f<g.getRowsLen();f++)m=k[f],m.isFree=!0,m.setIndex(-1),this.removeRowWgtsTextIds(m),a.removeTableRow(m);break}f++}}g.resetIterator()}a.deactivateDelegates()};b.prototype.cloneHeaderRow=
function(a,c){var e=new bc,b=c.getWidgets(),d=[],g;for(g in b){var k=b[g],f={ext:"cl_header",tableGroupWgt:a,isInHeader:!0};Object.assign(f,Q.getLiveTagsVariables(k),{liveTags:!0});d.push(Q.cloneWgt(k,f))}e.setAsHeader(!0);e.setType(c.getType());e.setStrokes(a);e.setStrokesColors(a);e.setBgColor(a);e.setSelBgColor(a);e.setSelFgColor(a);e.setSelStrokeColor(a);e.setWidgets(d);e.setGraphicGridRow(this.getDynamicGridRow(a,c));return e};b.prototype.cloneRow=function(a,c,e){var b=new bc,d=c.getWidgets(),
g=[],k;for(k in d){var f=d[k],m=f.getLayout().cOcc;g.push(Q.cloneWgt(f,{ext:"cl"+e+""+m,tableGroupWgt:a,isInHeader:!1}))}b.setAsHeader(!1);b.setType(c.getType());b.setStrokes(a);b.setStrokesColors(a);b.setBgColor(a);b.setSelBgColor(a);b.setSelFgColor(a);b.setSelStrokeColor(a);b.setWidgets(g);b.setGraphicGridRow(this.getDynamicGridRow(a,c));return b};b.prototype.removeRowWgtsTextIds=function(a){a=a.getWidgets();for(var c in a){var e=a[c];void 0!==this._texts[e.wgtId]&&delete this._texts[e.wgtId]}};
b.prototype.escapeString=function(a){return a.replace(/(\\\[)/g,"\\\\[").replace(/(\\\])/g,"\\\\]")};b.prototype.hasDataSourceML=function(a,c){return this._texts[a.wgtId]?this._texts[a.wgtId]&&this._texts[a.wgtId][c]:!1};b.prototype.addMLText=function(a,c,e){var b=Q.getWgtTextIds(c),d=Q.getSourceWgt(a,"_MultiLangMgr");Q.hasPropInDatalinks(a,c);if(0!==b.length){a={};var g=0,k;for(k in e){var f=[e[k]];Q.hasListProperty(c)&&(f=f[0].split(","));a[d.getLangIdFromLangCode(k)]=f;f.length>g&&(g=f.length)}null==
this._texts[c.wgtId]&&(this._texts[c.wgtId]={});for(e=0;e<g;e++){d={};for(k in a)d[k]=null==a[k][e]?"":this.escapeString(a[k][e]);if(null==b[e]){var f=b[e-1].split("-")[0],m=Number(b[e-1].split("-")[1]);b[e]=String(f+(m+1))}this._texts[c.wgtId][b[e]]=d}for(k=e+1;k<b.length;k++)b.splice(k,1);Q.setWgtTextIds(c,b)}};b.prototype.getHeaderRowProps=function(a,c){return this.getRowPropsHeader()[a][c]};b.prototype.getLastPropIndex=function(a,c){if(0==c)return 0;for(var e=this.getRowPropsHeader()[a],b=0,d=
0;d<c;d++)for(var g=0;g<e[d].length;g++)b++;return b++};b.prototype.activateWidget=function(a,c,e,b){a.getGridSize();var d=e.getIndex(),g=e.isHeader?this.getHeaderRowType():this.getRowType(d+1),d=e.isHeader?this.getHeaderRowValue():this.getRowValue(d+1),k=this.getHeaderRowProps(g,b);b=this.getLastPropIndex(g,b);for(g=0;g<k.length;g++){var f=k[g],m=new Kd(a,d[b+g]);if(null!=m){var r=Q.getPropertyPathInfos(f,c),f=r.w,r=r.p;if(m.isJSONObject())switch(m.getType()){case Rb.DATALINK:m=Q.generateDataLink(a,
f,r,m,e);Q.registerLink(e,m);break;case Rb.MULTILANGUAGE:this.addMLText(a,f,m.getMlText()),Q.updateWgtLanguage(f,!0)}else Q.setWgtValue(f,r,m)}}};b.prototype.activateRowWidgets=function(a,c){for(var e=c.getWidgets(),b=0;b<e.length;b++){var d=e[b];d&&this.activateWidget(a,d,c,b)}};b.prototype.activateRow=function(a,c,e){c.isFree=!1;c.setIndex(e);Q.destroyDynamicData(c);this.activateRowWidgets(a,c)};b.prototype.installTableHeader=function(a){if(this.hasHeader()&&null==this._header){var c=this.cloneHeaderRow(a,
this._rowPrototypes[this._model[1]._t]);c.isFree=!1;c.setIndex(null);this.activateRowWidgets(a,c);this.rectifyRowBounds(a,c);this.setRowBgColor(a,c,!0);this._header=c;a.addTableHeaderRow(c)}};b.prototype.updateRowPrototypes=function(a,c){var e=this.getRowType(c+1),b=this.getRowPrototypesByRowType(e),d=b.getRowsLen(),e=this._rowPrototypes[e],g=b.getIteratorIndex();if(g===b.getRowsLen())b.insertRow(this.cloneRow(a,e,d));else{var k=b.getCurrentRow();k.isFree||k.getIndex()===c||(k=b.getRows()[d-1],k.isFree?
b.swapRow(k):b.spliceRow(g,0,this.cloneRow(a,e,d)))}};b.prototype.setPreviousRow=function(a){if((a=this._model[a-1])&&void 0!==a._t&&(a=this.getRowPrototypesByRowType(a._t).getPreviousRow(),void 0!==a&&-1!==a.getIndex())){this._previousRowInView=a;return}this._previousRowInView=null};b.prototype.setNextRow=function(a){if((a=this._model[a+1])&&void 0!==a._t&&(a=this.getRowPrototypesByRowType(a._t).getNextRow(),void 0!==a&&-1!==a.getIndex())){this._nextRowInView=a;return}this._nextRowInView=null};b.prototype.addNewRow=
function(a,c,e){this.activateRow(a,c,e);a.addTableRow(c);this.rectifyRowBounds(a,c);this.setRowBgColor(a,c,!1)};b.prototype.updateViewMap=function(a){this._viewMap[a.getIndex()]=a};b.prototype.hasValidStartIndex=function(a){return a<this.getMinRowsIndex()||a>this.getMaxRowsIndex()?!1:!0};b.prototype.hasValidEndIndex=function(a){return a<this.getMinRowsIndex()||a>this.getMaxRowsIndex()?!1:!0};b.prototype.hasNewIndexes=function(a){return a.startIndex!==this._startIndex||a.endIndex!==this._endIndex};
b.prototype.enableCloning=function(a,c){return(this.hasNewIndexes(a)||c)&&this.hasValidStartIndex(a.startIndex)&&this.hasValidEndIndex(a.endIndex)};b.prototype.startCloning=function(a,c,e){this.enableCloning(c,e)&&(this._startIndex=c.startIndex,this._endIndex=c.endIndex,Q.clonePrototypes(this,a,c))};b.prototype.scrollTo=function(a,c,e){this.startCloning(a,this.getComputedIndexes(a,c),e)};b.prototype.destroyBodyDelegates=function(){for(var a=0;a<this._m_rowPrototypes.length;a++)for(var c=this._m_rowPrototypes[a],
e=c.getRows(),b=0;b<c.getRowsLen();b++){var d=e[b],g=d.getWidgets();Q.destroyDynamicData(d);for(var k in g)d=g[k],d.isClone&&Q.destroyWgt(d)}};b.prototype.destroyHeaderDelegates=function(){if(this._header){var a=this._header.getWidgets();Q.destroyDynamicData(this._header);for(var c in a){var e=a[c];e.isClone&&Q.destroyWgt(e)}}};b.prototype.update=function(a){this.destroyHeaderDelegates();this.destroyBodyDelegates();this._texts={};this._header=null;this.defineNewGeometry(a);this.initNewPrototypes(a);
this.installTableHeader(a)};b.ERROR_MSGS={MODEL_NOT_FOUND:"Table widget: js model not found !",MODEL_ROW_IDX_ERROR:"Table widget: row does not exist at specified index !",MODEL_ROW_KEY_ERROR:"Table widget: row property not found !"};return b}();f["export"]("TableGroupController",Ld);var cc=function(){function b(a,c,e,b){this._data=c;this._code=a||"";this._name=e||"";this._format=b||"";this.parseNumberFormat()}b.prototype.getStatusCode=function(){return this._code};b.prototype.getData=function(){return this._data};
b.prototype.getName=function(){return this._name};b.prototype.getDataLength=function(){return this._data.length};b.prototype.getSecondsOfSample=function(a){return a.rts};b.prototype.getMillisecondsOfSample=function(a){return a.ms};b.prototype.getDataQuality=function(a){return new (u.getModule("Quality"))(a.q)};b.prototype.formatText=function(a){return f["import"]("TextFormatUtil").formatText(this._options,a,null,!1)};b.prototype.getFormattedDataValue=function(a){return this.getDataQuality(a).isQualityBad()?
b.DATA_MSG.NO_DATA:this.formatText(a.v)};b.prototype.getLastSampleTS=function(){return this._data[this._data.length-1].ms};b.prototype.setData=function(a){this._data=a};b.prototype.pushData=function(a){this._data=this._data.concat(a)};b.prototype.addDecimalDigitsToFormat=function(a,c){a+=".";for(var e=0;e<c;e++)a+="#";return a};b.prototype.addLeadingDigitsToFormat=function(a,c){for(var e=1;e<c;e++)a="0"+a;return a};b.prototype.getDynamicFormat=function(){var a=this._format,a=0<=a.indexOf("h")?"#h":
0<=a.indexOf("H")?"#H":"#";void 0!==this._decimalDigits&&"#"===a&&0<this._decimalDigits&&(a=this.addDecimalDigitsToFormat(a,this._decimalDigits));void 0!==this._leadingDigits&&0<this._leadingDigits&&(a=this.addLeadingDigitsToFormat(a,this._leadingDigits));return a};b.prototype.parseNumberFormat=function(){this._options=f["import"]("TextFormatUtil").parseFormat(this._format)};b.prototype.setUsingFormat=function(a){this._format=a;this.parseNumberFormat()};b.prototype.setDecimalDigits=function(a){this._decimalDigits=
a;this._format=this.getDynamicFormat();this.parseNumberFormat()};b.prototype.setLeadingDigits=function(a){this._leadingDigits=a;this._format=this.getDynamicFormat();this.parseNumberFormat()};b.DATA_MSG={NO_DATA:"No data"};return b}(),Jc=function(){function b(){this.style=document.getElementById("jm-dyn-style");null===this.style&&(this.style=document.createElement("style"),this.style.setAttribute("id","jm-dyn-style"),document.head.appendChild(this.style));this.sheet=this.style.sheet}b.prototype.selector=
function(a,c){this.sheet.insertRule(a+" { "+c+" }",this.sheet.cssRules.length);return a};b.prototype.removeStyleRule=function(a){for(var c=this.sheet.cssRules,e=0,b=c.length;e<b;e++){var d=c[e];if(1==d.type&&d.selectorText==a)return this.sheet.deleteRule(e),!0}return!1};b.prototype.removeKeyframesRule=function(a){for(var c=this.sheet.cssRules,e=0,b=c.length;e<b;e++){var d=c[e];if(7==d.type&&d.name==a)return this.sheet.deleteRule(e),!0}return!1};return b}(),ra;(function(b){b[b.OPERATOR=0]="OPERATOR";
b[b.LBRACKET=1]="LBRACKET";b[b.RBRACKET=2]="RBRACKET";b[b.GROUP_NAME=3]="GROUP_NAME"})(ra||(ra={}));var Md=function(){function b(){this.buffer=null}b.prototype.tokenize=function(a){this.buffer=a;for(var c=[],e=null,b=a.length,d=0;d<b;d++){var g=a.charAt(d);if(this.isOperator(g)||this.isBracket(g)){null!==e&&(c.push({type:ra.GROUP_NAME,pos:{start:e,end:d-1}}),e=null);var k=void 0,k=this.isOperator(g)?ra.OPERATOR:"("==g?ra.LBRACKET:ra.RBRACKET;c.push({type:k,pos:{start:d,end:d}})}else null==e&&(e=d)}null!==
e&&c.push({type:ra.GROUP_NAME,pos:{start:e,end:b-1}});return c};b.prototype.isOperator=function(a){return"|"==a||"&"==a};b.prototype.isBracket=function(a){return"("==a||")"==a};return b}();f.addJSModule("GroupExpressionLexer",Md);var Nd=f.getJSModule("GroupExpressionLexer"),z;(function(b){b[b.EXPRESSION=0]="EXPRESSION";b[b.OPERATOR=1]="OPERATOR";b[b.LBRACKET=2]="LBRACKET";b[b.RBRACKET=3]="RBRACKET";b[b.ELEMENT=4]="ELEMENT";b[b.GROUPNAME=5]="GROUPNAME";b[b.END=6]="END";b[b.ACCEPT=7]="ACCEPT"})(z||
(z={}));var G;(function(b){b[b.SHIFT=0]="SHIFT";b[b.REDUCE=1]="REDUCE";b[b.GOTO=2]="GOTO";b[b.ACCEPT=3]="ACCEPT"})(G||(G={}));var Od=function(){function b(){this.actions={};this.goto={};this.actions[0]={};this.actions[0][z.LBRACKET]=[G.SHIFT,4];this.actions[0][z.GROUPNAME]=[G.SHIFT,3];this.actions[1]={};this.actions[1][z.END]=[G.ACCEPT,0];this.actions[1][z.OPERATOR]=[G.SHIFT,5];this.actions[2]={};this.actions[2][z.END]=[G.REDUCE,2];this.actions[2][z.LBRACKET]=[G.REDUCE,2];this.actions[2][z.RBRACKET]=
[G.REDUCE,2];this.actions[2][z.GROUPNAME]=[G.REDUCE,2];this.actions[2][z.OPERATOR]=[G.REDUCE,2];this.actions[3]={};this.actions[3][z.END]=[G.REDUCE,3];this.actions[3][z.LBRACKET]=[G.REDUCE,3];this.actions[3][z.RBRACKET]=[G.REDUCE,3];this.actions[3][z.GROUPNAME]=[G.REDUCE,3];this.actions[3][z.OPERATOR]=[G.REDUCE,3];this.actions[4]={};this.actions[4][z.LBRACKET]=[G.SHIFT,4];this.actions[4][z.GROUPNAME]=[G.SHIFT,3];this.actions[5]={};this.actions[5][z.LBRACKET]=[G.SHIFT,4];this.actions[5][z.GROUPNAME]=
[G.SHIFT,3];this.actions[6]={};this.actions[6][z.RBRACKET]=[G.SHIFT,8];this.actions[6][z.OPERATOR]=[G.SHIFT,5];this.actions[7]={};this.actions[7][z.END]=[G.REDUCE,1];this.actions[7][z.LBRACKET]=[G.REDUCE,1];this.actions[7][z.RBRACKET]=[G.REDUCE,1];this.actions[7][z.GROUPNAME]=[G.REDUCE,1];this.actions[7][z.OPERATOR]=[G.REDUCE,1];this.actions[8]={};this.actions[8][z.END]=[G.REDUCE,4];this.actions[8][z.LBRACKET]=[G.REDUCE,4];this.actions[8][z.RBRACKET]=[G.REDUCE,4];this.actions[8][z.GROUPNAME]=[G.REDUCE,
4];this.actions[8][z.OPERATOR]=[G.REDUCE,4];this.goto[0]={};this.goto[0][z.ELEMENT]=[G.GOTO,2];this.goto[0][z.EXPRESSION]=[G.GOTO,1];this.goto[4]={};this.goto[4][z.ELEMENT]=[G.GOTO,2];this.goto[4][z.EXPRESSION]=[G.GOTO,6];this.goto[5]={};this.goto[5][z.ELEMENT]=[G.GOTO,7]}b.prototype.parse=function(a){this.buffer=a;this.pos=0;this.parsedElements=[];this.groups=[];this.tokens=(new Nd).tokenize(a);a=[0];for(var c=this.consumeToken();;){var e=a[a.length-1],e=this.actions[e][c.type],b=e[0],e=e[1];if(b==
G.SHIFT)this.parsedElements.push(c),a.push(e),c=this.consumeToken();else if(b==G.REDUCE){for(var e=this.resoveRule(e),b=e[0],e=e[1],d=0;d<e;d++)a.pop();e=a[a.length-1];a.push(this.goto[e][b][1])}else{if(b==G.ACCEPT)return this.parsedElements[0].value;this.throwSyntaxError();return null}}};b.prototype.resoveRule=function(a){var c;switch(a){case 0:return[z.ACCEPT,1];case 1:a=this.parsedElements.pop().value;c=this.parsedElements.pop().value;var e=this.parsedElements.pop().value;c=this.buffer.substring(c.pos.start,
c.pos.end+1);c={type:z.OPERATOR,value:c,parent:null,children:[e,a]};e.parent=c;a.parent=c;this.parsedElements.push({type:z.EXPRESSION,value:c});return[z.EXPRESSION,3];case 2:return c=this.parsedElements.pop().value,this.parsedElements.push({type:z.EXPRESSION,value:c}),[z.EXPRESSION,1];case 3:return a=this.parsedElements.pop().value,a=this.buffer.substring(a.pos.start,a.pos.end+1),this.groups.push(a),this.parsedElements.push({type:z.ELEMENT,value:{type:z.GROUPNAME,value:a,parent:null,children:null}}),
[z.ELEMENT,1];case 4:return this.parsedElements.pop(),a=this.parsedElements.pop().value,this.parsedElements.pop(),this.parsedElements.push({type:z.ELEMENT,value:a}),[z.ELEMENT,3]}return null};b.prototype.mapToGPARSER_SYMBOLType=function(a){switch(a){case ra.GROUP_NAME:return z.GROUPNAME;case ra.OPERATOR:return z.OPERATOR;case ra.LBRACKET:return z.LBRACKET;case ra.RBRACKET:return z.RBRACKET}};b.prototype.getGoupsList=function(){return this.groups};b.prototype.consumeToken=function(){if(this.pos>=this.tokens.length)return{type:z.END,
value:null};var a=this.tokens[this.pos++];return{type:this.mapToGPARSER_SYMBOLType(a.type),value:a}};b.prototype.throwSyntaxError=function(){throw"Syntax Error: group expression is not well formed";};return b}();f.addJSModule("GroupExpressionParser",Od);var Pd=f.getJSModule("GroupExpressionParser"),Bb=f.getJSModule("Group"),Qd=function(){function b(a){this.parser=new Pd;this.srv=a}b.prototype.run=function(a,c,e){var b=this;this.input=a;this.groups=new Map;this.ast=this.parser.parse(a);a=this.parser.getGoupsList();
if(e)return this.requestGroupsInformationAsync(a).then(function(a){a=b.resolveGroupExpression(a);c.setState(a.info.name,a.info.code,a.getTagArray());e(c.info.name,c)}),null;a=this.resolveGroupExpression(this.requestGroupsInformation(a));return c.setState(a.info.name,a.info.code,a.getTagArray())};b.prototype.resolveGroupExpression=function(a){if(1==a.length)return a[0];for(var c=0;c<a.length;c++){var e=a[c];this.groups.set(e.info.name,e.getTagsMap())}a=this.excuteOperation(this.ast);return(new Bb).setState(this.input,
"S_OK",a)};b.prototype.requestGroupsInformationAsync=function(a){for(var c=this,e=Array(a.length),b=0,d=a.length;b<d;b++)e[b]=new Bb;return this.srv.activateGroups(a,e,!1).then(function(){return c.srv.readGroups(a,e,!1)})};b.prototype.requestGroupsInformation=function(a){for(var c=this,e=Array(a.length),b=0,d=a.length;b<d;b++)e[b]=new Bb;this.srv.activateGroups(a,e,!0).then(function(){return c.srv.readGroups(a,e,!0)});return e};b.prototype.excuteOperation=function(a){var c=a.children[0],e=a.children[1],
c=c.type===z.GROUPNAME?this.getTags(c.value):this.excuteOperation(c),e=e.type===z.GROUPNAME?this.getTags(e.value):this.excuteOperation(e);switch(a.value){case "&":return this.and(c,e);case "|":return this.or(c,e)}return{}};b.prototype.getTags=function(a){return this.groups.get(a)};b.prototype.and=function(a,c){var e={},b;for(b in a)c[b]&&(e[b]=a[b]);return e};b.prototype.or=function(a,c){var e={},b;for(b in a)e[b]=a[b];for(var d in c)e[d]=c[d];return e};return b}();f.addJSModule("GroupExpressionRunner",
Qd);var Rd=function(){function b(){this.mapVarInText=this.mapVarToDataLink=this.mapDatalinkToVar=null;this.variableIndex=0}b.prototype.setMap=function(a){this.mapVarInText=a};b.prototype.canBePresentLiveTags=function(a){return-1!=a.indexOf("[")&&-1!=a.indexOf("]")};b.prototype.getVariablesMap=function(){return this.mapVarInText};b.prototype.getVariables=function(){return this.mapVarToDataLink};b.prototype.parseTextVariables=function(a,c){if(-1==a.indexOf("["))return[a];this.mapVarInText={};for(var e=
"",b="",d=!1,g=!1,k=0,f=[],m=0,r=a.length;m<r;m++){var v=a.charAt(m);switch(v){case "[":g?(d?b+="\\"+v:e+=v,g=!1):(d?b+=v:(d=!0,f.push(e),e=""),k++);break;case "]":g?(d?b+="\\"+v:e+=v,g=!1):(k--,d&&0===k?(b=this.addVariables(this.convertArrayDotNotationToBrackets(b)),f.push(b),this.addToMap(b,c),b="",d=!1):b+=v);break;case "\\":g?(d?b+=v:e+=v,g=!1):g=!0;break;default:g&&(d?b+="\\":e+="\\"+v,g=!1),d?b+=v:e+=v}}""!==e&&f.push(e);return f};b.prototype.addVariables=function(a){this.mapDatalinkToVar||
(this.mapDatalinkToVar={},this.mapVarToDataLink={});var c=this.mapDatalinkToVar[a];c||(c="${"+this.variableIndex+"}",this.mapDatalinkToVar[a]=c,this.mapVarToDataLink[c]=a,this.variableIndex++);return c};b.prototype.addToMap=function(a,c){null===c&&(c="NL");var e=this.mapVarInText[c];e||(e=[],this.mapVarInText[c]=e);e.push(a)};b.prototype.convertArrayDotNotationToBrackets=function(a){var c=a.indexOf(":");if(-1!=c)return a;var e=a.indexOf(".");if(-1==e)return a;var b=a.indexOf("|"),c=c>b?c:b;return 0<=
c&&e>c?a:0<e?(c=-1==c?a.length-1:c,b=a.substring(0,e),e=a.substring(e+1,c+1),c<a.length-1?b+"["+e+"]"+a.substring(c,a.length):b+"["+e+"]"):a};return b}();f["export"]("TextLiveTagParser.ts",Rd);var Sd=function(){function b(a){this._value=a}b.of=function(a){return new b(a)};b.prototype.map=function(a){return dc.of(a(this._value))};b.prototype.value=function(){return this._value};b.prototype.chain=function(a){return this.map(a).value()};b.prototype.isNone=function(){return!1};return b}(),Td=function(){function b(a){}
b.of=function(a){return new b};b.prototype.map=function(a){return this};b.prototype.value=function(){return null};b.prototype.chain=function(a){return null};b.prototype.isNone=function(){return!0};return b}(),dc={of:function(b){return null===b||void 0===b?Td.of(null):Sd.of(b)}},Ud=dc;f["export"]("/DesignPatterns/Maybe.ts",dc);(function(b){var a=b["import"]("/DesignPatterns/Maybe.ts"),c=function(){function c(a){this.tags={};this.server=a?a:null;this.nSubscription=this.size=0}c.prototype.setServerInterface=
function(c){this.server=c};c.prototype.addTag=function(c){a.of(this.tags[c]).isNone()?(this.tags[c]={counter:1,subscribed:!1},this.size++):this.tags[c].counter++};c.prototype.removeTag=function(c){var b=a.of(this.server);if(!b.isNone()){var e=a.of(this.tags[c]);if(e.isNone())return!1;e=e.value();0==--e.counter&&(e.subscribed&&(b.value().unsubscribeTags([c]),this.nSubscription--),delete this.tags[c],this.size--);return!0}return!1};c.prototype.subscribeTags=function(){if(this.server&&0<this.size&&this.nSubscription<
this.size){var c=[],a;for(a in this.tags){var b=this.tags[a];b.subscribed||(c.push(a),b.subscribed=!0,this.nSubscription++)}this.server.subscribeTags(c)}};c.prototype.unsubscribeTags=function(c){if(this.server&&0<this.size){var a=[],b;for(b in this.tags){var e=this.tags[b];e.subscribed&&(a.push(b),e.subscribed=!1,this.nSubscription--)}c&&(a=a.filter(c));0<a.length&&this.server.unsubscribeTags(a);return a}return null};c.prototype.isTagSubscribed=function(c){return(c=this.tags[c])?c.subscribed:!1};
return c}();b["export"]("DynamicTagSubscriber.ts",c)})(u);var ba;(function(b){b[b.BAR=0]="BAR";b[b.FULLSCREEN=1]="FULLSCREEN"})(ba||(ba={}));var Vd=function(){function b(a){this.iconSize={width:64,height:50};this.style=void 0!==a?a:ba.BAR;a==ba.BAR?this.initBar():a==ba.FULLSCREEN&&this.initFullScreen();this.visible=!1}b.prototype.initBar=function(){this.statusBar=document.querySelector(".jm-status-bar");this.y=0;this.size=b.minHeight};b.prototype.initFullScreen=function(){this.statusBar=document.createElement("div");
this.statusBar.classList.add("jm-status-full-screen");this.statusBar.style.display="none";var a=document.createElement("div");a.classList.add("jm-no-connection-icon");this.statusBar.appendChild(a)};b.prototype.recalculateSize=function(a,c){switch(this.style){case ba.BAR:this.recalculateBarSize(a,c);break;case ba.FULLSCREEN:this.recalculateFullScreenSize(a,c)}};b.prototype.recalculateBarSize=function(a,c){var e=c/20;e>b.minHeight?this.size=Math.floor(e):32!=this.size&&(this.size=32);this.visible&&
this.drawBar()};b.prototype.recalculateFullScreenSize=function(a,c){var e=c/5;e>b.minHeight?this.size=Math.floor(e):32!=this.size&&(this.size=32);this.visible&&this.drawFullScreen()};b.prototype.setY=function(a){this.style==ba.BAR&&this.y!=a&&(this.y=a,this.visible&&this.drawBar())};b.prototype.drawBar=function(){this.statusBar.style.height=this.size+"px";this.statusBar.style.top=this.y+"px";var a=this.statusBar.querySelector(".jm-connstatus");a.style.height=this.size+"px";a.style.width=this.iconSize.width/
this.iconSize.height*this.size+"px"};b.prototype.show=function(){this.style==ba.BAR?this.showBar():this.style==ba.FULLSCREEN&&this.showFullScreen();this.visible=!0};b.prototype.hide=function(){this.style==ba.BAR?this.hideBar():this.style==ba.FULLSCREEN&&this.hideFullScreen()};b.prototype.showBar=function(){this.drawBar();var a=this.statusBar.querySelector(".jm-connstatus");a.classList.remove("jm-active");a.classList.add("jm-broken");this.statusBar.style.display="block";this.statusBar.style["z-index"]=
1};b.prototype.hideBar=function(){var a=this.statusBar.querySelector(".jm-connstatus");a.classList.remove("jm-broken");a.classList.add("jm-active");this.statusBar.style.display="none";this.statusBar.style["z-index"]=0;this.visible=!1};b.prototype.drawFullScreen=function(){null==document.querySelector(".jm-status-full-screen")&&document.querySelector("#jm-layer-messages").appendChild(this.statusBar);var a=this.statusBar.querySelector(".jm-no-connection-icon");a.style.height=this.size+"px";a.style.width=
this.iconSize.width/this.iconSize.height*this.size+"px"};b.prototype.showFullScreen=function(){this.drawFullScreen();this.statusBar.style.display="block"};b.prototype.hideFullScreen=function(){this.statusBar.style.display="none"};b.prototype.isVisible=function(){return this.visible};b.prototype.setStyle=function(a){if(a!=this.style)switch(a){case ba.BAR:this.style=ba.BAR;this.statusBar.parentNode&&this.statusBar.parentNode.removeChild(this.statusBar);this.initBar();break;case ba.FULLSCREEN:this.style=
ba.FULLSCREEN,this.initFullScreen()}};b.minHeight=32;return b}();u.addModule("StatusBar",Vd);q.prototype=Object.create(l.prototype);q.prototype.constructor=q;q.prototype.addDataLink=function(b){l.prototype.addDataLink.call(this,b);this.initDataLinkSideEffects(b,b.attr)};q.prototype.initDataLinkSideEffects=function(b,a){"tagSrc"==a&&(this.p.tag=b.tag,this.p.src=b.dataSrc.studioId,this.p.aIdx=b.tagIndex,this.p.srcType=b.srcType)};q.prototype.setValue=function(b,a,c){};q.prototype.getValue=function(b){};
q.prototype.destroy=function(){l.prototype.destroy.call(this)};f.fn.hmiAction=function(b,a,c,e){var h=q;if(1==a.t)h=Kc;else if(a.c){var d=f.getAction(a.c);d&&(h=d.constructor)}return new h(this,b,a,e,c)};q.prototype.execute=function(b,a,c){this.done()};q.prototype.addActionListener=function(b){this.listener=b};q.prototype.done=function(){this.listener&&this.listener.done&&this.listener.done()};q.prototype.getSelectedAlarms=function(){for(var b=[],a=0,c=f.getWidget("_AlarmsMgr",!0),e=0;e<c.vars.alSelect.length;e++)c.vars.alSelect[e]&&
b.push("al"+ ++a+"="+c.vars.alName[e]);0<b.length&&b.push("n="+b.length);return b.join("&")};q.prototype.changePage=function(b,a){requestAnimationFrame(function(){$hmi.activeProject.changePage(b,a)})};q.prototype.exist=function(b){return f.getWidget(b)?!0:!1};q.prototype.getDataLinkByAttr=function(b){for(var a in this.dataLinks){var c=this.dataLinks[a];if(c.getAttribute()==b)return c}return null};q.prototype.setParameters=function(b){this.c=b.c;this.p=b.p};q.prototype.getTagTypeByName=function(b){return f.getActiveProject().getTagMgr().getTagInfo(b).t};
f.addWidgetDefinition("hmiAction",q);fb.prototype=Object.create(q.prototype);fb.prototype.constructor=fb;fb.prototype.execute=function(b,a){var c=f.getWidget("_AlarmsMgr",!0),e=a.alID;"selected"===e?c.ackSelectedAlarms():c.ackSpecificAlarm(e);this.done()};f.addAction("hmiActionAckAlarm",fb);gb.prototype=Object.create(q.prototype);gb.prototype.constructor=gb;gb.prototype.execute=function(b,a){var c=f.activeProject.getWidget("_SysPropMgr",!0).getValue("System Time"),e;e=a.wgtName;if(null!=this.parentWidget.module&&
"*"==e.charAt(0)&&"."==e.charAt(1)){e=this.parentWidget.module;for(var h=!1;null!=e&&!(h=this.project.getCWidgetMgr().hasGfxInheritance(e.ctype));)e=e.module;e=h?e.getWidget(a.wgtName,!0):this.parentWidget.module.getWidget(a.wgtName,!0)}else e=f.getFocusPage().getWidget(a.wgtName,!0);e instanceof Eb?e.setValue("MaxInSeconds",Math.ceil(c)):e.setValue("max",Math.ceil(c));this.done()};f.addAction("hmiActionRefreshEvent",gb);Ua.prototype=Object.create(q.prototype);Ua.prototype.constructor=Ua;Ua.prototype.checkAll=
!0;Ua.prototype.execute=function(b,a){var c=f.getWidget("_AlarmsMgr",!0);if(c){if(a&&void 0!==a.md){var e=a.md,h=a.flt,d=a.wgt,g;if(h){var k,n,m,r;d&&(g=f.getFocusPage().getWidget(d,!0),k=g.getValue("filterAttr"),n=g.getValue("filterString"),m=g.getValue("filterAttr1"),r=g.getValue("filterString1"));g=c.getSelectAlarmsByFilter(k,n,m,r)}k=!0;if(0==e)if(h)for(e=0,h=g.length;e<h&&k;e++)c.isAlarmSelected(g[e])&&(k=!1);else k=c.getSelectedToggleStatus();else 2==e&&(k=!1);c.doSelectAlarms(g,k)}else this.select=
a&&void 0!=a.enable?a.enable:!this.select,c.selectAllAlarms(this.select);this.done()}};f.addAction("hmiActionSelectAllAlarms",Ua);hb.prototype=Object.create(q.prototype);hb.prototype.constructor=hb;hb.prototype.execute=function(b,a){var c=f.getWidget(b);a&&a.wgt&&(c=c.parentPage.getWidget(a.wgt,!0),0<c.getValue("PageDuration")&&(c instanceof Eb?c.setValue("MaxInSeconds",c.getValue("MaxInSeconds")-c.getTimeFrame()):(c.setValue("min",c.getValue("min")-c.getTimeFrame()),c.setValue("max",c.getValue("max")-
c.getTimeFrame()))));this.done()};f.addAction("hmiActionScrollEventsBackward",hb);ib.prototype=Object.create(q.prototype);ib.prototype.constructor=ib;ib.prototype.execute=function(b,a){var c=f.getWidget(b);a&&a.wgt&&(c=c.parentPage.getWidget(a.wgt,!0),0<c.getValue("PageDuration")&&(c instanceof Eb?c.setValue("MaxInSeconds",c.getValue("MaxInSeconds")+c.getTimeFrame()):(c.setValue("min",c.getValue("min")+c.getTimeFrame()),c.setValue("max",c.getValue("max")+c.getTimeFrame()))));this.done()};f.addAction("hmiActionScrollEventsForward",
ib);jb.prototype=Object.create(q.prototype);jb.prototype.constructor=jb;jb.prototype.execute=function(b,a){a&&"string"==typeof a.id&&f.getWidget("_MultiLangMgr",!0).changeLanguage(a.id);this.done()};f.addAction("hmiActionSetLanguage",jb);kb.prototype=Object.create(q.prototype);kb.prototype.constructor=kb;kb.prototype.execute=function(b,a,c){a.pg&&""!==$.trim(a.pg)&&(b=$.trim(a.pg),b=-1===b.indexOf("://")?"http://"+b:b,b=0===b.indexOf("://")?"http"+b:b,b=window.open(b,"_blank"),void 0!==b&&null!=b&&
b.focus?b.focus():f.notifyWarning("Launch Browser","We can not open a new tab or window, please check browser pop-up blocker settings."));f.mouseMgr.loseFocus();this.done()};f.addAction("hmiActionLaunchBrowser",kb);lb.prototype=Object.create(q.prototype);lb.prototype.constructor=lb;lb.prototype.execute=function(b,a){var c=f.getActiveProject().getCommunticationObj();a&&"undefined"!=typeof a.id&&c.deleteEventArchive(a.id);this.done()};f.addAction("hmiActionDeleteEventArchive",lb);mb.prototype=Object.create(q.prototype);
mb.prototype.constructor=mb;mb.prototype.execute=function(b,a){var c=this,e=f.getActiveProject().getCommunticationObj();a&&e.deleteTrend(a.n,!1).then(function(a){c.done()}).catch(function(a,b,e){f.debugMode&&f.notifyWarning("DeleteTrend","REST status: request failed.");c.done()});this.done()};f.addAction("hmiActionDeleteTrend",mb);nb.prototype=Object.create(q.prototype);nb.prototype.constructor=nb;nb.prototype.execute=function(b,a){var c=this,e=f.getActiveProject().getCommunticationObj();a?e.addRecipeDataSet(a.rc,
a.cp,a.ns,!1).then(function(a){"S_OK"!=a.code&&f.debugMode&&f.notifyWarning("AddRecipeDataSet","REST status:"+a.code);c.done()}).catch(function(a,b,e){f.debugMode&&f.notifyWarning("AddRecipeDataSet","REST status: request failed.");c.done()}):this.done()};f.addAction("hmiActionAddRecipeDataSet",nb);ob.prototype=Object.create(q.prototype);ob.prototype.constructor=ob;ob.prototype.execute=function(b,a){var c=this,e=f.getActiveProject().getCommunticationObj();a?e.delRecipeDataSet(a.rc,a.s,!1).then(function(a){"S_OK"!=
a.code&&f.debugMode&&f.notifyWarning("DelRecipeDataSet","REST status:"+a.code);c.done()}).catch(function(a,b,e){f.debugMode&&f.notifyWarning("DelRecipeDataSet","REST status: request failed.");c.done()}):this.done()};f.addAction("hmiActionDelRecipeDataSet",ob);pb.prototype=Object.create(q.prototype);pb.prototype.constructor=pb;pb.prototype.execute=function(b,a){var c=f.activeProject,e=c.getCommunticationObj(),h=c.getWidget("_RecipeMgr",!0),c=h.getValue("curRecipe"),h=h.getValue("curRecipeSet"),d=this;
e.downloadRecipe(c,h,!1).then(function(c){"S_OK"!=c.code&&f.debugMode&&f.notifyWarning("DownLoadCurRecipe","REST status:"+c.code);d.done()}).catch(function(c,a,b){f.debugMode&&f.notifyWarning("DownLoadCurRecipe","REST status: request failed.");d.done()})};f.addAction("hmiActionDownLoadCurRecipe",pb);qb.prototype=Object.create(q.prototype);qb.prototype.constructor=qb;qb.prototype.execute=function(b,a){var c=f.activeProject.getCommunticationObj();if(a){var e=this;c.downloadRecipe(a.r,a.s,!1).then(function(c){"S_OK"!=
c.code&&f.debugMode&&f.notifyWarning("DownLoadRecipe","REST status:"+c.code);e.done()}).catch(function(c,a,b){f.debugMode&&f.notifyWarning("DownLoadRecipe","REST status: request failed.");e.done()})}else this.done()};f.addAction("hmiActionDownLoadRecipe",qb);rb.prototype=Object.create(q.prototype);rb.prototype.constructor=rb;rb.prototype.execute=function(b,a){var c=this,e=f.getActiveProject().getCommunticationObj();a&&e.resetRecipe(a.r,!1).then(function(a){"S_OK"!=a.code&&f.debugMode&&f.notifyWarning("UpLoadCurRecipe",
"REST status:"+a.code);c.done()}).catch(function(a,b,e){f.debugMode&&f.notifyWarning("UpLoadCurRecipe","REST status: request failed.");c.done()})};f.addAction("hmiActionResetRecipe",rb);sb.prototype=Object.create(q.prototype);sb.prototype.constructor=sb;sb.prototype.execute=function(b,a){var c=f.activeProject,e=c.getCommunticationObj(),h=c.getWidget("_RecipeMgr",!0),c=h.getValue("curRecipe"),h=h.getValue("curRecipeSet"),d=this;e.uploadRecipe(c,h,!1).then(function(c){"S_OK"!=c.code&&f.debugMode&&f.notifyWarning("UpLoadCurRecipe",
"REST status:"+c.code);d.done()}).catch(function(c,a,b){f.debugMode&&f.notifyWarning("UpLoadCurRecipe","REST status: request failed.");d.done()})};f.addAction("hmiActionUpLoadCurRecipe",sb);tb.prototype=Object.create(q.prototype);tb.prototype.constructor=tb;tb.prototype.execute=function(b,a){var c=f.activeProject.getCommunticationObj();if(a){var e=this;c.uploadRecipe(a.r,a.s,!1).then(function(c){"S_OK"!=c.code&&f.debugMode&&f.notifyWarning("UpLoadRecipe","REST status:"+c.code);e.done()}).catch(function(c,
a,b){f.debugMode&&f.notifyWarning("UpLoadRecipe","REST status: request failed.");e.done()})}else this.done()};f.addAction("hmiActionUpLoadRecipe",tb);ub.prototype=Object.create(q.prototype);ub.prototype.constructor=ub;ub.prototype.execute=function(b,a){var c=this,e=f.getActiveProject().getCommunticationObj();if(a){var h=a.r,d=a.s,c=this;e.setCurrentRecipe(h,d,!1).then(function(a){"S_OK"!=a.code&&f.debugMode&&f.notifyWarning("WriteCurrentRecipeSet","REST status:"+a.code);c.done()}).catch(function(a,
b,e){f.debugMode&&f.notifyWarning("WriteCurrentRecipeSet","REST status: request failed.");c.done()})}else this.done()};f.addAction("hmiActionWriteCurrentRecipeSet",ub);vb.prototype=Object.create(q.prototype);vb.prototype.constructor=vb;vb.prototype.execute=function(b,a){var c=this,e=f.activeProject.getWidget("_UserGroupMgr",!0);e.useLastGroupPage()&&!e.isUMTemplate(f.getActivePage().studioId)&&e.storeLastPageUsed();null!=e.isSecurityEnabled()?e.isSecurityEnabled()&&this.project.getCommunticationObj().logOut().then(function(){c.done();
c.project.getCommunticationObj().loadLoginUI(e.isDefaultUser(),e.isForceRemoteLoginEnabled())}):this.project.getCommunticationObj().loadLoginUI(!0,!0);this.done()};f.addAction("hmiActionLogOut",vb);wb.prototype=Object.create(q.prototype);wb.prototype.constructor=wb;wb.prototype.execute=function(b,a){this.done()};f.addAction("hmiActionApplyEdit",wb);xb.prototype=Object.create(q.prototype);xb.prototype.constructor=xb;xb.prototype.execute=function(b,a,c){this.done()};f.addAction("hmiActionAddUser",xb);
yb.prototype=Object.create(q.prototype);yb.prototype.constructor=yb;yb.prototype.execute=function(b,a,c){this.done()};f.addAction("hmiActionDeleteUser",yb);zb.prototype=Object.create(q.prototype);zb.prototype.constructor=zb;zb.prototype.execute=function(b,a,c){this.done()};f.addAction("hmiActionEditUsers",zb);Ab.prototype=Object.create(q.prototype);Ab.prototype.constructor=Ab;Ab.prototype.execute=function(b,a,c){this.done()};f.addAction("hmiActionSwitchUser",Ab);var p=this&&this.__extends||function(){var b=
function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,a){c.__proto__=a}||function(c,a){for(var b in a)a.hasOwnProperty(b)&&(c[b]=a[b])};return b(a,c)};return function(a,c){function e(){this.constructor=a}b(a,c);a.prototype=null===c?Object.create(c):(e.prototype=c.prototype,new e)}}(),Wd=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){null!=a&&0<a.length&&f.getWidget(a[1],!0).setValue("visibility",a[0],null);
this.done()};return a}(q);f.addAction("hmiActionShowWidget",Wd);var Xd=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){if(null!=a){var b=a.deltaRow,d=f.getWidget(a.tableId,!0);void 0!==d&&null!==d&&d.scrollTable(b)}this.done()};return a}(q);f.addAction("hmiActionScrollTable",Xd);var Kc=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a,b,d){if(c=f.getWidget(c)){a=void 0;"PageWgt"==
c.getJMType()?(a=c.getCallbacks(),a=a[b].fn):a=(a=c.parentPage.getCallbacks())&&a[b]?a[b].fn:f.getActiveProject().getCallbacks()[b].fn;try{"function"==typeof a&&a(c,d)}catch(g){c?f.showErrorMessage(c.studioId,"JSAction",g.message):f.showErrorMessage("Unkown","JSAction",g.message)}}this.done()};return a}(q);f.addAction("hmiActionJS",Kc);var Yd=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){var b=f.activeProject.getWidget(a.src,!0),d=a.n;
"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d));if(d=b.getSubscribedWgtId(d)){var g=a.xMax instanceof Date?a.xMax.getTime()/1E3:a.xMax,k=a.xMin instanceof Date?a.xMin.getTime()/1E3:a.xMin;b.setTrendView(d,k,g,a.yMin,a.yMax)}this.done()};a.prototype.setValue=function(c,a,b){b&&!b.isQualityGood()||this.p[c]==a||(this.p[c]=a)};return a}(q);f.addAction("hmiActionSetTrendView",Yd);var Zd=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){var b=
a[0],d=a[1],g=a[2],k=f.getActiveProject();if(b="_TrendMgr"==b?k.getTrendMgr():f.getWidget(b,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=b.getSubscribedWgtId(d))&&b.showTrendCursor(d,"true"==g);this.done()};return a}(q);f.addAction("hmiActionShowTrendCursor",Zd);var $d=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){var b=a[0],d=a[1],g=f.getActiveProject();if(b="_TrendMgr"==b?g.getTrendMgr():f.getWidget(b,!0))"*"==d.charAt(0)&&
(d=this.parentWidget.resolveId(d)),(d=b.getSubscribedWgtId(d))&&b.moveTrendWindow(d,"down","page");this.done()};return a}(q);f.addAction("hmiActionPageDownTrend",$d);var ae=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){var b=a[0],d=a[1],g=a[2],k=f.getActiveProject();if(b="_TrendMgr"==b?k.getTrendMgr():f.getWidget(b,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=b.getSubscribedWgtId(d))&&b.changePageDuration(d,parseInt(g));
this.done()};return a}(q);f.addAction("hmiActionPageDurationTrend",ae);var be=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){var b=a[0],d=a[1],g=f.getActiveProject();if(b="_TrendMgr"==b?g.getTrendMgr():f.getWidget(b,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=b.getSubscribedWgtId(d))&&b.moveTrendWindow(d,"left","page");this.done()};return a}(q);f.addAction("hmiActionPageLeftTrend",be);var ce=function(b){function a(c,a,
h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){var b=a[0],d=a[1],g=f.getActiveProject();if(b="_TrendMgr"==b?g.getTrendMgr():f.getWidget(b,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=b.getSubscribedWgtId(d))&&b.moveTrendWindow(d,"right","page");this.done()};return a}(q);f.addAction("hmiActionPageRightTrend",ce);var de=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){var b=a[0],d=a[1],
g=f.getActiveProject();if(b="_TrendMgr"==b?g.getTrendMgr():f.getWidget(b,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=b.getSubscribedWgtId(d))&&b.moveTrendWindow(d,"up","page");this.done()};return a}(q);f.addAction("hmiActionPageUpTrend",de);var ee=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){var b=a[0],d=a[1],g=f.getActiveProject();if(b="_TrendMgr"==b?g.getTrendMgr():f.getWidget(b,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),
(d=b.getSubscribedWgtId(d))&&b.pauseTrend(d);this.done()};return a}(q);f.addAction("hmiActionPauseTrend",ee);var fe=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){var b=a[0],d=a[1],g=f.getActiveProject();if(b="_TrendMgr"==b?g.getTrendMgr():f.getWidget(b,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=b.getSubscribedWgtId(d))&&b.refreshTrend(d);this.done()};return a}(q);f.addAction("hmiActionRefreshTrend",fe);var ge=function(b){function a(c,
a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){var b=a.wgt,d=a.n,g=f.getActiveProject();if(b="_TrendMgr"==b?g.getTrendMgr():f.getWidget(b,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=b.getSubscribedWgtId(d))&&b.restoreTrendDefault(d);this.done()};return a}(q);f.addAction("hmiActionRestoreTrendDefault",ge);var he=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){var b=a[0],d=a[1],g=f.getActiveProject();
if(b="_TrendMgr"==b?g.getTrendMgr():f.getWidget(b,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=b.getSubscribedWgtId(d))&&b.resumeTrend(d);this.done()};return a}(q);f.addAction("hmiActionResumeTrend",he);var ie=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){var b=a[0],d=a[1],g=f.getActiveProject();if(b="_TrendMgr"==b?g.getTrendMgr():f.getWidget(b,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=b.getSubscribedWgtId(d))&&
b.moveTrendWindow(d,"down",null);this.done()};return a}(q);f.addAction("hmiActionScrollDownTrend",ie);var je=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){var b=a[0],d=a[1],g=f.getActiveProject();if(b="_TrendMgr"==b?g.getTrendMgr():f.getWidget(b,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=b.getSubscribedWgtId(d))&&b.moveTrendWindow(d,"left",null);this.done()};return a}(q);f.addAction("hmiActionScrollLeftTrend",je);var ke=
function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){var b=a[0],d=a[1],g=f.getActiveProject();if(b="_TrendMgr"==b?g.getTrendMgr():f.getWidget(b,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=b.getSubscribedWgtId(d))&&b.moveTrendWindow(d,"right",null);this.done()};return a}(q);f.addAction("hmiActionScrollRightTrend",ke);var le=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,
a){var b=a[0],d=a[1],g,k,n;a[2]&&(n=parseInt(a[2]));a[3]&&(g=parseInt(a[3]));a[4]&&(k=parseFloat(a[4]));var m=f.getActiveProject();if(b="_TrendMgr"==b?m.getTrendMgr():f.getWidget(b,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=b.getSubscribedWgtId(d))&&b.scrollTrendCursor(d,n,g,k);this.done()};return a}(q);f.addAction("hmiActionScrollTrendCursor",le);var me=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){var b=a[0],d=a[1],
g=a[2],k=a[3],n=a[4],m,r="_TrendMgr"==b?f.activeProject.getTrendMgr():f.getWidget(b,!0);if(r){"*"==k.charAt(0)&&(k=this.parentWidget.resolveId(k));var v=r.getSubscribedWgtId(k);if(v){b=f.cache.getTag(d);switch(g){case "Start":m=0;break;case "Center":m=1;break;case "End":m=2}b?(d=b.value,r.scrollTrendToTime(v,m,d)):(g=null,-1!=n.indexOf("Project:")?(n=n.substring(8),g=f.activeProject.getWidget(n,!0)):g=f.getWidget(n,!0),d=g.getValue(d),d instanceof Promise?d.then(function(c){r.scrollTrendToTime(v,
m,parseFloat(c))}):(moment.isMoment(d)&&(d=(new Date(d)).getTime()/1E3),r.scrollTrendToTime(v,m,d)))}}this.done()};return a}(q);f.addAction("hmiActionScrollTrendToTime",me);var ne=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){var b=a[0],d=a[1],g=f.getActiveProject();if(b="_TrendMgr"==b?g.getTrendMgr():f.getWidget(b,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=b.getSubscribedWgtId(d))&&b.moveTrendWindow(d,"up",null);this.done()};
return a}(q);f.addAction("hmiActionScrollUpTrend",ne);var oe=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){var b=a[0],d=a[1],g=f.getActiveProject();if(b="_TrendMgr"==b?g.getTrendMgr():f.getWidget(b,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=b.getSubscribedWgtId(d))&&b.zoomTrendWindow(d,!0,!0),this.done()};return a}(q);f.addAction("hmiActionZoomInTrend",oe);var pe=function(b){function a(c,a,h,d,g){return b.call(this,
c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){var b=a[0],d=a[1],g=f.getActiveProject();if(b="_TrendMgr"==b?g.getTrendMgr():f.getWidget(b,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=b.getSubscribedWgtId(d))&&b.zoomTrendWindow(d,!0,!1);this.done()};return a}(q);f.addAction("hmiActionZoomInYAxisTrend",pe);var qe=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){var b=a[0],d=a[1],g=f.getActiveProject();if(b="_TrendMgr"==
b?g.getTrendMgr():f.getWidget(b,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=b.getSubscribedWgtId(d))&&b.zoomTrendWindow(d,!1,!0);this.done()};return a}(q);f.addAction("hmiActionZoomOutTrend",qe);var re=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){var b=a[0],d=a[1],g=f.getActiveProject();if(b="_TrendMgr"==b?g.getTrendMgr():f.getWidget(b,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=b.getSubscribedWgtId(d))&&
b.zoomTrendWindow(d,!1,!1);this.done()};return a}(q);f.addAction("hmiActionZoomOutYAxisTrend",re);var se=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){var b=a[0],d=a[1],g=f.getActiveProject();if(b="_TrendMgr"==b?g.getTrendMgr():f.getWidget(b,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=b.getSubscribedWgtId(d))&&b.resetZoom(d,!0);this.done()};return a}(q);f.addAction("hmiActionZoomResetTrend",se);var te=function(b){function a(c,
a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){var b=a[0],d=a[1],g=f.getActiveProject();if(b="_TrendMgr"==b?g.getTrendMgr():f.getWidget(b,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=b.getSubscribedWgtId(d))&&b.resetZoom(d,!1);this.done()};return a}(q);f.addAction("hmiActionZoomResetYAxisTrend",te);var ue=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){f.getWidget("_AlarmsMgr",!0).saveConfiguration();
this.done()};return a}(q);f.addAction("hmiActionSaveConfiguration",ue);var ve=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){f.getWidget("_AlarmsMgr",!0).enableAlarms();this.done()};return a}(q);f.addAction("hmiActionEnableAlarm",ve);var we=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){f.activeProject.getAlarmsMgr().setSelectAlarm(a.alID,a.select);this.done()};return a}(q);
f.addAction("hmiActionSelectAlarm",we);var xe=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){f.getWidget(a.srcId,!0).selectAllAlarmsOnSrc();this.done()};return a}(q);f.addAction("hmiActionSelectAllAlarmsOnSrc",xe);var ye=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){this.project.getAlarmsMgr().resetSelectedAlarms();this.done()};return a}(q);f.addAction("hmiActionResetAlarm",
ye);var ze=function(b){function a(c,a,h,d,g){c=b.call(this,c,a,h,d,g)||this;c.setAsDefaultAlert();return c}p(a,b);a.prototype.setAsDefaultAlert=function(){var c=this;window.alert=function(a){c.execute(null,{msg:a},2)}};a.prototype.execute=function(c,a,b){var d,g,k;if(a){null!=a.msg&&(d=a.msg);if("undefined"!=typeof a.id){g=a.id;d=f.getWidget(c);if("AlarmsMgrWgt"===d.getJMType())k=d.getPageMLTextMgr(),d=d.alarmsConf.mlTexts[g][d.currLang];else if(f.getWidget(c,!1).isActiveAlarm)d=f.getWidget("_AlarmsMgr",
!0),k=d.getPageMLTextMgr(),d=d.alarmsConf.mlTexts[g][d.currLang];else if(k=c?this.parentWidget.getPageMLTextMgr():f.getActivePage().getPageMLTextMgr(),d=k.getText(g),null==d){var n=f.getFocusPage().getTemplateMLTextMgr();null!=n&&(d=n.getText(g),k=n)}k=k.getMultiLanguagesMgr().getLanguageFont(k.getCurrentLanguage())}c=null!==c?c.replace(/\./g,"_")+"_"+g:"default";g=document.createDocumentFragment();n=document.createElement("div");n.setAttribute("id","msg-o-"+c);n.setAttribute("class","jm-hmi-overlay");
g.appendChild(n);n=document.createElement("div");n.setAttribute("id","msg-b-"+c);n.setAttribute("class","jm-hmi-msg");var m="jm-round-button-circle";switch(b){case 1:b=document.createElement("div");b.setAttribute("class","jm-hmi-msg-hdr jm-bk-error");b.textContent="Error";m+=" rnd-btn-c-bk-err";break;case 2:b=document.createElement("div");b.setAttribute("class","jm-hmi-msg-hdr");b.textContent="Alert";m+=" rnd-btn-c-bk-alrt";break;case 3:b=document.createElement("div");b.setAttribute("class","jm-hmi-msg-hdr jm-cm-error");
b.textContent="Communication error";m+=" rnd-btn-c-bk-cmerr";break;default:b=document.createElement("div"),b.setAttribute("class","jm-hmi-msg-hdr"),b.textContent="Message"}n.appendChild(b);b=document.createElement("div");b.setAttribute("class","jm-hmi-msg-cnt");var r=document.createElement("p");r.setAttribute("style","margin:5px;"+(void 0!=k?"font-family:'"+k:""));a.format&&"html"==a.format?r.innerHTML=d:r.textContent=d;a=document.createElement("div");a.setAttribute("class","jm-round-button jm-hmi-msg-close");
a.innerHTML="<div class='"+m+"'><a>OK</a></div>";b.appendChild(r);b.appendChild(a);n.appendChild(b);g.appendChild(n);(a=this.project)||(a=this.core.getActiveProject());var v=a.getNode("messages");v.appendChild(g);a=v.querySelectorAll("#msg-b-"+c+" .jm-hmi-msg-close");var l=v.querySelectorAll("#msg-o-"+c),C=v.querySelectorAll("#msg-b-"+c);if(a=a[a.length-1])a.addEventListener("click",function(c){c.stopPropagation();v.removeChild(l[l.length-1]);v.removeChild(C[C.length-1]);f.getInputManager().enableMouse()}),
f.getInputManager().disableMouse();f.mouseMgr.loseFocus();this.done()}};return a}(q);f.addAction("hmiActionShowMessage",ze);f.setDefaultAlert(f.getAction("hmiActionShowMessage"));var ec=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a,b){b=this.project.getPageMgr();c=b.getCurrentPageId();b=b.getCurrentCategory();var d=b.alias[a.pg];a=d?d:a.pg;a!=c&&""!==a&&void 0!==a&&(-1==b.pages.indexOf(a)&&-1==b.umpages.indexOf(a)||this.changePage(c,
a));this.done()};a.jmType="LoadPageAction";return a}(q);f.addAction("hmiActionLoadPage",ec);var Ae=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){var b=this.project.getPageMgr(),d=b.getCurrentCategory(),g=d.pages.indexOf(b.getCurrentPageId());this.changePage(b.getCurrentPageId(),d.pages[0>g-1?d.pages.length-1:g-1]);this.done()};a.jmType="PrevPageAction";return a}(q);f.addAction("hmiActionPrevPage",Ae);var Be=function(b){function a(c,
a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){var b=this.project.getPageMgr(),d=b.getCurrentCategory(),g=d.pages.indexOf(b.getCurrentPageId());this.changePage(b.getCurrentPageId(),d.pages[g+1>=d.pages.length?0:g+1]);this.done()};a.jmType="NextPageAction";return a}(q);f.addAction("hmiActionNextPage",Be);var Ce=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){var b=this.project.getPageMgr(),d=this.project.getWidget("_UserGroupMgr",
!0);if(null==b||null==d)null!=f.urlParameters.code&&(-1==f.urlParameters.code?f.getAction("hmiActionLogOut").execute():this.project.getCommunticationObj().loadLoginUI(!0,!0));else{var g=b.getCurrentCategory();this.prevPageID=b.getLastVisitedPage();if(null==this.prevPageID)if(d=d.loadLastPageUsed(),null!=d)this.prevPageID=b.getWebPage(d.toLowerCase());else if(f.enablePjctWidgetServerReq)this.prevPageID=b.getHomePageId();else{f.getAction("hmiActionLogOut").execute();this.done();return}b=this.prevPageID;
-1==g.pages.indexOf(this.prevPageID)&&(b=this.project.getPageMgr().getWebPage(this.prevPageID.toLowerCase()));b&&this.changePage(f.getActivePage().wgtId,b)}this.done()};a.jmType="LastPageAction";return a}(q);f.addAction("hmiActionLastPage",Ce);var De=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){var b=this.project.getPageMgr(),d=b.getCurrentCategory();this.changePage(b.getCurrentPageId(),b.getWebPage(d.home.toLowerCase()));this.done()};
a.jmType="HomePageAction";return a}(q);f.addAction("hmiActionHomePage",De);var Fb=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.resolveParameters=function(c){var a,b;c=$.extend(!0,{},c);if("Alias"==c.srcType){b=this.project.getWidget(c.src,!0).getNameByTagAlias(c.tag);var d;null!=b&&(d=b.tag,b=b.idx,-1!=b&&(c.aIdx=b));c.tag=d;c.src="_TagMgr";c.srcType="Tag"}c.src&&1<c.src.split(":").length&&(c.wgtPage=c.src.split(":")[0],c.src=c.src.split(":")[1]);if("*"==
c.tag.charAt(0))return c.propType=3,c.rw="rw",c;if(c.tag)d=c.tag,b=f.getWidget(c.src,!0),!c.wgtPage&&b&&"GroupWgt"==b.getJMType()?(a=f.getWidget(c.src,!0),b=a.ctype,c.wgtId=a.wgtId,a=f.activeProject.props,b&&a&&a[b]&&a[b][d]?(c.aliases=a[b][d],c.propType=0):1<d.split(".").length?(c.aliases=d.split("."),c.propType=1):(c.prop=d,c.propType=2)):(c.prop=d,c.propType=2);else return null;c.rw="rw";return c};a.prototype.setWidgetProperty=function(c,a){var b,d;b=3==c.propType?[c.tag]:[c.prop];var g=c.propType,
k;k=c.wgtId?f.getFocusPage().getWidget(c.wgtId):f.getWidget(c.src,!0);for(var n=0,m=b.length;n<m;n++){d={wgt:null,prop:null};0==g||1==g?k.resolveAliasAttribute(b[n],d):d={wgt:k,prop:b[n]};var r=d.wgt;d=d.prop;if("rw"==c.rw){var v=parseFloat(r.getValue(d));if(isNaN(v)||this.isFloat(v))return!1;r.setProperty(d,a(v,c))}else"w"==c.rw&&r.setProperty(d,c.v)}return!0};a.prototype.isFloat=function(c){return"number"===typeof c&&0!==c%1?!0:!1};return a}(q),ea;(function(b){b[b.OVER=1]="OVER";b[b.LIMIT=2]="LIMIT";
b[b.STEP=4]="STEP"})(ea||(ea={}));var Ee=function(b){function a(c,a,h,d,g){c=b.call(this,c,a,h,d,g)||this;c.maskQualityTags=ea.STEP|ea.LIMIT|ea.OVER;return c}p(a,b);a.prototype.execute=function(c,a){var b=this,d=this.resolveParameters(a),g=this.maskQualityTags==(ea.STEP|ea.LIMIT|ea.OVER);if(null!=d&&g)if((g=this.project.getTagMgr())&&("_TagMgr"==d.src||d.wgtPage))g.stepTag(d.tag,d.aIdx,d.step,d.limit,d.over).then(function(c){b.done()})["catch"](function(){b.done()});else this.setWidgetProperty(d,
this.step32Bit),this.done();else this.done()};a.prototype.setValue=function(c,a,b){if("overLimitTagSrc"==c||"StepOverLimit"==c){if(b&&!b.isQualityGood())return this.maskQualityTags&=~ea.OVER,!1;b.isQualityGood()&&(this.maskQualityTags|=ea.OVER);this.p.over=a}else if("stepLimitTagSrc"==c||"StepLimit"==c){if(b&&!b.isQualityGood())return this.maskQualityTags&=~ea.LIMIT,!1;b.isQualityGood()&&(this.maskQualityTags|=ea.LIMIT);this.p.limit=a}else if("stepSizeTagSrc"==c||"Step"==c){if(b&&!b.isQualityGood())return this.maskQualityTags&=
~ea.STEP,!1;b.isQualityGood()&&(this.maskQualityTags|=ea.STEP);this.p.step=a}else"tagSrc"==c&&(c=this.getDataLinkByAttr("tagSrc"),null!=c&&this.p.aIdx!=c.tagIndex&&(this.p.aIdx=c.tagIndex));return!0};a.prototype.step32Bit=function(c,a){var b=c+a.step,d=b;a.over&&(d=0>a.step?b<a.limit?a.limit:b:b>a.limit?a.limit:b);return d};return a}(Fb);f.addAction("hmiActionStepTag",Ee);var Fe=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a,b){var d=
this;c=this.resolveParameters(a);if(null==c)this.done();else if("_TagMgr"==c.src||c.wgtPage)this.project.getTagMgr().toggleTag(c.tag,c.aIdx,c.idx).then(function(c){d.done()})["catch"](function(){d.done()});else this.setWidgetProperty(c,this.apply),this.done()};a.prototype.apply=function(c,a){return 0!==(c>>a.idx)%2?c&~(1<<a.idx):c|1<<a.idx};a.prototype.setValue=function(c,a,b){"tagSrc"==c&&(c=this.getDataLinkByAttr("tagSrc"),null!=c&&this.p.aIdx!=c.tagIndex&&(this.p.aIdx=c.tagIndex));return!0};return a}(Fb);
f.addAction("hmiActionToggleBit",Fe);var Ge=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a,b){var d=this;c=this.resolveParameters(a);if(null==c)this.done();else if("_TagMgr"==c.src||c.wgtPage)this.project.getTagMgr().setBitTag(c.tag,c.aIdx,c.idx).then(function(c){d.done()})["catch"](function(){d.done()});else this.setWidgetProperty(c,this.apply),this.done()};a.prototype.apply=function(c,a){var b=a.tagType,d=1<<a.idx,g=64;"Tag"==a.srcType&&
(g=u.getModule("Tag").getNumberOfBits(b)-1);return a.idx>g?c:c|d};a.prototype.setValue=function(c,a,b){"tagSrc"==c&&(c=this.getDataLinkByAttr("tagSrc"),null!=c&&this.p.aIdx!=c.tagIndex&&(this.p.aIdx=c.tagIndex));return!0};return a}(Fb);f.addAction("hmiActionSetBit",Ge);var He=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a,b){var d=this;c=this.resolveParameters(a);if(null==c)this.done();else if("_TagMgr"==c.src||c.wgtPage)this.project.getTagMgr().resetBitTag(c.tag,
c.aIdx,c.idx).then(function(c){d.done()})["catch"](function(){d.done()});else this.setWidgetProperty(c,this.apply),this.done()};a.prototype.apply=function(c,a){return c&~(1<<a.idx)};a.prototype.setValue=function(c,a,b){"tagSrc"==c&&(c=this.getDataLinkByAttr("tagSrc"),null!=c&&this.p.aIdx!=c.tagIndex&&(this.p.aIdx=c.tagIndex));return!0};return a}(Fb);f.addAction("hmiActionResetBit",He);var Ie=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,
a,b){var d=this;c=this.resolveParameters(a);if(null==c)this.done();else if("_TagMgr"==c.src||c.wgtPage)this.project.getTagMgr().setValue(c.tag,c.v,c.aIdx,!0).then(function(c){d.done()})["catch"](function(){d.done()});else this.setWidgetProperty(c,this.apply),this.done()};a.prototype.apply=function(c,a){return a.v};a.prototype.setValue=function(c,a,b){"tagSrc"==c&&(c=this.getDataLinkByAttr("tagSrc"),null!=c&&this.p.aIdx!=c.tagIndex&&(this.p.aIdx=c.tagIndex))};return a}(Fb);f.addAction("hmiActionWriteTag",
Ie);var Je=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){var b=this,d=this.project.getPageMgr().getCurrentCategory().alias[a.pg],g=d?d:a.pg;null!=g&&void 0!=g&&-1==f.activeProject.activeDialogs.indexOf(g)&&$.ajax({url:g+".html",dataType:"html",success:function(c){var a,e,d;a=document.createElement("link");a.setAttribute("rel","stylesheet");a.setAttribute("href","../css/pages/_"+g+".css");e=document.createElement("div");e.innerHTML=c;
d=e.querySelector("div[data-role='hmi-dialog']");requestAnimationFrame(function(){Ca(d,"Transform","translateZ(0) scale(0)");document.head.appendChild(a);for(var c=e.getElementsByTagName("script"),k=null,l=null,p=0,q=c.length;p<q;p++){var t=c[p].id;"hmi-page"===t?k=c[p].textContent:"hmi-init"===t&&(l=c[p].textContent)}null!=l&&eval(l);f.getActiveProject().getCWidgetMgr().injectCWTemplates(d,d.getAttribute("id"));b.project.getNode("container").appendChild(d);null!=k&&eval(k);c=f.getPageInitFunction("_"+
g)();c.bindCWJSClass();f.activeProject.subscribeDynamicTags();f.getEventMgr().trigger(f.getFocusPage().getHTMLElement(),"loadWgt");c.show();c.execJS();c.load()})}});this.done()};return a}(q);f.addAction("hmiActionShowDialog",Je);var Ke=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){var b=f.getActiveProject();if("*"==a.pg)b.closeAllDialogs();else{var d=f.getActiveProject().getPageMgr(),g=void 0;g=".*"==a.pg?f.getFocusPage().getId():(g=
d.getCurrentCategory().alias[a.pg])?g:d.getWebPage(a.pg);b.isActiveDialog(g)&&b.closeDialog(g)}this.done()};return a}(q);f.addAction("hmiActionCloseDialog",Ke);var Le=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){var b=f.getWidget(a[0],!0);b&&b.refresh();this.done()};return a}(q);f.addAction("hmiActionRefreshTrendTable",Le);var Me=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,
a){var b=f.getWidget(a[0],!0);b&&b.moveBackward();this.done()};return a}(q);f.addAction("hmiActionScrollTrendTableBackward",Me);var Ne=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a){var b=f.getWidget(a[0],!0);b&&b.moveForward();this.done()};return a}(q);f.addAction("hmiActionScrollTrendTableForward",Ne);var Oe=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.setValue=function(c,a,b){if(b.isQualityGood())switch(c){case "FolderPath":this.p.f=
a;break;case "CsvFields":this.p.csvfields=a;break;case "CsvLogs":this.p.csvlogs=a;break;case "DateTimeFormat":this.p.dtformat=a;break;case "LangCode":this.p.langcode=a}};a.prototype.execute=function(c,a){var b=this,d=$hmi.getActiveProject().getCommunticationObj();if(a)d.dumpTrend(a,!1).then(function(){b.done()})["catch"](function(){f.debugMode&&f.notifyWarning("DumpTrend","REST status: request failed.");b.done()});else this.done()};return a}(q);f.addAction("hmiActionDumpTrend",Oe);var fc;(function(b){b[b.DEFAULT=
0]="DEFAULT";b[b.PROG=1]="PROG";b[b.SUCC=2]="SUCC";b[b.FAILED=3]="FAILED"})(fc||(fc={}));var Pe=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.setValue=function(c,a,b){if(b.isQualityGood())switch(c){case "FilePath":this.p.p=a;break;case "FileName":this.p.fn=a}};a.prototype.execute=function(c,a){var b=this,d=f.getActiveProject().getCommunticationObj();if(a){var g=a.r,k=a.ds,n=a.p,m=a.fn,r=a.dt,v=a.ts,l=a.tagName,m=m.replace(/%r/g,"{{r}}"),m=m.replace(/%d/g,
"{{d}}");d.dumpRecipeData(g,k,n,m,l,r,v,!1).then(function(c){c.status==fc.FAILED&&(c.msg?f.showMessage("Dump Recipe Data",c.msg):f.showMessage("Dump Recipe Data","Error status code:"+c.status));b.done()})["catch"](function(){f.debugMode&&f.notifyWarning("DumpRecipeData","REST status: request failed.");b.done()})}else this.done()};return a}(q);f.addAction("hmiActionDumpRecipeData",Pe);var gc;(function(b){b[b.DEFAULT=0]="DEFAULT";b[b.PROG=1]="PROG";b[b.SUCC=2]="SUCC";b[b.FAILED=3]="FAILED"})(gc||(gc=
{}));var Qe=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.setValue=function(c,a,b){if(b.isQualityGood())switch(c){case "FilePath":this.p.p=a;break;case "FileName":this.p.fn=a}};a.prototype.execute=function(c,a){var b=this,d=f.getActiveProject().getCommunticationObj();if(a){var g=a.r,k=a.s,n=a.p,m=a.fn,r=a.br,v=a.tagName,l=a.rtype,m=m.replace(/%r/g,"{{r}}"),m=m.replace(/%d/g,"{{d}}");d.restoreRecipeData(g,k,n,m,v,r,l,!1).then(function(c){c.status==gc.FAILED&&
(c.msg?$hmi.showMessage("Restore Recipe Data",c.msg):$hmi.showMessage("Restore Recipe Data","Error status code:"+c.status));b.done()})["catch"](function(){$hmi.debugMode&&$hmi.notifyWarning("RestoreRecipeData","REST status: request failed.");b.done()})}};return a}(q);f.addAction("hmiActionRestoreRecipeData",Qe);var Re=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a,b){this.exist(c)&&(f.getActiveProject().getWidget("_UserGroupMgr",!0).loadUMForm(c,
b.toLowerCase()),this.done())};return a}(q);f.addAction("hmiActionChangePassword",Re);var Se=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a,b){this.exist(c)&&(f.getActiveProject().getWidget("_UserGroupMgr",!0).changePwdAction(),this.done())};return a}(q);f.addAction("hmiActionChangePwd",Se);l.prototype.opacity=1;l.prototype.visible=!0;l.prototype.blink=0;l.prototype.x=null;l.prototype.y=null;l.prototype.parentWidget=null;l.prototype.xFromScaling=
!1;l.prototype.isTemplateWgt=!1;l.prototype.hT=-1;l.prototype.aRT=-1;l.prototype.aRM=0;l.prototype.disabled=!1;l.prototype.nWgts=0;l.prototype.qualityIcon=-1;l.prototype.firstQualityShow=!0;l.prototype._initialized=!1;l.prototype._currentRot=null;l.prototype._center=null;l.prototype._boundingRect=null;l.prototype._dirtyBRect=!1;l.prototype._subscriptions=null;l.prototype._renderMask=0;l.prototype._baseRenderMask=0;l.prototype._baseRenderFlags={X:2,Y:4,CX:8,CY:16,WIDTH:32,HEIGHT:64,ROTATION:128,BLINK:512,
VISIBLE:1024,OPACITY:2048,SHOWQUALITY:4096,SHOWINFOICON:8192,HIDEINFOICON:16384};l.prototype.invokablePropsList=["visible"];l.prototype.invokableFunList=[];l.prototype._userValue=null;l.prototype.module=null;l.prototype._$elem=void 0;l.prototype.masked=!1;l.prototype.maskChar="*";l.jmType=null;Object.defineProperty(l.prototype,"$elem",{get:function(){void 0===this._$elem&&(this._$elem=$(this.elem));return this._$elem},set:function(b){this._$elem=b}});Object.defineProperty(l.prototype,"currentRot",
{get:function(){null==this._currentRot&&(this._currentRot=this._getCurrentRotation());return this._currentRot},set:function(b){this._currentRot=b}});Object.defineProperty(l.prototype,"center",{get:function(){null==this._center&&(this._center=this._map(vc(this.mtx),{x:this.cx,y:this.cy}));return this._center},set:function(b){this._center=b}});Object.defineProperty(l.prototype,"boundingRect",{get:function(){if(null==this._boundingRect||this._dirtyBRect){var b=xc(this.elem);this._boundingRect=this._mapRect(b,
{x:0,y:0,width:this.width,height:this.height});this._dirtyBRect=!1}return this._boundingRect},set:function(b){this._boundingRect=b}});Object.defineProperty(l.prototype,"id",{get:function(){return this.studioId}});l.prototype._registerJSAction=function(b){for(var a=f.actionMgr.enActionType.JS,c=0,e=b.length;c<e;c++)if(b[c].t==a){var h;h=this.constructor==I?this:this.parentPage;b[c].alAction&&(h=f.getActiveProject());h=h.registerPageCallback(b[c].c,this);b[c].c=h}return b};l.prototype.updateTransform=
function(){this.mtx=this._getTransformMtx($(this.elem).css("transform"));this.currentRot=this._getCurrentRotation()};l.prototype.setId=function(b){this.wgtId=b};l.prototype._getCurrentRotation=function(){var b=this.mtx;return Math.atan2(b[1][0],b[0][0])*(180/Math.PI)};l.prototype._setRotation=function(b){var a=b-this.currentRot,c=this.center.x,e=this.center.y,h=Math.PI/180,d=Math.cos(a*h),a=Math.sin(a*h),d=Ka([[1,0,c],[0,1,e],[0,0,1]],[[d,-a,0],[a,d,0],[0,0,1]]),d=Ka(d,[[1,0,-c],[0,1,-e],[0,0,1]]);
this.mtx=d=Ka(d,this.mtx);this.currentRot=b;this._dirtyBRect=!0};l.prototype.render=function(){if(!this.elem)return!1;this._baseRenderMask&this._baseRenderFlags.ROTATION&&(f.browserOptimizations.forceLayers?(this.elem.style.msTransform="translateZ(0) "+Ha(this.mtx),this.elem.style.webkitTransform="translateZ(0) "+Ha(this.mtx),this.elem.style.transform="translateZ(0) "+Ha(this.mtx)):(this.elem.style.msTransform=Ha(this.mtx),this.elem.style.webkitTransform=Ha(this.mtx),this.elem.style.transform=Ha(this.mtx)));
this._baseRenderMask&this._baseRenderFlags.VISIBLE&&(this.elem.style.display=this.visible?"block":"none");this._baseRenderMask&this._baseRenderFlags.OPACITY&&(this.elem.style.opacity=this.opacity);this._baseRenderMask&this._baseRenderFlags.BLINK&&(this.blink?this.elem.classList.add("jm-blink"):this.elem.classList.remove("jm-blink"));this._baseRenderMask&this._baseRenderFlags.X&&(this.elem.style.left=this.x+"px",this.left=this.x);this._baseRenderMask&this._baseRenderFlags.Y&&(this.elem.style.top=this.y+
"px",this.top=this.y);this._baseRenderMask&this._baseRenderFlags.WIDTH&&(this.elem.style.width=this.width+"px");this._baseRenderMask&this._baseRenderFlags.HEIGHT&&(this.elem.style.height=this.height+"px");this._baseRenderMask&this._baseRenderFlags.SHOWINFOICON&&this.addAccessDeniedIcon();this._baseRenderMask&this._baseRenderFlags.HIDEINFOICON&&this.removeAccessDeniedIcon();this._baseRenderMask&this._baseRenderFlags.SHOWQUALITY&&this.project&&-1!=this.project.iconStatusDelay&&(-1==this.qualityIcon?
this.hideQualityIcon():this.showQualityIcon(this.qualityIcon));this._baseRenderMask=0;return!0};l.prototype.getTransformMatrix=function(){return this.mtx};l.prototype._getTransformMtx=function(b){return wc(b)};l.prototype.setElem=function(b){this.elem=b};l.prototype.setOptions=function(b){if(null!=b){this._options=b;for(var a in b)switch(a){case "br":this.boundingRect={x:0,y:0,height:b[a][3],width:b[a][2]};break;case "x":this.left=b.x;break;case "y":this.top=b.y;break;case "w":this.width=b.w;break;
case "h":this.height=b.h;break;case "id":break;default:this.setDefaultOption(a,b[a])}}};l.prototype.setDefaultOption=function(b,a){this[b]=a};l.prototype.setOption=function(b,a){this.setValue(b,a)};l.prototype.getOption=function(b,a){return this.getValue(b)};l.prototype.getOptions=function(){var b=Object.keys(this._options),a;for(a in b)this._options[b[a]]=this[b[a]]instanceof Array?this[b[a]].slice(0):this[b[a]];return this._options};l.prototype.init=function(){};l.prototype.setValue=function(b,
a,c,e,h){e=!1;if(this.isBadValue(a,!1,c))return!1;if("visibility"==b||"visible"==b)"boolean"!=typeof a&&(a=parseInt(a)),a!=this.visible&&(this.visible=a,this.getAuthorizations()==this.umgr.getWidgetAuthorizationCodes().HIDE&&(this.constructor==I?this.elem.style.backgroundImage=null:this.visible=!1),this.setVisibility(this.visible),this._baseRenderMask|=this._baseRenderFlags.VISIBLE,e=!0);else if("opacity"===b||"fill-opacity"===b)a="boolean"==typeof a?1==a?1:0:parseFloat(a),this.opacity!=a&&(this.opacity=
a,this._baseRenderMask|=this._baseRenderFlags.OPACITY,e=!0);else if("blink"===b){a="boolean"==typeof a?1==a?1:0:parseFloat(a);if(1<a||0>a)a=1;this.blink!=a&&(this.blink=a,this._baseRenderMask|=this._baseRenderFlags.BLINK,e=!0)}else"x"===b?(a=parseFloat(a),this.x!=a&&(this.x=a,this._baseRenderMask|=this._baseRenderFlags.X,e=!0)):"y"===b?(a=parseFloat(a),this.y!=a&&(this.y=a,this._baseRenderMask|=this._baseRenderFlags.Y,e=!0)):"rot"==b?(a=parseFloat(a),this.rot!=a&&(this._setRotation(a),this._baseRenderMask|=
this._baseRenderFlags.ROTATION,e=!0)):"disabled"==b&&this.disabled!=a&&(this.disabled=1==a,e=!0);e&&(f.addToRender(this),this.sendUpdate(b,a,c))};l.prototype.setProperty=function(b,a,c){"width"==b?a!=this.width&&(2>a&&(a=2),b=f.getActivePage(),c=this.boundingRect.height,b.isFitToSizeEnable()&&(c=Number(Math.round(c/b.getScaleFactors().y+"e3")+"e-3")),this.wgt.setParentBounds(this.left,this.top,a,c,this.parentWidget)):"height"==b?a!=this.height&&(2>a&&(a=2),b=f.getActivePage(),c=this.boundingRect.width,
b.isFitToSizeEnable()&&(c=Number(Math.round(c/b.getScaleFactors().x+"e3")+"e-3")),this.wgt.setParentBounds(this.left,this.top,c,a,this.parentWidget)):this.setValue(b,a,ua.prototype.QUALITY_GOOD)};l.prototype.setVisibility=function(b){this.visible=b};l.prototype.getValue=function(b){var a={x:"left",y:"top",height:"height",width:"width"};return"id"==b||"objectName"==b?this.studioId:"visibility"==b?null==this.elem.style.display||"none"==this.elem.style.display?0:1:"opacity"==b||"fill-opacity"==b?this.opacity:
"undefined"!==typeof a[b]?this.elem?this.elem.style[a[b]].split("px")[0]:null:this[b]};l.prototype.getProperty=l.prototype.getParameter=function(b,a){return this.getValue(b,a)};l.prototype.getHTMLElement=function(){return this.elem};l.prototype.hasPropInDatalinks=function(b){this["has"+b+"PropInDatalinks"]=null!=b?!0:!1};l.prototype.addDataLink=function(b){b.dataSrc&&b.dataSrc.isTableDataSource&&this.dataSourceProps.push(b.attr);this.parentPage?this.parentPage.registerLink(b):this.registerLink&&this.registerLink(b);
this.subscribeDataLink(b)};l.prototype.initDataLinkSideEffects=function(b,a){};l.prototype.subscribeDataLink=function(b){void 0==this.dataLinks&&(this.dataLinks={});this.dataLinks[b.getId()]=b};l.prototype.removeDataLink=l.prototype.unsubscribeDataLink=function(b){this.dataLinks&&b&&delete this.dataLinks[b.getId()]};l.prototype.sendUpdate=function(b,a,c){if(null!=this.dataLinks){var e,h;for(h in this.dataLinks)e=this.dataLinks[h],e.dataSrcId===this.wgtId&&e.tag===b&&e.setWgtValue(a,void 0,c)}null!=
this.module&&(this.hasSubscriptionFor(this.module)?this.sendNotification("mdup",{attr:b,v:a,q:c}):(e=this.studioId.indexOf(this.module.studioId),-1!==e&&(e="*."+this.studioId.substr(e+this.module.studioId.length+1)+".",e="*"==b.charAt(0)&&"."==b.charAt(1)?e+b.substr(2):e+b,this.module.sendUpdate(e,a,c))))};l.prototype.areAliases=function(b,a){return!1};l.prototype.doWriteValue=function(b,a){var c,e=!1,h=this,d=new Promise(function(d,k){for(var f in h.dataLinks)c=h.dataLinks[f],(c.attr===b||c.tgtWgt.areAliases&&
c.tgtWgt.areAliases(c.attr,b))&&c.dataSrc!==h&&"r"!=c.getValue("rw")&&(h._addToExecutionQueue(h,c,a,d),e=!0);e||d()});return!e&&this.module?(d=this.studioId.indexOf(this.module.studioId),-1!==d?(d="*."+this.studioId.substr(d+this.module.studioId.length+1)+".",d="*"==b.charAt(0)&&"."==b.charAt(1)?d+b.substr(2):d+b,this.module.doWriteValue(d,a)):Promise.resolve()):d};l.prototype._addToExecutionQueue=function(b,a,c,e){b=this;this._eQueue.push(function(){a.setTagValue(c).then(function(){b._doNextWrite(e)}).catch(function(){b._doNextWrite(e)})});
0<this._eQueue.length&&0==this._eStatus&&(this._eStatus=1,this._eQueue.shift()())};l.prototype._doNextWrite=function(b){0<this._eQueue.length&&1==this._eStatus?this._eQueue.shift()():(b(),this._eStatus=0)};l.prototype.isBadValue=function(b,a,c){if(null!=this.umgr&&0==this.getAuthorizations()||this.elem&&"none"==this.elem.style.display||null===c)return!1;if(c){if(c.isQualityGood())return-1!=this.qualityIcon&&(this.qualityIcon=-1,this._baseRenderMask|=this._baseRenderFlags.SHOWQUALITY,f.addToRender(this)),
!1;c.isQualityUncertain()?this.qualityIcon=0:this.qualityIcon=1;this._baseRenderMask|=this._baseRenderFlags.SHOWQUALITY;f.addToRender(this);return!0}if(null===b||void 0===b||void 0===a&&isNaN(b))return this.qualityIcon=0,this._baseRenderMask|=this._baseRenderFlags.SHOWQUALITY,f.addToRender(this),!0;this.qualityIcon=-1;this._baseRenderMask|=this._baseRenderFlags.SHOWQUALITY;f.addToRender(this);return!1};l.prototype.showQualityIcon=function(b){var a=this;this.elem&&(!0===this.firstQualityShow?(this.firstQualityShow=
!1,setTimeout(function(){a.elem&&-1!=a.qualityIcon&&(a.hideQualityIcon(),a.addQualityIcon())},this.project.iconStatusDelay)):this.elem&&(-1!=this.qualityIcon&&this.hideQualityIcon(),setTimeout(function(){a.elem&&-1!=a.qualityIcon&&(a.hideQualityIcon(),a.addQualityIcon())},this.project.iconStatusDelay)))};l.prototype.hideQualityIcon=function(){this.elem&&(-1<this.elem.className.indexOf("jm-bad-a")&&(this.removeValueIcon(1),this.elem.classList.remove("jm-bad-a")),-1<this.elem.className.indexOf("jm-unc-a")&&
(this.removeValueIcon(0),this.elem.classList.remove("jm-unc-a")))};l.prototype.addQualityIcon=function(){if(this.elem){var b;0==this.qualityIcon?(this.elem.classList.add("jm-unc-a"),b="jm-unc"):(this.elem.classList.add("jm-bad-a"),b="jm-bad");var a=this.wgtId+"_"+b;b='<div id="'+a+'" class="'+b+'"></div>';this.parentWidget?"TableGroupWgt"===this.parentWidget.getJMType()?$("#"+CSS.escape(this.parentWidget.wgtId+".body")).append(b):$(this.parentWidget.elem).append(b):$(this.elem).append(b);b=parseFloat(this.elem.style.left.split("px")[0]);
parseFloat(this.elem.style.width.split("px")[0]);var c=parseFloat(this.elem.style.top.split("px")[0]);(a=$("#"+CSS.escape(a)))&&a.css({position:"absolute",left:b,top:c,width:16,height:16})}};l.prototype.removeValueIcon=function(b){var a;1==b?a=this.wgtId+"_jm-bad":0==b&&(a=this.wgtId+"_jm-unc");void 0!==a&&(b=document.getElementById(a),null!=b&&b.parentNode.removeChild(b))};l.prototype.showHideAccessDeniedIcon=function(){if(!this.adIconVisible){this.showAccessDeniedIcon();this.adIconVisible=!0;var b=
this;window.setTimeout(function(){b.hideAccessDeniedIcon();b.adIconVisible=!1},2500)}};l.prototype.showAccessDeniedIcon=function(){this._baseRenderMask|=this._baseRenderFlags.SHOWINFOICON;f.addToRender(this)};l.prototype.hideAccessDeniedIcon=function(){this._baseRenderMask|=this._baseRenderFlags.HIDEINFOICON;f.addToRender(this)};l.prototype.addAccessDeniedIcon=function(){if(this.elem){var b=this.wgtId+"_ad",a=document.createElement("div");a.setAttribute("id",b);a.setAttribute("class","hmi-access-denied");
a.style.position="absolute";a.style.left=this.left+this.width-24+"px";a.style.top=this.top+"px";a.style.width="24px";a.style.height="24px";this.parentWidget?this.parentWidget.elem.appendChild(a):this.elem.appendChild(a)}};l.prototype.removeAccessDeniedIcon=function(){var b=document.getElementById(this.wgtId+"_ad");null!=b&&b.parentNode.removeChild(b)};l.prototype.addWidget=function(b,a){this.wgts||(this.wgts={});null===this.wgtsOrder&&(this.wgtsOrder=[]);this.wgts[b]=a;this.wgtsOrder.push(b);this.nWgts++;
this.mapId[a.studioId]=b};l.prototype.removeWidget=function(b){if(this.wgts&&void 0!==this.wgts[b]){var a=this.wgtsOrder.indexOf(b);-1!=a&&this.wgtsOrder.splice(a,1);delete this.wgts[b];this.nWgts--}};l.prototype.getChild=function(b){return 0!=this.nWgts&&0<=b&&b<this.nWgts?this.wgts[this.wgtsOrder[b]]:null};l.prototype.getChildrendNumber=function(){return this.nWgts};l.prototype.getWidget=function(b,a,c){var e=this.wgts;if(a&&b==this.studioId)return this;if(null===e)return null;a&&void 0!==this.mapId[b]&&
(b=this.mapId[b]);var h=e[b];if(void 0!==h)return c?h.isTemplateWgt?h:null:h;for(var d in e)if(h=e[d].getWidget(b,a,c),null!==h)if(c){if(h.isTemplateWgt)return h}else return h;return null};l.prototype.getWidgetByClass=function(b){return this.getWidgetByCondition(function(a){return a.constructor==b})};l.prototype.getWidgetByCondition=function(b){for(var a=[this];0<a.length;){var c=a.pop(),e;for(e in c.wgts){c=this.wgts[e];if(b(c))return c;0<c.nWgts&&a.push(c)}}return null};l.prototype.getWidgetByJMType=
function(b){var a=null,c;for(c in this.wgts){a=this.wgts[c];if(a.getJMType()===b)break;a=a.getWidgetByJMType(b)}return a};l.prototype.resolveAliasAttribute=function(b,a){var c=b.split("."),e=c[0],c=c[1],h=e.replace(/[0-9]/g,""),e=parseInt(e.substring(h.length));isNaN(e)&&(e=1);h=$("div[data-widget='"+h+"']",this.elem);0<h.length&&h.length>=e?(e=h[e-1].getAttribute("id"),a.wgt=this.getWidget(e),a.prop=c):a.wgt=null};l.prototype.getWebIdFromAlias=function(b){for(var a=[],c,e=0;e<b.length;e++)c=b[e].split(".")[0],
a.push(c);return a};l.prototype.getPropFromAlias=function(b){for(var a=[],c,e=0;e<b.length;e++)c=b[e].split(".")[1],a.push(c);return a};l.prototype.getJsObject=function(){return this.constructor==Na&&this.js?this.js:this.parentWidget?this.parentWidget.getJsObject():null};l.prototype.getParentTransform=function(b){for(var a=this.parentWidget,c=[];a!=b;)e=a.mtx,c.push([[e[0][0],e[0][1],e[0][2]+a.left],[e[1][0],e[1][1],e[1][2]+a.top],[e[2][0],e[2][1],e[2][2]]]),a=a.parentWidget;var e=this.mtx;b=[[1,
0,0],[0,1,0],[0,0,1]];for(a=c.length-1;0<=a;a--)b=ia(b,c[a]);return b=ia(b,[[e[0][0],e[0][1],e[0][2]+this.left],[e[1][0],e[1][1],e[1][2]+this.top],[e[2][0],e[2][1],e[2][2]]])};l.prototype.updateOnResize=function(b){b&&(this.top=b.y,this.left=b.x,this.width=b.width,this.height=b.height,this.cx=b.center.x,this.cy=b.center.y,this.mtx=b.mtx)};l.prototype.setParentBounds=function(b,a,c,e,h){if(h!=this.parentWidget){h=this.getParentTransform(h);var d=vc(h),g=this._mapRect(ia(h,this.mtx),{x:0,y:0,width:this.width,
height:this.height}),k=1,f=1,k=0==g.width?0==c?1:c/1E-6:c/g.width,f=0==g.height?0==e?1:e/1E-6:e/g.height,f=[[k,0,0],[0,f,0],[0,0,1]];c=ia(h,this.mtx);c=ia(f,c);c=ia(d,c);f=ia(f,h);f=ia(d,f);e=Math.sqrt(c[0][0]*c[0][0]+c[1][0]*c[1][0]);g=Math.sqrt(c[0][1]*c[0][1]+c[1][1]*c[1][1]);k=[[1/e,0,0],[0,1/g,0],[0,0,1]];this.xformScaling?this.mtx=ia(f,this.mtx):(this.mtx=ia(c,k),this.center.x*=e,this.center.y*=g,this.width*=e,this.height*=g,this.elem.style.width=this.width+"px",this.elem.style.height=this.height+
"px");da(this.elem,Ha(this.mtx));this.updateBoundingRect();this._normalizePosition(h,d,{x:b,y:a});b=this._map(this.mtx,this.center)}else g=Xb(this.mtx)?{x:0,y:0,width:this.width,height:this.height}:this._mapRect(this.mtx,{x:0,y:0,width:this.width,height:this.height}),k=0==g.width?0==c?1:c/1E-6:c/g.width,f=0==g.height?0==e?1:e/1E-6:e/g.height,f=[[k,0,0],[0,f,0],[0,0,1]],c=ia(f,this.mtx),e=Math.sqrt(c[0][0]*c[0][0]+c[1][0]*c[1][0]),g=Math.sqrt(c[0][1]*c[0][1]+c[1][1]*c[1][1]),k=[[1/e,0,0],[0,1/g,0],
[0,0,1]],this.xformScaling?this.mtx=ia(f,this.mtx):(this.mtx=ia(c,k),this.center.x*=e,this.center.y*=g,this.width*=e,this.height*=g,this.elem.style.width=this.width+"px",this.elem.style.height=this.height+"px"),this.updateBoundingRect(),this._normalizePosition(null,null,{x:b,y:a}),b=this._map(this.mtx,{x:this.cx,y:this.cy});this.cx=b.x;this.cy=b.y};l.prototype._normalizePosition=function(b,a,c){var e=f.matrixPool,h=e.getMatrix3(this.mtx[0][0],this.mtx[0][1],0,this.mtx[1][0],this.mtx[1][1],0,this.mtx[2][0],
this.mtx[2][1],1),d=e.getMatrix3(0,0,0,0,0,0,0,0,0),g=h.m,k={x:0,y:0,width:this.width,height:this.height},n=this._mapRect(g,k),n=Xb(g)?k:this._mapRect(g,k);if(null===b)b=g;else{var m=d.m;m[0][0]=b[0][0]*g[0][0]+b[0][1]*g[1][0]+b[0][2]*g[2][0];m[0][1]=b[0][0]*g[0][1]+b[0][1]*g[1][1]+b[0][2]*g[2][1];m[0][2]=b[0][0]*g[0][2]+b[0][1]*g[1][2]+b[0][2]*g[2][2];m[1][0]=b[1][0]*g[0][0]+b[1][1]*g[1][0]+b[1][2]*g[2][0];m[1][1]=b[1][0]*g[0][1]+b[1][1]*g[1][1]+b[1][2]*g[2][1];m[1][2]=b[1][0]*g[0][2]+b[1][1]*g[1][2]+
b[1][2]*g[2][2];m[2][0]=b[2][0]*g[0][0]+b[2][1]*g[1][0]+b[2][2]*g[2][0];m[2][1]=b[2][0]*g[0][1]+b[2][1]*g[1][1]+b[2][2]*g[2][1];m[2][2]=b[2][0]*g[0][2]+b[2][1]*g[1][2]+b[2][2]*g[2][2];b=m}k=Xb(b)?k:this._mapRect(b,k);k=null===a?{x:k.x,y:k.y}:this._map(a,{x:k.x,y:k.y});a=null===a?c:this._map(a,c);this.mtx[0][2]=-n.x;this.mtx[1][2]=-n.y;this.mtx[2][2]=1;this.top=a.y-(k.y-n.y);this.left=a.x-(k.x-n.x);this.elem.style.top=this.top+"px";this.elem.style.left=this.left+"px";da(this.elem,Ha(this.mtx));this.updateBoundingRect();
e.free3(h);e.free3(d)};l.prototype.getParentBounds=function(b){b=this.getParentTransform(b);return this._mapRect(b,{x:0,y:0,width:this.width,height:this.height})};l.prototype._mapRect=function(b,a){a.right=a.x+a.width;a.bottom=a.y+a.height;a.top=a.y;a.left=a.x;var c=this._map(b,{x:a.left,y:a.top}),e=c.x,h=c.y,d=c.x,g=c.y,c=this._map(b,{x:a.right,y:a.top}),e=Math.min(e,c.x),h=Math.min(h,c.y),d=Math.max(d,c.x),g=Math.max(g,c.y),c=this._map(b,{x:a.right,y:a.bottom}),e=Math.min(e,c.x),h=Math.min(h,c.y),
d=Math.max(d,c.x),g=Math.max(g,c.y),c=this._map(b,{x:a.left,y:a.bottom}),e=Math.min(e,c.x),h=Math.min(h,c.y),d=Math.max(d,c.x),g=Math.max(g,c.y);return{x:e,y:h,width:d-e,height:g-h}};l.prototype.updateBoundingRect=function(){this.boundingRect=null};l.prototype._map=function(b,a){var c=f.matrixPool,e=c.getMatrix3x1(a.x,a.y,1),h=c.getMatrix3x1(0,0,0),d=h.m,g=e.m;d[0][0]=b[0][0]*g[0][0]+b[0][1]*g[1][0]+b[0][2]*g[2][0];d[1][0]=b[1][0]*g[0][0]+b[1][1]*g[1][0]+b[1][2]*g[2][0];d[2][0]=b[2][0]*g[0][0]+b[2][1]*
g[1][0]+b[2][2]*g[2][0];d={x:d[0][0],y:d[1][0]};c.free3x1(e);c.free3x1(h);return d};l.prototype.getParentWgt=function(){return this.parentWidget};l.prototype.getInvokablePropsList=function(){for(var b=l.prototype.invokablePropsList,a=this.invokablePropsList,c=0,e=b.length;c<e;c++){var h=b[c];-1==this.invokablePropsList.indexOf(h)&&(a=a.concat(h))}return a};l.prototype.getInvokableFunList=function(){for(var b=l.prototype.invokableFunList,a=this.invokableFunList,c=0,e=b.length;c<e;c++){var h=b[c];-1==
this.invokableFunList.indexOf(h)&&(a=a.concat(h))}return a};l.prototype.getPageMLTextMgr=function(){for(var b=!1,a=this.module;null!=a&&!b;){var c=this.project.getCWidgetMgr();if(c){if(b=c.hasGfxInheritance(a.ctype))break;a=a.module}else break}return b?a.getCWMLTextMgr():this.isTemplateWgt?this.parentPage.getTemplateMLTextMgr():this.parentPage.getPageMLTextMgr()};Va.prototype.getWidget=function(){return this.w};Va.prototype.addCallback=function(b){return this.cb.push(b)};Va.prototype.getCallbacks=
function(){return this.cb};l.prototype.subscribeWgt=function(b,a){b&&(void 0===this._subscriptions[b.wgtId]?this._subscriptions[b.wgtId]=new Va(b,a):this._subscriptions[b.wgtId].addCallback(a))};l.prototype.unsubscribeWgt=function(b){b&&delete this._subscriptions[b.wgtId]};l.prototype.sendNotification=function(b,a){for(var c in this._subscriptions)for(var e=this._subscriptions[c].cb,h=0,d=e.length;h<d;h++)e[h](b,a)};l.prototype.removeSubscriptions=function(){this._subscriptions={}};l.prototype.getAllSubscriptions=
function(){return this._subscriptions};l.prototype.getWidgetSubscribed=function(b){return this._subscriptions[b].getWidget()||null};l.prototype.hasSubscriptionFor=function(b){return null!=this._subscriptions[b.wgtId]};l.prototype.trigger=function(b,a){};l.prototype.updateLanguage=function(b){for(var a in this.wgts)this.ml&&this.wgts[a].updateLanguage()};l.prototype.unmountLinks=function(){for(var b in this.dataLinks)this.dataLinks[b].unmount()};l.prototype.mountLinks=function(){for(var b in this.dataLinks)this.dataLinks[b].mount()};
l.prototype.destroy=function(){if(this.destroyed)return!1;var b=this.wgts;if(b)for(var a in b)b[a].destroyed||b[a].destroy();delete f.renderingQueue[this.wgtId];this.elem&&(this.elem=null);this.wgtPos=this.wgtOffset=this.invMtxChain=this.js=null;this.unmountLinks();this.dataLinks={};this.removeAllActions();this.wgtsOrder=this.wgts=this._userValue=this.parentPage=this.parentWidget=null;return this.destroyed=!0};l.prototype.countDataLinks=function(){if(this.dataLinks){if("object"==typeof this.dataLinks)return Object.keys(this.dataLinks).length;
if(this.dataLinks.constructor==Array)return this.dataLinks.length}return 0};l.prototype._isNativeSelectCompatible=function(){var b=navigator.userAgent;return/Android/i.test(b)&&(/Chrome\/[.0-9]* (?!Mobile)/i.test(b)||/Chrome\/[.0-9]* Mobile/i.test(b))||/iPhone/i.test(b)||/iPad/i.test(b)?!1:null!=b.match(/webkit/i)||null!=b.match(/firefox/i)?!0:!1};l.prototype.isWgtEventsPreventDefault=function(){return!0};l.supportedEvents="onMousePress onMouseRelease onMouseClick onMouseHold onMouseHoldRepeat onMousePressRepeat onDataUpdate onActivate onDeactivate tonActivate tonDeactivate onDraw onMouseDrag".split(" ");
l.prototype.addAction=function(b,a){-1!=l.supportedEvents.indexOf(b)&&(this[b]?this[b].push(a):this[b]=[a],"tonActivate"==b?(this.isTemplateWgt=!0,this.tonActivate=this._registerJSAction(this.tonActivate),this.isTemplateWgt=!1):"tonDeactivate"==b?(this.isTemplateWgt=!0,this.tonDeactivate=this._registerJSAction(this.tonDeactivate),this.isTemplateWgt=!1):this[b]=this._registerJSAction(this[b]))};l.prototype.getActions=function(){for(var b={},a=0;a<l.supportedEvents.length;a++){var c=l.supportedEvents[a];
null!=this[c]&&(b[c]=this[c])}return b};l.prototype.invalidateMtxChain=function(){this.initInvMtxChain=!1;for(var b in this.wgts)this.wgts[b].initInvMtxChain=!1,this.wgts[b].wgts&&this.wgts[b].invalidateMtxChain()};l.prototype.saveInvMtxChain=function(b){this.invMtxChain=b.chain;this.wgtOffset=b.offset;this.wgtPos=b.pos;this.initInvMtxChain=!0};l.prototype.removeAllActions=function(){delete this.onMousePress;delete this.onMouseRelease;delete this.onMouseClick;delete this.onDataUpdate};l.prototype.saveValue=
function(b){var a=f.getActiveProject().projectName;if(Modernizr.localstorage){var c=window.localStorage.getItem("hmi");if(c)try{c=JSON.parse(c)}catch(e){c={}}else c={};c[a]||(c[a]={});if(null!=this[b]&&void 0!=typeof this[b])return c[a][this.wgtId]=this[b],window.localStorage.hmi=JSON.stringify(c),!0}return!1};l.prototype.loadValue=function(b){b=f.getActiveProject().projectName;if(Modernizr.localstorage)try{return JSON.parse(window.localStorage.getItem("hmi"))[b][this.wgtId]}catch(a){return null}else return null};
l.prototype.getDatalink=function(b){for(var a in this.dataLinks){var c=this.dataLinks[a];if(c.attr==b)return c}return null};l.prototype.getDataLinks=function(){return this.dataLinks};l.prototype.getDataLinksByDataSrc=function(b,a){for(var c in this.dataLinks){var e=this.dataLinks[c];e.dataSrcId===b.wgtId&&a.push(e)}if(null!=this.wgts)for(c in this.wgts)this.wgts[c].getDataLinksByDataSrc(b,a)};l.prototype.getAuthorizations=function(){return this.umgr?this.umgr.isSecurityEnabled()?this.umgr.getWidgetTreeAuthorizations(this):
this.umgr.getWidgetAuthorizationCodes().FULL:Pb.wgtAuth.FULL};l.prototype.ERROR_MSG={INIT_PRM:"Promise Widget Ready is not initialized"};l.prototype.resolveWgtReady=function(){throw this.ERROR_MSG.INIT_PRM;};l.prototype.rejectWgtReady=function(){throw this.ERROR_MSG.INIT_PRM;};l.prototype.initPromiseReady=function(){var b=this;this._prmWgtReady=new Promise(function(a,c){b.resolveWgtReady=a;b.rejectWgtReady=c})};l.prototype.waitWgtReady=function(){if(this._prmWgtReady)return this._prmWgtReady;throw this.ERROR_MSG.INIT_PRM;
};l.prototype.getHoldTime=function(){return this.project!==this&&-1==this.hT?this.project.getHoldTime():this.hT};l.prototype.getAutoRepeatPeriod=function(){return this.project!==this&&-1==this.aRT?this.project.getAutoRepeatPeriod():this.aRT};l.prototype.getAutoRepeatMode=function(){return this.aRM};l.prototype.load=function(){};l.prototype.unload=function(){};l.prototype.findJSFunction=function(b){var a=this[b];return void 0!==a?a:null!=this.parentWidget?this.parentWidget.findJSFunction(b):null};
l.prototype.setId=function(b){this.wgtId=b};l.prototype.getId=function(){return this.wgtId};l.prototype.getUserId=function(){return this.studioId};l.prototype.setAsVisible=function(b){this.elem&&(this.elem.style.display=b?"block":"none")};l.prototype.getLayout=function(){return!this.parentWidget||"GroupWgt"!=this.parentWidget.getJMType()&&"TableGroupWgt"!=this.parentWidget.getJMType()||null==this.parentWidget.getLayoutSize()?null:this.l[this.parentWidget.getLayoutSize()]};l.prototype.getOffsetTop=
function(){return 0};l.prototype.getOffsetLeft=function(){return 0};l.prototype.hasLayout=function(){return void 0!=this.l};l.prototype.getModule=function(){return void 0===this.module?null:this.module};l.prototype.getGraphicModule=function(){var b=this.project.getCWidgetMgr();if(b&&this.module){if(b.hasGfxInheritance(this.module.ctype))return this.module;if(this.parentWidget)return this.parentWidget.getGraphicModule()}return null};l.prototype.isModuleInstance=function(){return!1};l.prototype.resolveId=
function(b){if(null!=this.module){var a=this.getGraphicModule();if(a)return b.replace("*",a.studioId)}return b};l.prototype.getJMType=function(){return this.constructor.jmType};l.prototype.updateDataLink=function(b){};l.prototype.isCW=function(){var b=f.activeProject.getCWidgetMgr();return null!=this.ctype?b.isRegisteredModule(this.ctype)?!0:!1:!1};l.prototype.instantiateWgt=function(b,a,c){return new b({wgtId:null===c.ext?this.wgtId:this.wgtId+"."+c.ext},this.studioId,Object.assign({isClone:!0,protoWgtId:this.wgtId,
dataSourceProps:this.dataSourceProps},this.getOptions(),c),this.parentPage,a)};l.prototype.cloneDataLinks=function(b){if(null!=this.dataLinks)for(var a in this.dataLinks){var c=this.dataLinks[a];c.dataSrc&&c.dataSrc.isTableDataSource||$hmi.hmiAttach(b,c.dataSrcId,c.getOptions())}};l.prototype.cloneActions=function(b,a){var c=this.getActions(),e;for(e in c){var h=e,d=c[e],g;for(g in d){var k=d[g],f=k.getOptions();new k.constructor({wgtId:null==a.ext?k.wgtId:k.wgtId+"."+a.ext},h,f,b.parentPage,b)}}};
l.prototype.cloneWgt=function(b,a,c){b=this.instantiateWgt(this.constructor,b,c);this.cloneDataLinks(b);this.cloneActions(b,c);if(this.wgts&&!a)for(var e in this.wgts)null==b.wgts&&(b.wgts={}),this.wgts[e].cloneWgt(b,!1,c);return b};l.prototype.clone=function(b){var a=this.isCW();this.elem&&(Mb.setFragment(this.elem.cloneNode(!0)),Mb.changeFragmentIds(b.ext,a));b=this.cloneWgt(this.parentWidget,a,b);Mb.resetFragment();return b};l.prototype.executeActivationCallback=function(){return this.isWgtActive?
!1:!0};l.prototype.executeDeactivationCallback=function(){return this.isWgtActive?!0:!1};l.prototype.bindEvents=function(b,a){var c=null;null!=a?c=a:(c=this.parentPage.elem,this.isClone&&null!=this.tableGroupWgt&&(c=this.tableGroupWgt.elem));var e=f.getEventMgr(),h;for(h in b)e.on(c,h,b[h])};l.prototype.unbindEvents=function(b,a){var c=null;null!=a?c=a:(c=this.parentPage.elem,this.isClone&&null!=this.tableGroupWgt&&(c=this.tableGroupWgt.elem));var e=f.getEventMgr(),h;for(h in b)e.off(c,h,b[h])};l.prototype.deactivateWidgetPrototypes=
function(){this.unmountLinks();if(null!=this.wgts)for(var b in this.wgts)this.wgts[b].deactivateWidgetPrototypes()};l.prototype.getGridPosition=function(b){return null!=this.l?{rOcc:this.l[b].rOcc,cOcc:this.l[b].cOcc}:null};l.prototype.getRowSpan=function(b){return null!=this.l?this.l[b].rSpan:null};l.prototype.getColSpan=function(b){return null!=this.l?this.l[b].cSpan:null};l.prototype.setTextIds=function(b){this.mlIds=b};l.prototype.setCloneTextIds=function(b){this.clMLIds=b};l.prototype.getTextIds=
function(){return this.mlIds};l.prototype.getCloneTextIds=function(){return this.clMLIds};l.prototype.updateCloneMLIds=function(){this.clMLIds=[];if(this.mlIds)for(var b=0;b<this.mlIds.length;b++)this.clMLIds.push(this.ext+"-"+this.mlIds[b])};l.prototype.hasExportedDataLinks=function(){return null!=this.datalinks?!0:!1};l.prototype.hasDataSourceProp=function(b){return-1!==this.dataSourceProps.indexOf(b)?!0:!1};l.prototype.getSrcType=function(){var b;switch(this.studioId){case "_TagMgr":b="Tag";break;
case "_IndexedTagSetMgr":b="Alias";break;case "_RecipeMgr":b="Recipe";break;case "_SysPropMgr":b="Recipe";break;case "_MultiLangMgr":case "_VariablesWgt":case "_AlarmsMgr":case "_EventMgr":b="Widget"}return b};l.prototype.getWidgetType=function(){var b;switch(this.studioId){case "_TagMgr":case "_IndexedTagSetMgr":case "_RecipeMgr":case "_SysPropMgr":case "_MultiLangMgr":case "_VariablesWgt":case "_AlarmsMgr":case "_EventMgr":b="Project";break;default:b="Widget"}return b};l.prototype.hasGridLayout=
function(){return this.grid?!0:!1};l.prototype.getProject=function(){return f.getActiveProject()};l.prototype.isRoot=function(){return!1};l.prototype.updateStyle=function(b){};l.prototype.getDataLinks=function(){return this.dataLinks};l.prototype.constructor=l;f.addWidgetDefinition("hmiWidget",l);J.prototype=Object.create(l.prototype);J.prototype.constructor=J;J.prototype.showGrid=!0;J.prototype.cursorWidth=4;J.prototype.type=0;J.prototype.xanchor=0;J.prototype.yanchor=0;J.prototype.xspacing=0;J.prototype.yspacing=
0;J.prototype.cursorColor="rgb( 255, 0, 0 )";J.prototype._renderMask=0;J.prototype._renderFlags={GRID:2,CURSOR:4,UPDATEGRIDCANVAS:8,UPDATECRSCANVAS:16};J.jmType="GridWgt";J.prototype._initObjects=function(){this.gridGraph=new ja(this.elem.querySelector(".jm-trend_grid"),{width:this.width,height:this.height,minX:this.min||0,maxX:this.max||1E3,minY:this.y0||0,maxY:this.y1||100,xanchor:this.xanchor,yanchor:this.yanchor,xspacing:this.xspacing,yspacing:this.yspacing,gridX:this.gridX,gridY:this.gridY,colorX:this.colorX,
colorY:this.colorY});var b={width:this.width,height:this.height,xCursorShow:this.xCursorShow,yCursorShow:this.yCursorShow,yCursorPos:this.yCursorPos,cursorWidth:this.cursorWidth,cursorColor:this.cursorColor};this.trnWnd.isScatter()?this.cursorGraph=new W(this.elem.querySelector(".jm-trend_cursor"),b):this.cursorGraph=new P(this.elem.querySelector(".jm-trend_cursor"),b)};J.prototype.render=function(){l.prototype.render.call(this);this._renderMask&this._renderFlags.GRID&&(this.gridGraph.setGridX(this.gridX),
this.gridGraph.setGridY(this.gridY),this.gridGraph.setColorX(this.colorX),this.gridGraph.setColorY(this.colorY),this.showGrid&&this.gridGraph.drawBGGrid());if(this._renderMask&this._renderFlags.CURSOR){if(!this._initXCursor){var b=this.max-this.getTrendDuration()/2,a=null==this.yCursorPos?0:this.yCursorPos;this.cursorGraph.setXCursorPos(b);this.cursorGraph.setYCursorPos(a);this._initXCursor=!0}this.cursorGraph.drawCursor(!1)}this._renderMask&this._renderFlags.UPDATEGRIDCANVAS&&(this.gridGraph.updateSize(this.width,
this.height),this.gridGraph.clearCanvasContext(),this.gridGraph.drawBGGrid());this._renderMask&this._renderFlags.UPDATECRSCANVAS&&(this.cursorGraph.updateSize(this.width,this.height),this.cursorGraph.clearCanvasContext(),this.cursorGraph.drawCursor(!1));this._renderMask=0};J.prototype.setValue=function(b,a,c,e){e=!1;if(this.isBadValue(a,!1,c))return!1;switch(b){case "showGrid":this.showGrid!=a&&(this.showGrid=a,this._renderMask|=this._renderFlags.GRID,e=!0,this.sendUpdate(b,this.showGrid,c));break;
case "cursor_pos":this.xCursorPos!=a&&(this.xCursorPos=a,this.cursorGraph.setXCursorPos(this.xCursorPos),this._renderMask|=this._renderFlags.CURSOR,e=!0,this.sendUpdate(b,this.xCursorPos,c));break;case "ycursor_pos":this.yCursorPos!=a&&(this.yCursorPos=a,this.cursorGraph.setYCursorPos(this.yCursorPos),this._renderMask|=this._renderFlags.CURSOR,e=!0,this.sendUpdate(b,this.yCursorPos,c));break;case "min":this.min!=a&&(this.min=a,this.cursorGraph.setXMin(this.min),this._renderMask|=this._renderFlags.CURSOR,
e=!0,this.sendUpdate(b,this.min,c));break;case "max":this.max!=a&&(this.max=a,this.cursorGraph.setXMax(this.max),this._renderMask|=this._renderFlags.CURSOR,e=!0,this.sendUpdate(b,this.max,c));break;case "y0":this.y0!=a&&(this.y0=a,this.cursorGraph.setYMin(this.y0),this._renderMask|=this._renderFlags.CURSOR,e=!0,this.sendUpdate(b,this.y0,c));break;case "y1":this.y1!=a&&(this.y1=a,this.cursorGraph.setYMax(this.y1),this._renderMask|=this._renderFlags.CURSOR,e=!0,this.sendUpdate(b,this.y1,c));break;case "xanchor":this.xanchor!=
a&&(this.xanchor=a,this._renderMask|=this._renderFlags.CURSOR,e=!0,this.sendUpdate(b,this.xanchor,c));break;case "yanchor":this.yanchor!=a&&(this.yanchor=a,this._renderMask|=this._renderFlags.CURSOR,e=!0,this.sendUpdate(b,this.yanchor,c));break;case "xspacing":this.xspacing!=a&&(this.xspacing=a,this._renderMask|=this._renderFlags.CURSOR,e=!0,this.sendUpdate(b,this.xspacing,c));break;case "yspacing":this.yspacing!=a&&(this.yspacing=a,this._renderMask|=this._renderFlags.CURSOR,e=!0,this.sendUpdate(b,
this.yspacing,c));break;case "gridX":this.gridX!=a&&(this.gridX=a,this._renderMask|=this._renderFlags.GRID,e=!0,this.sendUpdate(b,this.gridX,c));break;case "gridY":this.gridY!=a&&(this.gridY=a,this._renderMask|=this._renderFlags.GRID,e=!0,this.sendUpdate(b,this.gridY,c));break;case "colorX":this.colorX!=a&&(this.colorX=a,this._renderMask|=this._renderFlags.GRID,e=!0,this.sendUpdate(b,this.colorX,c));break;case "colorY":this.colorY!=a&&(this.colorY=a,this._renderMask|=this._renderFlags.GRID,e=!0,this.sendUpdate(b,
this.colorY,c));break;default:l.prototype.setValue.call(this,b,a,c)}e&&f.addToRender(this)};J.prototype.getValue=function(b){switch(b){case "cursor_pos":return this.cursorGraph.getXPosition();case "ycursor_pos":return this.cursorGraph.getYPosition();case "cursor-show":return this.cursorGraph.isCursorVisible()}return l.prototype.getValue.call(this,b)};J.prototype.scrollTrendCursor=function(b,a,c){if(this.trnWnd.isScatter())this.cursorGraph.isVisible&&(b=this.cursorGraph.stepXY(b,c),this.xCursorPos=
b.xvalue,this._renderMask|=this._renderFlags.CURSOR,f.addToRender(this),this.updateXYCursorValue(b.xvalue,b.yoccurence));else{var e=this.getTrendDuration();a=0==a?e*c/100:1E3*c;b=this.getXCursor()+(1==b?-a:a);b<this.min&&(b=this.min);b>this.max&&(b=this.max);this.setValue("cursor_pos",b,null)}};J.prototype.setCursorVisibility=function(b){this.cursorGraph.setCursorVisibility(b);if(this.trnWnd.isInitialized()){var a=this.max-this.getTrendDuration()/2;b&&this.xCursorPos!=a?this.setValue("cursor_pos",
a,null):(this._renderMask|=this._renderFlags.CURSOR,f.addToRender(this))}this.trnWnd.isScatter()&&b&&(this.cursorGraph.resetXYCursor(),this.updateXYCursorValue(this.cursorGraph.getValueXY(),this.cursorGraph.getOccurenceXY()))};J.prototype.getXCursor=function(){return this.cursorGraph.getXPosition()};J.prototype.getYCursor=function(){return this.cursorGraph.getYPosition()};J.prototype.getTrendDuration=function(){return this.trnWnd.xPageSize};J.prototype.updateCursorGrid=function(){var b=this.parentWidget,
a=[],c;for(c in b.wgts){var e=b.wgts[c];e.constructor==S&&e.visible&&a.push(e)}this.cursorGraph.updateXYGrid(a);this.cursorGraph.isCursorVisible()&&(b=this.cursorGraph.getValueXY(),a=this.cursorGraph.getOccurenceXY(),void 0!==b&&void 0!==a&&this.updateXYCursorValue(b,a))};J.prototype.isCursorVisible=function(){return null!=this.cursorGraph?this.cursorGraph.isCursorVisible():!1};J.prototype.updateXYCursorValue=function(b,a){var c=this.parentWidget,e;for(e in c.wgts){var h=c.wgts[e];h.constructor==
S&&h.visible&&h.setXYCursorValue(b,a)}};J.prototype.setParentBounds=function(b,a,c,e,h){l.prototype.setParentBounds.call(this,b,a,c,e,h);this.updateOnResize()};J.prototype.updateOnResize=function(b){l.prototype.updateOnResize.call(b);this._renderMask=this._renderFlags.UPDATECRSCANVAS|this._renderFlags.UPDATEGRIDCANVAS;f.addToRender(this)};J.prototype.destroy=function(){if(this.destroyed)return!1;f.cache.setWgtProp(this.elem.id,"crsVisible",this.cursorGraph.isCursorVisible());f.cache.setWgtProp(this.elem.id,
"yCursorPos",this.xCursorPos);this.cursorGraph.clearCanvasContext();this.gridGraph.clearCanvasContext();this.cursorGraph=this.cursorGraph=null;return l.prototype.destroy.call(this)};f.fn.hmiGridWgt=function(b,a,c,e){return new J(this,b,a,c,e)};f.addWidgetDefinition("hmiGridWgt",J);aa.prototype=Object.create(l.prototype);aa.prototype.constructor=aa;aa.prototype.backgroundClass="bgColor00";aa.prototype.colors=["green","red"];aa.prototype.strokeColor="#FFF";aa.prototype.numStates=2;aa.prototype.disabled=
!1;aa.prototype._renderMask=0;aa.prototype._renderFlags={VALUE:1,STROKE:2};aa.jmType="IndicatorWgt";aa.prototype.render=function(){l.prototype.render.call(this);if(this._renderMask&this._renderFlags.VALUE){var b=Math.abs(parseInt(this.value)%this.numStates),b=this.colors[b],a=this.elem.getElementsByClassName(this.backgroundClass);0<a.length?a[0].style.fill?a[0].style.fill=b:a[0].setAttribute("fill",b):(a=this.elem.getElementsByTagName("svg"),0<a.length&&(a[0].style.fill=b));this.elem&&this.elem.setAttribute("data-c",
b)}this._renderMask&this._renderFlags.STROKE&&(this.elem.getElementsByTagName("path").style.stroke=this.strokeColor);this._renderMask=0};aa.prototype.setValue=function(b,a,c,e){if("value"==b||"frame"==b){if(this.isBadValue(a,!1,c))return!1;this.value!=a&&(this.value=a,this._renderMask|=this._renderFlags.VALUE,f.addToRender(this),this.sendUpdate(b,this.value,c))}else l.prototype.setValue.call(this,b,a,c,e)};aa.prototype.getValue=function(b){return"value"==b?this.curState:l.prototype.getValue.call(this,
b)};f.fn.hmiIndicator=function(b,a,c,e){return new aa(this,b,a,c,e)};f.addWidgetDefinition("hmiIndicator",aa);y.prototype=Object.create(l.prototype);y.prototype.constructor=y;y.prototype.backgroundClass="bgColor00";y.prototype.form="round";y.prototype.type=0;y.prototype.reverse=!1;y.prototype.min=0;y.prototype.max=100;y.prototype.startAngle=0;y.prototype.stopAngle=90;y.prototype.initAngle=180;y.prototype.value=0;y.prototype._clickOffset=null;y.prototype.dragging=0;y.prototype.discrete=0;y.prototype.opacity=
1;y.prototype.fill=null;y.prototype.stroke=null;y.prototype.disabled=!0;y.prototype.permission="rw";y.prototype.xformScaling=!0;y.prototype._renderMask=0;y.prototype._renderFlags={VALUE:1,FILL:2,STROKE:4,OPACITY:8,TOOLTIP:16,CREATETOOLTIP:32};y.prototype._mouseActionType={MOUSEDOWN:0,MOUSEMOVE:1,MOUSEUP:2};y.jmType="NeedleWgt";y.prototype.render=function(){l.prototype.render.call(this);this._renderMask&this._renderFlags.VALUE&&this.updateNeedle();this._renderMask&this._renderFlags.CREATETOOLTIP&&
this.renderToolTip();this._renderMask&this._renderFlags.TOOLTIP&&this.updateToolTip();this._renderMask&this._renderFlags.FILL&&$("."+this.backgroundClass,this.elem).css("fill",this.fill);this._renderMask&this._renderFlags.STROKE&&$("path",this.elem).attr("stroke",this.stroke);this._renderMask&this._renderFlags.OPACITY&&$("svg",this.elem).css("opacity",this.opacity);this._renderMask=0};y.prototype.renderToolTip=function(){if(this.parentPage&&(this.ndlToolTip=document.getElementById(this.parentPage.wgtId+
"_ndltooltip"),!this.ndlToolTip)){var b=document.createElement("div"),a=document.createElement("span");b.setAttribute("id",this.parentPage.wgtId+"_ndltooltip");b.setAttribute("style","position:absolute;font-family:arial;font-size:15px;width:15px;height:15px;top:0px;left:0px;display:none;");a.setAttribute("style","background-color:white;");b.appendChild(a);this.parentPage.elem&&(this.parentPage.elem.appendChild(b),this.ndlToolTip=b)}};y.prototype.handleEvent=function(){this.events={mousedown:!0,touchstart:!0}};
y.prototype.addDataLink=function(b){l.prototype.addDataLink.call(this,b);b.tgtWgt==this&&this.initDataLinkSideEffects(b,b.attr)};y.prototype.initDataLinkSideEffects=function(b,a){"value"==a&&(this.permission="rw"==b.rw||"w"==b.rw?"rw":"r")};y.prototype.updateNeedle=function(){this.value=this.value>this.max?this.max:this.value;this.value=this.value<this.min?this.min:this.value;var b=this.max-this.min;if(0==this.type){var a=this.initAngle-this.startAngle,b=0!=b?(this.stopAngle-this.startAngle)*(this.value-
this.min)/b:0,b=-a+b;da(this.image,"rotate("+b+"deg)");this.elem&&(this.elem.setAttribute("data-v",this.value),this.elem.setAttribute("data-a",b))}else 2==this.type?(a=this.width-this.imageW,b=0!=b?a*(this.value-this.min)/b:0,this.reverse&&(b=this.width-b-this.imageW),this.image.style.left=b+"px",this.elem&&(this.elem.setAttribute("data-v",this.value),this.elem.setAttribute("data-p",b))):1==this.type&&(a=this.height-this.imageH,b=0!=b?a*(this.value-this.min)/b:0,this.reverse&&(b=this.height-b-this.imageH),
this.image.style.top=b+"px",this.elem&&(this.elem.setAttribute("data-v",this.value),this.elem.setAttribute("data-p",b)))};y.prototype.updateToolTip=function(){var b=null,a=!1;if(1==this.wrMode){if(this._currMouseAction==this._mouseActionType.MOUSEDOWN||this._currMouseAction==this._mouseActionType.MOUSEMOVE)a=!0,b={x:0,y:0},this.ndlToolTip.style.display="block";this._currMouseAction==this._mouseActionType.MOUSEUP&&(this.ndlToolTip.style.display="none")}switch(this.type){case 0:a&&(b.x=this.width/2,
b.y=this.height/2);break;case 1:a&&(b.x=this.width,b.y=parseInt(this.image.style.top));break;case 2:a&&(b.x=parseInt(this.image.style.left),b.y=-1)}a&&this.drawToolTipItem(b)};y.prototype.drawToolTipItem=function(b){b=this.calculatePointsInPageCoordinates(b);b="translateX("+Math.round(b.x)+"px) translateY("+Math.round(b.y)+"px)";$(this.ndlToolTip).css({"-ms-transform":b,"-webkit-transform":b,transform:b});this.ndlToolTip.childNodes[0].textContent=this.value};y.prototype.calculatePointsInPageCoordinates=
function(b){var a=!1,c=!1;2==this.type&&2>this.parentWidget.top-15&&(b.y+=this.height,a=!0);1==this.type&&this.parentWidget.left>this.parentPage.width/2&&(b.x-=this.width,c=!0);b=Ka(this.mtxChain,[[b.x],[b.y],[1]]);2!=this.type||a||(b[1][0]-=15);1==this.type&&c&&(b[0][0]-=15);return{x:this.offsets.left+b[0][0],y:this.offsets.top+b[1][0]}};y.prototype.getParentsOffsets=function(){var b,a,c=this,e={top:0,left:0},h=!0;do if(b=isNaN(c.left)?0:c.left,a=isNaN(c.top)?0:c.top,Wb(c.mtx)&&(b*=this.mtxChain[0][0],
a*=this.mtxChain[1][1]),e.top+=a,e.left+=b,c=c.parentWidget,c.constructor==I||c.constructor==Ra)h=!1;while(h);return e};y.prototype.setValue=function(b,a,c){var e=!1,h="#000";if("value"==b){if(this.isBadValue(a,!1,c))return!1;a=parseFloat(a,!1,c);if(isNaN(a))return!1;a>this.max?a=this.max:a<this.min&&(a=this.min);this.value!=a?(this.value=a,this._renderMask|=this._renderFlags.VALUE,e=!0,this.sendUpdate(b,this.value,c)):1==this.wrMode&&this._currMouseAction==this._mouseActionType.MOUSEUP&&(this._renderMask|=
this._renderFlags.TOOLTIP,e=!0,this.sendUpdate(b,this.value,c))}else if("fill"==b)isNaN(a)?this.isBadValue(a,!0,c)?(this.fill=h,e=!0):this.fill!=a&&(0==a.indexOf("#")&&1<a.length&&8>=a.length&&(h=a),this.fill=h,e=!0,this.sendUpdate(b,this.fill,c)):(e=!0,this.fill=h),e&&(this._renderMask|=this._renderFlags.FILL);else if("stroke"==b)isNaN(a)&&(this.isBadValue(a,!0,c)?(this.stroke=h,e=!0):this.stroke!=a&&(0==a.indexOf("#")&&1<a.length&&8>=a.length&&(h=a),this.stroke=h,e=!0,this.sendUpdate(b,this.stroke,
c)),e&&(this._renderMask|=this._renderFlags.STROKE));else if("fill-opacity"==b){if(this.isBadValue(a,!1,c))return!1;a=parseFloat(a);0>a?a=0:1<a&&(a=1);this.opacity!=a&&(this.opacity=a,e=!0,this._renderMask|=this._renderFlags.OPACITY,this.sendUpdate(b,this.opacity,c))}else if("min"==b)a=parseFloat(a),this.min!=a&&(this.min=a,this.range=this.max-this.min,e=!0,this._renderMask|=this._renderFlags.VALUE,this.sendUpdate(b,this.min,c));else if("max"==b)a=parseFloat(a),this.max!=a&&(this.max=a,this.range=
this.max-this.min,e=!0,this._renderMask|=this._renderFlags.VALUE,this.sendUpdate(b,this.max,c));else if("numStates"==b){if(this.isBadValue(a,!1,c))return!1;h=parseInt(a);this.max!=this.min+h-1&&(this.max=a,this.range=this.max-this.min,e=!0,this._renderMask|=this._renderFlags.VALUE,this.sendUpdate(b,h,c))}else if("reverseScale"==b){if(this.isBadValue(a,!1,c))return!1;a=parseInt(a);this.reverse!=a&&(this.reverse=a,e=!0,this._renderMask|=this._renderFlags.VALUE,this.sendUpdate(b,this.reverse,c))}else"startAngle"==
b?this.startAngle!=a&&(0>a&&(a=0),this.startAngle=parseFloat(a),this.startAngle<=this.stopAngle&&(this._renderMask|=this._renderFlags.VALUE,e=!0)):"endAngle"==b||"stopAngle"==b?this.stopAngle!=a&&(360<a&&(a=360),this.stopAngle=parseFloat(a),this._renderMask|=this._renderFlags.VALUE,e=!0):l.prototype.setValue.call(this,b,a,c);e&&f.addToRender(this)};y.prototype.getValue=function(b){return"value"==b?this.value:this[b]?this[b]:l.prototype.getValue.call(this,b)};y.prototype.updateThumbPosition=function(b,
a){if(this.isBadValue(b,!1,a))return!1;b=parseFloat(b,!1,a);if(isNaN(b))return!1;b>this.max?b=this.max:b<this.min&&(b=this.min);this.value!=b?(this.value=b,this._renderMask=this._renderFlags.VALUE|this._renderFlags.TOOLTIP):this._renderMask|=this._renderFlags.TOOLTIP;f.addToRender(this)};y.prototype.doMouseDown=function(b,a){if(this.disabled||"r"==this.permission)return!1;if(this.umgr&&this.authCode==this.umgr.getWidgetAuthorizationCodes().RDONLY)return this.project.getValue("onAccessDenied")&&this.showHideAccessDeniedIcon(),
!1;this._currMouseAction=this._mouseActionType.MOUSEDOWN;this._currTargetId=b.wgt.wgtId;this.dragging=1;var c;1==this.wrMode&&(this.mtxChain=xc(this.elem),this.offsets=this.getParentsOffsets());1==this.type||2==this.type?(this._clickOffset={x:this.imageW/2,y:this.imageH/2},c={x:b.x-this._clickOffset.x,y:b.y-this._clickOffset.y},c=this._normValueFromMouseHV(c)):c=this._normValueFromMouseRound({x:b.x,y:b.y});1==this.wrMode?this.updateThumbPosition(c,null):(this.setValue("value",c,null),this.doWriteValue("value",
c))};y.prototype.doMouseUp=function(b,a){if(this.disabled||"r"==this.permission||this.umgr&&this.authCode==this.umgr.getWidgetAuthorizationCodes().RDONLY)return!1;this._currMouseAction=this._mouseActionType.MOUSEUP;this._currTargetId=null;this.dragging=0;1==this.wrMode&&(this.setValue("value",this.value,null),this.doWriteValue("value",this.value));this._clickOffset=null};y.prototype.doMouseMove=function(b,a){if(this.disabled||"r"==this.permission||this.umgr&&this.authCode==this.umgr.getWidgetAuthorizationCodes().RDONLY)return!1;
this._currMouseAction=this._mouseActionType.MOUSEMOVE;this.dragging=1;var c;1==this.type||2==this.type?(c={x:b.x-this._clickOffset.x,y:b.y-this._clickOffset.y},c=this._normValueFromMouseHV(c)):c=this._normValueFromMouseRound({x:b.x,y:b.y});1==this.wrMode?this.updateThumbPosition(c,null):(this.setValue("value",c,null),this._writeDraggingValues())};y.prototype._writeDraggingValues=function(){var b=this;null==this.draggingTimeOut&&(this.doWriteValue("value",b.value),this.draggingTimeOut=setTimeout(function(){b.doWriteValue("value",
b.value);b.draggingTimeOut=null},b.writeTagDelay))};y.prototype._normValueFromMouseHV=function(b){b=(1==this.type?b.y:b.x)/this.length;1<b?b=1:0>b&&(b=0);this.reverse&&(b=1-b);b=this.min+b*this.range;return 1==this.discrete?b.toFixed():b};y.prototype._normValueFromMouseRound=function(b){b=180*Math.atan2(this.cy-b.y,b.x-this.cx)/Math.PI;var a=0>this.startAngle?-180-this.startAngle:null;b=((a?-180<b&&b<a?-180-b:180-b:180-b)-this.startAngle)*this.range/(this.stopAngle-this.startAngle)+this.min;if(b<
this.min-.5||b>this.max+.5)b=this.value;this.discrete&&(b=Math.round(b));return b};y.prototype.destroy=function(){this.ndlToolTip=null;return l.prototype.destroy.call(this)};f.fn.hmiNeedle=function(b,a,c,e){return new y(this,b,a,c,e)};f.addWidgetDefinition("hmiNeedle",y);F.prototype=Object.create(l.prototype);F.prototype.constructor=F;F.prototype.visible=!0;F.prototype.pBuffer=null;F.prototype.min=0;F.prototype.max=1E3;F.prototype.y0=0;F.prototype.y1=100;F.prototype.y1=100;F.prototype.trendCurveType=
100;F.prototype._renderMask=0;F.prototype._renderFlags={UPDATECURVECANVAS:2};F.jmType="TrendCurveWgt";F.prototype.unload=function(){this.value=null;this.graph.clearData();this.clearCanvas()};F.prototype.getLineChartObj=function(b){this.graph=new E(b,{width:this.width,height:this.height,minX:this.min||0,maxX:this.max||1E3,minY:this.y0||0,maxY:this.y1||100,line:this.drawType,stroke:this.stroke,strokeWidth:this.strokeWidth},this)};F.prototype.createCurveCanvas=function(b){var a=document.createElement("canvas");
a.setAttribute("id",b);a.setAttribute("width",this.width);a.setAttribute("height",this.height);this.elem.appendChild(a)};F.prototype.updateCurveCanvasSize=function(){this.graph.updateSize(this.width,this.height)};F.prototype.updateCurveCanvasContainerSize=function(){this.graph.updateCanvasContainerSize(this.getParentBounds(this.parentWidget))};F.prototype.clearCanvas=function(){this.graph.clearCanvasContext()};F.prototype.renderCurve=function(){this.graph.drawCurve()};F.prototype.render=function(){l.prototype.render.call(this);
this._renderMask&this._renderFlags.UPDATECURVECANVAS&&(this.clearCanvas(),this.updateCurveCanvasContainerSize(),this.updateCurveCanvasSize());this._renderMask=0};F.prototype.updateHistoricGraph=function(){var b=this.trnWnd.startTime,a=this.trnWnd.endTime,c=this.trnWnd.width,e;if(null==this.pBuffer.getDeltaTime()||this.currPageDuration!=this.trnWnd.xPageSize)this.currPageDuration=this.trnWnd.xPageSize,0<c&&(e=parseInt(this.trnWnd.xPageSize/c),this.pBuffer.setDeltaTime(e));this.pBuffer.setHistoricParams(b,
a,c)};F.prototype.setValue=function(b,a,c,e){if(this.isBadValue(a,!1,c))return 0;switch(b){case "web-value":this.value==a||this.trnWnd.isOnPause()||(this.value=a,void 0!=this.value&&null!=this.value[this.value.length-1]&&this.elem.setAttribute("data-cv",this.value[this.value.length-1].y));break;case "Value":this.val!=a&&(this.val=a,this.sendUpdate(b,this.val,c));break;case "min":if(this.min!=a||this.trnWnd.forceUpdate())e=this.min,this.min=a,this.updateValues(),this.pBuffer&&e!=a&&this.updateHistoricGraph(),
this.sendUpdate(b,this.min,c);break;case "max":if(this.max!=a||this.trnWnd.forceUpdate())e=this.max,this.max=a,this.updateValues(),this.pBuffer&&e!=a&&this.updateHistoricGraph(),this.sendUpdate(b,this.max,c);break;case "y0":if(this.y0!=a||this.trnWnd.forceUpdate())this.y0=a,this.updateValues(),this.sendUpdate(b,this.y0,c);break;case "y1":if(this.y1!=a||this.trnWnd.forceUpdate())this.y1=a,this.updateValues(),this.sendUpdate(b,this.y1,c);break;case "drawType":this.drawType!=a&&(this.drawType=a,this.visible=
0>this.drawType||1<this.drawType?0:1,this.updateValues(),this.sendUpdate(b,this.drawType,c));break;case "visibility2":this.visible!=a&&(this.getAuthorizations()==this.umgr.getWidgetAuthorizationCodes().HIDE?this.visible=0:this.visible=0>a||1<a?1:a,this.updateValues(),this.sendUpdate(b,this.visible,c));break;case "cursor-value":this.cursorValue!=a&&(this.cursorValue=a,this.sendUpdate(b,this.cursorValue,c));default:l.prototype.setValue.call(this,b,a,c)}};F.prototype.updateMinMax=function(b,a){var c=
!1;this.min!=b&&(this.min=b,this.updateValues(),c=!0,this.sendUpdate("min",this.min,null));this.max!=a&&(this.max=a,c=!0,this.updateValues(),this.sendUpdate("max",this.max,null));c&&0==this.curveType&&this.updateHistoricGraph()};F.prototype.updateValues=function(){this.value&&0<this.value.length&&this.value[0]&&(this.graph.setXRange(this.min,this.max),this.graph.setYRange(this.y0,this.y1),this.graph.updateCurve(this.value,this.drawType,this.visible),this.trnWnd.isScatter()&&this.trnWnd.drawCurves(),
this.cursorTs=this.trnWnd.getValue("cursor-timestamp"))};F.prototype.getValue=function(b){switch(b){case "web-value":b=this.pBuffer?this.getArrayPointsFromSamples():this.value;break;case "Value":b=this.val;break;case "min":b=this.min;break;case "max":b=this.max;break;case "y0":b=this.y0;break;case "y1":b=this.y1;break;case "visibility2":b=this.visible;break;case "cursor-value":b=this.cursorValue;break;case "cursor-ts":b=this.cursorTs;break;default:b=l.prototype.getValue.call(this,b)}return b};F.prototype.getArrayPointsFromSamples=
function(){var b=[];if(this.value)for(var a=0;a<this.value.length;a++)b.push([this.value[a].x,this.value[a].y]);return b};F.prototype.addDataLink=function(b){l.prototype.addDataLink.call(this,b);this.initDataLinkSideEffects(b,b.attr)};F.prototype.initDataLinkSideEffects=function(b,a){b.dataSrc.constructor==Sb&&b.dataSrc.isHistoric()&&(this.pBuffer=b.dataSrc)};F.prototype.getSamplingTime=function(){if(this.pBuffer)return this.pBuffer.getTrendST()};F.prototype.getWindowMinMax=function(){return{wndStart:this.trnWnd.startTime,
wndEnd:this.trnWnd.endTIme}};F.prototype.refreshTrend=function(){this.trnWnd.isScatter()&&this.trnWnd.update();this.trnWnd.drawCurves()};F.prototype.setParentBounds=function(b,a,c,e,h){l.prototype.setParentBounds.call(this,b,a,c,e,h);this.updateOnResize()};F.prototype.updateOnResize=function(b){l.prototype.updateOnResize.call(b);this._renderMask=this._renderFlags.UPDATECURVECANVAS;f.addToRender(this)};F.prototype.destroy=function(){if(this.destroyed)return!1;this.trnWnd.unsubscribeWgt(this);this.graph.destroy();
this.value=null;this.unbindEvents({unloadWgt:this.deactivateHandler});return l.prototype.destroy.call(this)};f.fn.hmiTrendCurveWgt=function(b,a,c,e){return new F(this,b,a,c,e)};f.addWidgetDefinition("hmiTrendCurveWgt",F);S.prototype=Object.create(F.prototype);S.prototype.constructor=S;S.jmType="XYCurveWgt";S.prototype.load=function(){null==this.value&&(this.value=Array(this.maxLimit))};S.prototype.unload=function(){this.xvalue=this.yvalue=this.value=null;this.graph.clearData();this.clearCanvas()};
S.prototype.setValue=function(b,a,c,e){if(this.isBadValue(a,!1,c))return 0;switch(b){case "xvalue":this.xvalue!=a&&(this.xvalue=a,this.updateXYValue(),this.updateValues(),this.sendUpdate(b,this.xvalue,c));break;case "yvalue":this.yvalue!=a&&(this.yvalue=a,this.updateXYValue(),this.updateValues(),this.sendUpdate(b,this.yvalue,c));break;case "min":if(this.min!=a||this.trnWnd.forceUpdate())this.min=a,this.updateValues(),this.sendUpdate(b,this.min,c);break;case "max":if(this.max!=a||this.trnWnd.forceUpdate())this.max=
a,this.updateValues(),this.sendUpdate(b,this.max,c);break;case "y0":if(this.y0!=a||this.trnWnd.forceUpdate())this.y0=a,this.updateValues(),this.sendUpdate(b,this.y0,c);break;case "y1":if(this.y1!=a||this.trnWnd.forceUpdate())this.y1=a,this.updateValues(),this.sendUpdate(b,this.y1,c);break;default:l.prototype.setValue.call(this,b,a,c)}};S.prototype.getValue=function(b){switch(b){case "xvalue":b=this.xvalue;break;case "yvalue":b=this.yvalue;break;case "min":b=this.min;break;case "max":b=this.max;break;
case "y0":b=this.y0;break;case "y1":b=this.y1;break;case "cursor-value":b=this.cursorValue;break;case "cursor-ts":b=this.trnWnd.getGridWgt().getXCursor();break;default:b=l.prototype.getValue.call(this,b)}return b};S.prototype.updateXYValue=function(){var b=this.trnWnd.getGridWgt();if(this.xvalue&&this.yvalue){for(var a=Math.min(this.xvalue.length,this.maxLimit),c=0;c<a;c++)void 0!==this.yvalue[c]&&(void 0!==this.value[c]?(this.value[c].x=this.xvalue[c],this.value[c].y=this.yvalue[c]):this.value[c]=
new V(this.xvalue[c],this.yvalue[c],new va(192)));b.updateCursorGrid()}};S.prototype.setXYCursorValue=function(b,a){void 0!==this.value[this.idxSelectedSample]&&this.value[this.idxSelectedSample].select(!1);var c=this.xvalue.indexOf(b);if(-1!==c){var c=this._findIndex(b,c,a),e=this.yvalue[c];void 0==e&&(c=this.xvalue.lastIndexOf(b),e=this.yvalue[c]);this.idxSelectedSample=c;this.cursorValue=e;void 0!==this.value[this.idxSelectedSample]&&this.value[this.idxSelectedSample].select(!0)}else this.cursorValue=
"";this.trnWnd.setValue("cursor-timestamp",b,ua.prototype.QUALITY_GOOD);this.sendUpdate("cursor-value",this.cursorValue,ua.prototype.QUALITY_GOOD)};S.prototype._findIndex=function(b,a,c){var e=this.xvalue,h=a;a+=1;for(var d=e.length;a<d&&0<c;a++)e[a]==b&&(c--,h=a);return h};S.prototype.resetCursorValue=function(){void 0!==this.value[this.idxSelectedSample]&&(this.value[this.idxSelectedSample].select(!1),this.idxSelectedSample=void 0);this.cursorValue="";this.sendUpdate("cursor-value",this.cursorValue,
ua.prototype.QUALITY_GOOD);this.trnWnd.setValue("cursor-timestamp","",ua.prototype.QUALITY_GOOD)};S.prototype.addDataLink=function(b){l.prototype.addDataLink.call(this,b)};S.prototype.destroy=function(){l.prototype.unbindEvents.call(this,{loadWgt:this.activateHandler});return F.prototype.destroy.call(this)};f.fn.hmiXYCurveWgt=function(b,a,c,e){return new S(this,b,a,c,e)};f.addWidgetDefinition("hmiXYCurveWgt",S);Ia.prototype=Object.create(l.prototype);Ia.prototype.constructor=Ia;Ia.jmType="RecipeWgt";
f.fn.hmiRecipeWgt=function(b,a,c,e){return new Ia(this,b,a,c,e)};f.addWidgetDefinition("hmiRecipeWgt",Ia);var p=this&&this.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,a){c.__proto__=a}||function(c,a){for(var b in a)a.hasOwnProperty(b)&&(c[b]=a[b])};return b(a,c)};return function(a,c){function e(){this.constructor=a}b(a,c);a.prototype=null===c?Object.create(c):(e.prototype=c.prototype,new e)}}(),Oa=this&&this.__assign||function(){Oa=
Object.assign||function(b){for(var a,c=1,e=arguments.length;c<e;c++){a=arguments[c];for(var h in a)Object.prototype.hasOwnProperty.call(a,h)&&(b[h]=a[h])}return b};return Oa.apply(this,arguments)},fa;(function(b){b[b.RECIPE=2]="RECIPE";b[b.SET=3]="SET";b[b.ELEM=4]="ELEM"})(fa||(fa={}));var hc=function(b){function a(c,a,h,d,g){var k=b.call(this,c.wgtId,a,h,d,g)||this;k.setDefaultState();if(!f.enablePjctWidgetServerReq)return k;f.isTestModeActive()||k.parentWidget.waitWgtReady().then(function(){k.srv=
k.project.getCommunticationObj();k.srv.getRecipeList(!1).then(function(c){null!=c&&0!=c.length&&(k.recipeList=c.join(","),k.srv.getRecipeParams("curRecipe","all",!1).then(function(c){k.curRecipe=c;k.srv.subscribeRecipe("curRecipe",function(c,a){k.onCurrRecipeUpdate(c,a)});k._usedInCurrPage?k.srv.setRecipeNotificationRate(k._ACTIVE_POLL):k.srv.setRecipeNotificationRate(k._IDLE_POLL);k._firstUpdate()}))}).catch(function(){k.core.getAction("hmiActionShowMessage").execute(null,{msg:"Error loading recipes configuration. Reloading..."},
3);setTimeout(function(){this.project.getCommunticationObj().loadIndex()},2E3)})});return k}p(a,b);a.prototype.setDefaultState=function(){this.recipeList=void 0!==this.recipeList?this.recipeList:"";this.curRecipeSetList=void 0!==this.curRecipeSetList?this.curRecipeSetList:[];this.curRecipeSet=void 0!==this.curRecipeSet?this.curRecipeSet:null;this.curRecipe=void 0!==this.curRecipe?this.curRecipe:null;this.curSelRecipeSet=void 0!==this.curSelRecipeSet?this.curSelRecipeSet:null;this.enSub=void 0!==this.enSub?
this.enSub:{};this._IDLE_POLL=void 0!==this._IDLE_POLL?this._IDLE_POLL:8E3;this._ACTIVE_POLL=void 0!==this._ACTIVE_POLL?this._ACTIVE_POLL:1500;this._usedInCurrPage=void 0!==this._usedInCurrPage?this._usedInCurrPage:!1;this._isRemoteSrc=void 0!==this._isRemoteSrc?this._isRemoteSrc:!1;this._baseProps=void 0!==this._baseProps?this._baseProps:["recipeList","curRecipeSetList","curRecipeSet","curRecipe"]};a.prototype.getValue=function(c){if("curRecipe"==c)return this.curRecipe?this.curRecipe.id:void 0;
if("recipeList"==c)return this.recipeList;if("curRecipeSetList"==c)return this.curRecipe?this.curRecipe.RecipeSetList:void 0;if("curRecipeSet"==c)return this.curRecipe?this.curRecipe.selSet:void 0;var a=c.split("."),b=a[a.length-1];if(this.enSub[c])return this.enSub[c].obj[b];if(this.core.initPageLogic)return null;c=a.length;var d,g;c==fa.RECIPE&&(d=this.srv.getRecipeParam(a[0],b,!0),g=d.err,d=d.v);c==fa.SET&&(d=this.srv.getRecipeSetParam(a[0],a[1],b,!0),g=d.err,d=d.v);c==fa.ELEM&&(d=this.srv.getRecipeElemParam(a[0],
a[1],a[2],b,!0),g=d.err,d=d.v);g&&this.core.notifyWarning("Recipe Manager","REST status:"+g);return d};a.prototype.setValue=function(c,a,b,d){b=!1;d=u.getModule("Tag");if("curRecipe"==c)this.curRecipe.id!=a&&(this.curRecipe.id=a,this._isRemoteSrc||this.srv.setCurrentRecipe(this.curRecipe.id,null,!1),b=!0);else if("curRecipeSetList"==c)this.curRecipe.RecipeSetList!=a&&(this.curRecipe.RecipeSetList=a,b=!0);else if("curRecipeSet"==c)this.curRecipe.selSet!=a&&(this.curRecipe.selSet=a,this._isRemoteSrc||
this.srv.setCurrentRecipe(this.curRecipe.id,this.curRecipe.selSet,!1),b=!0);else if("recipeList"==c)this.recipeList!=a&&(this.recipeList=a,b=!0);else{if(!c)return;var g=c.split("."),k=g.length,f=g[k-1];if(this.enSub[c]&&this.enSub[c].en){var m=this.enSub[c],k=m.type;a instanceof Kb&&(a=a[f]);void 0!=a&&m.obj[f]!=a&&(m.obj[f]=a,b=!0)}else b=!0;!this._isRemoteSrc&&b&&(k==fa.RECIPE&&this.srv.setRecipeParam(g[0],a,!1),k==fa.SET&&(this.srv.setRecipeSetParam(g[0],g[1],f,a,!1),g[0]==this.curRecipe.id&&this.sendUpdate("curRecipeSet",
a,d.QUALITY_GOOD)),k==fa.ELEM&&this.srv.setRecipeElemParam(g[0],g[1],g[2],f,a,!1))}b&&this.sendUpdate(c,a,d.QUALITY_GOOD)};a.prototype.subscribeDataLink=function(c){b.prototype.subscribeDataLink.call(this,c);var a=c.tag.split("."),h=a.length;c=c.tag;this._usedInCurrPage||(this._usedInCurrPage=!0,this.srv.setRecipeNotificationRate(this._ACTIVE_POLL));if(-1==this._baseProps.indexOf(c)){var d=this;this.enSub[c]&&this.enSub[c].en||(this.enSub[c]={en:!0,type:h},h==fa.RECIPE?("RecipeSetList"==a[1]?this.srv.subscribeRecipeSetList(a[0],
function(c,a){d.onDataUpdate(c,a)}):this.srv.subscribeRecipe(a[0],function(c,a){d.onDataUpdate(c,a)}),this.enSub[c].obj=new ha):h==fa.SET?(this.srv.subscribeRecipeSet(a[0],a[1],function(c,a){d.onDataUpdate(c,a)}),this.enSub[c].obj=new oa):h==fa.ELEM&&(this.srv.subscribeRecipeSetElem(a[0],a[1],a[2],function(c,a){d.onDataUpdate(c,a)}),this.enSub[c].obj=new ta))}};a.prototype.onCurrRecipeUpdate=function(c,a){var b=u.getModule("Tag");this._isRemoteSrc=!0;this.setValue("curRecipe",a.id,b.QUALITY_GOOD);
void 0!=a.RecipeSetList&&this.setValue("curRecipeSetList",a.RecipeSetList,b.QUALITY_GOOD);void 0!=a.selSet&&this.setValue("curRecipeSet",a.selSet,b.QUALITY_GOOD);void 0!=a.rcList&&this.setValue("recipeList",a.rcList,b.QUALITY_GOOD);this._isRemoteSrc=!1};a.prototype.onDataUpdate=function(c,a){var b=u.getModule("Tag");this._isRemoteSrc=!0;this.setValue(c,a,b.QUALITY_GOOD);this._isRemoteSrc=!1};a.prototype._firstUpdate=function(){for(var c=u.getModule("Tag"),a=this._baseProps,b=0,d=a.length;b<d;b++)this.sendUpdate(a[b],
this.getValue(a[b]),c.QUALITY_GOOD)};a.prototype.onPageChange=function(){if(this.srv){this.srv.setRecipeNotificationRate(this._IDLE_POLL);this._usedInCurrPage=!1;for(var c in this.enSub){var a=c.split("."),b=a.length;this.enSub[c]&&this.enSub[c].en&&(b==fa.RECIPE?"RecipeSetList"==a[1]?this.srv.unsubscribeRecipeSetList(a[0]):this.srv.unsubscribeRecipe(a[0]):b==fa.SET?this.srv.unsubscribeRecipeSet(a[0],a[1]):b==fa.ELEM&&this.srv.unsubscribeRecipeSetElem(a[0],a[1],a[2]),this.enSub[c].en=!1)}}};a.jmType=
"RecipeMgrWgt";return a}(l);f.fn.hmiRecipeMgr=function(b,a,c,e){return new hc(this,b,a,c,e)};f.addWidgetDefinition("hmiRecipeMgr",hc);var Gb;(function(b){b[b.DOWN=0]="DOWN";b[b.UP=1]="UP"})(Gb||(Gb={}));var Lc=function(b){function a(c,a,h,d,g,k,f){var m=b.call(this)||this;m.dropDir=Gb.DOWN;m.widget=c;m.inputType=a;m.format=h;m.browserInputSupport=f;m.valueFormat=g;if(k.getElementById("jm-kpd"))m.keyboard=null;else{c=void 0;switch(a){case "datetime":a=-1!=h.indexOf("M")||-1!=h.indexOf("d")||-1!=h.indexOf("y");
h=-1!=h.indexOf("s")||-1!=h.indexOf("h")||-1!=h.indexOf("m");c=m.createKeyboardDateTimeContainer({input:m.createDateTimeInput(d,a,h),save:m.createSaveButton(),cancel:m.createCancelButton()},f);break;default:c=m.createKeyboardContainer({input:m.createStandardInput("jm-nField",a,m.format,d),save:m.createSaveButton(),cancel:m.createCancelButton()})}m.keyboard=c;m.setVerticalAlignment();m.setPosition();m.appendChildren()}return m}p(a,b);a.prototype.createStandardInput=function(c,a,b,d){var g=document.createElement("div"),
k=document.createElement("input");k.setAttribute("name","nField");k.setAttribute("id",c);k.setAttribute("autocapitalize","off");k.setAttribute("autofocus","");""==b&&k.setAttribute("type",a);k.style.width=this.widget.elem.style.width;k.style.color="#383838";k.style.backgroundColor="#dfdfde";k.style.font=this.widget.elem.style.font;k.style.fontSize=this.widget.elem.style.fontSize;k.style.textAlign=this.widget.elem.style.textAlign;k.setAttribute("value",d?d.trim():"");"time"==this.inputType&&-1!=this.format.toLowerCase().indexOf("ss")&&
k.setAttribute("step","1");g.appendChild(k);return g};a.prototype.createDTInput=function(c,a,b){var d=document.createElement("input");d.setAttribute("name",c);d.setAttribute("id",c);d.setAttribute("class",c);d.setAttribute("autocapitalize","off");d.setAttribute("autofocus","");d.setAttribute("type",a);d.style.width=this.widget.elem.style.width;d.style.color="#383838";d.style.backgroundColor="#efefe7";d.style.font=this.widget.elem.style.font;d.style.fontSize=this.widget.elem.style.fontSize;d.style.textAlign=
this.widget.elem.style.textAlign;d.style.top="0px";d.style.boxSizing="border-box";d.style.border="0px";d.setAttribute("value",b?b.trim():"");"time"==this.inputType&&-1!=this.format.toLowerCase().indexOf("ss")&&d.setAttribute("step","1");return d};a.prototype.createCustomDTInput=function(c,a,b,d){var g=document.createElement("div");g.setAttribute("id",c);g.setAttribute("class",c);g.setAttribute("style","display:inline-block;width:"+d.width+"px;height:"+d.width+"px;");var k;"date"==a?(k=b.split("-"),
k=[{value:k[0],min:1970,max:NaN},{value:k[1],min:1,max:12},{value:k[2],min:1,max:31}]):"time"==a&&(k=b.split(":"),k=[{value:k[0],min:0,max:24},{value:k[1],min:0,max:59},{value:k[2],min:0,max:59}]);if(void 0!=k)for(d="width:"+d.width/k.length+"px;height:"+d.height+"px;font-size:"+this.widget.getValue("fontSize")+"px;box-sizing:border-box",c=0;c<k.length;c++)a=k[c],b=document.createElement("input"),b.setAttribute("type","number"),b.setAttribute("value",a.value),b.setAttribute("style",d),NaN!=a.min&&
b.setAttribute("min",a.min.toString()),NaN!=a.max&&b.setAttribute("max",a.max.toString()),g.appendChild(b);return g};a.prototype.creatDateInput=function(c,a,b,d){var g=document.createElement("div");g.style.backgroundColor="#efefe7";g.style.display="flex";g.style.width=a.width+b+"px";g.style.height=a.height+"px";var k=document.createElement("div");k.style.height=b+"px";k.style.width=b+"px";k.style.display="inline-block";var f=document.createElement("div");f.setAttribute("class","jm-calendar");f.style.height=
b-d+"px";f.style.width=b-d+"px";f.style.margin=d/2+"px";g.style.borderRadius="2px";k.appendChild(f);g.appendChild(k);this.browserInputSupport.date?g.appendChild(this.createDTInput("jm-nFiledDate","date",c)):g.appendChild(this.createCustomDTInput("jm-nFiledDate","date",c,a));return g};a.prototype.createTimeInput=function(c,a,b,d){var g=document.createElement("div");g.style.backgroundColor="#efefe7";g.style.display="flex";g.style.width=a.width+b+"px";g.style.height=a.height+"px";var k=document.createElement("div");
k.style.height=b+"px";k.style.width=b+"px";k.style.display="inline-block";var f=document.createElement("div");f.setAttribute("class","jm-clock");f.style.height=b-d+"px";f.style.width=b-d+"px";f.style.margin=d/2+"px";g.style.borderRadius="2px";k.appendChild(f);g.appendChild(k);this.browserInputSupport.time?g.appendChild(this.createDTInput("jm-nFiledTime","time",c)):g.appendChild(this.createCustomDTInput("jm-nFiledTime","time",c,a));return g};a.prototype.createDateTimeInput=function(c,a,b){c=c.split(" ");
var d=c[0],g=c[1],k=parseFloat(this.widget.elem.style.width),f=parseFloat(this.widget.elem.style.height),m=this.dateTimeIconSize=10<f?f:20,r=c=0,l=document.createElement("div");a&&(a=this.creatDateInput(d,{width:k,height:f},m,10),l.appendChild(a),c=parseInt(a.style.width),r=parseInt(a.style.height));b&&(b=this.createTimeInput(g,{width:k,height:f},m,10),l.appendChild(b),c=c<parseInt(b.style.width)?parseInt(b.style.width):c,r=0!=r?r+parseInt(b.style.height):parseInt(b.style.height));l.style.width=c+
"px";l.style.height=r+"px";return l};a.prototype.createSaveButton=function(){var c=document.createElement("button");c.setAttribute("type","button");c.setAttribute("class","positive");c.setAttribute("name","save");c.setAttribute("id","jm-save");var a=document.createElement("div");a.setAttribute("class","jm-img jm-saveimg");c.appendChild(a);c.appendChild(document.createTextNode("Save"));c.style.width="80px";c.style.height="30px";return c};a.prototype.createCancelButton=function(){var c=document.createElement("button");
c.setAttribute("type","button");c.setAttribute("class","negative");c.setAttribute("name","discard");c.setAttribute("id","jm-discard");var a=document.createElement("div");a.setAttribute("class","jm-img jm-cancelimg");c.appendChild(a);c.appendChild(document.createTextNode("Cancel"));c.style.width="80px";c.style.height="30px";return c};a.prototype.appendChildren=function(){this.dropDir===Gb.UP?(this.keyboard.appendChild(this.save),this.keyboard.appendChild(this.cancel),this.keyboard.appendChild(this.input)):
(this.keyboard.appendChild(this.input),this.keyboard.appendChild(this.save),this.keyboard.appendChild(this.cancel))};a.prototype.setVerticalAlignment=function(){var c=0,a=this.widget.getVerticalAlignment(),b=parseFloat(this.widget.elem.style.fontSize),d=parseFloat(this.widget.elem.style.height);"middle"===a?c=d/2-b/2:"bottom"===a&&(c=d-b);this.keyboard.style.marginTop=c+"px"};a.prototype.moveKeyboardInsidePage=function(c){var a=this.keyboard,b=parseFloat(a.style.left),d=parseFloat(a.style.top);f.getFocusPage();
var g=parseFloat(a.style.width),k=parseFloat(a.style.height),g=c.width-(b+g);0>g&&(g=b+g,a.style.left=(0>g?0:g)+"px");c=c.height-(d+k);0>c&&(d+=c,a.style.top=(0>d?0:d)+"px",this.dropDir=Gb.UP);0>b&&(a.style.left="0px")};a.prototype.setPosition=function(){for(var c=this.widget,a=this.widget.parentWidget,b=c.left,d=c.top;!(a==c||a instanceof I||a instanceof Ra);){var g=a.left||0,k=a.top||0,f=0,m=0;a instanceof Na&&a.hasGridLayout()&&(f=a.getXScrollPosition(),c.isInHeader||(m=a.getYScrollPosition(),
a instanceof Ea&&(d+=a.getHeaderHeight())),d+=a.getGlobalStrokeWidth(),b+=a.getGlobalStrokeWidth());d-=m;b-=f;d+=k;b+=g;a=a.parentWidget}this.keyboard.style.left=b+"px";this.keyboard.style.top=d+"px";this.moveKeyboardInsidePage(a)};a.prototype.createKeyboardContainer=function(c){var a=document.createElement("div");a.setAttribute("id","jm-kpd");a.setAttribute("data-wgtid",this.widget.wgtId);f.browserOptimizations.forceLayers&&a.setAttribute("class","jm-hacklayer");this.input=c.input;this.save=c.save;
this.cancel=c.cancel;a.style.width=Math.max(this.widget.width,2*parseFloat(this.save.style.width)+10)+"px";a.style.height=this.widget.height+parseFloat(this.save.style.height)+10+"px";return a};a.prototype.createKeyboardDateTimeContainer=function(c,a){var b=this.createKeyboardContainer(c),d=parseFloat(c.input.style.width);b.style.width=Math.max(d,2*parseFloat(this.save.style.width)+10)+"px";b.style.height=parseInt(c.input.style.height)+parseInt(c.save.style.height)+10+"px";return b};a.prototype.show=
function(){null!==this.keyboard&&(f.getFocusPage().elem.appendChild(this.keyboard),f.getInputManager().disableMouse())};a.prototype.onSave=function(c){if("datetime"==this.inputType)this.onSaveDateTime(c);else this.onSaveStandard(c)};a.prototype.onSaveStandard=function(c){if(this.keyboard){var a=$("#jm-nField"),b=a.attr("type");this.keyboard.querySelector("#jm-save").addEventListener("click",function(){c(b,a.val())})}};a.prototype.getDateTimeFormCustomField=function(c,a){for(var b=c.getElementsByTagName("input"),
d=Array(3),g=0,k=b.length;g<k;g++)d[g]=b.item(g).value;return d.join(a)};a.prototype.onSaveDateTime=function(c){var a=this;if(this.keyboard){var b=this.keyboard.querySelector("#jm-nFiledDate"),d=this.keyboard.querySelector("#jm-nFiledTime");this.keyboard.querySelector("#jm-save").addEventListener("click",function(){var g,k;a.browserInputSupport.date?b&&(g=b.value):g=a.getDateTimeFormCustomField(b,"-");a.browserInputSupport.time?d&&(k=d.value):k=a.getDateTimeFormCustomField(d,":");c(a.inputType,{date:g,
time:k})})}};a.prototype.onCancel=function(c){this.keyboard&&this.keyboard.querySelector("#jm-discard").addEventListener("click",c)};a.prototype.onKeyUp=function(c){if(this.keyboard)if("datetime"==this.inputType){var a=this.keyboard.querySelector("#jm-nFiledDate");a&&a.addEventListener("keyup",c);(a=this.keyboard.querySelector("#jm-nFiledTime"))&&a.addEventListener("keyup",c)}else this.keyboard.querySelector("#jm-nField").addEventListener("keyup",c)};a.prototype.hide=function(){if(this.keyboard){var c=
this.keyboard.parentNode;c&&c.removeChild(this.keyboard);f.getInputManager().enableMouse()}this.keyboard=null};a.remove=function(){var c=document.getElementById("kpd");if(c){var a=c.parentNode;a&&a.removeChild(c)}};return a}(function(){function b(){}b.prototype.getHTML=function(){return this.keyboard};b.prototype.show=function(){};b.prototype.hide=function(){};b.prototype.onSave=function(a){};b.prototype.onCancel=function(a){};b.prototype.onKeyUp=function(a){};return b}()),Mc=function(){function b(a,
c){this.document=a;this.browserInputSupport=c}b.prototype.createKeyboard=function(a,c,b,h,d){return new Lc(a,c,b,h,d,this.document,this.browserInputSupport)};b.destroyAllKeyboards=function(){Lc.remove()};return b}();(function(b){b[b.NONE=0]="NONE";b[b.FITSIZE=1]="FITSIZE";b[b.FITPAGETOSCREENSIZE=2]="FITPAGETOSCREENSIZE"})(O||(O={}));(function(b){b[b.NORMAL=0]="NORMAL";b[b.PRECACHE=1]="PRECACHE"})(ka||(ka={}));I=function(b){function a(c,e,h,d){e=b.call(this,c.wgtId,e,h,null,null)||this;e.setDefaultState();
e.isCached=!1;e.invokablePropsList=["id","Id"];e.dialog=0;e.sFactor=0;e.callbacks={};e.loadMode=1===d?ka.PRECACHE:ka.NORMAL;e.constructor==a&&(f.setProjectReady(),f.setCurrentPage(e),(d=f.getActiveProject().getPageMgr())&&e.loadMode==ka.NORMAL&&(f.setActivePage(e),d&&!d.isCurrentPageDefined()&&d.setCurrentPageFromName(e.wgtId)));e.project=f.getActiveProject();f.addWidget(c.wgtId,e);e.elem&&null!=e.project&&(c=e.elem.style.backgroundColor,e.backgroundColor=c,2==e.project.getValue("bgColorOption")&&
e.getId()==f.getActivePage().getId()&&(d=u.getModule("Quality"),e.project.setValue("color",c,new d(192))));e.templateWebId&&(e.templatePagePrefix=e.templateWebId.split("_")[0]);e.cntMtx=[[1,0,0],[0,1,0],[0,0,1]];e.left=0;e.top=0;e.mtx||(e.mtx=[[1,0,0],[0,1,0],[0,0,1]]);0==f.mode&&e.constructor==a&&e.executeOnDemandFitToScreenSizeModality();e.elem&&e.loadFontsFace();f.activeProject&&(e.sysVars=f.activeProject.getWidget("_SysPropMgr",!0));e.ml=!0;e.linksList={};e.loadMode==ka.NORMAL&&(f.setFocusPage(e),
f.mouseMgr.loseFocus());return e}p(a,b);a.prototype.setDefaultState=function(){this.visible=void 0!==this.visible?this.visible:!1;this.fitCssTransform=void 0!==this.fitCssTransform?this.fitCssTransform:"";this.bgColor=void 0!==this.bgColor?this.bgColor:"";this.xPageOffset=void 0!==this.xPageOffset?this.xPageOffset:0;this.yPageOffset=void 0!==this.yPageOffset?this.yPageOffset:0;this.resizeTimer=void 0!==this.resizeTimer?this.resizeTimer:null;this.resizeDialogTimer=void 0!==this.resizeDialogTimer?this.resizeDialogTimer:
null;this.templateWebId=void 0!==this.templateWebId?this.templateWebId:null;this.backgroundColor=void 0!==this.backgroundColor?this.backgroundColor:null;this.mlPage=void 0!==this.mlPage?this.mlPage:null;this.exportedLang=void 0!==this.exportedLang?this.exportedLang:this.project.getMultiLanguageMgr().getCurrentLanguage()};a.prototype.pageactivate=function(){this.onActivateActions();if(this.constructor==a&&(this.isCached&&f.activeProject.getWidget("_TagMgr",!0).subscribePageGroups(f.getActivePage().wgtId),
this.isCached&&this.constructor==a&&this.executeOnDemandFitToScreenSizeModality(),"changepassword"==this.studioId)){var c=f.activeProject.getWidget("_UserGroupMgr",!0);c.clearAll();c.checkMessages()}if(this.isCached){for(var b in this.linksList)this.linksList[b].update(),this.linksList[b].mount();this.project.subscribeDynamicTags()}this.constructor==a&&f.activeProject.activateDialogs()};a.prototype.load=function(){this.pageactivate()};a.prototype.pagedeactivate=function(){var c=f.activeProject.getWidget("_IndexedTagSetMgr",
!0);f.activeProject.getWidget("_TagMgr",!0).unsubscribePageGroups(this.wgtId);null!=c&&c.unsubscribePageGroups(this.wgtId);f.activeProject.off("resize.page");this.unmountDataLinks();this.visible=!1;this.tOnDeActivateActions();this.onDeActivateActions();this.executeActions()};a.prototype.unload=function(){this.pagedeactivate()};a.prototype.registerLink=function(c){this.isCached||(this.linksList[c.getId()]=c)};a.prototype.unregisterLink=function(c){delete this.linksList[c.getId()]};a.prototype.unmountDataLink=
function(c){this.linksList[c.getId()].unmount()};a.prototype.unmountDataLinks=function(){for(var c in this.linksList)this.linksList[c].unmount()};a.prototype.destroy=function(){b.prototype.destroy.call(this);clearTimeout(this.resizeTimer);this.mlPage=this.mlTemplate=null;f.getWidgets()[this.wgtId]=null;this.project.removeGroupedButton(this.wgtId);this.linksList=null;return!0};a.prototype.render=function(){if(!b.prototype.render.call(this))return this._renderMask=0,!1;if(this._renderMask&a._renderFlags.VISIBLE){var c=
document.getElementById("_"+this.wgtId);this.visible?(Ca(c,"Transform",this.fitCssTransform),Ca(c,"TransformOrigin","0px 0px")):Ca(c,"Transform","translateZ(0)scale(0)")}if(this._renderMask&a._renderFlags.REDRAW){switch(this.fitsize){case O.FITPAGETOSCREENSIZE:this.executeFitPageToScreenSize();break;case O.FITSIZE:case O.NONE:this.executeFitToSize(),this.project.updateStatusBarPosition(this.yPageOffset)}this.forceRedraw=!1}this._renderMask&a._renderFlags.BGCOLOR&&(this.elem.style.backgroundColor=
this.bgColor);this._renderMask=0;return!0};a.prototype.executeOnDemandFitToScreenSizeModality=function(){this.fitsize==O.FITSIZE&&(this.bgColor=this.elem.style.backgroundColor,this._renderMask|=a._renderFlags.BGCOLOR);if(this.fitsize==O.FITSIZE||this.fitsize==O.FITPAGETOSCREENSIZE){var c=f.getBrowserWindowSize();this.adaptToBrowserViewport(c.width,c.height)}else this.sFactor=1,this._renderMask|=a._renderFlags.REDRAW,f.addToRender(this);this.bindResizeEvent();this.project.getValue("enableFitToScreenTransition")&&
Sa(this.elem,"none")};a.prototype.executeFitToSize=function(){var c=document.getElementById("_"+this.wgtId),a=f.getBrowserWindowSize(),b=(a.width-this.width*this.sFactor)/2,a=(a.height-this.height*this.sFactor)/2;.1>b&&(b=0);.1>a&&(a=0);this.xPageOffset=b;this.yPageOffset=a;this.fitCssTransform="translateY( "+a+"px ) translateX( "+b+"px ) scale( "+this.sFactor+" )";this.cntMtx[0][0]=this.cntMtx[1][1]=this.sFactor;this.cntMtx[0][2]=b;this.cntMtx[1][2]=a;null!=c&&(this.visible&&(La(c,"left top"),da(c,
this.fitCssTransform)),c.style.position="absolute",c.style.left="0px",c.style.top="0px",this.executeGroupGridLayout())};a.prototype.executeFitPageToScreenSize=function(){var c=document.getElementById("_"+this.wgtId);c.style.width=this.elem.style.width=this.width+"px";c.style.height=this.elem.style.height=this.height+"px";for(var a in this.wgts)if(c=this.wgts[a],c.elem&&c.parentWidget==this){var b=c.getParentBounds(this);c.setParentBounds(b.x*this.xScale,b.y*this.yScale,b.width*this.xScale,b.height*
this.yScale,this)}};a.prototype.executeGroupGridLayout=function(){for(var c in this.wgts){var a=this.wgts[c];a.elem&&a.parentWidget==this&&a.hasGridLayout()&&a.executeGridLayout()}};a.prototype.bindResizeEvent=function(){var c=this;this.forceRedraw=!1;this.invalidateMtxChain();f.activeProject.on("resize.page",function(a){clearTimeout(c.resizeTimer);c.resizeTimer=window.setTimeout(function(a,b){c.project.getValue("enableFitToScreenTransition")?Sa(c.elem,"0.3s"):Sa(c.elem,"none");c.adaptToBrowserViewport(a,
b);c.invalidateMtxChain()},300,a.width,a.height)})};a.prototype.adaptToBrowserViewport=function(c,b){var h=this.getRatio(c,b);this.fitsize==O.FITSIZE?this.sFactor=Math.min(h.x,h.y):this.fitsize==O.FITPAGETOSCREENSIZE&&(this.width=c,this.height=b,this.xScale=h.x,this.yScale=h.y);this.forceRedraw=!0;this._renderMask|=a._renderFlags.REDRAW;f.addToRender(this)};a.prototype.getRatio=function(c,a){return{x:0==this.width?0==c?1:c/1E-6:c/this.width,y:0==this.height?0==a?1:a/1E-6:a/this.height}};a.prototype.getScaleFactors=
function(){var c={x:1,y:1};this.sFactor&&(c.x=c.y=this.sFactor);this.xScale&&this.yScale&&(c.x=this.xScale,c.y=this.yScale);return c};a.prototype.isFitToSizeEnable=function(){return this.fitsize==O.FITSIZE?!0:!1};a.prototype.isFitPageToScreenSizeEnable=function(){return this.fitsize==O.FITPAGETOSCREENSIZE?!0:!1};a.prototype.loadFontsFace=function(){void 0!=this.fonts&&0<this.fonts.length&&WebFont.load({custom:{families:this.fonts,urls:["../css/fonts.css"]}})};a.prototype.onActivateActions=function(){if(this.onActivate)for(var c=
this.onActivate,a=0;a<c.length;a++)f.doAction(this.wgtId,c[a])};a.prototype.tOnActivateActions=function(){if(this.tonActivate)for(var c=this.tonActivate,a=0;a<c.length;a++)f.doAction(this.wgtId,c[a])};a.prototype.executeActions=function(){f.actionMgr.doActions()};a.prototype.onDeActivateActions=function(){if(this.onDeactivate)for(var c=this.onDeactivate,a=0;a<c.length;a++)f.doAction(this.wgtId,c[a])};a.prototype.tOnDeActivateActions=function(){if(this.tonDeactivate)for(var c=this.tonDeactivate,a=
0;a<c.length;a++)f.doAction(this.wgtId,c[a])};a.prototype.setDialogElem=function(){this.dialog=(this.elem=document.getElementById(this.wgtId+"Dialog"))?1:0};a.prototype.getEventWidgets=function(){var c=[],a;for(a in this.wgts)"EventBufferWgt"==this.wgts[a].getJMType()&&c.push(this.wgts[a]);return c};a.prototype.initialUpdate=function(){for(var c in this.wgts){var a=this.wgts[c].getDataLinks();if(a)for(var b in a){var d=a[b],g=d.dataSrc.getValue(d.tag);"object"!=typeof g&&0<=d.rw.indexOf("r")&&d.tgtWgt.setValue(d.attr,
g,void 0)}}};a.prototype.bindCWCallbacks=function(){for(var c in this.callbacks){var a=this.callbacks[c],b=a.callbackString.indexOf(".");-1!=b&&"this"==a.callbackString.substring(0,b)&&(a.fn=a.wgt.findJSFunction(a.callbackString.substring(b+1)))}};a.prototype.bindJSCallback=function(c){for(var b in this.callbacks){var h=this.callbacks[b];if(h.wgt.constructor==a||c==h.wgt.isTemplateWgt){var d=h.callbackString.indexOf(".");if(-1!=d)if("this"==h.callbackString.substring(0,d))h.fn=h.wgt.findJSFunction(h.callbackString.substring(d+
1));else try{h.fn=this.__eval__(h.callbackString)}catch(g){}else try{h.fn=this.__eval__(h.callbackString)}catch(k){}}}};a.prototype.__eval__=function(c){};a.prototype.registerPageCallback=function(c,a){var b=c;a&&0==c.indexOf("this.")?b=a.isClone?":"+a.protoWgtId+":"+c:":"+a.wgtId+":"+c:a.isTemplateWgt&&(b=this.templatePagePrefix+b);this.callbacks[b]||(this.callbacks[b]={callbackString:c,fn:null,wgt:a});return b};a.prototype.bindCWJSClass=function(){var c=f.getActiveProject().getCWidgetMgr();c&&c.bindCWLogicClass(this)};
a.prototype.setValue=function(c,b,h,d){d=!1;if(null!=this.elem)switch(c){case "color":c="rgb(0,0,0)";isNaN(b)&&!this.isBadValue(b,!0,h)&&this.backgroundColor!=b&&(/^rgb\(\s*\d+,\s*\d+\s*,\s*\d+\s*\)$/.test(b)?c=b:b&&0==b.indexOf("#")&&1<b.length&&8>=b.length&&(c=b));this.backgroundColor!=c&&(this.backgroundColor=c,2==this.project.getValue("bgColorOption")&&this.project.setValue("color",c,h));break;case "visibility":case "visible":this.visible!=b&&(this._renderMask|=a._renderFlags.VISIBLE,this.forceRedraw&&
(this._renderMask|=a._renderFlags.REDRAW),this.visible=b,d=!0);default:l.prototype.setValue.call(this,c,b,h)}d&&f.addToRender(this);return!0};a.prototype.getValue=function(c){return"backgroundColor"==c?this.backgroundColor:"id"==c||"Id"==c?this.studioId:l.prototype.getValue.call(this,c)};a.prototype.addWidget=function(c,a){b.prototype.addWidget.call(this,c,a);"PageMLTextMgrWgt"==a.getJMType()&&(a.isTemplateWgt?this.mlTemplate=a:this.mlPage=a)};a.prototype.getPageMLTextMgr=function(){return this.mlPage};
a.prototype.getTemplateMLTextMgr=function(){return this.mlTemplate};a.prototype.execTemplateJS=function(){if("undefined"!=typeof f.getPagesScript()){var c=this.templateWebId;if(c&&(c=f.getPagesScript()[c]))try{c()}catch(a){f.showErrorMessage(this.studioId,"Initialization",a.message)}}};a.prototype.execJS=function(){if(this.project.isProjectReady()){if("undefined"!=typeof f.getPagesScript()){var c=f.getPagesScript()[this.wgtId];if(c)try{c()}catch(a){f.showErrorMessage(this.studioId,"Initialization",
a.message)}}}else{var b=this;setTimeout(function(){b.execJS()},100)}};a.prototype.show=function(){this.setValue("visibility",1,null)};a.prototype.setCached=function(c){this.isCached=c};a.prototype.getProject=function(){return this.project};a.prototype.getTransformMatrix=function(){return this.cntMtx};a.prototype.isPageCached=function(){return this.isCached};a.prototype.hidePageContainer=function(){var c=this;requestAnimationFrame(function(){Ca(document.getElementById("_"+c.wgtId),"Transform","translateZ(0)scale(0)");
c.visible=!1})};a.prototype.getPrefix=function(){return this.prefix};a.prototype.getLoadingMode=function(){return this.loadMode};a.prototype.isRoot=function(){return!0};a.prototype.getExportedLanguage=function(){return this.exportedLang};a.prototype.getWidgets=function(){return this.wgts};a.prototype.getCallbacks=function(){return this.callbacks};a.jmType="PageWgt";a._renderMask=0;a._renderFlags={VISIBLE:1,REDRAW:2,BGCOLOR:4,REDRAWDLG:8,UPDATEPOS:16,APPLYMASK:32,APPLYDLGPARAMS:64,APPLYDLGHDR:128,
APPLYFITTOSCREENSIZE:256};return a}(l);Object.defineProperty(I.prototype,"backgroundColor",{get:function(){return this.elem?this.elem.style.backgroundColor:""},set:function(b){this.bgColor=b;this._renderMask|=I._renderFlags.BGCOLOR;f.addToRender(this)}});f.fn.hmiPage=function(b,a,c,e){return new I(this,b,a,e)};f.addWidgetDefinition("hmiPage",I);var Te=function(){function b(a,c,b,h,d){if(null==d||""==d)d=c;var g=this.hdrContElem=document.createElement("div"),k=document.createElement("div");g.setAttribute("data-role",
"dialog-header");g.setAttribute("id",a+"_header");k.setAttribute("id",a+"_title");k.className+=" jm-hdr-title";k.appendChild(document.createTextNode(d));g.appendChild(k);d=document.createElement("div");var k=document.createElement("div"),n=document.createElement("a");d.id=a+"_close";d.className+=" jm-round-button";k.className+=" jm-round-button-circle";n.appendChild(document.createTextNode("X"));k.appendChild(n);d.appendChild(k);g.style.position="absolute";g.style.width=b+"px";g.style.height=h+"px";
g.style.backgroundColor="rgb( 223, 223, 223)";d.style.position="absolute";d.style.width="30px";d.style.left="7px";d.style.top="7px";g.appendChild(d);$(d).on("click",function(){f.getInputManager().isMouseEnabled()&&f.getAction("hmiActionCloseDialog").execute(a,{pg:c.toLowerCase()})})}b.prototype.getElement=function(){return this.hdrContElem};return b}(),Ra=function(b){function a(c,a,h){c=b.call(this,c,a,h)||this;c.visible=void 0===c.visible?!0:c.visible;c.hdrHeight=47;a=f;c.fitsize=a.getActivePage().fitsize;
c.dlgCont=document.getElementById(c.wgtId+"_content");c.dlgMain=document.getElementById("_"+c.wgtId);c.parentPage||(c.parentPage=a.getActivePage());c._renderMask=I._renderFlags.APPLYMASK|I._renderFlags.APPLYDLGPARAMS;c.cntMtx=[[1,0,0],[0,1,0],[0,0,1]];1==c.fitsize?(c.bindResizeDialogEvent(),c.adaptDialogToBrowserViewport()):(c.drawHeader(),c.updatePosition(),c.checkGridLayoutGroups());c.inflateActiveDialogsArray();return c}p(a,b);a.prototype.inflateActiveDialogsArray=function(){f.getActiveProject().addActiveDialogs(this)};
a.prototype.render=function(){this._renderMask&I._renderFlags.UPDATEPOS&&this.runtimePosition();this._renderMask&I._renderFlags.APPLYMASK&&this.attachPointerEventMask(this.getLastActiveDialog());this._renderMask&I._renderFlags.APPLYDLGPARAMS&&this.setDialogParameters();this._renderMask&I._renderFlags.APPLYDLGHDR&&this.addHeader();this._renderMask&I._renderFlags.REDRAWDLG&&this.applyTransform();this._renderMask&I._renderFlags.APPLYFITTOSCREENSIZE&&I.prototype.executeGroupGridLayout.call(this);return b.prototype.render.call(this)};
a.prototype.applyTransform=function(){var c=f.getActivePage().sFactor;if(0==this.fitsize||2==this.fitsize)c=1;this.fitCssTransform="scale( "+c+" )translateZ(0)";this.cntMtx[0][0]=this.cntMtx[1][1]=c;La(this.dlgMain,"left top");da(this.dlgMain,this.fitCssTransform)};a.prototype.bindResizeDialogEvent=function(){var c=this;f.getActiveProject().on("resize."+this.wgtId,function(){clearTimeout(c.resizeDialogTimer);c.resizeDialogTimer=window.setTimeout(function(){c.adaptDialogToBrowserViewport();c.invalidateMtxChain()},
100)})};a.prototype.drawHeader=function(){this.titlebar&&void 0==this.headerElem&&(this._renderMask|=I._renderFlags.APPLYDLGHDR,f.addToRender(this))};a.prototype.updatePosition=function(){this._renderMask|=I._renderFlags.UPDATEPOS;f.addToRender(this)};a.prototype.checkGridLayoutGroups=function(){this._renderMask|=I._renderFlags.APPLYFITTOSCREENSIZE;f.addToRender(this)};a.prototype.adaptDialogToBrowserViewport=function(){this.dlgMain&&(this.drawHeader(),this.updatePosition(),this.checkGridLayoutGroups(),
1==this.fitsize&&(this._renderMask|=I._renderFlags.REDRAWDLG,f.addToRender(this)))};a.prototype.runtimePosition=function(){if(this.dynPos)this.xPosition=parseFloat(this.elem.getAttribute("px")),this.yPosition=parseFloat(this.elem.getAttribute("py"));else{var c=this.width,a=this.height;1==this.fitsize&&(c*=f.getActivePage().sFactor,a*=f.getActivePage().sFactor);this.xPosition=f.browserWindow.width/2-c/2;this.yPosition=this.titlebar?f.browserWindow.height/2-(a+this.hdrHeight)/2:f.browserWindow.height/
2-a/2}a=c=0;this.dynPos&&(0==this.fitsize&&(c=(f.browserWindow.width-this.parentPage.width)/2,a=0),1==this.fitsize&&(c=this.parentPage.xPageOffset,a=this.parentPage.yPageOffset),0>c&&(c=0),0>a&&(a=0));this.left=c+this.xPosition;this.top=a+this.yPosition;this.dlgMain.style.left=this.left+"px";this.dlgMain.style.top=this.top+"px";this.applyTransform()};a.prototype.attachPointerEventMask=function(c){this.maskDiv||(this.maskDiv=document.createElement("div"),this.maskDiv.id="hmi-p-event-mask",this.maskDiv.style.position=
"absolute",this.maskDiv.style.width="100%",this.maskDiv.style.height="100%");this.removePointerEventMask();this.maskDiv.appendBefore(c)};a.prototype.setDialogParameters=function(){this.dlgMain.style.position="absolute";this.dlgMain.style.width=this.width+"px";this.dlgMain.style.height="auto";if(this.titlebar||"transparent"!=this.backgroundColor)this.titlebar&&(this.dlgCont.style.marginTop="46px",this.elem.style.position="relative"),this.dlgMain["box-shadow"]="1px 1px 20px #000000",this.dlgMain["-mozbox-shadow"]=
"1px 1px 20px #000000",this.dlgMain["-webkitbox-shadow"]="1px 1px 20px #000000"};a.prototype.enableDrag=function(){var c=this;$(this.dlgMain).draggable({handle:$("#"+this.headerElem.getElement().id),cursor:"move",drag:function(){var a=$(this)[0];c.left=parseFloat(a.style.left.split("px")[0]);c.top=parseFloat(a.style.top.split("px")[0]);c.xPosition=(c.left-c.xPageOffset)/c.sFactor;c.yPosition=(c.top-c.yPageOffset)/c.sFactor;c.invalidateMtxChain()}})};a.prototype.addHeader=function(){this.headerElem=
new Te(this.wgtId,this.studioId,this.width,this.hdrHeight,this.elem.getAttribute("titlename"));this.headerElem.getElement().appendBefore(this.dlgCont);this.enableDrag()};a.prototype._enablePagePointer=function(){var c=f.getActiveProject().activeDialogs;0<c.length?(this.attachPointerEventMask(this.getLastActiveDialog()),this.changeFocusPage(c[c.length-1])):this.removePointerEventMask()};a.prototype.changeFocusPage=function(c){f.setFocusPage(f.getWidget(c))};a.prototype.getLastActiveDialog=function(){var c=
f.getActiveProject().activeDialogs;return 0<c.length?document.getElementById("_"+c[c.length-1]):null};a.prototype.removePointerEventMask=function(){$("#hmi-p-event-mask").remove()};a.prototype.pagedeactivate=function(){var c=f.getActiveProject().getWidget("_TagMgr",!0);f.getEventMgr().trigger(this.elem,"unloadWgt");c=$hmi.getActiveProject().getWidget("_TagMgr",!0);null!=c&&c.unsubscribePageGroups(this.wgtId);c=$hmi.activeProject.getWidget("_IndexedTagSetMgr",!0);null!=c&&c.unsubscribePageGroups(this.wgtId);
this.unmountDataLinks();this.destroy()};a.prototype.enablePointer=function(){this._enablePagePointer()};a.prototype.closeDialog=function(){this.pagedeactivate()};a.prototype.destroy=function(){this.resizeDialogTimer=null;f.getActiveProject().off("resize."+this.wgtId);$(this.dlgMain).remove();$("link[href='../css/pages/_"+this.wgtId+".css']").remove();return b.prototype.destroy.call(this)};a.prototype.getOffsetTop=function(){return this.titlebar?1==this.fitsize?this.hdrHeight*f.getActivePage().sFactor:
this.hdrHeight:0};a.prototype.getOffsetLeft=function(){return 0};a.prototype.getTransformMatrix=function(){return this.cntMtx};a.prototype.pageactivate=function(){f.getActiveProject().getWidget("_TagMgr",!0).subscribePageGroups(this.wgtId);1==this.fitsize&&this.bindResizeDialogEvent()};a.prototype.stopLogic=function(){var c=f.getActiveProject();c.getWidget("_TagMgr",!0).unsubscribePageGroups(this.wgtId);c.off("resize."+this.wgtId)};a.prototype.getDialogContainerElem=function(){return this.dlgMain?
this.dlgMain:null};a.jmType="DialogWgt";return a}(I);f.fn.hmiDialog=function(b,a,c){return new Ra(this,b,a)};f.addWidgetDefinition("hmiDialog",Ra);ec=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.execute=function(c,a,b){b=this.project.getPageMgr();c=b.getCurrentPageId();b=b.getCurrentCategory();var d=b.alias[a.pg];a=d?d:a.pg;a!=c&&""!==a&&void 0!==a&&(-1==b.pages.indexOf(a)&&-1==b.umpages.indexOf(a)||this.changePage(c,a));this.done()};a.jmType="LoadPageAction";
return a}(q);f.addAction("hmiActionLoadPage",ec);var Nc=function(b){function a(c,a,h,d,g){var k=b.call(this,c.wgtId,a,h,d,g)||this;k.PROPS={TIME:"System Time",XSCREEN:"X Screen resolution",YSCREEN:"Y Screen resolution",GROUP:"This Client Group-Name",USRNAME:"This Client User-Name",CONN_ST:"Connection status",CLIENTID:"This Client ID",MEMORY:"Available System Memory",CURR_LANG_ID:"Current Language Id",CURR_LANG_NAME:"Current Language Name",CURR_LANG_CODE:"Current Language Code"};k.sysProp={};c=f;k.sysProp[k.PROPS.XSCREEN]=
c.browserWindow.width;k.sysProp[k.PROPS.YSCREEN]=c.browserWindow.height;k._pollingTime=1E3;k.DLSSetting={status:"",stdoff:null,stdw:"",stdd:"",stdm:"",stdhh:"",stdmm:"",dlsoff:null,dlsw:"",dlsd:"",dlsm:"",dlshh:"",dlsmm:"",mode:null};k.sysProp[k.PROPS.TIME]=new Date;k._pollTimer=null;k._systemTimeDelayTimer=null;k._timeoutSytemTime=3E5;k.enabledVars={"System Time":!1,"X Screen resolution":!1,"Y Screen resolution":!1};k.propsImpl={};c.isTestModeActive()||(k.parentWidget.waitWgtReady().then(function(){k.srv=
k.project.getCommunticationObj();k._requestTimeSettings().then(function(){k.startQuerying(k.PROPS.TIME)})}),k.sysProp[k.PROPS.CONN_ST]=k.project.getConnectionStatus());if(c=k.project.getWidget("_UserGroupMgr",!0))c.waitWgtReady().then(function(){k.trigger("um_login")}),c.subscribeWgt(k,function(c,a){k.trigger(c,a)});(c=k.project.getMultiLanguageMgr())&&c.subscribeWgt(k,function(c,a){k.trigger(c,a)});k.project.subscribeWgt(k,function(c,a){k.trigger(c,a)});return k}p(a,b);a.prototype.subscribeDataLink=
function(c){b.prototype.subscribeDataLink.call(this,c);var a=c.tag;this.enabledVars[a]?c.tgtWgt.setValue(c.attr,this.sysProp[a],null):this.startQuerying(a)};a.prototype._requestTimeSettings=function(){var c=this;return this.srv.getDLSSettings().then(function(a){c.DLSSetting=a})};a.prototype.getServerOffset=function(){return 0===this.DLSSetting.mode?this.DLSSetting.stdoff:1===this.DLSSetting.mode?this.DLSSetting.dlsoff:0};a.prototype.startXScreenWatch=function(){var c=this;this.project.on("resize.sysvar",
function(){c.updateScreenSize("X")})};a.prototype.startYScreenWatch=function(){var c=this;this.project.on("resize.sysvar",function(){c.updateScreenSize("Y")})};a.prototype.updateScreenSize=function(c){var a=0,b=u.getModule("Tag"),a=f;"X"==c?(a=a.browserWindow.width=this.sysProp[this.PROPS.XSCREEN]=window.innerWidth,this.sendUpdate(this.PROPS.XSCREEN,a,b.QUALITY_GOOD)):"Y"==c&&(a=a.browserWindow.height=this.sysProp[this.PROPS.YSCREEN]=window.innerHeight,this.sendUpdate(this.PROPS.YSCREEN,a,b.QUALITY_GOOD))};
a.prototype.setValue=function(c,a,b,d){"System Time"==c?("date"==$.type(a)?this.srv.setTime(Math.round(a.getTime()/1E3),!1):this.srv.setTime(a,!1),clearTimeout(this._systemTimeDelayTimer),this._systemTimeDelayTimer=null):c==this.PROPS.CONN_ST?this.sendUpdate(c,this.sysProp[this.PROPS.CONN_ST],b):this.propsImpl[c]&&a!=this.sysProp[c]&&(this.sysProp[c]=a,this.sendUpdate(c,a,b))};a.prototype.getTime=function(){return this.sysProp[this.PROPS.TIME].toDate().getTime()};a.prototype.getValue=function(c){var a=
f;if(c!=this.PROPS.TIME||this.enabledVars[c]){if(c==this.PROPS.TIME)return this.sysProp[c].toDate().getTime()/1E3;if(c==this.PROPS.CONN_ST)return this.sysProp[this.PROPS.CONN_ST];if(this.propsImpl[c])return this.sysProp[c];var b=null;switch(c){case this.PROPS.XSCREEN:return this.enabledVars[this.PROPS.XSCREEN]?this.sysProp[c]:a.browserWindow.width;case this.PROPS.YSCREEN:return this.enabledVars[this.PROPS.YSCREEN]?this.sysProp[c]:a.browserWindow.height;case this.PROPS.CLIENTID:if(c=this.project.getWidget("_UserGroupMgr",
!0))return c.getValue("ClientID");break;case this.PROPS.CURR_LANG_ID:return(b=this.project.getMultiLanguageMgr())?b.getValue("curLangId"):"";case this.PROPS.CURR_LANG_NAME:return(b=this.project.getMultiLanguageMgr())?b.getValue("curLangName"):"";case this.PROPS.CURR_LANG_CODE:if(b=this.project.getMultiLanguageMgr())return b.getValue("curLangCode");default:return this.sysProp[c]}}else return moment().toDate().getTime()/1E3};a.prototype.trigger=function(c,a){var b=u.getModule("Tag");switch(c){case "c_status":var d=
this.project.getConnectionStatus();this.sysProp[this.PROPS.CONN_ST]!=d&&(this.sysProp[this.PROPS.CONN_ST]=d,this.sendUpdate(this.PROPS.CONN_ST,d,b.QUALITY_GOOD));break;case "um_login":var d=this.project.getWidget("_UserGroupMgr",!0).getValue("username"),g=this.project.getWidget("_UserGroupMgr",!0).getValue("group");this.sysProp[this.PROPS.USRNAME]!=d&&(this.sysProp[this.PROPS.USRNAME]=d,this.sendUpdate(this.PROPS.USRNAME,d,b.QUALITY_GOOD));this.sysProp[this.PROPS.GROUP]!=g&&(this.sysProp[this.PROPS.GROUP]=
g,this.sendUpdate(this.PROPS.GROUP,g,b.QUALITY_GOOD));break;case "up-lang":if(d=this.project.getMultiLanguageMgr())this.sendUpdate(this.PROPS.CURR_LANG_ID,d.getValue("curLangId"),b.QUALITY_GOOD),this.sendUpdate(this.PROPS.CURR_LANG_NAME,d.getValue("curLangName"),b.QUALITY_GOOD),this.sendUpdate(this.PROPS.CURR_LANG_CODE,d.getValue("curLangCode"),b.QUALITY_GOOD)}};a.prototype.isSystemVarsEnable=function(c){return this.enabledVars[c]};a.prototype.startDateTimePolling=function(){var c=this,a=u.getModule("Tag");
null==this._systemTimeDelayTimer?this.srv.getTime(!1).then(function(b){"#S_OK"==b.status&&(b=new Date(b.time),c.sysProp["System Time"]=moment(b),c.sendUpdate("System Time",b,a.QUALITY_GOOD));c._pollTimer=window.setTimeout(function(){c.startDateTimePolling()},c._pollingTime);c._systemTimeDelayTimer=window.setTimeout(function(){clearTimeout(c._systemTimeDelayTimer);c._systemTimeDelayTimer=null},c._timeoutSytemTime)}):(c.sysProp["System Time"]=c.sysProp["System Time"].add(1,"seconds"),c.sendUpdate("System Time",
c.sysProp["System Time"].clone().toDate().getTime()/1E3,a.QUALITY_GOOD),c._pollTimer=window.setTimeout(function(){c.startDateTimePolling()},c._pollingTime))};a.prototype.startQuerying=function(c){var a=this;switch(c){case this.PROPS.TIME:this.startDateTimePolling();this.enabledVars[this.PROPS.TIME]=!0;break;case this.PROPS.XSCREEN:this.updateScreenSize("X");this.startXScreenWatch();this.enabledVars[this.PROPS.XSCREEN]=!0;var b=f.getEventMgr();if(b){a=this;this.deactivateXHandler=function(){f.activeProject.off("resize.sysvar");
a.enabledVars[a.PROPS.XSCREEN]=!1;b.off(d,"unloadWgt",a.deactivateXHandler)};var d=f.getActivePage().elem;b.on(d,"unloadWgt",this.deactivateXHandler)}break;case this.PROPS.YSCREEN:this.updateScreenSize("Y");this.startYScreenWatch();this.enabledVars[this.PROPS.YSCREEN]=!0;b&&(a=this,this.deactivateYHandler=function(){f.activeProject.off("resize.sysvar");a.enabledVars[a.PROPS.YSCREEN]=!1;b.off(d,"unloadWgt",a.deactivateYHandler)},d=f.getActivePage().elem,b.on(d,"unloadWgt",this.deactivateYHandler));
break;default:this.propsImpl[c]&&(this.enabledVars[c]=!0)}};a.prototype.__implementsProperty=function(c,a){var b=u.getModule("Tag");this.propsImpl[c]&&clearTimeout(this.propsImpl[c].timer);void 0===a.interval&&(a.interval=5E3);1E3>a.interval&&(a.interval=1E3);void 0===a.timer&&(a.timer=null);var d=this.propsImpl[c]=a,g=d.query();this.setValue(c,g,b.QUALITY_GOOD);this._pollCustomProperty(c,d)};a.prototype._pollCustomProperty=function(c,a){var b=this,d=u.getModule("Tag");a.timer=window.setTimeout(function(){var g=
a.query();b.setValue(c,g,d.QUALITY_GOOD);b._pollCustomProperty(c,a)},a.interval)};a.jmType="SysPropMgrWgt";return a}(l);f.fn.hmiSystemVars=function(b,a,c,e){return new Nc(this,b,a,c,e)};f.addWidgetDefinition("hmiSystemVars",Nc);var Oc;(function(b){b[b.AUTO=0]="AUTO";b[b.SSE=1]="SSE";b[b.LONGPOLLING=2]="LONGPOLLING"})(Oc||(Oc={}));var Pc;(function(b){b[b.NONE=0]="NONE";b[b.RUNTIME=1]="RUNTIME";b[b.BROWSER=2]="BROWSER"})(Pc||(Pc={}));var Qc;(function(b){b[b.JMOBILE=0]="JMOBILE";b[b.STANDALONE=1]="STANDALONE"})(Qc||
(Qc={}));var Za=function(b){function a(c,e,h,d){var g=b.call(this,c,e,h,d)||this;g.defs=f.defs;g.actMgr=f.actionMgr;if(1===f.mode)g.setDefaultState(),f.init(),g.project=g,f.activeProject=g,f.projectInterface=new K(g),g.initPromiseReady(),g.props={},void 0!==Ma&&(g.cWidgetMgr=new Ma(g)),g.resolveWgtReady(!0);else{g.template={body:{node:null,children:{container:{node:null},init:{node:null},broken:{node:null},overlays:{node:null,children:{dtpop:{node:null},spinnerbox:{node:null},loading:{node:null},
messages:{node:null}}}}}};"undefined"!=typeof h.modernBrowser&&(h.modernBrowser?(f.browserOptimizations.nativeRenderLoop=h.optimizations.nativeRenderCycle,f.browserOptimizations.forceLayers=h.optimizations.forceLayers):(f.browserOptimizations.nativeRenderLoop=!1,f.browserOptimizations.forceLayers=!1));g.setDefaultState();g.projectName=h.projectName;g.maxBandwidth=h.maxBandwidth;g.connectionMode=h.connectionMode;g.iconStatusDelay=h.webSysIconDelay;g._renderMask=0;g.status=0;g._browserListener=["resize"];
g.groupedButtons={};g.initGFX();f.init();g.bindToWindowEvent();c=u.getModule("StatusBar");g.enbleStatusBar=!0;g.statusBarStyle="FULLSCREEN";g.statusBar=new c(1);f.cache.clear();g.tagMgr=null;g.trendMgr=null;g.pageMgr=null;g._prmTagMgr=new Promise(function(c,a){g._fnResolveTagMgr=c});f.activeProject=g;f.projectInterface=new K(g);1==g.bgColorOption&&(g._renderMask|=a._renderFlags.BGCOLOR,f.addToRender(g));c=g.getScrollbarSize();f.browserScrollbarWidth=c.width;f.browserScrollbarHeight=c.height;50>g.pollRate?
g.pollRate=50:1E4<g.pollRate&&(g.pollRate=1E4);if(0>g.timeout||864E5<g.timeout)g.timeout=0;f.startInActivityTimer(g.timeout,function(){f.getAction("hmiActionLogOut").execute()});g.activeDialogs=[];g._dlgInfo={};g.projectReady=!1;g.cpAnimation=!1;g.cpAnimationOnCache=!0;g.pagesCacheSize=6;g.fitToScreenTransition=!0;g.enableListenerOnHashChange();g.initPromiseReady();f.isTestModeActive()?(void 0!==Ma&&(g.cWidgetMgr=new Ma(g)),g.resolveWgtReady(!0)):(g.curURL=window.location.href.substring(0,window.location.href.lastIndexOf("/")+
1),f.getServerConf().then(function(c){c.projectName=g.projectName;c.maxBandwidth=g.maxBandwidth;c.connectionMode=g.connectionMode;g.ttl=c.ttl;f.initServerInterface(c);g.srv=f.getServerInterface();c=f.getJSModule("GroupExpressionRunner");g.groupExpressionRunner=new c(g.srv);g.srv.getProjectInformation().then(function(){setInterval(function(){var c=g.srv.isSessionAlive();2==c.status&&f.loadLoginPage();1==c.status&&0==g.connstatus&&(g.hideStatusBar(),g.connstatus=1,g.sendNotification("c_status"));0==
c.status&&1==g.connstatus&&(g.showStatusBar(),g.connstatus=0,g.sendNotification("c_status"));1==c.status&&g.projectName.toLowerCase()!=c.projectName.toLowerCase()&&-1==c.projectName.indexOf("_SIMULATOR_")&&f.loadLoginPage()},g.ttl);g.srv.requestConf();g.srv.getConf("propsMap.json").then(function(c){g.props=c["propsMap.json"]});void 0!==Ma&&(g.cWidgetMgr=new Ma(g));g.resolveWgtReady(!0)})}))}return g}p(a,b);a.prototype.showStatusBar=function(){this.enbleStatusBar&&(this.updateStatusBar(this.core.browserWindow.width,
this.core.browserWindow.height),this.statusBar.show())};a.prototype.hideStatusBar=function(){this.statusBar.hide()};a.prototype.enableListenerOnHashChange=function(){var c=this;window.addEventListener("hashchange",function(){var a=location.hash,b=a.indexOf("loadPage=");-1!=b&&(a=c.getWidget("_PageMgr",!0).getWebPage(a.substring(b+9).toLowerCase()),c.changePage(f.getActivePage().getId(),a))},!1)};a.prototype.initGFX=function(){var c=this.template;c.body.node=document.getElementsByClassName("jm-body")[0];
c.body.children.container.node=document.getElementById("jm-container");c.body.children.init.node=document.getElementById("hmi-init");c.body.children.broken.node=document.getElementsByClassName("jm-broken");c.body.children.overlays.children.dtpop.node=document.getElementById("jm-hmi-dtpop");c.body.children.overlays.children.spinnerbox.node=document.getElementById("jm-spinnerbox");c.body.children.overlays.children.loading.node=document.getElementById("jm_loading_");c.body.children.overlays.children.messages.node=
document.getElementById("jm-layer-messages")};a.prototype.updateStatusBar=function(c,a){this.statusBar.recalculateSize(c,a)};a.prototype.updateStatusBarPosition=function(c){this.statusBar.setY(c)};a.prototype.getNode=function(c){var a=this.template;if(!a)return null;switch(c){case "body":return a.body.node;case "container":return a.body.children.container.node;case "initcode":return a.body.children.initcode.node;case "broken":return a.body.children.broken.node;case "dtpopup":return a.body.children.overlays.childern.dtpopup.node;
case "spinnerbox":return c=a.body.children.overlays.children.spinnerbox.node,null==c&&(c=document.getElementById("jm-spinnerbox"),a.body.children.overlays.children.spinnerbox.node=c),c;case "loading":return a.body.children.overlays.children.loading.node;case "messages":return c=a.body.children.overlays.children.messages.node,null==c&&(c=document.getElementById("jm-layer-messages"),a.body.children.overlays.children.messages.node=c),c}return null};a.prototype.removeNode=function(c){var a=this.template;
switch(c){case "loading":c=a.body.children.overlays.children.loading.node,null!=c&&(c.parentNode.removeChild(c),a.body.children.overlays.children.loading.node=null)}return null};a.prototype.setDefaultState=function(){this.props=void 0!==this.props?this.props:null;this.pollRate=void 0!==this.pollRate?this.pollRate:3E3;this.timeout=void 0!==this.timeout?this.timeout:6E5;this.connstatus=void 0!==this.connstatus?this.connstatus:1;this.color=void 0!==this.color?this.color:"none";this.connectionMode=void 0!==
this.connectionMode?this.connectionMode:0;this._callbacks={};this._webPageSync=null;this.curURL=window.location.href.substring(0,window.location.href.lastIndexOf("/")+1);this.webMemoryThreshold=void 0!==this.webMemoryThreshold?this.webMemoryThreshold:0;this.shortDateFormat=void 0!==this.shortDateFormat?this.shortDateFormat:"DD/MMM/YYYY";this.longDateFormat=void 0!==this.longDateFormat?this.longDateFormat:"MM/DD/YY - hh:mm:ss";this.fieldsStyle||(this.fieldsStyle={},this.fieldsStyle.decimalSymbol=void 0!==
this.fieldsStyle.decimalSymbol?this.fieldsStyle.decimalSymbol:".",this.fieldsStyle.thousandSymbol=void 0!==this.fieldsStyle.thousandSymbol?this.fieldsStyle.thousandSymbol:",");this.fieldsStyle.digitsGrouping=3};a.prototype.getConnectionStatus=function(){return this.connstatus};a.prototype.hideLoadingPage=function(){this.removeNode("loading")};a.prototype.getScrollbarSize=function(){var c=document.body,a=document.createElement("div"),b=document.createElement("div");a.setAttribute("style","width:50px;height:50px;position:absolute;overflow:scroll;");
a.appendChild(b);b.setAttribute("style","width:100px;height:100px;");c.appendChild(a);var b=a.offsetWidth-a.clientWidth,d=a.offsetHeight-a.clientHeight;c.removeChild(a);return{width:b,height:d}};a.prototype.addActiveDialogs=function(c){this._dlgInfo[c.wgtId]?this._dlgInfo[c.wgtId].enable=!0:(this.activeDialogs.push(c.wgtId),this._dlgInfo[c.wgtId]={wgt:c,enable:!0})};a.prototype.removeActiveDialogs=function(c){var a=this.activeDialogs.indexOf(c);-1!=a&&(this.activeDialogs.splice(a,1),delete this._dlgInfo[c])};
a.prototype.getActiveDialogsLength=function(){return this.activeDialogs.length};a.prototype.getActiveDialogs=function(){return this._dlgInfo};a.prototype.hasActiveDialogs=function(){return 0<this.activeDialogs.length};a.prototype.isActiveDialog=function(c){return-1!=this.activeDialogs.indexOf(c)};a.prototype.closeAllDialogs=function(){for(var c=this.activeDialogs.length-1;0<=c;c--)this.closeDialog(this.activeDialogs[c]);this.activeDialogs=[];this._dlgInfo={};$(window).off("load.dialog orientationchange.dialog resize.dialog")};
a.prototype.activateDialogs=function(){for(var c=0;c<this.activeDialogs.length;c++){var a=this.activeDialogs[c],b=f.getWidget(a),d=b.getDialogContainerElem();this.getNode("container").appendChild(d);this._dlgInfo[a].enable||(f.setFocusPage(b),this._dlgInfo[a].enable=!0,f.getEventMgr().trigger(f.getFocusPage().getHTMLElement(),"loadWgt"),b.show(),b.execJS(),b.load())}};a.prototype.closeDialog=function(c){var a=this.activeDialogs.indexOf(c);-1!=a&&(a=this._dlgInfo[this.activeDialogs[a]].wgt,a.closeDialog(),
this.removeActiveDialogs(c),this.cWidgetMgr.freeCWInstances("_"+c),a.enablePointer(),0<this.activeDialogs.length?(c=f.getWidget(this.activeDialogs[this.activeDialogs.length-1]),f.setFocusPage(c)):f.setFocusPage(f.getActivePage()))};a.prototype.stopDialogsLogic=function(){for(var c=0,a=this.activeDialogs.length;c<a;c++){var b=this.activeDialogs[c];this._dlgInfo[b].wgt.stopLogic();this._dlgInfo[b].enable=!1}};a.prototype.addWidget=function(c,a){b.prototype.addWidget.call(this,c,a);switch(a.getJMType()){case "TagMgrWgt":this.tagMgr=
a;this._fnResolveTagMgr(this.tagMgr);break;case "MultiLangMgrWgt":this.multiLangMgr=a;break;case "SysPropMgrWgt":this.systemVars=a;break;case "TrendMgrWgt":this.trendMgr=a}};a.prototype.getTagMgrInstance=function(){return this._prmTagMgr};a.prototype.getAlarmsMgr=function(){return this.getWidget("_AlarmsMgr",!0)};a.prototype.getTagMgr=function(){null==this.tagMgr&&(this.tagMgr=this.getWidget("_TagMgr",!0));return this.tagMgr};a.prototype.getMultiLanguageMgr=function(){null==this.multiLangMgr&&(this.multiLangMgr=
this.getWidget("_MultiLangMgr",!0));return this.multiLangMgr};a.prototype.getSystemPropertiesMgr=function(){null==this.systemVars&&(this.systemVars=this.getWidget("_SysPropMgr",!0));return this.systemVars};a.prototype.getTrendMgr=function(){null==this.trendMgr&&(this.trendMgr=this.getWidget("_TrendMgr",!0));return this.trendMgr};a.prototype.getPageMgr=function(){null==this.pageMgr&&(this.pageMgr=this.getWidget("_PageMgr",!0));return this.pageMgr};a.prototype.getProject=function(){return this};a.prototype.getRecipeMgr=
function(){null==this.recipeMgr&&(this.recipeMgr=this.getWidget("_RecipeMgr",!0));return this.recipeMgr};a.prototype.getTag=function(c,a,b,d,g){return"function"!=typeof d?this._getTagSync(c,a,b,d):this._getTagAsync(c,a,b,d,g)};a.prototype._getTagSync=function(c,a,b,d){var g=null;d||"undefined"==typeof f.getTagFromCache(c)?(d=u.getModule("Tag"),b=this.srv.readTagSync(new d(c,b)),b.getMessageStatus().getValue()!=x.status.E_TIMEOUT&&(g=b.getValue(),a instanceof B&&(a.setState(b.quality,g,b.type,"S_OK",
b.timestamp),a.setMessageCode(b.getMessageStatus().getValue())))):(c=f.getTagFromCache(c),g=c.getValue(b),a&&a.setState(c.quality,g,c.type,"S_OK",c.ts));return g};a.prototype._getTagAsync=function(c,a,b,d,g){var k=u.getModule("Tag");if(g||"undefined"==typeof f.getTagFromCache(c))return this.srv.readTag(new k(c,b)).then(function(b){if((b instanceof B||b instanceof k)&&b.getMessageStatus().getValue()!=x.status.E_TIMEOUT){var h;h=a instanceof B?a:new B;h.setState(b.quality,b.value,b.type,"S_OK",b.timestamp);
return d(c,h)}});g=f.getTagFromCache(c);a.setState(g.quality,g.getValue(b),g.type,"S_OK",g.ts);return d(c,a)};a.prototype.setTag=function(c,a,b,d){var g=new B,k=this.getWidget("_TagMgr",!0);"undefined"==typeof b&&(b=0);if(d)return(c=k.setTagValue(c,a,b,g,!0).getMessageStatus())?c.getValue()==x.status.S_OK:!1;k.setTagValue(c,a,b,g,!1)};a.prototype.getCommunticationObj=function(){return this.srv};a.prototype.getGroup=function(c,a,b){return this.groupExpressionRunner.run(c,a,b)};a.prototype.getPollRate=
function(){return this.pollRate};a.prototype.changePageByIndex=function(c,a){var b=c.getPages();0<a&&a<=b.length&&(--a,this.changePage(f.getActivePage().getId(),b[a]))};a.prototype.setValue=function(c,b,h,d){var g=this;switch(c){case "WebPageSynch":var k=this.getWidget("_PageMgr",!0);if(isNaN(b)||!k)return!1;if(1>b||b>k.length()){this._webPageSync=b;break}var n=parseInt(b)-1;parseInt(b)!=this._webPageSync&&(this._webPageSync=b,requestAnimationFrame(function(){k.isPrecaching()?k.waitPrecacheEnd().then(function(){return g.changePageByIndex(k,
n)}).catch(function(){return g.changePageByIndex(k,n)}):g.changePageByIndex(k,n)}));break;case "changePageAnimation":this.changePageAnimation(b);break;case "changePageAnimationOnCache":this.cpAnimationOnCache=1==b;break;case "enableFitToScreenTransition":this.fitToScreenTransition=b;break;case "pagesCacheSize":this.pagesCacheSize!=b&&(1>b&&(b=1),this.pagesCacheSize=b);break;case "color":this.color!=b&&(this.color=this.validateColor(b)?b:"#000",this._renderMask|=a._renderFlags.BGCOLOR,f.addToRender(this));
break;case "webMemoryThreshold":b!=this.webMemoryThreshold&&h.isQualityGood()&&(this.webMemoryThreshold=b,this.sendUpdate(c,b,h));break;case "webMemoryAvailable":b!=this.webMemoryAvailable&&h.isQualityGood()&&(this.webMemoryAvailable=b,this.sendUpdate(c,b,h));break;case "shortDateFormat":void 0!=b&&""!==b&&b!=this.shortDateFormat&&(this.shortDateFormat=b,this.updateGlobalStyle({shortDateFormat:this.shortDateFormat}),this.sendUpdate(c,b,h));break;case "longDateFormat":void 0!=b&&""!==b&&b!=this.longDateFormat&&
(this.longDateFormat=b,this.updateGlobalStyle({longDateFormat:this.longDateFormat}),this.sendUpdate(c,b,h));break;case "decimalSymbol":void 0!=b&&""!==b&&b!=this.fieldsStyle.decimalSymbol&&"string"==typeof b&&1==b.length&&(this.fieldsStyle.decimalSymbol=b,this.updateGlobalStyle({decimalSymbol:this.fieldsStyle.decimalSymbol}),this.sendUpdate(c,b,h));break;case "thousandSymbol":void 0!=b&&""!==b&&b!=this.fieldsStyle.thousandSymbol&&"string"==typeof b&&1==b.length&&(this.fieldsStyle.thousandSymbol=b,
this.updateGlobalStyle({thousandSymbol:this.fieldsStyle.thousandSymbol}),this.sendUpdate(c,b,h));break;case "webDebugLogs":c=u.import("JMVirtualConsole");null==this.jmConsole&&(this.jmConsole=new c);this.jmConsole.getMode()!=b.mode&&(this.jmConsole.setMode(b.mode),1==b.mode&&(this.jmConsole.setConnectionParameters(b.address,b.port),this.jmConsole.openConnection()));break;case "webEnableStatusBar":this.enbleStatusBar!=b&&(this.enbleStatusBar=1==b);break;case "webStatusBarStyle":this.statusBarStyle!=
b&&(this.statusBarStyle=b,"BAR"==this.statusBarStyle?this.statusBar.setStyle(0):"FULLSCREEN"==this.statusBarStyle&&this.statusBar.setStyle(1))}return!0};a.prototype.jmLog=function(c){this.jmConsole&&this.jmConsole.log(c)};a.prototype.updateGlobalStyle=function(c){var a=f.getFocusPage().getWidgets(),b;for(b in a)a[b].updateStyle(c);if(f.getFocusPage().getId()!=f.getActivePage().getId())for(b in a=f.getActivePage().getWidgets(),a)a[b].updateStyle(c)};a.prototype.render=function(){this._renderMask&a._renderFlags.BGCOLOR&&
(1==this.bgColorOption||2==this.bgColorOption)&&(document.body.style.background=this.color);this._renderMask&a._renderFlags.UPDATESTATUSBAR&&this.updateStatusBar(this.core.browserWindow.width,this.core.browserWindow.height);this._renderMask=0;return!0};a.prototype.validateColor=function(c){return void 0===c||null===c?!1:0==c.indexOf("#")&&1<c.length&&8>=c.length||"r"===c.charAt(0)&&"g"===c.charAt(1)&&"b"===c.charAt(2)?!0:!1};a.prototype.getValue=function(c){switch(c){case "WebPageSynch":return this._webPageSync;
case "changePageAnimation":return this.cpAnimation;case "changePageAnimationOnCache":return this.cpAnimationOnCache;case "pagesCacheSize":return this.pagesCacheSize;case "enableFitToScreenTransition":return this.fitToScreenTransition;case "decimalSymbol":return this.fieldsStyle.decimalSymbol;case "thousandSymbol":return this.fieldsStyle.thousandSymbol;case "webDebugLogs":return this.jmConsole?{mode:this.jmConsole.getMode(),address:this.jmConsole.getAddress(),port:this.jmConsole.getPort()}:null;default:return this[c]}};
a.prototype.checkAvailableMemory=function(){return 0===this.webMemoryThreshold||0===this.webMemoryAvailable?!0:this.webMemoryAvailable>this.webMemoryThreshold};a.prototype.isProjectReady=function(){return this.projectReady};a.prototype.hideLoading=function(){var c=this;f.isCoreWidgetsReady().then(function(){if(c.srv.getConnectionStatus())c.hideLoadingPage();else c.srv.onConnectionReady(function(){c.hideLoadingPage()})}).catch(function(c){})};a.prototype.execJS=function(){var c=this;f.isCoreWidgetsReady().then(function(){if("undefined"!=
typeof f.getPagesScript()){var a=f.getPagesScript()[c.wgtId];if(a)try{a()}catch(b){f.showErrorMessage(c.studioId,"Project Page",b.message)}}c.projectReady=!0;c.status=1}).catch(function(c){})};a.prototype.onPageChange=function(c){if(c.recipes){var a=this.getRecipeMgr();if(a)a.onPageChange()}c.dialogs&&this.stopDialogsLogic()};a.prototype.getURLForNextNormalPage=function(c){if(1<c.length){var a=c.length;if("umtemplates"==c[a-2])return c[a-2]="pages",this.curURL=c.join("/");if("pages"==c[a-2])return this.curURL}return this.curURL+
"pages/"};a.prototype.getURLForNextUMPage=function(c){if(1<c.length){var a=c.length;if("pages"==c[a-2])return c[a-2]="umtemplates",this.curURL=c.join("/")}-1==this.curURL.indexOf("umtemplates")&&(this.curURL+="umtemplates/");return this.curURL};a.prototype.getPageUrl=function(c){return this.getWidget("_UserGroupMgr",!0).isUMTemplate(c)?this.getURLForNextUMPage(this.curURL.split("/")):this.getURLForNextNormalPage(this.curURL.split("/"))};a.prototype.changePage=function(c,a){var b=this,d=this.getPageMgr();
if(!d.isPrecaching()){this.status=2;f.pageNavigationOptions.pageToLeave=c;f.pageNavigationOptions.pageToLoad=a;var g=f.getBrowserWindowSize();this.triggerEvent("shouldChangePage",{src:d.getPageStudioId(c),dst:d.getPageStudioId(a),height:g.height,width:g.width});this.onPageChange({recipes:!0,dialogs:!0});f.pageNavigationOptions.pageToLeave!=f.pageNavigationOptions.pageToLoad&&(!this.cpAnimationOnCache&&this.getPageMgr().isCached(f.pageNavigationOptions.pageToLoad)||f.activeProject.showSpinner(!0));
d.setLastVisitedPage(c);d=this.getPageUrl($hmi.pageNavigationOptions.pageToLoad);$hmi.changePage(d+($hmi.pageNavigationOptions.pageToLoad+".html"),{src:$hmi.pageNavigationOptions.pageToLeave,dst:$hmi.pageNavigationOptions.pageToLoad,beautify:function(c){b.injectCWTemplatesToDOM(c)}});this.status=1}};a.prototype.injectCWTemplatesToDOM=function(c){this.cWidgetMgr.injectCWTemplates(c,c.getAttribute("id"))};a.prototype.getClientType=function(){return"web"};a.prototype.bindToWindowEvent=function(){var c=
this;window.addEventListener("resize",function(){var b=window.innerWidth,h=window.innerHeight;f.setBrowserWindowSize(b,h);c.triggerEvent("resize",{width:b,height:h});c._renderMask|=a._renderFlags.UPDATESTATUSBAR;c.core.addToRender(c)})};a.prototype.on=function(c,a){var b=null;-1!=c.indexOf(".")&&(b=c.split("."),c=b[0],b=b[1]);null==this._callbacks[c]?this._callbacks[c]=[{n:b,cb:a}]:this._callbacks[c].push({n:b,cb:a})};a.prototype.off=function(c){var a=null;-1!=c.indexOf(".")&&(a=c.split("."),c=a[0],
a=a[1]);if(null!=this._callbacks[c])if(null==a)delete this._callbacks[c];else{for(var b=this._callbacks[c],d=[],g=0,k=b.length;g<k;g++)b[g].n!=a&&d.push(b[g]);this._callbacks[c]=d}};a.prototype.triggerEvent=function(c,a){var b=f.activeProject,d=b._callbacks[c];if(null==d)return!0;for(var g=0,k=d.length;g<k;g++){var n=d[g].cb(a);if("shouldChangePage"==c&&null!=n){var m=b.getWidget("_PageMgr",!0).getWebPage(n.toLowerCase());null!=m&&(f.pageNavigationOptions.pageToLoad=m)}if(!1===n)return!1}return!0};
a.prototype._resolveStartPage=function(c,a){var b=null,d=this.getWidget("_UserGroupMgr",!0),g=this.getPageMgr();if(c&&d.isUMTemplate(c))return c;var k=g.getCurrentCategory();if(d.useLastGroupPage()&&!a){var f=d.loadLastPageUsed();if(f&&!g.isUserManagmentPage(f)&&k&&(b=g.getWebPage(f.toLowerCase()))&&-1!=k.pages.indexOf(b))return b}d=d.getHomePage(k.name);c||b||!d||(b=d);c||b||(b=k.home);if(b&&(b=g.getWebPage(b.toLowerCase()),void 0!==b))return b;if(null==c||-1==k.pages.indexOf(c))c="";return c.toLowerCase()};
a.prototype.loadHomePage=function(c,a){var b=this;$hmi.enablePjctWidgetServerReq?$hmi.isTestModeActive()||$hmi.isCoreWidgetsReady().then(function(){b.changePage(null,b._resolveStartPage(c,a))}):this.changePage(null,this._resolveStartPage(c,a))};a.prototype.getCWidgetMgr=function(){return this.cWidgetMgr};a.prototype.subscribeDynamicTags=function(){this.getTagMgr().subscribeDynamicTags()};a.prototype.unsubscribeDynamicTags=function(){this.getWidget("_TagMgr",!0).unsubscribeDynamicTags()};a.prototype.changePageAnimation=
function(c){this.cpAnimation=1==c};a.prototype.showSpinner=function(c){if(this.cpAnimation){var a=this.getNode("spinnerbox");c?yc(a,"translate(0px,0px)"):yc(a,"translate(-10000px,-10000px)")}};a.prototype.getWidgetDefinitions=function(){return this.defs};a.prototype.getWidgetDefinition=function(c){return this.defs[c]};a.prototype.getActionMgr=function(){return this.actMgr};a.prototype.getFocusPage=function(){return f.getFocusPage()};a.prototype.groupButtonIn=function(c,a){var b=c.parentPage.getId();
void 0===this.groupedButtons[b]&&(this.groupedButtons[b]={});void 0===this.groupedButtons[b][a]&&(this.groupedButtons[b][a]={});this.groupedButtons[b][a][c.getId()]=c};a.prototype.updateButtonGroupedByID=function(c,a){var b=c.parentPage.getId();if(this.groupedButtons[b]&&this.groupedButtons[b][a]){var b=this.groupedButtons[b][a],d=c.getId(),g;for(g in b)g!=d&&1==b[g].getValue("value")&&b[g].doMouseDown()}};a.prototype.removeGroupedButton=function(c){this.groupedButtons[c]&&delete this.groupedButtons[c]};
a.prototype.addModule=function(c){var a=this;return this.waitWgtReady().then(function(){a.cWidgetMgr.addModule(c)})};a.prototype.pagedeactivate=function(){};a.prototype.getSrcType=function(c){switch(c.studioId){case "_TagMgr":c="Tag";break;case "_IndexedTagSetMgr":c="Alias";break;case "_RecipeMgr":c="Recipe";break;case "_SysPropMgr":c="Recipe";break;case "_MultiLangMgr":case "_VariablesWgt":case "_AlarmsMgr":case "_EventMgr":c="Widget";break;default:c="Widget"}return c};a.prototype.hasTagInCache=
function(c){return void 0!=f.cache.getTag(c)};a.prototype.isDebugMode=function(){return 1==this.webShowRuntimeErrors};a._renderFlags={BGCOLOR:1,UPDATESTATUSBAR:2};a.jmType="ProjectWgt";return a}(I);f.fn.hmiProject=function(b,a,c,e){return new Za(this,b,a,c)};f.addWidgetDefinition("hmiProject",Za);var U;(function(b){b[b.SEGMENTS=0]="SEGMENTS";b[b.HRZ_STRETCH=1]="HRZ_STRETCH";b[b.VRT_STRETCH=2]="VRT_STRETCH";b[b.VRT=3]="VRT";b[b.HRZ=4]="HRZ"})(U||(U={}));var Rc=function(b){function a(c,a,h,d,g){c=b.call(this,
c.wgtId,a,h,d,g)||this;c.setDefaultState();c.type==U.VRT_STRETCH||c.type==U.HRZ_STRETCH?c.bar=c.elem.getElementsByTagName("svg")[0]:(c.background=c.elem.getElementsByClassName("jm-bargraph-bk")[0],c.bar=c.elem.getElementsByClassName("jm-bargraph-bar")[0]);return c}p(a,b);a.prototype.setDefaultState=function(){this.min=void 0===this.min?0:this.min;this.max=void 0===this.max?100:this.max;this.color=this.color?this.color:"rgb(170,170,170)";this.backgroundColor=void 0==this.backgroundColor?"none":this.backgroundColor;
this.nodes=void 0===this.nodes?0:this.nodes;this.reverse=void 0===this.reverse?!1:this.reverse;this.gpuEnabled=void 0===this.gpuEnabled?!0:this.gpuEnabled;this.type=void 0===this.type?U.SEGMENTS:this.type;this._renderMask=0};a.prototype.setValue=function(c,e,h,d){var g="#000";if("value"===c){if(this.isBadValue(e,!1,h))return!1;e=parseFloat(e);if(isNaN(e))return!1;e!=this.value&&(e>this.max?e=this.max:e<this.min&&(e=this.min),this.value=e,this.elem&&this.elem.setAttribute("data-v",this.value.toString()),
this._renderMask|=a._renderFlags.VALUE,f.addToRender(this),this.sendUpdate(c,this.value,h))}else if("fill"===c){if(this.isBadValue(e,!1,h))return!1;this.color!=e&&(this.color=e,this._renderMask|=a._renderFlags.FILL,f.addToRender(this),this.sendUpdate(c,e,h))}else if("color"==c||"Color"==c)if(isNaN(e)){if(this.isBadValue(e,!0,h))return this.backgroundColor=g,this._renderMask|=a._renderFlags.COLOR,f.addToRender(this),!1;this.backgroundColor!=e&&(0==e.indexOf("#")&&1<e.length&&8>=e.length&&(g=e),this.backgroundColor=
g,this._renderMask|=a._renderFlags.COLOR,f.addToRender(this),this.sendUpdate(c,g,h))}else this._renderMask|=a._renderFlags.COLOR,f.addToRender(this),this.backgroundColor=g;else if("min"==c){if(this.isBadValue(e,!1,h))return!1;e!=this.min&&(e>this.max&&(e=this.max),this.min=e,this._renderMask|=a._renderFlags.VALUE,f.addToRender(this),this.sendUpdate(c,this.min,h))}else if("max"==c){if(this.isBadValue(e,!1,h))return!1;e!=this.max&&(e<this.min&&(e=this.min),this.max=e,this._renderMask|=a._renderFlags.VALUE,
f.addToRender(this),this.sendUpdate(c,this.max,h))}else b.prototype.setValue.call(this,c,e,h,d);return!0};a.prototype.render=function(){b.prototype.render.call(this);var c=f.browserOptimizations.forceLayers;if(this._renderMask&a._renderFlags.VALUE){var e=0;if(this.type==U.SEGMENTS)this.colorSegments();else if(this.type==U.HRZ_STRETCH)e=(this.value-this.min)/(this.max-this.min),c?da(this.bar,"translateZ(0) scaleX("+e+")"):da(this.bar,"scaleX("+e+")");else if(this.type==U.VRT_STRETCH)e=(this.value-
this.min)/(this.max-this.min),c?da(this.bar,"translateZ(0) scaleY("+e+")"):da(this.bar,"scaleY("+e+")");else if(c){var e=(this.value-this.min)/(this.max-this.min),h;if(this.type==U.HRZ_STRETCH||this.type==U.HRZ)h="translateZ(0) scaleX("+e+")";else if(this.type==U.VRT_STRETCH||this.type==U.VRT)h="translateZ(0) scaleY("+e+")";da(this.bar,h)}else c=this.bar.style,this.type==U.VRT?(e=this.height*(this.value-this.min)/(this.max-this.min),this.reverse||(c.top=this.height-e+"px"),c.height=e+"px"):this.type==
U.HRZ&&(e=this.width*(this.value-this.min)/(this.max-this.min),this.reverse&&(c.left=this.width-e+"px"),c.width=e+"px")}if(this._renderMask&a._renderFlags.FILL)switch(this.type){case U.SEGMENTS:this.colorSegments();break;case U.HRZ_STRETCH:case U.VRT_STRETCH:c=this.bar.getElementsByClassName("bgColor00");0<c.length?c[0].setAttribute("fill",this.color):this.bar.firstElementChild.setAttribute("fill",this.color);break;default:this.bar.style.backgroundColor=this.color}if(this._renderMask&a._renderFlags.COLOR)switch(this.type){case U.SEGMENTS:this.colorSegments();
break;default:this.background.style.backgroundColor=this.backgroundColor}this._renderMask&a._renderFlags.UPDATESVG&&this.elem.getElementsByTagName("svg")[0]&&(c=this.elem.getElementsByTagName("svg")[0],e=this.width/parseFloat(c.getAttribute("width")),h=this.height/parseFloat(c.getAttribute("height")),La(c,"top left"),da(c,"scale("+e+","+h+")"));this._renderMask=0};a.prototype.colorSegments=function(){var c=Math.floor((this.value-this.min)/(this.max-this.min)*this.nodes);this.reverse&&(c=this.nodes-
c);for(var a="",b=1;b<=this.nodes;b++){var d=this.elem.querySelector(".jm-hmi-bar-seg-"+b),a=b<=c?this.color:this.backgroundColor;null!=d.style.fill&&(d.style.fill=a);d.setAttribute("fill",a)}};a.prototype.getValue=function(c){return"value"==c?this.value:b.prototype.getValue.call(this,c)};a.prototype.setParentBounds=function(c,a,h,d,g){b.prototype.setParentBounds.call(this,c,a,h,d,g);this.updateOnResize()};a.prototype.updateOnResize=function(c){b.prototype.updateOnResize.call(this,c);this._renderMask|=
a._renderFlags.UPDATESVG;f.addToRender(this)};a.prototype.destroy=function(){this.bar=this.background=null;return b.prototype.destroy.call(this)};a._renderFlags={VALUE:2,FILL:4,COLOR:8,UPDATESVG:16};a.jmType="BargraphWgt";return a}(l);f.fn.hmiBarGraph=function(b,a,c,e){return new Rc(this,b,a,c,e)};f.addWidgetDefinition("hmiBarGraph",Rc);var Sc=function(b){function a(c,a,h,d,g){var k=b.call(this,c.wgtId,a,h,d,g)||this;k.authCode=k.getAuthorizations();k.cnvId=k.wgtId+"_gcnv";k.cnvEl=k.elem.querySelector("#"+
k.cnvId);k.context2d=k.cnvEl.getContext("2d");k.applyContextTransformations();k.events={mousedown:!0,touchstart:!0};f.getEventMgr()&&(k.activateHandler=function(){l.prototype.executeActivationCallback.call(k)&&(k.update(),k.isWgtActive=!0)},l.prototype.bindEvents.call(k,{loadWgt:k.activateHandler}));return k}p(a,b);a.prototype.render=function(){b.prototype.render.call(this);if(this._renderMask&a._renderFlags.DRAW&&this.onDraw){this.clearCanvasContext();for(var c=this.onDraw,e=0;e<c.length;e++)f.doAction(this.wgtId,
c[e])}this._renderMask&a._renderFlags.RESIZE&&(this.cnvEl.width=this.width,this.cnvEl.height=this.height);this._renderMask=0};a.prototype.applyContextTransformations=function(){var c=this.width/this.cnvW,a=this.height/this.cnvH;switch(this.rdrHint){case 1:this.context2d.scale(Math.min(c,a),Math.min(c,a));break;case 2:this.context2d.scale(c,a)}};a.prototype.setValue=function(c,a,h,d,g){b.prototype.setValue.call(this,c,a,h,d,g);this.update()};a.prototype.update=function(){this._renderMask|=a._renderFlags.DRAW;
f.addToRender(this)};a.prototype.clearCanvasContext=function(){this.context2d.clearRect(0,0,this.width,this.height)};a.prototype.doMouseDown=function(){return this.authCode==this.umgr.getWidgetAuthorizationCodes().RDONLY?(this.project.getValue("onAccessDenied")&&this.showHideAccessDeniedIcon(),!1):!0};a.prototype.doMouseUp=function(){return this.authCode==this.umgr.getWidgetAuthorizationCodes().RDONLY?(this.project.getValue("onAccessDenied")&&this.showHideAccessDeniedIcon(),!1):!0};a.prototype.doMouseMove=
function(){if(this.authCode==this.umgr.getWidgetAuthorizationCodes().RDONLY)return!1};a.prototype.destroy=function(){if(this.destroyed)return!1;l.prototype.unbindEvents.call(this,{loadWgt:this.activateHandler});this.clearCanvasContext();return b.prototype.destroy.call(this)};a.prototype.setParentBounds=function(c,e,h,d,g){b.prototype.setParentBounds.call(this,c,e,h,d,g);this._renderMask|=a._renderFlags.RESIZE;f.addToRender(this)};a.jmType="GenericCanvasWgt";a._renderFlags={DRAW:2,RESIZE:4};return a}(l);
f.fn.hmiGenericCanvasWgt=function(b,a,c,e){return new Sc(this,b,a,c,e)};f.addWidgetDefinition("hmiGenericCanvasWgt",Sc);var ic=function(b){function a(c,a,h,d,g){c=b.call(this,c.wgtId,a,h,d,g)||this;c.values={value1:null,value2:null,value3:null,value4:null,value5:null,value6:null,value7:null,value8:null,value9:null,value10:null,value11:null,value12:null,value13:null,value14:null,value15:null,value16:null};return c}p(a,b);a.prototype.setValue=function(c,a,b){this.values[c]!=a&&void 0!=a&&(this.values[c]=
a,this.sendUpdate(c,a,b))};a.prototype.getValue=function(c){return this.values[c]};a.prototype.setParentBounds=function(c,a,b,d,g){};a.prototype.getParentBounds=function(c){return{x:0,y:0,width:0,height:0}};a.prototype.destroy=function(){this.values=null;return this.destroyed?!1:b.prototype.destroy.call(this)};a.prototype.setProperty=function(c,a){this.doWriteValue(c,a);this.setValue(c,a,u.getModule("Tag").QUALITY_GOOD)};a.jmType="JSFunctBlockWgt";a.invokablePropsList="value1 value2 value3 value4 value5 value6 value7 value8 value9 value10 value11 value12 value13 value14 value15 value16".split(" ");
return a}(l);Object.defineProperties(ic.prototype,{value1:{get:function(){return this.getValue("value1")},set:function(b){this.setProperty("value1",b)}},value2:{get:function(){return this.getValue("value2")},set:function(b){this.setProperty("value2",b)}},value3:{get:function(){return this.getValue("value3")},set:function(b){this.setProperty("value3",b)}},value4:{get:function(){return this.getValue("value4")},set:function(b){this.setProperty("value4",b)}},value5:{get:function(){return this.getValue("value5")},
set:function(b){this.setProperty("value5",b)}},value6:{get:function(){return this.getValue("value6")},set:function(b){this.setProperty("value6",b)}},value7:{get:function(){return this.getValue("value7")},set:function(b){this.setProperty("value7",b)}},value8:{get:function(){return this.getValue("value8")},set:function(b){this.setProperty("value8",b)}},value9:{get:function(){return this.getValue("value9")},set:function(b){this.setProperty("value9",b)}},value10:{get:function(){return this.getValue("value10")},
set:function(b){this.setProperty("value11",b)}},value11:{get:function(){return this.getValue("value11")},set:function(b){this.setProperty("value11",b)}},value12:{get:function(){return this.getValue("value12")},set:function(b){this.setProperty("value12",b)}},value13:{get:function(){return this.getValue("value13")},set:function(b){this.setProperty("value13",b)}},value14:{get:function(){return this.getValue("value14")},set:function(b){this.setProperty("value14",b)}},value15:{get:function(){return this.getValue("value15")},
set:function(b){this.setProperty("value15",b)}},value16:{get:function(){return this.getValue("value16")},set:function(b){this.setProperty("value16",b)}}});f.fn.hmiJSFunctBlock=function(b,a,c,e){return new ic(this,b,a,c,e)};f.addWidgetDefinition("hmiJSFunctBlock",ic);var Tb=function(b){function a(c,a,h,d,g){var k=b.call(this,c.wgtId,a,h,d,g)||this;k.tagSetsData={};k.activeCgiGroups={};k.dataLinks={};k.mapIdxToName={};k.idxsInPage={};k.initPromiseReady();k.initialized=!1;k.tagsToUnsubscr=[];k.tagMgr=
f.activeProject.getWidget("_TagMgr",!0);k.tagMgr.subscribeWgt(k,function(c,a){k.trigger(c,a)});if(!f.enablePjctWidgetServerReq)return k;k.parentWidget.waitWgtReady().then(function(){k.srv=k.parentWidget.getCommunticationObj();k.srv.getConf().then(function(c){k.tagSetsData=c["indexedtagset.json"];k.generateMapIdxToName();k.resolveWgtReady();k.initialized=!0}).catch(function(){f.getAction("hmiActionShowMessage").execute(null,{msg:"Error loading indexed tag configuration file. Reloading..."},3);setTimeout(function(){k.project.getCommunticationObj().loadIndex()},
2E3)})});return k}p(a,b);a.prototype.generateMapIdxToName=function(){for(var c in this.tagSetsData)null==this.mapIdxToName[this.tagSetsData[c].idx]&&(this.mapIdxToName[this.tagSetsData[c].idx]=[]),this.mapIdxToName[this.tagSetsData[c].idx].push(c)};a.prototype.removeUnusedIndexes=function(){var c=f.getActiveProject().getPageMgr();if(Object.keys(this.idxsInPage).length>this.project.getValue("pagesCacheSize"))for(var a in this.idxsInPage)c.isCached(c.getWebPage(a.toLowerCase()))||delete this.idxsInPage[a]};
a.prototype.trigger=function(c,a){if("indexedtagsetready"==c&&this.initialized){var b=f.getFocusPage().studioId,d=[],g=[],k=[],n=0,m=0;this.removeUnusedIndexes();if(0<a.length)for(n=0;n<a.length;n++)m=f.cache.getTag(a[n].n),null!=this.mapIdxToName[a[n].n]?(k.push(m),d.push(a[n].n),null==this.idxsInPage[b]&&(this.idxsInPage[b]=[]),-1==this.idxsInPage[b].indexOf(a[n].n)&&this.idxsInPage[b].push(a[n].n)):g.push(a[n]);for(var r in this.mapIdxToName)f.cache.getTag(r)&&this.idxsInPage[b]&&-1!=this.idxsInPage[b].indexOf(r)&&
(m=f.cache.getTag(r))&&-1==d.indexOf(m.name)&&(k.push(m),d.push(m.name));b=[];d=[];r=[];if(0<k.length){for(n=0;n<k.length;n++){var l=this.mapIdxToName[k[n].name];if(0<l.length)for(m=0;m<l.length;m++){var p,C=l[m],q=k[n].getValue().toString();p=this.isIndexedTagGroup(C);if(!p||!this.isGroupAlreadyActive(C,q))if(q=this.getIndexIgnoringCase(C,q),p&&null!=q)p=!1,b.push(C),d.push({ts:C,i:q}),r.push({ts:C,i:q,bi:p});else if(p){p=!0;var q=null,t;for(t in this.activeCgiGroups)if(null!=this.activeCgiGroups[t]&&
this.activeCgiGroups[t].tagName==C){q=this.activeCgiGroups[t];break}null!=q&&(q=q.group.groupName.split("@")[2],r.push({ts:C,i:q,bi:p}))}}}0<b.length&&this.unsubscribeGroups(b);0<d.length&&this.subscribeGroups(d);0<r.length&&this.updateGroupTag(r)}0<g.length&&this.update(g)}};a.prototype.getGroupName=function(c,a){return f.getFocusPage().studioId+"@"+c+"@"+a};a.prototype.isGroupAlreadyActive=function(c,a){var b=this.getGroupName(c,a),d;for(d in this.activeCgiGroups)if(d==b)return!0;return!1};a.prototype.isIndexedTagGroup=
function(c){var a=f.getFocusPage(),b=a.studioId&&a.studioId.toLowerCase(),a=a.templateStudioId&&a.templateStudioId.toLowerCase();return null==this.tagSetsData[c]||null==this.tagSetsData[c].pgs||-1==this.tagSetsData[c].pgs.indexOf(b)&&-1==this.tagSetsData[c].pgs.indexOf(a)?!1:!0};a.prototype.getIndexIgnoringCase=function(c,a){var b=f.getFocusPage();if(null!=this.tagSetsData[c]&&null!=this.tagSetsData[c].pgs){var d=b.studioId&&b.studioId.toLowerCase(),b=b.templateStudioId&&b.templateStudioId.toLowerCase();
if(-1!=this.tagSetsData[c].pgs.indexOf(d)||-1!=this.tagSetsData[c].pgs.indexOf(b))for(var d=Object.keys(this.tagSetsData[c].inst),b=0,g=d.length;b<g;b++)if(d[b].toLowerCase()==a.toLowerCase())return d[b]}return null};a.prototype.unsubscribeGroups=function(c){var a=[],b;for(b in this.activeCgiGroups)this.activeCgiGroups[b].pageWebId==f.getFocusPage().wgtId&&-1!=c.indexOf(this.activeCgiGroups[b].tagName)&&(a.push(b),delete this.activeCgiGroups[b]);this.srv.unsubscribeGroups(a)};a.prototype.unsubscribePageGroups=
function(c){var a=[],b;for(b in this.activeCgiGroups)this.activeCgiGroups[b].pageWebId==c&&a.push(b);this.srv.unsubscribeGroups(a);this.srv.unsubscribeTags(this.tagsToUnsubscr,null);this.tagsToUnsubscr=[]};a.prototype.subscribeGroups=function(c){for(var a=f.activeProject.getWidget("_TagMgr",!0),b=f.getFocusPage(),d=[],g=0;g<c.length;g++){var k=c[g],n=this.getGroupName(k.ts,k.i),m=new Hb({wgtId:n},n,{groupName:n,tagMgr:a,tags:this.tagSetsData[k.ts].inst[k.i].tgs},b,b);this.activeCgiGroups[n]={group:m,
tagName:k.ts,pageWebId:b.wgtId};d.push(n)}this.srv.subscribeGroups(d,null)};a.prototype.updateGroupTag=function(c){var a=[],b;for(b in c){var d=c[b],g=this.getGroupName(d.ts,d.i),k=this.activeCgiGroups[g].group.tags;for(b in k){var n=b.split(".")[0],k=d.i;if(n=f.cache.getTag(n))for(var m=this.activeCgiGroups[g].group.tags[b],r=0;r<m.length;r++){var l=d.ts+"."+m[r];this.dataLinks[l]&&(d.bi?this.sendUpdate(l,void 0,n.getQuality(),k):this.sendUpdate(l,n.getValue(),n.getQuality(),k))}}d.bi&&a.push(d.ts)}0<
a.length&&this.unsubscribeGroups(a)};a.prototype.update=function(c){for(var a=new (u.getModule("Quality"))(0),b=0;b<c.length;b++){var d=f.cache.getTag(c[b].n),g=d.getValue(),k=d.name,n=[],m;for(m in this.activeCgiGroups)if(void 0!=this.activeCgiGroups[m].group.tags){var r=this.activeCgiGroups[m].group.tags,l=this.activeCgiGroups[m].tagName,p=[],C;for(C in r){var q=C.split(".");if(q[0]==k)for(p=r[C],1<q.length&&(q=parseInt(q[1].substr(1,q[1].length-1)),g instanceof Array&&-1!=q&&(g=g[q])),q=0;q<p.length;q++)if(n=
l+"."+p[q],void 0!=this.dataLinks[n])for(var n=this.dataLinks[n],t=0;t<n.length;t++)if(d.isQualityGood()){var w=0;0!=n[t].tagIndex?w=n[t].tagIndex:n[t].tgtWgt.index&&(w=n[t].tgtWgt.index);g instanceof Array?"Index"==n[t].attr?n[t].setWgtValue(g,w,d.getQuality(),null,d.ts):-1==w?n[t].setWgtValue(g,w,d.getQuality()):void 0==g[w]?n[t].setWgtValue(g[w],w,a,null,d.ts):n[t].setWgtValue(g[w],w,d.getQuality(),null,d.ts):n[t].setWgtValue(g,-1,d.getQuality(),null,d.ts)}else n[t].setWgtValue(null,-1,d.getQuality(),
null,d.ts)}}}};a.prototype.sendUpdate=function(c,a,b,d){for(var g=this.dataLinks[c],k=new (u.getModule("Quality"))(0),f=0;f<g.length;f++){var m=0;-1!=g[f].tagIndex?m=g[f].tagIndex:g[f].tgtWgt.index&&(m=g[f].tgtWgt.index);if(g[f].tag==c)if(g[f].dataSrc.getValue(g[f].tag)instanceof Array){var r=g[f].dataSrc.getValue(g[f].tag).length;0>m||m>r-1?g[f].setWgtValue(a,m,k):g[f].setWgtValue(a,m,b)}else m=d,g[f].setWgtValue(a,m,b)}};a.prototype.getNameByTagAlias=function(c){c=c.split(".");var a=c[0],b=c[1],
d;c=-1;var g=f.cache.getTag(this.tagSetsData[a].idx);if(g&&(g=g.getValue().toString(),g=this.getIndexIgnoringCase(a,g),null!=this.tagSetsData[a].inst[g])){var a=this.tagSetsData[a].inst[g].tgs,k;for(k in a)if(-1!=a[k].indexOf(b)){d=k;break}}if(void 0!=d)return k=d.split("."),1<k.length&&(d=k[0],c=parseInt(k[1].substr(1,k[1].length-1))),{tag:d,idx:c}};a.prototype.getValue=function(c,a){var b;if(this.initialized){var d=this.getNameByTagAlias(c),g;d&&(b=d.tag,g=d.idx,b=f.cache.getTag(b))}return b?(void 0==
a&&(a=g),b.getValue(a)):null};a.prototype.setValue=function(c,a,b,d){var g=u.getModule("Tag"),k=this.getNameByTagAlias(c),n;if(k){n=k.tag;k=k.idx;-1!=k&&(b=k);if(d){c=new B;var m=f.activeProject.getWidget("_TagMgr",!0);m.tagsInfo[n]&&(m=g.getTypeRange(m.tagsInfo[n].t),null!=m&&(a<m.min?a=m.max-Math.abs(m.min-a):a>m.max&&(a=m.min+Math.abs(a-(m.max+1)))));return this.srv.writeTag(new g(n,b,null,null,null,null),a,c,!1)}(k=f.cache.getTag(n))&&this.dataLinks[c]&&(d=k.getQuality(),k.value instanceof Array?
(m=f.cache.getTag(n).clone(!1),0<=b&&b<m.value.length&&(m.value[b]=parseFloat(a)),m=m.value):m=a,m=new g(n,b,m,"S_OK",d),f.cache.updateTag(n,m)&&this.sendUpdate(c,a,d,b));return m}return new g(n,b,null,null,null,null)};a.prototype.subscribeDataLink=function(c){var a=c.tag;this.dataLinks[a]||(this.dataLinks[a]=[]);this.dataLinks[a].push(c);c=c.tag.split(".")[0];c=this.tagSetsData[c].idx;var a=f.getFocusPage().wgts[f.getFocusPage().studioId+"@$GroupSubscrWgt@$0"],b=null;f.getFocusPage().templateStudioId&&
(b=f.getFocusPage().wgts[f.getFocusPage().templateStudioId+"@$GroupSubscrWgt@$0"]);var d=a?a.tags:null,g=b?b.tags:null;d&&!d[c]&&(this.tagsToUnsubscr.push(c),this.tagMgr.subscribeForTagsNotification([c]));g&&!g[c]&&(this.tagsToUnsubscr.push(c),this.tagMgr.subscribeForTagsNotification([c]));a||b||(this.tagsToUnsubscr.push(c),this.tagMgr.subscribeForTagsNotification([c]))};a.prototype.unsubscribeDataLink=function(c){this.removeDataLink(c)};a.prototype.removeDataLink=function(c){for(var a=this.dataLinks[c.tag],
b=null,d=0,g=a.length;d<g;d++)if(a[d].getId()==c.getId()){b=d;break}null!=b&&(a.splice(b,1),0==a.length&&delete this.dataLinks[c.tag])};a.jmType="IndexedTagSetMgrWgt";return a}(l);f.fn.hmiIndexedTagSetMgr=function(b,a,c,e){return new Tb(this,b,a,c,e)};f.addWidgetDefinition("hmiIndexedTagSetMgr",Tb);(function(b){b[b.INIT_PRM=0]="INIT_PRM"})(xa||(xa={}));$b=function(){function b(){this._prmWgtReady=null}b.prototype.resolveWgtReady=function(a){throw xa.INIT_PRM;};b.prototype.rejectWgtReady=function(a){throw xa.INIT_PRM;
};b.prototype.initPromiseReady=function(){var a=this;this._prmWgtReady=new Promise(function(c,b){a.resolveWgtReady=c;a.rejectWgtReady=b})};b.prototype.waitWgtReady=function(){if(this._prmWgtReady)return this._prmWgtReady;throw xa.INIT_PRM;};return b}();(function(b){b[b.NORMAL=0]="NORMAL";b[b.TEMPLATE=1]="TEMPLATE"})(ya||(ya={}));var Ma=function(b){function a(c){var a=b.call(this)||this;a.project=c;a.cwgts={};a.instancesMap={};a.HTMLTemplatePolyfillEnabled=HTMLTemplateElement.bootstrap instanceof Function;
c=document.getElementById("hmi-templates");var h=!1;a.initPromiseReady();c&&(h=0!=c.childNodes.length);f.isTestModeActive()?a.resolveWgtReady(!0):h?a.resolveWgtReady(!0):a.project.getCommunticationObj().getResource("templates.xml").then(function(c){document.getElementById("hmi-templates").innerHTML=c;a.HTMLTemplatePolyfillEnabled&&HTMLTemplateElement.bootstrap(document);a.resolveWgtReady(!0)}).catch(function(){a.resolveWgtReady(!1)});return a}p(a,b);a.prototype.setCWMap=function(c,a){null==this.instancesMap[c]&&
(this.instancesMap[c]=a)};a.prototype.getCWMap=function(c){c=this.instancesMap[c];return void 0!=c?c:null};a.prototype.freeCWInstances=function(c){delete this.instancesMap[c]};a.prototype.getAttributeLink=function(c,a){c=c.toLowerCase();return void 0!==this.cwgts[c]&&null!==this.cwgts[c].props?this.cwgts[c].props.attr[a]:[]};a.prototype.hasAttribute=function(c,a){c=c.toLowerCase();return void 0!==this.cwgts[c]&&null!==this.cwgts[c].props};a.prototype.getParameters=function(c){c=c.toLowerCase();return void 0!==
this.cwgts[c]&&null!==this.cwgts[c].props?this.cwgts[c].props.par:[]};a.prototype.isRegisteredModule=function(c){c=c.toLowerCase();return void 0!==this.cwgts[c]};a.prototype.hasGfxInheritance=function(c){c=c.toLowerCase();c=this.cwgts[c];return null!=c&&null!=c.conf&&null!=c.conf.w};a.prototype.findCustomWidget=function(c,a){var b=null,d=null;void 0!=a&&(d=this.getCWMap(a));for(var g=c.querySelectorAll("[data-ctype]"),k=0,f=g.length;k<f;k++){var m=g[k],r=m.getAttribute("data-ctype"),l="1"==m.getAttribute("data-tmpl");
this.isRegisteredModule(r)&&(null===b&&(b={p:[],t:[]}),m={webId:m.getAttribute("id"),studioId:m.getAttribute("data-sid"),moduleName:r},l?(b.t.push(m),null!=d&&d.t.push(m)):(b.p.push(m),null!=d&&d.p.push(m)))}return b};a.prototype.addModule=function(c){this.cwgts[c.name]=c};a.prototype.injectCWTemplates=function(c,a){var b=this.getCWMap(a),d=c.getAttribute("id")!=a;if(null==b||d){b=this.findCustomWidget(c,a);if(null==b)return;d||this.setCWMap(a,b)}this.injectCW(c,b.t,a,ya.TEMPLATE);this.injectCW(c,
b.p,a,ya.NORMAL)};a.prototype.injectCW=function(c,a,b,d){if(void 0!==a)for(var g=0,k=a.length;g<k;g++){var f=a[g].webId,m=a[g].studioId,r=a[g].moduleName.toLowerCase(),l=this.cwgts[r];if(void 0!==l){null===l.template&&(l.template=document.getElementById(r));l=l.template;r=c.querySelector("#"+CSS.escape(f));null!=l&&null!=r&&(l instanceof HTMLTemplateElement?r.appendChild(l.content.cloneNode(!0)):l instanceof DocumentFragment&&r.appendChild(l.cloneNode(!0)));for(var l=r.querySelectorAll(".jm-wgt, .jm-wgt>div, .jm-hmi-col, canvas"),
p=0,q=l.length;p<q;p++){var t=l[p];if("*"===t.id.charAt(0)&&"."===t.id.charAt(1)){t.id=t.id.replace("*",f);var u=t.getAttribute("data-sid");null!=u&&t.setAttribute("data-sid",u.replace("*",m))}d==ya.TEMPLATE&&t.setAttribute("data-tmpl","1")}this.injectCWTemplates(r,b)}}};a.prototype.instantiateCW=function(c,a){var b;a=a.toLowerCase();var d=this.cwgts[a],g=this.project.getWidgetDefinitions(),k=this.project.getActionMgr(),n=(b={},b[a]=c,b);if(null!=d&&null!=d.conf&&null!=d.conf.w){c.setModule();d.conf.grid&&
c.setGridLayout(d.conf.grid);b=d.conf.w;for(var m=0,r=b.length;m<r;m++){var l=b[m],p=l.w.replace("*",c.wgtId),q=this.deepClonePlainObject(l.p),t=void 0,t=void 0!==l.s?l.s.replace("*",c.studioId):p,u=n[l.f.toLowerCase()];-1!=l.t.indexOf("hmiAction")?(q.module=c,t=k.getActionDefinition(l.t),n[l.w]=new t({wgtId:p},l.e,q,this.project.getFocusPage(),u)):"hmiAttach"===l.t?f.hmiAttach(n[l.w],l.s,q):(q.isTemplateWgt=c.isTemplateWgt,q.module=c,c.isClone&&(q.isClone=c.isClone,q.protoWgtId=c.protoWgtId+"."+
l.w.substring(2),q.tableGroupWgt=c.tableGroupWgt,q.ext=c.ext),"hmiCWMLTextMgr"==l.t&&d.tr&&this.applyMLPatch(q.texts,d.tr),void 0===u&&(u=c),n[l.w]=new g[l.t]({wgtId:p},t,q,this.project.getFocusPage(),u))}this.subscribeAttributeLinks(d,c);k=g=void 0;Wb(c.mtx)?(g=c.width,k=c.height):(k=c._map(c.mtx,{x:c.width,y:c.height}),g=k.x,k=k.y);n=c.left;b=c.top;c.width=d.conf.br.width;c.height=d.conf.br.height;c.left=0;c.top=0;n==c.left&&c.top==b&&c.width==g&&c.height==k||c.setParentBounds(n,b,g,k,c.parentWidget);
this.bindJSClass(c)}};a.prototype.subscribeAttributeLinks=function(c,a){if(null!==c.props&&null!==c.props.attr)for(var b in c.props.attr){var d=c.props.attr[b];if(0<d.length)for(var g=0,k=d.length;g<k;g++){var f=d[g].lastIndexOf("."),m=d[g].substring(0,f),f=a.getWidget(m,!0,a.isTemplateWgt);if(null==f){var r=m.replace(/[0-9]/g,""),m=parseInt(m.substring(r.length));isNaN(m)&&(m=1);var l=[];a.getWidgetsByJMClass(r,m,l);l.length==m&&(f=l[m-1])}null!=f&&f.subscribeWgt(a,function(c,a){return function(b,
e){"mdup"==b&&c.sendUpdate(a,e.v,e.q)}}(a,b))}}};a.prototype.applyMLPatch=function(c,a){for(var b in a){var d=c[b],g=a[b],k;for(k in g)d[k]=g[k]}};a.prototype.bindJSClass=function(c){var a=this.cwgts[c.ctype.toLowerCase()];void 0!==a&&null!=a.js&&a.js.call(c,c)};a.prototype.bindCWLogicClass=function(c,a){var b=this.getCWMap(a?a:"_"+c.wgtId);if(null!==b){for(var d=b.t,g=0,k=d.length;g<k;g++){var f=d[g];this.hasGfxInheritance(f.moduleName)||(f=c.getWidget(f.webId),this.subscribeAttributeLinks(this.cwgts[f.ctype.toLowerCase()],
f),this.bindJSClass(f))}d=b.p;g=0;for(k=d.length;g<k;g++)f=d[g],this.hasGfxInheritance(f.moduleName)||(f=c.getWidget(f.webId),this.subscribeAttributeLinks(this.cwgts[f.ctype.toLowerCase()],f),this.bindJSClass(f));(0<b.t.length||0<b.p.length)&&c.bindCWCallbacks()}};a.prototype.deepCloneArray=function(c){for(var a=c.length,b=Array(a),d=0;d<a;d++){var g=c[d],k=typeof g;b[d]="number"==k||"boolean"==k?g:this.deepClonePlainObject(g)}return b};a.prototype.deepClonePlainObject=function(c){if(null===c)return null;
switch(typeof c){case "string":return c.slice(0);case "object":if(Array.isArray(c))return this.deepCloneArray(c);var a={},b;for(b in c){var d=c[b];if(Array.isArray(d))a[b]=this.deepCloneArray(d);else{var g=typeof d;a[b]="number"==g||"boolean"==g?d:this.deepClonePlainObject(d)}}return a;default:return c}};return a}($b),jc=function(b){function a(c,a,h,d,g){c=b.call(this,c.wgtId,a,h,d,g)||this;if(!f.enablePjctWidgetServerReq)return c;c.setDefaultState();var k=c;c.firstLangLoad=!0;c.mlMgr=f.activeProject.getWidget("_MultiLangMgr",
!0);if(c.mlMgr){c.mlMgr.subscribe(c.wgtId,function(c){k.isActive()&&k.changePageLanguage(c)});if(c.parentPage.elem){if(a=c.parentPage.elem.getAttribute("data-hmilang"))c.curLangId=a;if(a=f.getEventMgr())k=c,c.activateHander=function(){k.load()},c.deactivateHander=function(){k.unload()},a.on(c.parentPage.elem,"loadWgt",c.activateHander),a.on(c.parentPage.elem,"unloadWgt",c.deactivateHander)}c.module&&c.module.setCWMLTextMgr(c);c.checkForLanguageUpdate();c.status=!0}return c}p(a,b);a.prototype.setDefaultState=
function(){this.curLangId=null!=this.curLangId?this.curLangId:null;this.mlMgr=null!=this.mlMgr?this.mlMgr:null};a.prototype.checkForLanguageUpdate=function(){var c=this.mlMgr.curLangId;(this.curLangId!=c||this.firstLangLoad)&&this.changePageLanguage(c)};a.prototype.load=function(){this.status=!0;this.checkForLanguageUpdate()};a.prototype.unload=function(){this.status=!1};a.prototype.changePageLanguage=function(c){if(this.curLangId!=c||this.firstLangLoad){this.firstLangLoad=!1;this.curLangId=c;var a=
this.parentPage.wgts,b;for(b in a){var d=a[b],g=!this.isTemplateWgt&&!d.isTemplateWgt,k=this.isTemplateWgt&&d.isTemplateWgt,f=void 0,f=d instanceof Na?d.hasModule&&d.hasMLManager():null!=d.module&&d.module.hasMLManager();!g&&!k||f||d.updateLanguage()}this.parentPage.elem&&!this.isTemplateWgt&&this.parentPage.elem.setAttribute("data-hmilang",c)}};a.prototype.getMLTexts=function(c){return this.texts[c]};a.prototype.getText=function(c,a){return this.texts[c]?this.texts[c][this.curLangId]:null};a.prototype.getCurrentFont=
function(){return this.mlMgr.getLanguageFont(this.curLangId)};a.prototype.getCurrentLanguage=function(){return this.mlMgr.curLangId};a.prototype.getMultiLanguagesMgr=function(){return this.mlMgr};a.prototype.isActive=function(){return this.status};a.prototype.setValue=function(c,a){};a.prototype.getValue=function(c){};a.prototype.destroy=function(){this.mlMgr&&this.mlMgr.unsubscribe(this.wgtId);var c=f.getEventMgr();c.off(this.parentPage.elem,"loadWgt",this.activateHander);c.off(this.parentPage.elem,
"unloadWgt",this.deactivateHander);return b.prototype.destroy.call(this)};a.jmType="PageMLTextMgrWgt";return a}(l);f.fn.hmiPageMLTextMgr=function(b,a,c,e){return new jc(this,b,a,c,e)};f.addWidgetDefinition("hmiPageMLTextMgr",jc);var Ue=function(b){function a(c,a,h,d,g){return b.call(this,c,a,h,d,g)||this}p(a,b);a.prototype.changePageLanguage=function(c){if(this.curLangId!=c||this.firstLangLoad){this.firstLangLoad=!1;this.curLangId=c;c=this.parentWidget.wgts;for(var a in c){var b=c[a];(!this.isTemplateWgt&&
!b.isTemplateWgt||this.isTemplateWgt&&b.isTemplateWgt)&&b.updateLanguage()}a=u.getModule("Tag");c=this.parentWidget.getAttributeLinks();for(var d in c)b=c[d],b.t==bb.MLPATCH&&(b=b.v[parseInt(this.curLangId.substr(1))],this.parentWidget.setValue(d,b,a.QUALITY_GOOD))}};a.prototype.getMLTexts=function(c){return this.texts[c]};a.prototype.getText=function(c,a,b){if(a&&b){var d=a.getUserId().split(".");b="*."+d[d.length-1]+"."+b;if((d=this.parentWidget.getAttributeLinks())&&(b=d[b])&&b.t==bb.MLPATCH)return b.v[this.curLangId.substr(1)]}return a&&
a.isClone?a.tableGroupWgt.getText(c,this.curLangId):this.texts[c]?this.texts[c][this.curLangId]:null};a.jmType="CustomWgtMLTextMgrWgt";return a}(jc);f.addWidgetDefinition("hmiCWMLTextMgr",Ue);Zb=function(){function b(){this.dataLinks=null}b.prototype.addDataLink=function(a){this.parentPage?this.parentPage.registerLink(a):this.registerLink&&this.registerLink(a);this.subscribeDataLink(a)};b.prototype.subscribeDataLink=function(a){void 0==this.dataLinks&&(this.dataLinks={});this.dataLinks[a.getId()]=
a};b.prototype.removeDataLink=function(a){delete this.dataLinks[a.getId()]};b.prototype.registerLink=function(a){};b.prototype.getWidget=function(a,c,b){return null};b.prototype.setProperty=function(a,c){var b=u.getModule("Tag");this.setValue(a,c,b.QUALITY_GOOD)};b.prototype.setValue=function(a,c,b,h,d){};b.prototype.getValue=function(a){return null};b.prototype.getId=function(){return""};b.prototype.destroy=function(){for(var a in this.dataLinks){var c=this.dataLinks[a];c.dataSrc.getId()!=this.getId()?
c.dataSrc.removeDataLink(c):c.tgtWgt.getId()!=this.getId()&&c.tgtWgt.removeDataLink(c)}};b.prototype.unmountLinks=function(){for(var a in this.dataLinks)this.dataLinks[a].unmount()};b.prototype.mountLinks=function(){for(var a in this.dataLinks)this.dataLinks[a].mount(),this.dataLinks[a].update()};return b}();(function(b){b[b.EMPTY=-1]="EMPTY";b[b.BOOLEAN=0]="BOOLEAN";b[b.BYTE=1]="BYTE";b[b.SHORT=2]="SHORT";b[b.INT=3]="INT";b[b.UNSIGNEDBYTE=4]="UNSIGNEDBYTE";b[b.UNSIGNEDSHORT=5]="UNSIGNEDSHORT";b[b.UNSIGNEDINT=
6]="UNSIGNEDINT";b[b.FLOAT=7]="FLOAT";b[b.DOUBLE=8]="DOUBLE";b[b.STRING=9]="STRING";b[b.BINARY=10]="BINARY";b[b.TIME=11]="TIME";b[b.INT64=12]="INT64";b[b.UINT64=13]="UINT64";b[b.INT64A=14]="INT64A";b[b.UINT64A=15]="UINT64A"})(w||(w={}));(function(b){b[b.EMPTY=0]="EMPTY";b[b.BIT=1]="BIT";b[b.BYTE=2]="BYTE";b[b.SHORT=3]="SHORT";b[b.INT=4]="INT";b[b.UNSIGNED_BYTE=5]="UNSIGNED_BYTE";b[b.UNSIGNED_SHORT=6]="UNSIGNED_SHORT";b[b.UNSIGNED_INT=7]="UNSIGNED_INT";b[b.FLOAT=8]="FLOAT";b[b.DOUBLE=9]="DOUBLE";b[b.STRING=
10]="STRING";b[b.BINARY=11]="BINARY";b[b.TIME=12]="TIME";b[b.ARRAY_BIT=13]="ARRAY_BIT";b[b.ARRAY_BYTE=14]="ARRAY_BYTE";b[b.ARRAY_SHORT=15]="ARRAY_SHORT";b[b.ARRAY_INT=16]="ARRAY_INT";b[b.ARRAY_UNSIGNED_BYTE=17]="ARRAY_UNSIGNED_BYTE";b[b.ARRAY_UNSIGNED_SHORT=18]="ARRAY_UNSIGNED_SHORT";b[b.ARRAY_UNSIGNED_INT=19]="ARRAY_UNSIGNED_INT";b[b.ARRAY_FLOAT=20]="ARRAY_FLOAT";b[b.ARRAY_DOUBLE=21]="ARRAY_DOUBLE";b[b.ARRAY_TIME=22]="ARRAY_TIME";b[b.UINT64=23]="UINT64";b[b.INT64=24]="INT64";b[b.ARRAY_UINT64=25]=
"ARRAY_UINT64";b[b.ARRAY_INT64=26]="ARRAY_INT64";b[b.OBJECT=27]="OBJECT"})(Xa||(Xa={}));var Qb=function(b){function a(c,a,h,d){var g=b.call(this)||this;g.dataSrc=null;g.tgtWgt=null;g.attr="";g.dataSrc=null;g.dataSrcId="";g.numXforms=0;g.rw="r";g.tag="";g.tagIndex=-1;g.tagType=-1;g.tagRange=null;g.initialized=!0;g.id=c;g._options=d;g.tgtWgt=a;g.page=f.getFocusPage();g.setDataSrcWgt(h);g.initOptions(d);c=u.getModule("Tag");g.quality_good=c.QUALITY_GOOD;g.quality_uncertain=c.QUALITY_UNCERTAIN;return g}
p(a,b);a.prototype.setOptions=function(c){this._options=c};a.prototype.getOptions=function(){return this._options};a.prototype.resolveTagName=function(){if(!(this.dataSrc instanceof Tb||this.dataSrc instanceof kc||this.dataSrc instanceof hc)&&"*"!==this.tag.charAt(0)&&-1!==this.tag.indexOf(".")){var c=this.tag.split(".");if(1<c.length){var a=c[c.length-1],c=this.dataSrc.getWidgetByJMType(c[c.length-2]);this.tag=a;this.dataSrc=c;this.dataSrcId=c.wgtId}}};a.prototype.initOptions=function(c){if(null!=
c){for(var a in c)"xforms"!=a&&(this[a]=c[a]);null!=this.tagType&&(this.tagRange=u.getModule("Tag").getTypeRange(this.tagType));this.resolveTagName();this.loadXForms(c.xforms);this.loadStructuredTag()}};a.prototype.loadXForms=function(c){if(c&&0<c.length){this.numXforms=c.length;this.xforms=Array(this.numXforms);for(var a=f.getActiveProject(),b=0,d=this.numXforms;b<d;b++){var g=void 0;if(c[b]instanceof za)g=c[b];else{var k=c[b],g=new (a.getWidgetDefinition(k.hmiConstructor))({wgtId:k.id},k.id,Oa({className:k.className},
k.parameters),f.getFocusPage(),this.tgtWgt);if(k.datalinks)for(var n=0,m=k.datalinks.length;n<m;n++){var r=k.datalinks[n].p,l=void 0,p=0,l=0==r.wT?this.tgtWgt.parentPage.getProject().getWidget(r.dataSource,!0):this.tgtWgt.parentPage.getWidget(r.dataSource,!0);this.parentPage&&(p=this.tgtWgt.parentPage.getLoadingMode());f.createAndMountDataLink(g,l,r,p)}}g&&g.setDLink(this);this.xforms[b]=g}}};a.prototype.resolveParameterReference=function(c){for(var a=c.match(/\${\w*}/g),b=0;b<a.length;b++){var d=
a[b];if(null!==d&&3<d.length){var g=d.substring(2,d.length-1),k=this.tgtWgt.getModule();if(null!==k)if(k.hasParameter(g))c=c.replace(d,k.getValue(g)),k.addParameterDataLink(g,this);else if(k=k.getParentModuleWithParameter(g))c=c.replace(d,k.getValue(g)),k.addParameterDataLink(g,this)}}return c};a.prototype.loadStructuredTag=function(){if(null!=this._tag&&""!=this._tag){var c=this.resolveParameterReference(this._tag),a=this.tagIndex;null!=this._tagIndex&&""!=this._tagIndex&&(a=parseFloat(this.resolveParameterReference(this._tagIndex)));
(this.tag!=c&&this._tag!=c||this.tagIndex!=a)&&this.updateDataSourceAttribute(c,a);this.dataSrc.updateDataLink(this)}};a.prototype.getModule=function(){return this.tgtWgt.getModule()};a.prototype.addInternalLink=function(c){void 0===this.links&&(this.links=[]);this.links.push(c)};a.prototype.mountInternalLinks=function(){if(this.links&&0<this.links.length)for(var c=0,a=this.links.length;c<a;c++){var b=this.links[c].s,d=this.links[c].p,b=0==d.wT?this.page.getProject().getWidget(b,!0):this.page.getWidget(b,
!0),d=f.createDataLink(this,b,d);d.update();d.mount()}};a.prototype.unmountInternalLinks=function(){if(this.links&&0<this.links.length)for(var c in this.dataLinks)this.dataLinks[c].unmount()};a.prototype.unmountXForms=function(){for(var c=this.page.getProject().getFocusPage(),a=0,b=this.xforms;a<b.length;a++)c.removeXForm(b[a].getId())};a.prototype.mount=function(){this.tgtWgt.addDataLink(this);this.dataSrc&&this.dataSrc.subscribeDataLink(this);this.mountInternalLinks();if(this.xforms)for(var c=0,
a=this.xforms;c<a.length;c++)a[c].mountLinks();return this};a.prototype.unmount=function(){this.tgtWgt.removeDataLink(this);this.dataSrc&&this.dataSrc.unsubscribeDataLink(this);this.unmountInternalLinks();if(this.xforms)for(var c=0,a=this.xforms;c<a.length;c++)a[c].unmountLinks();return this};a.prototype.update=function(){if("rw"===this.rw||"r"===this.rw){var c=f.cache.getTag(this.tag),a=this.srcType;"Widget"==a||"Data"==a||"Recipe"==a||"Alias"==a?(c=this.dataSrc.getValue(this.tag,this.tagIndex),
this.setWgtValue(c,-1,this.quality_good,!1,null)):"System"==a?(c=this.dataSrc.getValue(this.tag),this.tgtWgt.setValue(this.attr,c,this.quality_good,this.tagIndex)):c?this.setWgtValue(c.getValue(this.tagIndex),-1,c.getQuality(),!1,c.ts):this.tgtWgt.setValue(this.attr,void 0,this.quality_uncertain)}return this};a.prototype.updateDSParameter=function(){if(null!=this._tag){var c=this.resolveParameterReference(this._tag),a=this.tagIndex;null!=this._tagIndex&&""!=this._tagIndex&&(a=parseFloat(this.resolveParameterReference(this._tagIndex)));
if(this.tag!=c&&this._tag!=c||this.tagIndex!=a)this.updateDataSourceAttribute(c,a),this.dataSrc.updateDataLink(this),"TagMgrWgt"==this.dataSrc.getJMType()&&this.dataSrc.subscribeDynamicTags()}};a.prototype.updateDataSourceAttribute=function(c,a){this.dataSrc.unsubscribeDataLink(this);this.tag=c;this.tagIndex=a;this.dataSrc.subscribeDataLink(this)};a.prototype.setWgtValue=function(c,a,b,d,g){this.enableUpdate=null!=d?d:!0;if("w"!=this.rw){var k=this.tgtWgt.getValue(this.attr);0<this.numXforms&&(c=
this.doXform(c,"r"));if("undefined"!=typeof this.tgtWgt.onDataUpdate&&this.enableUpdate&&k!=c)if(f.activeProject.isProjectReady())this.doOnDataUpdate(c,k,this.attr,0,"R");else{var n=this;f.isCoreWidgetsReady().then(function(){n.doOnDataUpdate(c,k,n.attr,0,"R")})}void 0===a&&(a=this.tagIndex);this.tgtWgt.setValue(this.attr,c,b,a,g)}};a.prototype.doOnDataUpdate=function(c,a,b,d,g){if(void 0!=this.tgtWgt&&void 0!=this.tgtWgt.onDataUpdate){c={attribute:this.attr,oldValue:a,newValue:c,attrName:b,mode:g,
index:d};a=this.tgtWgt.onDataUpdate;for(b=0;b<a.length;b++)f.doAction(this.tgtWgt.wgtId,a[b],c);f.actionMgr.doActions()}};a.prototype.setTagValue=function(c){if(null!=this.dataSrc){var a=c,b=0;if(0<this.numXforms){c=this.doXform(a,"w");c=this.scaleTagValues(c);var d=this.doXform(c,"r");a!=d&&this.tgtWgt.setValue(this.attr,d,this.quality_good)}else c=this.scaleTagValues(c);var g=this.dataSrc.getValue(this.tag,this.tagIndex);if("undefined"!=typeof this.tgtWgt.onDataUpdate&&g!=c){var k=this.tagIndex;
if(f.activeProject.isProjectReady())this.doOnDataUpdate(c,g,this.attr,k,"W");else{var n=this;f.isCoreWidgetsReady().then(function(){n.doOnDataUpdate(c,g,n.attr,k,"W")})}}-1!=this.tagIndex?b=this.tagIndex:this.tgtWgt.index&&(b=this.tgtWgt.index);return this.dataSrc.constructor==Cb?this.dataSrc.setValue(this.tag,c,b,!0):this.dataSrc.constructor==Tb?Promise.resolve(this.dataSrc.setValue(this.tag,c,b,!0)):Promise.resolve(this.dataSrc.setValue(this.tag,c,this.quality_good,b,!0))}return Promise.resolve(!0)};
a.prototype.isOutOfTagRange=function(c){return c<this.tagRange.min||c>this.tagRange.max};a.prototype.castWithSign=function(c){var a,b;switch(this.tagType){case w.BYTE:a=255;b=128;break;case w.SHORT:a=65535,b=32768}return this.isOutOfTagRange(c)&&(c&=a,0!=(c&b))?-((~c&a)+1):c};a.prototype.scaleTagValues=function(c){var a=this.tagType,b=!isNaN(c),d=0!=c%1;switch(a){case w.BOOLEAN:return b?1==c?1:0:0;case w.BYTE:case w.SHORT:return b?d?Math.round(this.castWithSign(c)):this.castWithSign(c):0;case w.INT:return b?
Math.round(c):0;case w.FLOAT:case w.DOUBLE:return b?c:0;case w.UNSIGNEDBYTE:return b?(c=Math.round(c)>>>0,d?Math.round(c)&255:c&255):0;case w.UNSIGNEDSHORT:return b?(c=Math.round(c)>>>0,d?Math.round(c)&65535:c&65535):0;case w.UNSIGNEDINT:return b?(c=Math.round(c)>>>0,d?Math.round(c)&4294967295:c&4294967295):0;default:return c}};a.prototype.doXform=function(c,a){for(var b=0;b<this.numXforms;b++){var d=this.xforms[b];if(void 0!=d){var g=d.getValue();c=d.execute(this,c,a,g)}}return c};a.prototype.getId=
function(){return this.id};a.prototype.getDataSrc=function(){return this.dataSrc};a.prototype.getAttribute=function(){return this.attr};a.prototype.getTag=function(){return this.tag};a.prototype.getTagType=function(){return this.tagType};a.prototype.getTagValue=function(){var c=this.dataSrc.getValue(this.tag);"object"==typeof c&&c.constructor==Array&&(c=-1==this.tagIndex?c[0]:c[this.tagIndex]);return c};a.prototype.setAttribute=function(c){this.attr=c};a.prototype.setDataSrcWgt=function(c){c&&(this.dataSrc=
c,this.dataSrcId=c.wgtId)};a.prototype.setTgtWgt=function(c){this.tgtWgt=c};a.prototype.setValue=function(c,a,b,d,g){if(!b.isQualityGood())return!1;switch(c){case "Index":a!=this.tagIndex&&(this.tagIndex=a,this.update())}return!0};a.prototype.getValue=function(c){return"rw"==c?this.rw:null};a.prototype.getTargetWidget=function(){return this.tgtWgt};a.parseString=function(c,a){for(var b="",d="_TagMgr",g="",k="",f="",m="-1",r=[],l=!1,p=!1,q=!1,t=void 0===a?!1:a,u=!1,w=!1,A=c.length,x=0;x<A;x++)switch(c[x]){case "\\":if(p||
l||w)f+="\\";p=!p;break;case "|":p||l?l&&q?(m=f,f="",q=!1):(f+="|",p&&(p=!1)):(w=!0,0==g.length?g=f:t?(k=f,u=t=!1):u?(d=f,u=!1):r.push(f),f="");break;case "[":if(p||l||w)f+="[";l||p||(l=!0,0==g.length&&(g=f,f="",q=!0));p&&(p=!1);break;case "]":if(p||w)f+="]";l&&!p&&(w||(q?(m=f,""!=f&&(isNaN(Number(f))?(m="0",b=f):m=f),q=!1):b=f,f=""),l=!1);p&&(p=!1);break;case ":":p||l?(f+=":",p=!1):(u=!0,0==g.length&&(g=f),f="");break;case ">":p||l?(f+=">",p=!1):(t=!0,0==g.length?g=f:u&&(d=f),f="");break;default:p&&
(p=!1),f+=c[x]}0<f.length&&(0==g.length?g=f:t?k=f:u?d=f:r.push(f));return{strSrcWgt:d,strTagName:g,strIndex:m,elemList:r,strAttr:k,strIndexTag:b}};a.prototype.generateXFormFeature=function(c){var b=c.indexOf("("),h=c.indexOf(")");if(-1!=b&&-1!=h){var d=f.activeProject,g=f.getFocusPage(),k=c.substring(0,b);c=c.substring(b+1,h);b=g.wgtId.split("_")[0]+"_tmpXForm"+a.tmpXFormSeed++;d=new (d.getWidgetDefinition("hmi"+k))({wgtId:b},b,{},g,null);d.readFromString(c,this);return d}return null};a.prototype.getTagOptionsFromString=
function(c,b,h){var d,g=d||(d={});g[g.R=0]="R";g[g.W=1]="W";g[g.RW=2]="RW";var k=["R","W","R/W"],n,m="",r="r",l,p,g={};if("="===c[0])h=f.getFocusPage(),r=c.substring(1),d=h.wgtId.split("_")[0]+"_tmpXForm"+a.tmpXFormSeed++,h=new lc({wgtId:d},d,null,h,null),h.readFromString(r,this),n=null,g.rw="rw",g.tag="",g.srcType="Formula",g.dataSource="",g.xforms=[h],g.tagIndex=-1,g.wT=1;else{var q=a.parseString(c,b);c=q.strTagName;b=q.strIndex;var m=q.strSrcWgt,t=q.elemList,u=q.strAttr;n=q.strIndexTag;q=[];""!==
n&&(l=f.createDataLink(null,null,{}),l.readFromString(n+":Index",!0),this.addInternalLink({id:"tmp",p:l.getOptions(),s:l.dataSrc.studioId,w:"tmp_l0"}));n=f.getWidget(m,!0);p=f.activeProject.getSrcType(n);m=n.studioId;l="Project"==n.getWidgetType()?0:1;var w=0,A;for(A in t){var x=t[A],z=this.generateXFormFeature(x);if(null!=z)q.push(z),w++;else switch(x){case k[d.R]:r="r";break;case k[d.W]:r="w";break;case k[d.RW]:r="rw"}}if(void 0!=h&&0==w&&"TagMgrWgt"==n.getJMType())for(d=0;d<h.length;d++)A=h[d],
(k=n.getTagInfo(c))&&k.t==A.tagType&&(z=this.generateXFormFeature(A.feature),null!=z&&(q.push(z),w++));g.rw=r;g.tag=c;g.attr=null==u||""==u?this.attr:u;g.srcType=p;g.dataSource=m;g.tagIndex=Number(b);g.xforms=q;g.wT=l}this.setDataSrcWgt(n);return g};a.prototype.readFromString=function(c,a){if(0<c.length){var b=this.getTagOptionsFromString(c,a);this.setOptions(b);this.initOptions(b)}return null};a.prototype.readFromStringAndSetTarget=function(c,a,b,d){if(0==c.length)return this;c=this.getTagOptionsFromString(c,
!1,d);c.attr=b;c.dataSource=a.studioId;this.setOptions(c);this.initOptions(c);return this};a.prototype.writeToString=function(c,a){void 0===c&&(c=!0);void 0===a&&(a=!1);var b=["R","W","RW"],d="",g,k=g||(g={});k[k.R=0]="R";k[k.W=1]="W";k[k.RW=2]="RW";if("Formula"===this.srcType)1==this.xforms.length&&(b=this.xforms[0],b=b.writeToString(c,a),d+=b);else{k=this.tag;k.replace("\\","\\\\");k.replace("[","\\[");k.replace("]","\\]");k.replace(";","\\;");k.replace(":","\\:");k.replace(">","\\>");k.replace("|",
"\\|");d=k;if(0<k.length){var n="Tag"==this.srcType||"Recipe"==this.srcType||"Alias"==this.srcType||this.tagType==w.EMPTY,m=void 0,r=null,l;for(l in this.dataLinks){var m=this.dataLinks[l],p=m.tgtWgt;if(m&&p.getId()==this.getId()&&"Index"==m.attr){r=m;break}}n&&(r||-1!=this.tagIndex)&&(m=this.tagIndex.toString(),a&&null!=r.tag&&(m=r.tag),k.replace("\\","\\\\"),k.replace("[","\\["),k.replace("]","\\]"),k.replace(";","\\;"),k.replace(":","\\:"),k.replace(">","\\>"),k.replace("|","\\|"),r?(l=r.writeToString(c,
a),m="["+m+"|"+l+"]"):m="["+m+"]",d+=m)}l=this.dataSrc.studioId;0<l.length&&"_TagMgr"!=l&&(k.replace("\\","\\\\"),k.replace("[","\\["),k.replace("]","\\]"),k.replace(";","\\;"),k.replace(":","\\:"),k.replace(">","\\>"),k.replace("|","\\|"),d+=":"+l);c&&(k=f.cache.getTag(this.tag).getStringTagType(),d+=">"+k+":"+this.attr);this.rw.toUpperCase()!=b[g.R]&&(k=this.rw.toUpperCase(),k==b[g.RW]&&(k="R/W"),d+="|"+k);if(null!=this.xforms)for(g=this.xforms,k=0;k<g.length;k++)b=this.xforms[k],l=b.writeToString(c,
a),d+="|"+b.className+"("+l+")"}return d};a.prototype.destroy=function(){var c=this.xforms;if(c)for(var a in c)c[a].destroy();return!0};a.prototype.hasStructuredTag=function(){return null!=this._tag&&""!=this._tag};a.prototype.subscribeForDatasourceNotification=function(){this.dataSrc instanceof Cb&&this.dataSrc.subscribeDynamicTags()};a.tmpXFormSeed=0;return a}(Zb);f.addWidgetDefinition("hmiDataLink",Qb);f.export("hmiDataLink",Qb);var Fa=function(){function b(){this.colProperties=[];this.rowProperties=
[];this.colXPos=[];this.rowYPos=[]}b.prototype.init=function(a,c,e){this.gridProperties=c.gr;this.colProperties=[];this.rowProperties=[];for(var h in c.colsProps)this.colProperties.push(JSON.parse(JSON.stringify(c.colsProps[h])));for(var d in c.rowsProps)this.rowProperties.push(JSON.parse(JSON.stringify(c.rowsProps[d])));a.getGridGlobalStrokeCollapsed()==b.enumStrokeCollaption.TRUE&&(e||this.computeRowStrokeCollapsed(a),this.computeColStrokeCollapsed(a))};b.prototype.getGridColSuperiorLimit=function(){for(var a=
0,c=0;c<this.gridProperties.grCols;c++)a+=this.colProperties[c].maxWidth;return a};b.prototype.getGridRowSuperiorLimit=function(){for(var a=0,c=0;c<this.gridProperties.grRows;c++)a+=this.rowProperties[c].minHeight;return a};b.prototype.getRowProperties=function(){return this.rowProperties?this.rowProperties:null};b.prototype.getColProperties=function(){return this.colProperties?this.colProperties:null};b.prototype.computeRowStrokeCollapsed=function(a){var c=this.gridProperties.grGStkMode,e=this.gridProperties.grGStkWidth,
h=this.gridProperties.grGStkColor;a=a.getGridRowsNumber();for(var d=0;d<a;d++){var g=this.rowProperties[d].tStroke,k=this.rowProperties[d].bStroke;0==d&&(c==b.enumStrokeMode.AUTO&&(this.rowProperties[d].tStroke=Math.max(g,e)/2),e>=g&&(this.rowProperties[d].tStkColor=h));if(0<d){var f=this.rowProperties[d-1].bStroke,m=Math.max(g,f)/2;this.rowProperties[d].tStroke=Math.ceil(m);this.rowProperties[d-1].bStroke=Math.floor(m);f>g?this.rowProperties[d].tStkColor=this.rowProperties[d-1].bStkColor:this.rowProperties[d-
1].bStkColor=this.rowProperties[d].tStkColor;d==a-1&&(c==b.enumStrokeMode.AUTO&&(this.rowProperties[d].bStroke=Math.max(k,e)/2),e>=k&&(this.rowProperties[d].bStkColor=h))}}};b.prototype.computeColStrokeCollapsed=function(a){var c=this.gridProperties.grGStkMode,e=this.gridProperties.grGStkWidth,h=this.gridProperties.grGStkColor;a=a.getGridColsNumber();for(var d=0;d<a;d++){var g=this.colProperties[d].lStroke,k=this.colProperties[d].rStroke;0==d&&(c==b.enumStrokeMode.AUTO&&(this.colProperties[d].lStroke=
Math.max(g,e)/2),e>=g&&(this.colProperties[d].lStkColor=h));if(0<d){var f=this.colProperties[d-1].rStroke,m=Math.max(g,f)/2;this.colProperties[d].lStroke=Math.ceil(m);this.colProperties[d-1].rStroke=Math.floor(m);f>g?this.colProperties[d].lStkColor=this.colProperties[d-1].rStkColor:this.colProperties[d-1].rStkColor=this.colProperties[d].lStkColor;d==a-1&&(c==b.enumStrokeMode.AUTO&&(this.colProperties[d].rStroke=Math.max(k,e)/2),e>=k&&(this.colProperties[d].rStkColor=h))}}};b.prototype.getWAspectRatio=
function(a){return parseFloat(a.split(":")[0])};b.prototype.getHAspectRatio=function(a){return parseFloat(a.split(":")[1])};b.prototype.getTotalColMinWidth=function(){var a=0;if(0<this.colProperties.length)for(var c=0;c<this.gridProperties.grCols;c++)a+=this.colProperties[c].minWidth;return a};b.prototype.getTotalRowMinHeight=function(){var a=0;if(0<this.rowProperties.length)for(var c=0;c<this.gridProperties.grRows;c++)a+=this.rowProperties[c].minHeight;return a};b.prototype.preserveAspectRatio=function(a){a.getParentBounds(a.parentWidget);
var c=a.getChildren(),e;for(e in c)if(c[e].hasLayout()){var h=c[e].getLayout(),d=c[e].getParentBounds(c[e].parentWidget);if(1==h.preserveAR){var g=d.width*(this.getHAspectRatio(h.aR)/this.getWAspectRatio(h.aR));if(g<=d.height){var k=d.height-g,f=d.y,m=a.getGridUnderflow().v;switch(h.vItemUF){case b._wgtVerUnderflowMode.INHERITED:switch(m){case b._groupVerUnderflowMode.MIDDLE:f+=k/2;break;case b._groupVerUnderflowMode.BOTTOM:f+=k}break;case b._wgtVerUnderflowMode.MIDDLE:f+=k/2;break;case b._wgtVerUnderflowMode.BOTTOM:f+=
k}c[e].setParentBounds(d.x,f,d.width,g,c[e].parentWidget)}else{g=d.height*this.getWAspectRatio(h.aR)/this.getHAspectRatio(h.aR);k=d.width-g;f=d.x;m=a.getGridUnderflow().h;switch(h.hItemUF){case b._wgtHorUnderflowMode.INHERITED:switch(m){case b._groupHorUnderflowMode.CENTER:f+=k/2;break;case b._groupHorUnderflowMode.RIGHT:f+=k}break;case b._wgtHorUnderflowMode.CENTER:f+=k/2;break;case b._wgtHorUnderflowMode.RIGHT:f+=k}c[e].setParentBounds(f,d.y,g,d.height,c[e].parentWidget)}}}};b.prototype.applyAlgorithm=
function(a,c){this.widthCalc(a);this.heightCalc(a);this.preserveAspectRatio(a);c&&c()};b.prototype.widthCalc=function(a,c){var e=a.getGridOverflow().h,h=a.getGridUnderflow().h,d=a.getParentBounds(a.parentWidget),g=a.getChildren(),k=d.width,f=0,m=a.getScrollbarAutohide(),r=a.getScrollbarSize();m==b._scrollbarAutohide.ALWAYSVISIBLE&&this.getTotalColMinWidth()>d.width&&(f+=Math.max(0,r+this.gridProperties.grSclOffset));k-=f;0>=k&&(k=.1);d=this.baseWidthCalc(a,k);if(d==b._grState.OK)this.wgtRepositioningX(a,
g,0);else if(d==b._grState.OVERFLOW)switch(e){case b._groupHorOverflow.HIDDEN:this.wgtRepositioningX(a,g,0);break;case b._groupHorOverflow.SCROLL:c||this.heightCalc(a,!0),this.wgtRepositioningX(a,g,0)}else if(d==b._grState.UNDERFLOW)switch(h){case b._groupHorUnderflowMode.LEFT:this.wgtRepositioningX(a,g,0);break;case b._groupHorUnderflowMode.CENTER:case b._groupHorUnderflowMode.RIGHT:e=k-this.getGridColSuperiorLimit();h==b._groupHorUnderflowMode.CENTER&&(e=Math.floor(e/2));for(h=0;h<=a.getGridColsNumber();h++)this.colProperties[h].colPos+=
e;this.wgtRepositioningX(a,g,0);break;default:this.wgtRepositioningX(a,g,0)}};b.prototype.heightCalc=function(a,c){var e=a.getGridOverflow().v,h=a.getGridUnderflow().v,d=a.getParentBounds(a.parentWidget),g=a.getChildren(),k=d.height,f=0,m=a.getScrollbarAutohide(),r=a.getScrollbarSize();m==b._scrollbarAutohide.ALWAYSVISIBLE&&this.getTotalRowMinHeight()>d.height&&(f+=Math.max(0,r+this.gridProperties.grSclOffset));k-=f;0>=k&&(k=.1);d=this.baseHeightCalc(a,k);if(d==b._grState.OK)this.wgtRepositioningY(a,
g,0);else if(d==b._grState.OVERFLOW)switch(e){case b._groupHorOverflow.HIDDEN:this.wgtRepositioningY(a,g,0);break;case b._groupHorOverflow.SCROLL:c||this.widthCalc(a,!0),this.wgtRepositioningY(a,g,0)}else if(d==b._grState.UNDERFLOW)switch(h){case b._groupVerUnderflowMode.TOP:this.wgtRepositioningY(a,g,0);break;case b._groupVerUnderflowMode.MIDDLE:case b._groupVerUnderflowMode.BOTTOM:e=k-this.getGridRowSuperiorLimit();h==b._groupVerUnderflowMode.MIDDLE&&(e=Math.floor(e/2));for(h=0;h<=a.getGridRowsNumber();h++)this.rowProperties[h].rowPos+=
e;this.wgtRepositioningY(a,g,0);break;default:this.wgtRepositioningY(a,g,0)}};b.prototype.fuzzyCompare=function(a,c){return 1E-5>=Math.abs(a-c)?!0:!1};b.prototype.wgtRepositioningX=function(a,c,e){e=[];for(var h=a.getGridColsNumber(),d=0;d<h;d++)e[d]=this.colProperties[d+1].colPos-this.colProperties[d].colPos;for(var g in c)if(c[g].hasLayout()){for(var h=c[g].getParentBounds(c[g].parentWidget),d=c[g].getLayout(),k=d.cOcc,f=d.cSpan,m=k-1,r=m+f-1,l=0,p=m;p<=r;p++)l+=e[p];l-=d.maxWidth;r=p=0;0>=l&&(l=
0);var q=a.getGridUnderflow().h;if(0!=l)switch(d.hItemUF){case b._wgtHorUnderflowMode.INHERITED:switch(q){case b._groupHorUnderflowMode.LEFT:r=l;break;case b._groupHorUnderflowMode.CENTER:p=l/2;r=l/2;break;case b._groupHorUnderflowMode.RIGHT:p=l}break;case b._wgtHorUnderflowMode.LEFT:r=l;break;case b._wgtHorUnderflowMode.CENTER:p=l/2;r=l/2;break;case b._wgtHorUnderflowMode.RIGHT:p=l}l=m;p=Math.round(this.colProperties[l].colPos+this.colProperties[l].lMargin+this.colProperties[l].lStroke+p);l=m+f;
f=Math.round(this.colProperties[l].colPos-p-this.colProperties[k+f-2].rMargin-this.colProperties[l-1].rStroke-r);0>=f&&(f=.1);p+=d.lMargin;f=f-d.lMargin-d.rMargin;0>=f&&(f=.1);0<k?c[g].setAsVisible(!0):c[g].setAsVisible(!1);c[g].setParentBounds(p,h.y,f,h.height,c[g].parentWidget)}};b.prototype.wgtRepositioningY=function(a,c,e){e=[];for(var h=a.getGridRowsNumber(),d=0;d<h;d++)e[d]=this.rowProperties[d+1].rowPos-this.rowProperties[d].rowPos;for(var g in c)if(c[g].hasLayout()){for(var h=c[g].getParentBounds(c[g].parentWidget),
d=c[g].getLayout(),k=d.rOcc,f=d.rSpan,m=k-1,r=m+f-1,l=0,p=m;p<=r;p++)l+=e[p];l-=d.maxHeight;r=p=0;0>=l&&(l=0);var q=a.getGridUnderflow().v;if(0!=l)switch(d.vItemUF){case b._wgtVerUnderflowMode.INHERITED:switch(q){case b._groupVerUnderflowMode.TOP:r=l;break;case b._groupVerUnderflowMode.MIDDLE:p=l/2;r=l/2;break;case b._groupVerUnderflowMode.BOTTOM:p=l}break;case b._wgtVerUnderflowMode.TOP:r=l;break;case b._wgtVerUnderflowMode.MIDDLE:p=l/2;r=l/2;break;case b._wgtVerUnderflowMode.BOTTOM:p=l}l=m;p=Math.round(this.rowProperties[l].rowPos+
this.rowProperties[l].tMargin+this.rowProperties[l].tStroke+p);l=m+f;f=Math.round(this.rowProperties[l].rowPos-p-this.rowProperties[k+f-2].bMargin-this.rowProperties[l-1].bStroke-r);0>=f&&(f=.1);p+=d.tMargin;f=f-d.tMargin-d.bMargin;0>=f&&(f=.1);0<k?c[g].setAsVisible(!0):c[g].setAsVisible(!1);c[g].setParentBounds(h.x,p,h.width,f,c[g].parentWidget)}};b.prototype.baseWidthCalc=function(a,c){var e,h=0,d=[],g=[],k=[],f=a.getGridColsNumber();this.colProperties.length<=f&&(this.colProperties.push({}),this.colProperties[f].colPos=
0,this.colProperties[f].maxWidth=0);c=Math.round(c);if(0>=c)return b._grState.ERROR;for(var m=0;m<f;m++)k.push(!0);for(var l=b._grState.ERROR,p=0;p<=f;p++){for(m=e=0;m<f;m++)d[m]=0,k[m]&&(e+=this.colProperties[m].stretch);for(var q=0,m=0;m<f;m++){if(k[m]){d[m]=this.colProperties[m].stretch/e;null==g[m]&&(g[m]=0);g[m]+=d[m]*(c-h);var t=this.colProperties[m].minWidth,u=this.colProperties[m].maxWidth;g[m]>u-1E-5&&(g[m]=u);g[m]<t+1E-5&&(g[m]=t)}q+=g[m]}h=q;if(this.fuzzyCompare(c,h)){l=b._grState.OK;break}e=
!0;if(h>c){for(m=0;m<f;m++)k[m]&&(t=this.colProperties[m].minWidth,g[m]<t+1E-5?k[m]=!1:e=!1);if(e){l=b._grState.OVERFLOW;break}}else{for(m=0;m<f;m++)k[m]&&(u=this.colProperties[m].maxWidth,g[m]>u-1E-5?k[m]=!1:e=!1);if(e){l=b._grState.UNDERFLOW;break}}}this.colProperties[0].colPos=0;for(m=1;m<=f;m++)this.colProperties[m].colPos=this.colProperties[m-1].colPos+g[m-1];return l};b.prototype.baseHeightCalc=function(a,c){var e,h=0,d=[],g=[],k=[],f=a.getGridRowsNumber();this.rowProperties.length<=f&&(this.rowProperties.push({}),
this.rowProperties[f].rowPos=0,this.rowProperties[f].maxHeight=0);c=Math.round(c);if(0>=c)return b._grState.ERROR;for(var m=0;m<f;m++)k.push(!0);for(var l=b._grState.ERROR,p=0;p<=f;p++){for(m=e=0;m<f;m++)d[m]=0,k[m]&&(e+=this.rowProperties[m].stretch);for(var q=0,m=0;m<f;m++){if(k[m]){d[m]=this.rowProperties[m].stretch/e;null==g[m]&&(g[m]=0);g[m]+=d[m]*(c-h);var t=this.rowProperties[m].minHeight,u=this.rowProperties[m].maxHeight;g[m]>u-1E-5&&(g[m]=u);g[m]<t+1E-5&&(g[m]=t)}q+=g[m]}h=q;if(this.fuzzyCompare(c,
h)){l=b._grState.OK;break}e=!0;if(h>c){for(m=0;m<f;m++)k[m]&&(t=this.rowProperties[m].minHeight,g[m]<t+1E-5?k[m]=!1:e=!1);if(e){l=b._grState.OVERFLOW;break}}else{for(m=0;m<f;m++)k[m]&&(u=this.rowProperties[m].maxHeight,g[m]>u-1E-5?k[m]=!1:e=!1);if(e){l=b._grState.UNDERFLOW;break}}}this.rowProperties[0].rowPos=0;for(m=1;m<=f;m++)this.rowProperties[m].rowPos=this.rowProperties[m-1].rowPos+g[m-1];return l};b._grState={OK:0,OVERFLOW:1,UNDERFLOW:2,ERROR:3};b._wgtHorUnderflowMode={INHERITED:0,LEFT:1,CENTER:2,
RIGHT:3};b._groupHorUnderflowMode={BLOCKED:0,LEFT:1,CENTER:2,RIGHT:3};b._wgtVerUnderflowMode={INHERITED:0,TOP:1,MIDDLE:2,BOTTOM:3};b._groupVerUnderflowMode={BLOCKED:0,TOP:1,MIDDLE:2,BOTTOM:3};b._groupHorOverflow={HIDDEN:0,VISIBLE:1,SCROLL:2};b._groupVerOverflow={HIDDEN:0,VSIBLE:1,SCROLL:2};b._scrollbarAutohide={AUTO:0,ALWAYSVISIBLE:1};b.enumStrokeMode={AUTO:0,FIXED:1};b.enumStrokeCollaption={FALSE:0,TRUE:1};return b}(),Ve=function(){function b(a){this._group=a}b.prototype.drawGrid=function(){for(var a=
this._group.getGridProperties(),c=a.grRows,a=a.grCols,b=this.createTableElement(),h,d,g=0;g<c;g++){h=this.createRowElement();for(var f=0;f<a;f++)d=this.createCellElement(),this.applyStyles(h,d,g,f),h.appendChild(d);b.appendChild(h)}this.removeBackgroundStrokes(b);this.appendTableElement(b)};b.prototype.appendTableElement=function(a){var c=this._group.getScrollbarContentElem(),b=c?c.firstElementChild:this._group.elem.firstElementChild;b?a.appendBefore(b):c.appendChild(a)};b.prototype.createTableElement=
function(){var a=document.createElement("div"),c=this._group.getParentBounds(this._group.parentWidget);a.id=this._group.wgtId+".table-grid";a.style.position="absolute";a.style.width=c.width+"px";a.style.height=c.height+"px";return a};b.prototype.createRowElement=function(){var a=document.createElement("div");a.id=this._group.wgtId+".table-row";a.className+=" jm-gr-row";return a};b.prototype.createCellElement=function(){var a=document.createElement("div");a.id=this._group.wgtId+".table-cell";a.className+=
" jm-gr-cell";return a};b.prototype.canApplyStyles=function(a,c,b,h){return 0>a||0>c||0>b||0>h?!1:!0};b.prototype.removeBackgroundStrokes=function(a){var c=this._group.getGLRowProps(),b=this._group.getChildren(),h;for(h in b)if(b[h].hasLayout()){var d=b[h].getLayout(),g=d.rOcc-1,f=g+d.rSpan,n=d.cOcc-1,m=n+d.cSpan;if(this.canApplyStyles(g,f,n,m)){var l=d.lBgColor?d.lBgColor:c[g].bgColor;if(1==d.rSpan&&1==d.cSpan)a.childNodes[g].childNodes[n].style.backgroundColor=l;else for(d=g;d<f;d++)for(var p=a.childNodes[d],
q=n;q<m;q++){var t=p.childNodes[q];d+1<f&&(t.style.borderBottom="none");d-1>=g&&(t.style.borderTop="none");q+1<m&&(t.style.borderRight="none");q-1>=n&&(t.style.borderLeft="none");t.style.backgroundColor=l}}}};b.prototype.applyStyles=function(a,c,b,h){var d=this._group.getGLRowProps(),g=this._group.getGLColProps();a.style.top=d[b].rowPos+"px";c.style.left=g[h].colPos+"px";c.style.height=d[b+1].rowPos-d[b].rowPos+"px";c.style.width=g[h+1].colPos-g[h].colPos+"px";c.style.borderLeft=g[h].lStroke+"px solid "+
g[h].lStkColor;c.style.borderRight=g[h].rStroke+"px solid "+g[h].rStkColor;c.style.borderTop=d[b].tStroke+"px solid "+d[b].tStkColor;c.style.borderBottom=d[b].bStroke+"px solid "+d[b].bStkColor;c.style.backgroundColor=d[b].bgColor};b.prototype.delete=function(){var a=this._group.getScrollbarContentElem(),c;a?c=a.firstElementChild:(c=this._group.elem.firstElementChild,a=this._group.elem);var b=this._group.wgtId+".table-grid";c&&c.id===b&&a.removeChild(c)};return b}(),Ic=function(){function b(a,c){this._scrollbar=
window.Scrollbar.use(Ta);this._scrollbar=window.Scrollbar.init(a,c.lib);c.ext.disableX&&this.disableXScroll();c.ext.disableY&&this.disableYScroll();c.ext.bgColor&&this.setBgColor(c.ext.bgColor);c.ext.color&&this.setColor(c.ext.color)}b.prototype.addListener=function(a){this._callback=a;this._scrollbar.addListener(a)};b.prototype.removeListener=function(){this._scrollbar.removeListener(this._callback)};b.prototype.enableXScroll=function(){this._scrollbar.containerEl.appendChild(this._scrollbar.track.xAxis.element);
this._scrollbar.options.plugins.disableScroll.direction=null};b.prototype.enableYScroll=function(){this._scrollbar.containerEl.appendChild(this._scrollbar.track.yAxis.element);this._scrollbar.options.plugins.disableScroll.direction=null};b.prototype.disableXScroll=function(){this._scrollbar.track.xAxis.element.remove();this._scrollbar.options.plugins.disableScroll.direction="x"};b.prototype.disableYScroll=function(){this._scrollbar.track.yAxis.element.remove();this._scrollbar.options.plugins.disableScroll.direction=
"y"};b.prototype.setPosition=function(a,c){this._scrollbar.setPosition(a,c)};b.prototype.setContentSize=function(a){this._scrollbar.setContentSize(a)};b.prototype.setBgColor=function(a){this._scrollbar.setXAxisColor(a);this._scrollbar.setYAxisColor(a)};b.prototype.setColor=function(a){this._scrollbar.setXThumbColor(a);this._scrollbar.setYThumbColor(a)};b.prototype.setSize=function(a){this._scrollbar.setXAxisSize(a);this._scrollbar.setYAxisSize(a)};b.prototype.setAlwaysShowTracks=function(a){this._scrollbar.options.alwaysShowTracks=
a};b.prototype.getContainerSize=function(){return this._scrollbar.getSize().container};b.prototype.getContentSize=function(){return this._scrollbar.getSize().content};b.prototype.getLimit=function(){return this._scrollbar.limit};b.prototype.scrollTo=function(a,c){this._scrollbar.scrollTo(a,c)};b.prototype.update=function(){this._scrollbar.update()};b.prototype.getOffset=function(){return this._scrollbar.offset};b.prototype.getContentEl=function(){return this._scrollbar.contentEl};b.prototype.getContainerEl=
function(){return this._scrollbar.containerEl};b.prototype.getScrollTop=function(){return this._scrollbar.scrollTop};b.prototype.getScrollLeft=function(){return this._scrollbar.scrollLeft};b.prototype.destroy=function(){this._scrollbar.destroy()};return b}(),bb;(function(b){b[b.VALUE=0]="VALUE";b[b.MLPATCH=1]="MLPATCH"})(bb||(bb={}));var cb;(function(b){b[b.X=0]="X";b[b.Y=1]="Y"})(cb||(cb={}));var Na=function(b){function a(c,a,h,d,g){c=b.call(this,c.wgtId,a,h,d,g)||this;c.xScroll=0;c.yScroll=0;c.relHorScrollPos=
0;c.relVerScrollPos=0;c.clickWgtId=null;c.activeElements=[];c.invokablePropsList=c.initializeIvokablePropList();c.hasModule=!1;c.cwMLMgr=null;a=f.activeProject.getCWidgetMgr();if(null!=a){a.instantiateCW(c,c.ctype);a=u.getModule("Tag");for(var k in c.links)(h=c.links[k],h.t==bb.VALUE&&null!=h.v)?c.setValue(k,h.v,a.QUALITY_GOOD):h.t==bb.MLPATCH&&(d=f.activeProject.getWidget("_MultiLangMgr",!0))&&(h=h.v[d.getCurrentLangIndex()],c.setValue(k,h,a.QUALITY_GOOD))}c.hasGridLayout()&&(c.initGridLayout(),
c.initScrollbar());return c}p(a,b);a.prototype.setGridLayout=function(c){this.grid=c;this.initGridLayout()};a.prototype.initScrollbar=function(){if("GroupWgt"==this.getJMType()){var c=this.getOverflow();if(c.h==Fa._groupHorOverflow.SCROLL||c.v==Fa._groupVerOverflow.SCROLL)this._renderMask|=a._renderFlags.DRWSCROLLBAR,f.addToRender(this)}};a.prototype.initializeIvokablePropList=function(){var c=[];if(f.activeProject.props&&f.activeProject.props[this.ctype]){var a=f.activeProject.props[this.ctype],
b;for(b in a)c.push(b)}return c=c.concat("gridNRows gridNCols gridHorOverFlow gridVerOverFlow gridHorUnderFlow gridVerUnderFlow gridScrollColor gridScrollBgColor gridScrollSize gridScrollAutohide gridGlobalStrokeCollapsed".split(" "))};a.prototype.findWgt=function(c,a){var b=a.replace("*",c.studioId),b=c.mapId[b];if(void 0!==b)return c.wgts[b];var d=a.split("."),g=d.length;if(!(1>=g)){for(var f=1;f<g;f++)b=c.mapId[c.studioId+"."+d[f]],void 0!==b&&(c=c.wgts[b]);return c}};a.prototype.getWidget=function(c,
a,h){if(!0===a&&"*"===c.charAt(0)&&"."===c.charAt(1)){var d=this.findWgt(this,c);if(void 0!==d)return h?d.isTemplateWgt?d:null:d;var d=this.wgts,g;for(g in d){var f=d[g].getWidget(c,a,h);if(null!==f)if(h){if(f.isTemplateWgt)return f}else return f}return null}return b.prototype.getWidget.call(this,c,a,h)};a.prototype.getWidgetsByJMClass=function(c,b,h){for(var d in this.wgts){var g=this.wgts[d];if(g.getJMType()==c){if(h.push(g),h.length>=b)return!0}else if(g instanceof a&&g.getWidgetsByJMClass(c,b,
h))return!0}return!1};a.prototype.addDataLink=function(c){b.prototype.addDataLink.call(this,c);var a=c.attr;if("*"===a[0]&&"."===a[1]){var h=a.lastIndexOf("."),h=this.getWidget(a.substring(0,h),!0,this.isTemplateWgt);null!==h&&(a=a.split("."),h.initDataLinkSideEffects(c,a[a.length-1]))}};a.prototype.addParameterDataLink=function(c,a){var b=c.toLowerCase();void 0===this.params[b].links&&(this.params[b].links=[]);this.params[b].links.push(a)};a.prototype.hasParameter=function(c){c=c.toLowerCase();return this.params&&
this.params[c]?!0:!1};a.prototype.setParamsValue=function(c,a){var b=c.toLowerCase();this.params&&this.params[b]&&(this.params[b].v=a)};a.prototype.getParamsValue=function(c){c=c.toLowerCase();return this.params&&this.params[c]?this.params[c].v:""};a.prototype.getParentModuleWithParameter=function(c){for(var a=this.module;a;){if(a.hasParameter(c))return a;a=this.parentWidget.module}return null};a.prototype.updateDataLinkParm=function(c){c=c.toLowerCase();if(c=this.params[c].links)for(var a=0,b=c.length;a<
b;a++)c[a].updateDSParameter()};a.prototype.getDatalink=function(c){for(var a in this.dataLinks){var b=this.dataLinks[a];if(b.attr==c)return b}return null};a.prototype.setModule=function(){this.hasModule=!0};a.prototype.areAliases=function(c,a){var b=this.project.getCWidgetMgr().getAttributeLink(this.ctype,c);return b&&-1!=b.indexOf(a)};a.prototype.addWidget=function(c,a){b.prototype.addWidget.call(this,c,a);this.disabled&&a.setValue("disabled",1,null,null)};a.prototype.setValue=function(c,e,h,d){var g=
f.activeProject.getCWidgetMgr(),k=this.invokablePropsList;if("*"===c[0]&&"."===c[1]){var g=c.lastIndexOf("."),n=this.getWidget(c.substring(0,g),!0,this.isTemplateWgt);null!==n&&(g=c.split("."),n.setValue(g[g.length-1],e,h,d),this.sendUpdate(c,e,h))}else if(-1!==g.getParameters(this.ctype).indexOf(c)||this.hasParameter(c)){if(void 0===h||h.isQualityGood())this.setParamsValue(c,e),this.updateDataLinkParm(c)}else if(this[c]!=e||h&&!h.isQualityGood())if((g=g.getAttributeLink(this.ctype,c))&&0<g.length){for(var k=
0,m=g.length;k<m;k++){var l=g[k].lastIndexOf("."),n=g[k].substring(0,l),l=g[k].substr(l+1),n=this.getWidget(n,!0,this.isTemplateWgt);null==n&&(n={wgt:null,prop:null},this.resolveAliasAttribute(g[k],n),n=n.wgt);n&&n.setValue(l,e,h,d)}if(void 0===h||h.isQualityGood())this[c]=e;this.sendUpdate(c,e,h)}else if(k&&-1!=k.indexOf(c)&&void 0!==f.activeProject.props[this.ctype]){g=f.activeProject.props[this.ctype][c];n={wgt:null,prop:null};for(k=0;k<g.length;k++)this.resolveAliasAttribute(g[k],n),null!==n.wgt&&
n.wgt.setValue(n.prop,e,h,d);h.isQualityGood()&&(this[c]=e)}else if("disabled"==c){if(this.disabled!=e)for(m in this.disabled=e="boolean"==typeof e?1==e?1:0:parseFloat(e),this.sendUpdate(c,this.disabled,h),this.wgts)this.wgts[m].setValue(c,this.disabled,h,d)}else"relHorScrollPos"==c?this.scrollbarInstance&&this.relHorScrollPos!=e&&(this.relHorScrollPos=e,this._renderMask|=a._renderFlags.UPDATESCROLLBARX,this.sendUpdate(c,this.relHorScrollPos,null),f.addToRender(this)):"relVerScrollPos"==c?this.scrollbarInstance&&
this.relVerScrollPos!=e&&(this.relVerScrollPos=e,this._renderMask|=a._renderFlags.UPDATESCROLLBARY,this.sendUpdate(c,this.relVerScrollPos,null),f.addToRender(this)):"visibility"==c?(this.visibility=e,this.sendUpdate(c,this.visibility,null),b.prototype.setValue.call(this,c,e,h,d)):"gridHorOverFlow"==c?e!==this.gridHorOverFlow&&this.scrollbarInstance&&(this.gridHorOverFlow=e,this.sendUpdate(c,this.gridHorOverFlow,null),this.gridHorOverFlow===Fa._groupHorOverflow.HIDDEN?this.scrollbarInstance.disableXScroll():
this.scrollbarInstance.enableXScroll()):"gridVerOverFlow"==c?e!==this.gridVerOverFlow&&(this.gridVerOverFlow=e,this.sendUpdate(c,this.gridVerOverFlow,null),this.gridVerOverFlow===Fa._groupVerOverflow.HIDDEN?this.scrollbarInstance.disableYScroll():this.scrollbarInstance.enableYScroll()):"gridHorUnderFlow"==c?e!==this.gridHorUnderFlow&&(this.gridHorUnderFlow=e,this.sendUpdate(c,this.gridHorUnderFlow,null),this.gridLayoutInstance.applyAlgorithm(this),this instanceof Ea&&this.update()):"gridVerUnderFlow"==
c?e!==this.gridVerUnderFlow&&(this.gridVerUnderFlow=e,this.sendUpdate(c,this.gridVerUnderFlow,null),this.gridLayoutInstance.applyAlgorithm(this),this instanceof Ea&&this.update()):"gridScrollColor"==c?e!==this.gridScrollColor&&this.scrollbarInstance&&(this.gridScrollColor=e,this.scrollbarInstance.setColor(this.gridScrollColor),this.sendUpdate(c,this.gridScrollColor,null),this.scrollbarInstance.update()):"gridScrollBgColor"==c?e!==this.gridScrollBgColor&&this.scrollbarInstance&&(this.gridScrollBgColor=
e,this.sendUpdate(c,this.gridScrollBgColor,null),this.scrollbarInstance.setColor(this.gridScrollBgColor),this.scrollbarInstance.update()):"gridScrollSize"==c?e!==this.gridScrollSize&&this.scrollbarInstance&&(this.gridScrollSize=e,this.sendUpdate(c,this.gridScrollSize,null),this.scrollbarInstance.setSize(this.gridScrollSize),this.scrollbarInstance.update()):"gridScrollAutohide"==c?e!==this.gridScrollAutohide&&(this.gridScrollAutohide=e,this.sendUpdate(c,this.gridScrollAutohide,null),this.scrollbarInstance.setAlwaysShowTracks(0===
this.gridScrollAutohide?!1:!0),this.scrollbarInstance.update()):"gridGlobalStrokeCollapsed"==c?e!==this.gridGlobalStrokeCollapsed&&(this.gridGlobalStrokeCollapsed=e,this.sendUpdate(c,this.gridGlobalStrokeCollapsed,null),this.gridLayoutInstance.applyAlgorithm(this),this instanceof Ea&&this.update()):b.prototype.setValue.call(this,c,e,h,d)};a.prototype.getValue=function(c){if(this.hasParameter(c))return this.getParamsValue(c);if("*"==c[0]&&"."==c[1]){var a=c.lastIndexOf("."),a=this.getWidget(c.substring(0,
a),!0,this.isTemplateWgt);if(null!==a)return c=c.split("."),a.getValue(c[c.length-1])}else switch(c){case "gridNRows":return this.getGridRowsNumber();case "gridNCols":return this.getGridColsNumber();default:return l.prototype.getValue.call(this,c)}};a.prototype.resolveAliasAttribute=function(c,a){if("*"===c[0]&&"."===c[1]){var h=c.lastIndexOf("."),h=this.getWidget(c.substring(0,h),!0,this.isTemplateWgt);if(null!==h){var d=c.split(".");a.wgt=h;a.prop=d[d.length-1]}else a.wgt=null,a.prop=null}else b.prototype.resolveAliasAttribute.call(this,
c,a)};a.prototype.createScrollbar=function(c){this.scrollbarInstance=new Ic(c,{lib:{damping:.1,thumbMinSize:this.gridScrollSize,renderByPixels:!1,alwaysShowTracks:0===this.gridScrollAutohide?!1:!0,continuousScrolling:!0,wheelEventTarget:this.elem,plugins:{disableScroll:{direction:null}}},ext:{disableX:this.gridHorOverFlow!=Fa._groupHorOverflow.SCROLL?!0:!1,disableY:this.gridVerOverFlow!=Fa._groupVerOverflow.SCROLL?!0:!1,bgColor:this.gridScrollBgColor,color:this.gridScrollColor}});this.scrollbarInstance.addListener(this.scrollCallback.bind(this))};
a.prototype.destroyScrollbar=function(){this.scrollbarInstance&&(this.scrollbarInstance.removeListener(),this.scrollbarInstance.destroy())};a.prototype.updateTrackPosition=function(c){var a=this.scrollbarInstance.getOffset();switch(c){case cb.X:this.scrollbarInstance&&this.gridHorOverFlow==Fa._groupHorOverflow.SCROLL&&this.scrollbarInstance.setPosition(this.xScroll,a.y);break;case cb.Y:this.scrollbarInstance&&this.gridVerOverFlow==Fa._groupVerOverflow.SCROLL&&this.scrollbarInstance.setPosition(a.x,
this.yScroll)}};a.prototype.render=function(){b.prototype.render.call(this);this._renderMask&a._renderFlags.DRWSCROLLBAR&&this.createScrollbar(this.elem);this._renderMask&a._renderFlags.SCROLLCONTENTSIZE&&this.scrollbarInstance.setContentSize({height:this.scrollContentHeight});this._renderMask&a._renderFlags.UPDATESCROLLBARX&&this.updateTrackPosition(cb.X);this._renderMask&a._renderFlags.UPDATESCROLLBARY&&this.updateTrackPosition(cb.Y);this._renderMask&a._renderFlags.DRAWGRID&&(this.graphicGrid.delete(),
this.graphicGrid.drawGrid());this._renderMask=0};a.prototype.setParentBounds=function(c,a,h,d,g){var f=this.width,n=this.height;b.prototype.setParentBounds.call(this,c,a,h,d,g);if(this.hasGridLayout())this.isClone||this.executeGridLayout();else if(!this.xformScaling){a=this.width;c=this.height;var f=0==f?0==a?1:a/1E-6:a/f,n=0==n?0==c?1:c/1E-6:c/n,m;for(m in this.wgts)c=this.wgts[m],a=c.getParentBounds(this),c.setParentBounds(a.x*f,a.y*n,a.width*f,a.height*n,this)}};a.prototype.getGridSize=function(){return this.groupConfigurations[this.configurationId].gr.s};
a.prototype.getGridRowsProps=function(){return this.groupConfigurations[this.configurationId].rowsProps};a.prototype.getGridColsProps=function(){return this.groupConfigurations[this.configurationId].colsProps};a.prototype.getGLColProps=function(){return this.gridLayoutInstance?this.gridLayoutInstance.getColProperties():null};a.prototype.getGLRowProps=function(){return this.gridLayoutInstance?this.gridLayoutInstance.getRowProperties():null};a.prototype.getRowProps=function(c){return this.getGridRowsProps()[c]};
a.prototype.getColProps=function(c){return this.getGridColsProps()[c]};a.prototype.getGridRowsNumber=function(){return this.groupConfigurations[this.configurationId].gr.grRows};a.prototype.getGridColsNumber=function(){return this.groupConfigurations[this.configurationId].gr.grCols};a.prototype.getGridOverflow=function(){return{h:this.gridHorOverFlow,v:this.gridVerOverFlow}};a.prototype.getGridUnderflow=function(){return{h:this.gridHorUnderFlow,v:this.gridVerUnderFlow}};a.prototype.getGridGlobalStrokeCollapsed=
function(){return this.gridGlobalStrokeCollapsed};a.prototype.getScrollbarAutohide=function(){return this.gridScrollAutohide};a.prototype.isGlobalStrokeCollaptionActive=function(){return 1===this.gridGlobalStrokeCollapsed};a.prototype.isGlobalStrokeModeFixed=function(){return 1==this.groupConfigurations[this.configurationId].gr.grGStkMode};a.prototype.getGlobalStrokeWidth=function(){return this.groupConfigurations[this.configurationId].gr.grGStkWidth};a.prototype.getGlobalStrokeColor=function(){return this.groupConfigurations[this.configurationId].gr.grGStkColor};
a.prototype.getGridGroupConfigurations=function(){return this.groupConfigurations?this.groupConfigurations:null};a.prototype.initGridLayout=function(){this.gridLayoutInstance=new Fa;this.groupConfigurations=this.getConfigurationClones();this.graphicGrid=new Ve(this);this.configurationId=-1;this.updateGridLayoutConfiguration()};a.prototype.updateGridLayoutConfiguration=function(){var c=this.checkGridConfiguration(this.groupConfigurations);if(c.id!==this.configurationId){var a=!1;this instanceof Ea&&
(a=!0);this.configurationId=c.id;this.gridLayoutInstance.init(this,c.cl,a);this.gridHorOverFlow=this.groupConfigurations[this.configurationId].gr.grHOF;this.gridVerOverFlow=this.groupConfigurations[this.configurationId].gr.grVOF;this.gridHorUnderFlow=this.groupConfigurations[this.configurationId].gr.grHUF;this.gridVerUnderFlow=this.groupConfigurations[this.configurationId].gr.grVUF;this.gridGlobalStrokeCollapsed=this.groupConfigurations[this.configurationId].gr.grGStkCollapsed;this.gridScrollBgColor=
this.groupConfigurations[this.configurationId].gr.grSclBgColor;this.gridScrollColor=this.groupConfigurations[this.configurationId].gr.grSclColor;this.gridScrollSize=this.groupConfigurations[this.configurationId].gr.grSclSize;this.gridScrollAutohide=this.groupConfigurations[this.configurationId].gr.grSclAutohide}};a.prototype.updateChildren=function(){for(var c in this.wgts){var a=this.wgts[c];"TableGroupWgt"===a.getJMType()&&a.update()}};a.prototype.executeGridLayout=function(){this.updateGridLayoutConfiguration();
this.gridLayoutInstance.applyAlgorithm(this,this.updateChildren.bind(this));this.graphicGrid.delete();this.graphicGrid.drawGrid()};a.prototype.updateLanguage=function(){for(var c in this.wgts)this.wgts[c].updateLanguage()};a.prototype.setCWMLTextMgr=function(c){this.cwMLMgr=c};a.prototype.getCWMLTextMgr=function(){return this.cwMLMgr};a.prototype.getAttributeLinks=function(){return this.links};a.prototype.hasMLManager=function(){return null!=this.cwMLMgr};a.prototype.checkGridConfiguration=function(c){for(var a=
c.length,b=0;b<a;b++){var d=c[b-1],g=c[b],f=g.gr.s?g.gr.s:this.width;if(this.width>(d?d.gr.s:0)&&this.width<=f||b==a-1)return{cl:g,id:b}}return{cl:c[a-1],id:a-1}};a.prototype.cloneConf=function(c){var a={},b;for(b in c)a[b]="object"==typeof c[b]?this.cloneConf(c[b]):c[b];return a};a.prototype.getConfigurationClones=function(){for(var c=[],a=0;a<this.grid.length;a++)c.push(this.cloneConf(this.grid[a]));return c};a.prototype.getGridProperties=function(){return this.gridLayoutInstance?this.gridLayoutInstance.gridProperties:
null};a.prototype.getOverflow=function(){var c=this.getGridProperties();return void 0!=c.grHOF&&void 0!=c.grVOF?{h:c.grHOF,v:c.grVOF}:null};a.prototype.getScrollbarBgColor=function(){return this.groupConfigurations[this.configurationId].gr.grSclBgColor};a.prototype.getScrollbarThumbColor=function(){return this.groupConfigurations[this.configurationId].gr.grSclColor};a.prototype.getScrollbarSize=function(){return this.groupConfigurations[this.configurationId].gr.grSclSize};a.prototype.getScrollbarOffset=
function(){return this.groupConfigurations[this.configurationId].gr.grSclOffset};a.prototype.getScrollbarOffsets=function(){var c={top:0,left:0};if(this.scrollbarInstance){var a=this.scrollbarInstance.getScrollTop(),b=this.scrollbarInstance.getScrollLeft();c.top=f.getActivePage().isFitToSizeEnable()?a*f.getActivePage().sFactor:a;c.left=f.getActivePage().isFitToSizeEnable()?b*f.getActivePage().sFactor:b}return c};a.prototype.getYScrollPosition=function(){return this.scrollbarInstance?this.scrollbarInstance.getOffset().y:
0};a.prototype.getXScrollPosition=function(){return this.scrollbarInstance?this.scrollbarInstance.getOffset().x:0};a.prototype.getScrollbarContentElem=function(){return this.scrollbarInstance?this.scrollbarInstance.getContentEl():null};a.prototype.getScrollbarContainerElem=function(){return this.scrollbarInstance?this.scrollbarInstance.getContainerEl():null};a.prototype.hasScrollbar=function(){return null!=this.scrollbarInstance?!0:!1};a.prototype.getChildren=function(){return this.wgts};a.prototype.getLayoutSize=
function(){return this.hasGridLayout()?this.getGridProperties().s:null};a.prototype.destroy=function(){b.prototype.destroy.call(this);this.scrollbarInstance&&(this.scrollbarInstance.removeListener(),this.scrollbarInstance.destroy());this.xforms=null;return!0};a.prototype.addAction=function(c,a){var b=f.getActiveProject().getCWidgetMgr(),d;b&&(d=b.getAttributeLink(this.ctype,c));if(void 0===d||0==d.length)d=[c];for(var b=0,g=d.length;b<g;b++){var k=d[b];if("*"==k.charAt(0)&&"."==k.charAt(1)){var n=
k.lastIndexOf("."),m=k.substr(n+1),k=this.getWidget(k.substring(0,n),!0,this.isTemplateWgt);null!=k&&k.addAction(m,a)}}};a.prototype.getGraphicModule=function(){return this.isModuleInstance()&&this.project.getCWidgetMgr().hasGfxInheritance(this.ctype)?this:b.prototype.getGraphicModule.call(this)};a.prototype.addXForm=function(c,a){this.xforms||(this.xforms={});this.xforms[c]=a};a.prototype.getXForm=function(c){if(void 0!==this.xforms)return this.xforms[c]};a.prototype.addActiveElement=function(c){this.activeElements.push(c)};
a.prototype.isModuleInstance=function(){return null!=this.ctype&&""!=this.ctype};a.prototype.deactivateWidgetPrototypes=function(){b.prototype.deactivateWidgetPrototypes.call(this)};a.prototype.scrollCallback=function(){if(0<this.activeElements.length)for(var c in this.activeElements)this.activeElements[c].remove();this.scrollbarInstance&&(c=this.scrollbarInstance.getLimit(),this.setXScroll(this.scrollbarInstance.getScrollLeft()),this.setYScroll(this.scrollbarInstance.getScrollTop()),this.setValue("relHorScrollPos",
this.xScroll/c.x,null),this.setValue("relVerScrollPos",this.yScroll/c.y,null))};a.prototype.getScrollbar=function(){return this.scrollbarInstance};a.prototype.setXScroll=function(c){this.xScroll=c};a.prototype.setYScroll=function(c){this.yScroll=c};a.prototype.setMountingPoint=function(c){this.mountingPoint=c};a.prototype.getMountingPoint=function(){return this.mountingPoint};a.jmType="GroupWgt";a._renderFlags={DRAWGRID:2,DRWSCROLLBAR:4,UPDATESCROLLBARX:8,UPDATESCROLLBARY:16,SCROLLCONTENTSIZE:32};
return a}(l);f.fn.hmiGroup=function(b,a,c,e){return new Na(this,b,a,c,e)};f.addWidgetDefinition("hmiGroup",Na);var Hb=function(b){function a(c,a,h,d,g){a=b.call(this,c.wgtId,a,h,d,g)||this;a.groupName=c.wgtId;a.srv=f.activeProject.getCommunticationObj();a.tagMgr=void 0!==a.tagMgr?a.tagMgr:null;a.tags=void 0!==a.tags?a.tags:null;a._cbId=void 0!==a._cbId?a._cbId:null;return a}p(a,b);a.prototype.stop=function(){f.getActiveProject().getTagMgr().unsubscribeGroup(this.wgtId)};a.prototype.getCallbackId=
function(){return this._cbId};a.prototype.setCallbackId=function(c){this._cbId=c};a.prototype.destroy=function(){this.tagMgr=this.tags=null;return b.prototype.destroy.call(this)};a.prototype.containsTag=function(c){return 1===this.tags[c]};a.prototype.removeDataLink=function(c){};a.jmType="GroupSubscribeWgt";return a}(l);f.fn.hmiGroupSubscribeWgt=function(b,a,c,e){return new Hb(this,b,a,c,e)};f.addWidgetDefinition("hmiGroupSubscribeWgt",Hb);var Tc=function(b){function a(c,a,h,d,g){c=b.call(this,c.wgtId,
a,h,d,g)||this;c.mlWgts={};c.loadedFonts=[];c.generateLangCodeMap();(a=c.loadValue("curLangId"))&&a!=c.curLangId?c.changeLanguage(a):c.changeLanguage(c.curLangId);return c}p(a,b);a.prototype.generateLangCodeMap=function(){this.mapLangCodeToLangId={};for(var c in this.langs)this.mapLangCodeToLangId[this.langs[c].langCode]=this.langs[c].langId};a.prototype.subscribe=function(c,a){this.mlWgts[c]=a};a.prototype.unsubscribe=function(c){delete this.mlWgts[c]};a.prototype.changeLanguage=function(c){if(this.langs[c]){if(this.curLangId!=
c){var a=u.getModule("Tag");this.curLangId=c;this.sendUpdate("curLangId",this.getValue("curLangId"),a.QUALITY_GOOD);this.sendUpdate("curLangName",this.getValue("curLangName"),a.QUALITY_GOOD);this.sendNotification("up-lang")}this.saveValue("curLangId");a=this.langs[c].defaultFont;-1==this.loadedFonts.indexOf(a)&&(WebFont.load({custom:{families:[this.langs[c].defaultFont],urls:["../css/fonts.css"]}}),this.loadedFonts.push(a));for(var b in this.mlWgts)if(this.mlWgts[b])this.mlWgts[b](c)}};a.prototype.setValue=
function(c,a,b,d){switch(c){case "curLangId":return c="L"+a,void 0!==this.langs[c]&&c!=this.curLangId&&this.changeLanguage(c),!0}return!1};a.prototype.getValue=function(c){switch(c){case "curLangId":return this.curLangId.substr(1);case "curLangName":return this.langs[this.curLangId].name;case "curLangCode":return this.langs[this.curLangId].langCode;case "langNameList":c=[];for(var a in this.langs)c.push(this.langs[a].name);return c.join(",")}return null};a.prototype.getLanguageFont=function(c){return(c=
this.langs[c])?c.defaultFont:""};a.prototype.getCurrentLanguage=function(){return this.curLangId};a.prototype.getCurrentLangIndex=function(){return parseInt(this.curLangId.substr(1))};a.prototype.getCurrentLangCode=function(){return this.getLangCodeFromLangId(this.getCurrentLanguage())};a.prototype.getLangIdFromLangCode=function(c){return this.mapLangCodeToLangId[c]};a.prototype.getLangCodeFromLangId=function(c){return this.langs[c].langCode};a.jmType="MultiLangMgrWgt";return a}(l);f.fn.hmiMultiLangMgr=
function(b,a,c,e){return new Tc(this,b,a,c,e)};f.addWidgetDefinition("hmiMultiLangMgr",Tc);var Uc=function(b){function a(c,a,h,d,g){c=b.call(this,c.wgtId,a,h,d,g)||this;c.clickWgtId=null;return c}p(a,b);a.prototype.render=function(){b.prototype.render.call(this);this._renderMask&a._renderFlags.FILL&&this.updateBackground();if(this._renderMask&a._renderFlags.UPDATE){var c=this.elem.getElementsByTagName("img");0<c.length&&(c[0].src=this.base64)}this._renderMask&a._renderFlags.UPDATESVG&&((c=this.elem.getElementsByTagName("svg"))&&
0<c.length&&c[0].parentNode.removeChild(c[0]),c=this.elem.appendChild((new DOMParser).parseFromString(this.SVG_code,"utf8").documentElement),c[0].setAttribute("width",this.width.toString()),c[0].setAttribute("height",this.height.toString()));this._renderMask=0};a.prototype.updateBackground=function(){var c=$("."+a.backgroundClass,this.elem);c.length?c.css("fill",this.bgColor):$("svg",this.elem).css("fill",this.bgColor)};a.prototype.setValue=function(c,e,h,d){d=!1;if(null!=this.elem)switch(c){case "fill":isNaN(e)&&
void 0!=e&&(this.isBadValue(e,!0,h)?d=!0:this.bgColor!=e&&(0==e.indexOf("#")&&1<e.length&&8>=e.length&&(this.bgColor=e),d=!0,this._renderMask|=a._renderFlags.FILL,this.sendUpdate(c,this.bgColor,null)));break;case "base64":case "imageBase64":this.base64!=e&&(this.base64=e,d=!0,this._renderMask|=a._renderFlags.UPDATE);break;case "SVG_code":this.SVG_code!=e&&(this.SVG_code=e,this._renderMask|=a._renderFlags.UPDATESVG);break;default:b.prototype.setValue.call(this,c,e,h)}d&&f.addToRender(this)};a.prototype.setParentBounds=
function(c,a,h,d,g){b.prototype.setParentBounds.call(this,c,a,h,d,g);this.updateOnResize()};a.prototype.updateOnResize=function(c){b.prototype.updateOnResize.call(this,c);this.imageOpt||(c=this.elem.getElementsByTagName("svg"))&&0<c.length&&(c[0].setAttribute("width",this.width.toString()),c[0].setAttribute("height",this.height.toString()))};a.backgroundClass="bgColor00";a._renderFlags={FILL:1,UPDATESVG:2,WIDTH:4,HEIGHT:8,UPDATE:16};a.jmType="ImageWgt";return a}(l);f.fn.hmiImage=function(b,a,c,e){return new Uc(this,
b,a,c,e)};f.addWidgetDefinition("hmiImage",Uc);var Vc=function(b){function a(c,e,h,d,g){c=b.call(this,c.wgtId,e,h,d,g)||this;c.bkElem=c.elem.querySelector("."+a.backgroundClass);c.backgroundColor=c.bkElem.getAttribute("fill");return c}p(a,b);a.prototype.applyStrokeColor=function(){this.elem.getElementsByTagName("svg")[0].firstElementChild.setAttribute("stroke",this.strokeColor)};a.prototype.applyStrokeWidth=function(){var c=this.elem.getElementsByTagName("svg")[0].firstElementChild,a=(this.width-
this.strokeWidth)/this.width,b=(this.height-this.strokeWidth)/this.height;La(c,"center");da(c,"scale( "+a+","+b+" )");c.setAttribute("stroke-width",""+this.strokeWidth)};a.prototype.render=function(){b.prototype.render.call(this);this._renderMask&a._renderFlags.FILL&&this.updateBackground();if(this._renderMask&a._renderFlags.UPDATESVG&&this.elem.getElementsByTagName("svg")[0]){var c=this.elem.getElementsByTagName("svg")[0],e=this.width/parseFloat(c.getAttribute("width")),h=this.height/parseFloat(c.getAttribute("height"));
La(c,"top left");da(c,"scale("+e+","+h+")")}this._renderMask&a._renderFlags.STRK&&this.applyStrokeColor();this._renderMask&a._renderFlags.STRKWIDTH&&this.applyStrokeWidth();this._renderMask=0};a.prototype.updateBackground=function(){null!=this.bkElem&&this.bkElem.setAttribute("fill",this.backgroundColor)};a.prototype.setValue=function(c,b,h,d){d=!1;var g="#000";if(null!=this.elem){switch(c){case "fill":this.isBadValue(b,!0,h)||this.strokeColor==b||(this.validateColor(b)&&(g=b),this.backgroundColor=
g,d=!0,this.sendUpdate(c,this.backgroundColor,h));this._renderMask|=a._renderFlags.FILL;break;case "stroke":this.strokeColor!=b&&this.validateColor(b)&&(this.strokeColor=b,this._renderMask|=a._renderFlags.STRK,d=!0,this.sendUpdate(c,this.strokeColor,h));break;case "stroke-width":this.strokeWidth!=b&&(this.strokeWidth=b,this._renderMask|=a._renderFlags.STRKWIDTH,d=!0);break;default:l.prototype.setValue.call(this,c,b,h)}d&&f.addToRender(this)}};a.prototype.validateColor=function(c){return void 0==c?
!1:"number"!=typeof c&&(0==c.indexOf("#")&&1<c.length&&8>=c.length||"r"===c.charAt(0)&&"g"===c.charAt(1)&&"b"===c.charAt(2))?!0:!1};a.prototype.getValue=function(c){return"fill"==c?this.backgroundColor:b.prototype.getValue.call(this,c)};a.prototype.setParentBounds=function(c,a,h,d,g){b.prototype.setParentBounds.call(this,c,a,h,d,g);this.updateOnResize()};a.prototype.updateOnResize=function(c){b.prototype.updateOnResize.call(this,c);this._renderMask|=a._renderFlags.UPDATESVG;f.addToRender(this)};a.prototype.destroy=
function(){this.backgroundColor=this.bkElem=null;return b.prototype.destroy.call(this)};a.backgroundClass="bgColor00";a._renderFlags={FILL:2,UPDATESVG:4,STRK:8,STRKWIDTH:16};a.jmType="ShapeWgt";return a}(l);f.fn.hmiShape=function(b,a,c,e){return new Vc(this,b,a,c,e)};f.addWidgetDefinition("hmiShape",Vc);(function(b){b[b.INT=0]="INT";b[b.FLOAT=1]="FLOAT";b[b.HEXL=2]="HEXL";b[b.HEXU=3]="HEXU";b[b.EXP=4]="EXP";b[b.EXPD=5]="EXPD";b[b.THOUSAND=6]="THOUSAND"})(M||(M={}));(function(b){b[b.TEXT=0]="TEXT";
b[b.NUMBER=1]="NUMBER";b[b.DATETIME=2]="DATETIME"})(R||(R={}));(function(b){b[b.TIME_ONLY=0]="TIME_ONLY";b[b.DATE_ONLY=1]="DATE_ONLY";b[b.DATE_SEP_TIME=2]="DATE_SEP_TIME";b[b.TIME_SEP_DATE=3]="TIME_SEP_DATE"})(Ob||(Ob={}));var Ya=function(){function b(a,c,b){this.date=void 0!==a?a:new Date;this.format=c;this.configuration=b;void 0!==this.format&&(this.options=u.import("TextFormatUtil").parseDateTimeFormat(c,b))}b.prototype.setDate=function(a){this.date=new Date(a)};b.prototype.setFormat=function(a,
c){this.format=a;this.options=u.import("TextFormatUtil").parseDateTimeFormat(a,void 0!==c?c:this.configuration);this.configuration=c};b.prototype.setConfiguration=function(a){var c=!1;this.configuration.longDateFormat!=a.longDateFormat&&(this.configuration.longDateFormat=a.longDateFormat,c=!0);this.configuration.shortDateFormat!=a.shortDateFormat&&(this.configuration.shortDateFormat=a.shortDateFormat,c=!0);this.configuration.serverOffset!=a.serverOffset&&(this.configuration.longDateFormat=a.longDateFormat,
c=!0);c&&(this.options=u.import("TextFormatUtil").parseDateTimeFormat(this.format,this.configuration));return c};b.prototype.showMilliSeconds=function(){this.options.milliseconds=!0};b.prototype.getSeparator=function(){return this.options.sep};b.prototype.getOrder=function(){return this.options.order};b.prototype.splitFormat=function(a){for(var c=-1,b=-1,h=-1,d=-1,g=-1,f=-1,n=0,m=a.length;n<m;n++){var l=a.charAt(n),p="M"==l||"d"==l||"D"==l||"y"==l||"Y"==l,l="s"==l||"h"==l||"H"==l||"m"==l||"A"==l||
"P"==l;-1==c&&p&&(-1!=d&&(g=n-1),c=n);-1==d&&l&&(-1!=c&&(b=n-1),d=n);p&&(h=n);l&&(f=n)}-1!=c&&-1==b&&(b=a.length);-1!=d&&-1==g&&(g=a.length);return[-1!=c&&-1!=b?a.substring(c,h+1):"",-1!=d&&-1!=g?a.substring(d,f+1):""]};b.prototype.formatDateTimeAndSplit=function(a,c){if(void 0===this.format)return[];var b=this.splitFormat(this.options.format),h=this.options.format;this.options.format=b[0];var d=u.import("TextFormatUtil").formatDateTime(this.date,a,this.options,c?c:this.configuration);this.options.format=
b[1];b=u.import("TextFormatUtil").formatDateTime(this.date,a,this.options,c?c:this.configuration);this.options.format=h;return[d,b]};b.prototype.formatDateTime=function(a,c){return void 0===this.format?"":u.import("TextFormatUtil").formatDateTime(this.date,a,this.options,c?c:this.configuration)};b.prototype.formatDateTimeValue=function(){var a=this.format,c=!1;a.match(/(ap|a)/i)&&(c=!0);c=this.computeTimeParams(c);a=a.replace(/(ap|a)/i,c.amPm);a=a.replace(/MMM/,c.months[c.dt.getMonth()]);a=a.replace(/DD/,
c.cdate);a=a.replace(/YYYY/,c.cyear4);a=a.replace(/YY/,c.cyear2);a=a.replace(/MM/,c.cmonth);a=a.replace(/(hh|h)/,c.hrs);a=a.replace(/mm/,c.mts);a=a.replace(/ss/,c.sec);return a.trim()};b.prototype.computeTimeParams=function(a){var c={months:"Jan Feb Mar Apr May June July Aug Sep Oct Nov Dec".split(" ")};if(!(this.date instanceof Date))return null;c.dt=this.date;c.cdate=10>this.date.getDate()?"0"+this.date.getDate().toString():this.date.getDate().toString();c.cmonth=10>this.date.getMonth()+1?"0"+(this.date.getMonth()+
1).toString():(this.date.getMonth()+1).toString();c.cyear2=this.date.getFullYear().toString().slice(2);c.cyear4=this.date.getFullYear().toString();c.hrs=10>this.date.getHours()?"0"+this.date.getHours().toString():this.date.getHours().toString();c.mts=10>this.date.getMinutes()?"0"+this.date.getMinutes():this.date.getMinutes().toString();c.sec=10>this.date.getSeconds()?"0"+this.date.getSeconds():this.date.getSeconds().toString();a&&(c.amPm=12>parseInt(c.hrs)?"AM":"PM",c.hrs=13>parseInt(c.hrs)?c.hrs:
10>parseInt(c.hrs)-12?"0"+(parseInt(c.hrs)-12).toString():(parseInt(c.hrs)-12).toString());return c};return b}(),Wc;(function(b){b[b.INT=0]="INT";b[b.FLOAT=1]="FLOAT";b[b.HEXL=2]="HEXL";b[b.HEXU=3]="HEXU";b[b.EXP=4]="EXP";b[b.EXPD=5]="EXPD";b[b.THOUSAND=6]="THOUSAND"})(Wc||(Wc={}));var Xc=function(b){function a(c,e,h,d,g){c=b.call(this,c.wgtId,e,h,d,g)||this;c.setDefaultState();void 0===c.width&&(c.width=parseFloat(c.elem.style.width.split("px")[0]));void 0===c.height&&(c.height=parseFloat(c.elem.style.height.split("px")[0]));
void 0===c.cx&&(c.cx=c.width/2);void 0===c.cy&&(c.cy=c.height/2);void 0===c.radiusX&&(c.radiusX=c.cx);void 0===c.radiusY&&(c.radiusY=c.cy);c.labelNames&&(c.listLablesNames=c.labelNames.split(","));c._initLabelSize(c.dataType,c.form);"Time"==c.dataType&&(c.parseTimeFormat(),c.activateHandler=c.getActivateHandler(),b.prototype.bindEvents.call(c,{loadWgt:c.activateHandler}));c._renderMask=a._renderFlags.MIN|a._renderFlags.MAX|a._renderFlags.LBSFREQ|a._renderFlags.FNSIZE;f.addToRender(c);c._initialized=
!0;return c}p(a,b);a.prototype.setDefaultState=function(){this.reverse=void 0!==this.reverse?this.reverse:0;this.min=void 0!==this.min?this.min:0;this.max=void 0!==this.max?this.max:500;this.labels=void 0!==this.labels?this.labels:10;this.startAngle=void 0!==this.startAngle?this.startAngle:0*Math.PI/180;this.stopAngle=void 0!==this.stopAngle?this.stopAngle:90*Math.PI/180;this.cx=void 0!==this.cx?this.cx:0;this.cy=void 0!==this.cy?this.cy:0;this.range=void 0!==this.range?this.range:500;this.fontSize=
void 0!==this.fontSize?this.fontSize:"10px";this.fontFamily=void 0!==this.fontFamily?this.fontFamily:"Thaoma";this.fontColor=void 0!==this.fontColor?this.fontColor:"rgb( 0,0,0 )";this.dataFormat=void 0!==this.dataFormat?this.dataFormat:"Numeric";this.dataType=void 0!==this.dataType?this.dataType:"Number";this.invokablePropsList=["fill","fontColor"];this.timeSpec=void 0!==this.timeSpec?this.timeSpec:"local";this._valueWithMaxSymbols=this.max.toString();this._renderMask=0};a.prototype.getActivateHandler=
function(){var c=this;return function(){c.dateFormatter.setConfiguration({longDateFormat:c.project.getValue("longDateFormat"),shortDateFormat:c.project.getValue("shortDateFormat"),serverOffset:c.project.getSystemPropertiesMgr().getServerOffset()})&&(c._renderMask|=a._renderFlags.MIN,c._renderMask|=a._renderFlags.MAX,$hmi.addToRender(c))}};a.prototype._initLabelSize=function(c,b){if("Time"==c)if(this.isCached())this.maxTextSize=this.getCachedSize();else{var h=-1!=this.dataFormat.indexOf("A")?this.dataFormat+
"A":this.dataFormat;this.maxTextSize=a.getMeasureText(h,this.fontFamily,parseFloat(this.fontSize));this.setCachedSize()}else Math.abs(this.min)>Math.abs(this.max)?this._valueWithMaxSymbols=this.getValueByFormat(this.min):this._valueWithMaxSymbols=this.getValueByFormat(this.max);"vert"==this.form&&"Number"!=this.dataType&&(this.maxTextSize={width:this.width,height:parseInt(this.fontSize)});if(("round"==this.form||"horiz"==this.form)&&"Text"==c){var d=h=0;if(this.listLablesNames)for(var g=0;g<this.listLablesNames.length;g++)this.listLablesNames[g].length>
d&&(d=this.listLablesNames[g].length,h=g);this.isCached()?this.maxTextSize=this.getCachedSize():(this.maxTextSize=a.getMeasureText(this.listLablesNames[h],this.fontFamily,parseFloat(this.fontSize)),this.setCachedSize())}};a.prototype.render=function(){l.prototype.render.call(this);if(this._renderMask&(a._renderFlags.MIN|a._renderFlags.MAX|a._renderFlags.LBSFREQ|a._renderFlags.FNSIZE|a._renderFlags.REVERSE|a._renderFlags.REDRAW))switch(this.form){case "horiz":this.drawLinear(!1);break;case "vert":this.drawLinear(!0);
break;case "round":this.drawRadial()}this._renderMask&a._renderFlags.FNCOLOR&&(this.elem.style.color=this.fill);this._renderMask=0};a.prototype.removeChildren=function(){for(;this.elem.hasChildNodes();)this.elem.removeChild(this.elem.firstChild)};a.prototype.drawRadial=function(){if(!this.isCached()||this._initialized){var c=this.cx,b=this.cy,h=this.radiusX,d=this.radiusY,g=this.startAngle,f,n,m;this.min>this.max&&(this.max=this.min);this.elem.setAttribute("data-cx",this.radiusX.toString());this.elem.setAttribute("data-cy",
this.radiusY.toString());this.removeChildren();var l=(this.stopAngle-this.startAngle)/(this.labels-1),p=(this.max-this.min)/(this.labels-1),q=this.min;this.reverse&&(p=-p,q=this.max);this.maxTextSize||(this.maxTextSize=a.getMeasureText(" "+this._valueWithMaxSymbols,this.fontFamily,parseFloat(this.fontSize)));for(var t,u=document.createDocumentFragment(),w=0;w<this.labels;w++)f=Math.cos(Math.PI*g/180),n=Math.sin(Math.PI*g/180),f=c-(h-this.maxTextSize.width/2-3)*f,n=b-(d-this.maxTextSize.height/2-3)*
n,f-=this.maxTextSize.width/2,n-=this.maxTextSize.height/2,1>l?m="":this.listLablesNames&&this.listLablesNames[w]?m=this.listLablesNames[w]:(q=Math.round(q*Math.pow(10,6))/Math.pow(10,6),m=this.getValueByFormat(q)),t=document.createElement("div"),m=document.createTextNode(m),t.style.fontSize=this.fontSize,t.style.fontFamily=this.fontFamily,t.style.position="absolute",t.style.width=this.maxTextSize.width+"px",t.style.height=this.maxTextSize.height+"px",t.style.top=n.toFixed(2)+"px",t.style.left=f.toFixed(2)+
"px",t.style.textAlign="center",t.appendChild(m),q+=p,g+=l,u.appendChild(t);this.elem.appendChild(u)}};a.prototype.drawLinear=function(c){if(!this.isCached()||this._initialized){this.min>this.max&&(this.max=this.min);this.removeChildren();var b=(this.max-this.min)/(this.labels-1),h=this.min;this.reverse&&(b=-b,h=this.max);if(this.listLablesNames)for(var d=0;d<this.listLablesNames.length;d++);var g=this._renderMask&a._renderFlags.UPLBLSIZE;this.maxTextSize&&0==g||(this.maxTextSize=a.getMeasureText(" "+
this._valueWithMaxSymbols,this.fontFamily,parseFloat(this.fontSize)));var k=g=d=0;if(c)switch(d=(this.height-this.maxTextSize.height)/(this.labels-1),this.align){case 0:g=0;break;case 1:g=this.width-this.maxTextSize.width;break;case 2:g=this.width/2-this.maxTextSize.width/2}else switch(d=(this.width-this.maxTextSize.width)/(this.labels-1),this.align){case 0:k=0;break;case 1:k=this.height-this.maxTextSize.height;break;case 2:k=this.height/2-this.maxTextSize.height/2}for(var n=this.maxTextSize.height/
2,m=this.maxTextSize.width/2,l=d,p,q,t=document.createDocumentFragment(),d=0;d<this.labels;d++){this.listLablesNames&&this.listLablesNames[d]?p=this.listLablesNames[d]:(h=Math.round(h*Math.pow(10,6))/Math.pow(10,6),p=this.getValueByFormat(h));q=document.createElement("div");p=document.createTextNode(p);q.style.fontSize=this.fontSize;q.style.fontFamily=this.fontFamily;q.style.position="absolute";q.style.width=this.maxTextSize.width+"px";q.style.height=this.maxTextSize.height+"px";f.browserOptimizations.forceLayers&&
q.setAttribute("class","hacklayer willcnt");if(c){switch(this.align){case 0:q.style.textAlign="left";break;case 1:q.style.textAlign="right";break;default:q.style.textAlign="center"}q.style.top=n-this.maxTextSize.height/2+"px";q.style.left=g+"px"}else q.style.top=k+"px",q.style.left=m-this.maxTextSize.width/2+"px",q.style.textAlign="center";q.appendChild(p);c?n+=l:m+=l;h+=b;t.appendChild(q)}this.elem.appendChild(t)}};a.prototype.parseNumberFormat=function(){void 0!==this.format&&""!=this.format&&"none"!=
this.format&&(this.formatOptions=f.import("TextFormatUtil").parseFormat(this.format),this.decimalDigits=this.formatOptions.decimalPlaces,this.leadingDigits=this.formatOptions.leadingDigits)};a.prototype.parseTimeFormat=function(){var c={longDateFormat:this.project.getValue("longDateFormat"),shortDateFormat:this.project.getValue("shortDateFormat"),serverOffset:this.project.getSystemPropertiesMgr().getServerOffset()};this.dateFormatter=new Ya(new Date,this.dataFormat,c)};a.prototype.updateStyle=function(c){if(c.longDateFormat||
c.shortDateFormat)this.parseTimeFormat(),this._renderMask|=a._renderFlags.MIN,this._renderMask|=a._renderFlags.MAX,$hmi.addToRender(this)};a.prototype.formatText=function(c){var a=this.project?this.project.getValue("fieldsStyle"):null;return f.import("TextFormatUtil").formatText(this.formatOptions,c,a,!1)};a.prototype.getValueByFormat=function(c){switch(this.dataType){case "Number":return this.parseNumberFormat(),this.formatText(c);case "Text":return c;case "Time":return this.dateFormatter.setDate(c),
this.dateFormatter.formatDateTime(this.timeSpec)}};a.prototype.isCached=function(){return Boolean(this.elem.getAttribute("cache"))};a.prototype.setCachedSize=function(){this.elem.setAttribute("cache","true");this.elem.setAttribute("maxLabelWidth",this.maxTextSize.width.toString());this.elem.setAttribute("maxLabelHeight",this.maxTextSize.height.toString())};a.prototype.getCachedSize=function(){return{width:parseFloat(this.elem.getAttribute("maxLabelWidth")),height:parseFloat(this.elem.getAttribute("maxLabelHeight"))}};
a.prototype.updateMaxLabelSize=function(){this.maxTextSize=null;var c=this.getValueByFormat(this.max);c.length>this._valueWithMaxSymbols.toString().length&&(this._valueWithMaxSymbols=c)};a.prototype.setValue=function(c,e,h,d){var g=!1;switch(c){case "min":if(this.isBadValue(e,!1,h))return!1;parseFloat(e)!=this.min&&(this.min=parseFloat(e),"Number"==this.dataType&&(g=this.getValueByFormat(this.min),e=g.length,d=this._valueWithMaxSymbols.length,e>d||e==d&&"-"==this._valueWithMaxSymbols.charAt(0))&&
(this._valueWithMaxSymbols=g,this._renderMask|=a._renderFlags.UPLBLSIZE),this._renderMask|=a._renderFlags.MIN,g=!0,this.sendUpdate(c,this.min,h));break;case "max":if(this.isBadValue(e,!1,h))return!1;parseFloat(e)!=this.max&&(this.max=parseFloat(e),"Number"==this.dataType&&(g=this.getValueByFormat(this.max),e=g.length,d=this._valueWithMaxSymbols.length,e>d||e==d&&"-"==this._valueWithMaxSymbols.charAt(0))&&(this._valueWithMaxSymbols=g,this._renderMask|=a._renderFlags.UPLBLSIZE),this._renderMask|=a._renderFlags.MAX,
g=!0,this.sendUpdate(c,this.max,h));break;case "labelFreq":if(this.isBadValue(e,!1,h))return!1;e=parseFloat(e);0>e&&(e=0);this.labels!=e&&(this.labels=e,this._renderMask|=a._renderFlags.LBSFREQ,g=!0,this.sendUpdate(c,this.labels,h));break;case "numStates":if(this.isBadValue(e,!1,h))return!1;e=parseFloat(e);e=0<e?e:0;this.labels!=e&&(this.labels=e,this.max=this.min+this.labels-1,this._renderMask|=a._renderFlags.LBSFREQ,g=!0,this.sendUpdate(c,this.labels,h));break;case "fill":case "fontColor":d="#000";
this.isBadValue(e,!0,h)||this.fill==e?this.fill!=d&&(/^rgb\(\s*\d+,\s*\d+\s*,\s*\d+\s*\)$/.test(e)?d=e:"string"==typeof e&&0==e.indexOf("#")&&1<e.length&&8>=e.length&&(d=e),this.fill=d,g=!0,this.sendUpdate(c,d,h)):g=!0;g&&(this._renderMask|=a._renderFlags.FNCOLOR);break;case "font-size":if(this.isBadValue(e,!1,h))return!1;c=parseFloat(e);10>c&&(c=10);e=this.fontSize.split("p");h=parseInt(e[0]);e="p"+e[1];h!=c&&(this.fontSize=c+e,g=!0,this._renderMask|=a._renderFlags.FNSIZE);break;case "reverseScale":if(this.isBadValue(e,
!1,h))return!1;e=parseInt(e);this.reverse!=e&&(this.reverse=e,g=!0,this._renderMask|=a._renderFlags.REVERSE,this.sendUpdate(c,this.reverse,h));break;case "visibility2":l.prototype.setValue.call(this,"visibility",e,h,d);break;case "usingFormat":e!=this.format&&void 0!==e&&(g=!0,this.format=e,this.updateMaxLabelSize(),this._renderMask|=a._renderFlags.REDRAW,this.sendUpdate(c,this.format,h));break;case "decimalDigits":e!=this.decimalDigits&&void 0!==e&&(g=!0,e=10<e||0>e?this.decimalDigits:e,this.formatOptions.decimalPlaces=
this.decimalDigits=e,this.updateMaxLabelSize(),this._renderMask|=a._renderFlags.REDRAW,this.sendUpdate(c,this.decimalDigits,h));break;case "leadingDigits":e!=this.leadingDigits&&void 0!==e&&(g=!0,e=10<e||0>e?this.leadingDigits:e,this.formatOptions.leadingDigits=this.leadingDigits=e,this.updateMaxLabelSize(),this._renderMask|=a._renderFlags.REDRAW,this.sendUpdate(c,this.leadingDigits,h));break;case "startAngle":this.startAngle!=e&&(this.startAngle=parseFloat(e),this._renderMask|=a._renderFlags.REDRAW,
g=!0,this.sendUpdate(c,this.startAngle,h));break;case "stopAngle":case "endAngle":this.stopAngle!=e&&(360<e&&(e=360),this.stopAngle=parseFloat(e),this._renderMask|=a._renderFlags.REDRAW,g=!0,this.sendUpdate(c,this.stopAngle,h));break;case "dataFormat":void 0!=e&&this.dataFormat!=e&&(this.dataFormat=e,this.parseTimeFormat(),this._renderMask|=a._renderFlags.MIN,this._renderMask|=a._renderFlags.MAX,g=!0,this.sendUpdate(c,this.dataFormat,h));break;default:b.prototype.setValue.call(this,c,e,h,d)}g&&f.addToRender(this);
return!0};a.prototype.getValue=function(c){return"fill"==c||"fontColor"==c?this.fill?this.fill:this.elem.style.color:"undefined"!=typeof this[c]?this[c]:l.prototype.getValue.call(this,c)};a.prototype.setParentBounds=function(c,b,h,d,g){var k=this.width,n=this.height;l.prototype.setParentBounds.call(this,c,b,h,d,g);this.radiusX*=this.width/k;this.radiusY*=this.height/n;this._renderMask|=a._renderFlags.REDRAW;f.addToRender(this)};a.getMeasureText=function(c,a,b){if("string"!=typeof c||"string"!=typeof a||
"number"!=typeof b)throw"getMeasureText(): Invalid parameter type !";var d=document.createElement("canvas").getContext("2d");d.font=b+"px "+a;return{width:d.measureText(c).width,height:b}};a.prototype.destroy=function(){b.prototype.unbindEvents.call(this,{loadWgt:this.activateHandler});return b.prototype.destroy.call(this)};a._renderFlags={MIN:2,MAX:4,LBSFREQ:8,FNCOLOR:16,FNSIZE:32,REVERSE:64,UPLBLSIZE:128,REDRAW:256};a.jmType="LabelsWgt";return a}(l);f.fn.hmiLabels=function(b,a,c,e){return new Xc(this,
b,a,c,e)};f.addWidgetDefinition("hmiLabels",Xc);var H;(function(b){b[b.VERTICAL=0]="VERTICAL";b[b.HORIZONTAL=1]="HORIZONTAL";b[b.ROUND=2]="ROUND"})(H||(H={}));var Yc=function(b){function a(c,a,h,d,g){c=b.call(this,c.wgtId,a,h,d,g)||this;c.line=null;c.pathMajor=null;c.pathMinor=null;c.strokeColor="rgb(0,0,0)";c.svg=c.elem.getElementsByTagName("svg")[0];if(a=c.elem.getElementsByTagName("path"))1==c.tFrame&&c.form==H.ROUND?(c.line=a[0],c.pathMajor=a[1],c.pathMinor=a[2]):(c.pathMajor=a[0],c.pathMinor=
a[1]);(c.form==H.HORIZONTAL||c.form==H.VERTICAL)&&(a=c.elem.getElementsByTagName("line"))&&1<=a.length&&(c.line=a[0]);return c}p(a,b);a.prototype.render=function(){b.prototype.render.call(this);this._renderMask&a._renderFlags.COLOR&&(this.form==H.VERTICAL||this.form==H.HORIZONTAL?(this.pathMajor.setAttribute("fill",this.strokeColor),this.pathMinor.setAttribute("fill",this.strokeColor)):(this.pathMajor.setAttribute("stroke",this.strokeColor),this.pathMinor.setAttribute("stroke",this.strokeColor)),
this.line&&this.line.setAttribute("stroke",this.strokeColor));if(this._renderMask&a._renderFlags.UPDATE||this._renderMask&a._renderFlags.NEWSIZE)this.form==H.ROUND?this.generateTicksCodeRoundPath(document,this.width,this.height,this.cx,this.cy,this.form,this.align,this.max,this.majorTicks,this.majorThickness,this.majorTicksLength,this.minorTicks,this.minorThickness,this.minorTicksLength,this.startAngle,this.endAngle,this.tFrame,this.linecap,this.strokeColor):this.form!=H.HORIZONTAL&&this.form!=H.VERTICAL||
this.generateTicksCodeHVPath(document,this.width,this.height,this.form,this.align,this.max,this.majorTicks,this.majorThickness,this.majorTicksLength,this.minorTicks,this.minorThickness,this.minorTicksLength,this.tFrame,this.linecap,this.strokeColor);this._renderMask=0};a.prototype.setValue=function(c,e,h,d){d=!1;switch(c){case "majorTicks":case "labelFreq":if(this.isBadValue(e,!0,h))return!1;this.majorTicks!=e&&(d=e,2>e&&(d=2),this.majorTicks=d,this._renderMask|=a._renderFlags.UPDATE,d=!0,this.sendUpdate(c,
e,h));break;case "minorTicks":case "tickFreq":if(this.isBadValue(e,!0,h))return!1;var g=e;0>e&&(g=0);this.minorTicks!=g&&(this.minorTicks=g,this._renderMask|=a._renderFlags.UPDATE,d=!0,this.sendUpdate(c,e,h));break;case "align":if(this.isBadValue(e,!0,h))return!1;this.align!=e&&(this.align=e,this._renderMask|=a._renderFlags.UPDATE,d=!0,this.sendUpdate(c,e,h));break;case "max":if(this.isBadValue(e,!0,h))return!1;this.max!=e&&(this.max=e,this._renderMask|=a._renderFlags.UPDATE,d=!0,this.sendUpdate(c,
e,h));break;case "majorThickness":case "stroke-width":if(this.isBadValue(e,!0,h))return!1;this.majorThickness!=e&&(this.majorThickness=e,this._renderMask|=a._renderFlags.UPDATE,d=!0,this.sendUpdate(c,e,h));break;case "majorTicksLength":case "tickSize2":if(this.isBadValue(e,!0,h))return!1;this.majorTicksLength!=e&&(this.majorTicksLength=e,this._renderMask|=a._renderFlags.UPDATE,d=!0,this.sendUpdate(c,e,h));break;case "minorThickness":case "minorStroke-width":if(this.isBadValue(e,!0,h))return!1;this.minorThickness!=
e&&(this.minorThickness=e,this._renderMask|=a._renderFlags.UPDATE,d=!0,this.sendUpdate(c,e,h));break;case "minorTicksLength":case "tickSize":if(this.isBadValue(e,!0,h))return!1;this.minorTicksLength!=e&&(this.minorTicksLength=e,this._renderMask|=a._renderFlags.UPDATE,d=!0,this.sendUpdate(c,e,h));break;case "startAngle":if(this.isBadValue(e,!0,h))return!1;this.startAngle!=e&&(this.startAngle=e,this._renderMask|=a._renderFlags.UPDATE,d=!0,this.sendUpdate(c,e,h));break;case "endAngle":if(this.isBadValue(e,
!0,h))return!1;this.endAngle!=e&&(this.endAngle=e,this._renderMask|=a._renderFlags.UPDATE,d=!0,this.sendUpdate(c,e,h));break;case "stroke":g="#000";this.isBadValue(e,!0,h)?(this.strokeColor=g,this._renderMask|=a._renderFlags.COLOR,d=!0):this.strokeColor!=e&&(isNaN(e)&&0==e.indexOf("#")&&1<e.length&&8>=e.length&&(g=e),this.strokeColor=g,this._renderMask|=a._renderFlags.COLOR,d=!0,this.sendUpdate(c,this.strokeColor,h));break;case "visibility2":b.prototype.setValue.call(this,"visibility",e,h,null);break;
default:b.prototype.setValue.call(this,c,e,h,null)}d&&f.addToRender(this);return!0};a.prototype.setParentBounds=function(c,a,h,d,g){b.prototype.setParentBounds.call(this,c,a,h,d,g);this.updateOnResize()};a.prototype.updateOnResize=function(c){b.prototype.updateOnResize.call(this,c);this._renderMask|=a._renderFlags.UPDATE;f.addToRender(this)};a.prototype.destroy=function(){this.pathMinor=this.pathMajor=this.line=this.svg=null;return b.prototype.destroy.call(this)};a.prototype.generateTicksCodeHVPath=
function(c,a,b,d,g,f,n,m,l,p,q,t,u,w,A){f=this.svg;f.setAttribute("width",a.toString());f.setAttribute("height",b.toString());var x=f=0,z=0,y=0,D,E;d==H.VERTICAL?1==g?(D=a-l-m/2,D<m&&(D=m/2)):0==g&&(D=l+m/2,D>=a&&(D=a-m/2)):d==H.HORIZONTAL&&(1==g?(E=b-l-m/2,E<m&&(E=m/2)):0==g&&(E=l,E>=b&&(E=b-m/2)));0==g?d==H.VERTICAL?(f=D,x=0,z=D,y=b):d==H.HORIZONTAL&&(f=0,x=E,z=a,y=E):1==g?d==H.VERTICAL?(f=D,x=0,z=D,y=b):d==H.HORIZONTAL&&(f=0,x=E,z=a,y=E):2==g&&(d==H.VERTICAL?(f=a/2,x=0,z=a/2,y=b):d==H.HORIZONTAL&&
(f=0,x=b/2,z=a,y=b/2));1==u?(u=void 0,u=null==this.line?c.createElementNS("http://www.w3.org/2000/svg","line"):this.line,u.setAttribute("x1",f.toString()),u.setAttribute("y1",x.toString()),u.setAttribute("x2",z.toString()),u.setAttribute("y2",y.toString()),u.setAttribute("stroke-linecap",w),u.setAttribute("stroke-width",m.toString()),u.setAttribute("stroke",A)):null!=this.line&&(this.line.parentNode.removeChild(this.line),this.line=null);z=0;y=m/2;0==g?d==H.VERTICAL?(f=D-m/2,x=0,z=-(l+y)):d==H.HORIZONTAL&&
(f=0,x=E-m/2,z=-(l+m)):1==g?d==H.VERTICAL?(f=D+m/2,x=0,z=l+y):d==H.HORIZONTAL&&(f=0,x=E+m/2,z=l+m):2==g&&(d==H.VERTICAL?(f=a/2-l/2,x=0):d==H.HORIZONTAL&&(f=0,x=b/2-l/2));l=[];w=0;d==H.VERTICAL?w=(b-m)/(n-1):d==H.HORIZONTAL&&(w=(a-m)/(n-1));var F=this.pathMajor,B="";for(c=0;c<n;c++)u=w*c,d==H.VERTICAL?(B+=" M"+f+" "+u,B+=" h"+z,B+=" v"+m,B+=" h"+-z):d==H.HORIZONTAL&&(B+=" M"+u+" "+x,B+=" h"+m,B+=" v"+z,B+=" h"+-m),l.push(u+y);F.setAttribute("fill",A);F.setAttribute("d",B);z=this.pathMinor;y="";for(c=
0;c<n-1;c++){F=l[c];w=l[c+1];B=0;0==g?d==H.VERTICAL?(f=D-m/2,x=0,B=-(t+m/2)):d==H.HORIZONTAL&&(f=0,x=E,B=-(t+m/2)):1==g?d==H.VERTICAL?(f=D+m/2,x=0,B=t+m/2):d==H.HORIZONTAL&&(f=0,x=E,B=t+m/2):2==g&&(d==H.VERTICAL?(f=a/2-t/2,x=0):d==H.HORIZONTAL&&(f=0,x=b/2-t/2));w=(w-F-q)/(p+1);for(var G=1;G<=p;G++)u=F+w*G,d==H.VERTICAL?(y+=" M"+f+" "+u,y+=" h"+B,y+=" v"+q,y+=" h"+-B):d==H.HORIZONTAL&&(y+=" M"+u+" "+x,y+=" h"+q,y+=" v"+B,y+=" h"+-q)}z.setAttribute("d",y);z.setAttribute("fill",A)};a.prototype.generateTicksCodeRoundPath=
function(c,a,b,d,g,f,n,m,l,p,q,t,u,w,x,z,y,A,B){f=this.svg;f.setAttribute("width",a.toString());f.setAttribute("height",b.toString());a=d-2;b=g-2;0==n?(a-=p/2,b-=p/2):1==n?(a-=w+p,b-=w+p):2==n&&(a=a-w/2-p,b=b-w/2-p);n="";1==y?(y=void 0,y=null==this.line?c.createElementNS("http://www.w3.org/2000/svg","path"):this.line,n=ac(d,g,a,b,x,z),y.setAttribute("d",n),y.setAttribute("stroke-width",p.toString()),y.setAttribute("fill","none"),y.setAttribute("stroke",B),null==this.line&&(this.line=y,this.svg.appendChild(this.line))):
null!=this.line&&(this.line.parentNode.removeChild(this.line),this.line=null);c=this.pathMajor;c.setAttribute("stroke-width",p.toString());n="";a=d-2;b=g-2;z=(z-x)/(l-1);y=[];f=a-(q+p);q=b-(q+p);for(m=0;m<l;m++){A=ab(d,g,a-p/2,b-p/2,x);var D=ab(d,g,f,q,x);n+=" M"+A.x+" "+A.y+" L"+D.x+" "+D.y;y.push(x);x+=z}c.setAttribute("stroke",B);""!=n&&c.setAttribute("d",n);c=this.pathMinor;n="";c.setAttribute("stroke-width",u.toString());f=a-(w+p);q=b-(w+p);for(m=0;m<l-1;m++)for(z=(y[m+1]-y[m])/(t+1),x=y[m]+
z,u=0;u<t;u++)A=ab(d,g,a-p/2,b-p/2,x),D=ab(d,g,f,q,x),n+=" M"+A.x+" "+A.y+" L"+D.x+" "+D.y,x+=z;c.setAttribute("stroke",B);c.setAttribute("d",n)};a._renderFlags={COLOR:2,UPDATE:4,NEWSIZE:8};a.jmType="TicksWgt";return a}(l);f.fn.hmiTicks=function(b,a,c,e){return new Yc(this,b,a,c,e)};f.addWidgetDefinition("hmiTicks",Yc);var Zc=function(b){function a(c,e,h,d,g){c=b.call(this,c.wgtId,e,h,d,g)||this;c.setDefaultState();-1!=c.groupID&&c.parentPage.getProject().groupButtonIn(c,c.groupID);c.imageOpt=!1!==
h.jmOptimization;c.authCode=c.getAuthorizations();c.isClone&&c.changeInternalElementsIds();"standard"==c.form?c.classReleased&&c.classPressed?(c.isRaster=!0,c.curState=-1!=c.elem.className.indexOf(c.classPressed)?1:0):(c.divPressed=c.elem.querySelector("#"+CSS.escape(c.wgtId+"_pressed")),c.divReleased=c.elem.querySelector("#"+CSS.escape(c.wgtId+"_released")),c.curState=1==parseInt(c.divPressed.style.opacity)?1:0):(c.dwnFill&&(c.curState=c.elem.style.backgroundColor==c.dwnFill?1:0),c.dwnStroke&&(c.curState=
c.elem.style.borderColor==c.dwnStroke?1:0));c.events={mousedown:!0,touchstart:!0};c.wgtsOnTop=[];if(c.parentWidget&&c.parentWidget.constructor==Na)for(h=c.elem.nextSibling;h;)c.wgtsOnTop.push(h),h=h.nextSibling;c._animStatus=c.curState;0==c.toggle&&1==c.curState&&(c.curState=0,c._renderMask|=a._renderFlags.VALUE,c.render());return c}p(a,b);a.prototype.setDefaultState=function(){this.isRaster=void 0===this.isRaster?!1:this.isRaster;this.classPressed=void 0===this.classPressed?null:this.classPressed;
this.classReleased=void 0===this.classReleased?null:this.classReleased;this.curState=void 0===this.curState?0:this.curState;this.toggle=void 0===this.toggle?0:this.toggle;this.action=void 0===this.action?"write":this.action;this.numStates=void 0===this.numStates?2:this.numStates;this.form=void 0===this.form?"standard":this.form;this.strokeWidth=void 0===this.strokeWidth?1:this.strokeWidth;this.backgroundClass=void 0===this.backgroundClass?"bgColor00":this.backgroundClass;this.backgroundColor=void 0===
this.backgroundColor?"":this.backgroundColor;this.dx=void 0===this.dx?2:this.dx;this.dy=void 0===this.dy?2:this.dy;this.groupID=void 0===this.groupID?-1:this.groupID;this.invokablePropsList=["value"];this._renderMask=this._animStatus=0;this._lockEvent=!1};a.prototype.doMouseDown=function(c){var a=this;if(this.disabled)return!1;if(this.umgr&&this.authCode==this.umgr.getWidgetAuthorizationCodes().RDONLY)return this.project.getValue("onAccessDenied")&&this.showHideAccessDeniedIcon(),!1;if(this._lockEvent)return!1;
this._lockEvent=!0;setTimeout(function(){a._lockEvent=!1},100);this.setValue("value",this.toggle?1===this.curState?0:1:1,null);c=this.doWriteValue("value",this.curState);this.toggle&&-1!=this.groupID&&c.then(function(){return a.project.updateButtonGroupedByID(a,a.groupID)});return!0};a.prototype.doMouseUp=function(c){if(this.disabled||this.umgr&&this.authCode==this.umgr.getWidgetAuthorizationCodes().RDONLY)return!1;this.toggle||(this.setValue("value",0,null),this.doWriteValue("value",this.curState));
return!0};a.prototype.updateColor=function(){var c=this;$("."+this.backgroundClass,this.elem).each(function(){var a=$(this);a.css("fill")?a.css("fill",c.fill):a.attr("fill",c.fill)})};a.prototype.offsetTopWgts=function(c){for(var a=0,b=this.wgtsOnTop.length;a<b;a++){var d=this.wgtsOnTop[a];if(3!=d.nodeType){var g=parseInt(d.style.top.split("px")[0]),f=parseInt(d.style.left.split("px")[0]);c?(d.style.top=g+this.dy+"px",d.style.left=f+this.dx+"px"):(d.style.top=g-this.dy+"px",d.style.left=f-this.dx+
"px")}}};a.prototype.render=function(){if(!l.prototype.render.call(this))return!1;var c=f.browserOptimizations.forceLayers,b=this;if(this._renderMask&a._renderFlags.VALUE)if("standard"===this.form)if(this.isRaster){var h,d=this.elem.className.split(" ");this.curState?(h=d.indexOf(this.classReleased),-1!=h&&(this._animStatus=a._enStatus.IS_PRESSED,d.splice(h,1),this.elem.className=d.join(" ")+" "+this.classPressed,this.offsetTopWgts(1))):c?b.elem&&0==b.curState&&(h=d.indexOf(b.classPressed),-1!=h&&
(b._animStatus=a._enStatus.IS_RELEASED,d.splice(h,1),b.elem.className=d.join(" ")+" "+b.classReleased,b.offsetTopWgts(0))):setTimeout(function(){b.elem&&0==b.curState&&(h=d.indexOf(b.classPressed),-1!=h&&(b._animStatus=a._enStatus.IS_RELEASED,d.splice(h,1),b.elem.className=d.join(" ")+" "+b.classReleased,b.offsetTopWgts(0)))},50)}else this.curState?(this._animStatus=a._enStatus.IS_PRESSED,this.divPressed.style.opacity="1",this.divReleased.style.opacity="0",this.offsetTopWgts(1)):(b=this,c?(b._animStatus=
a._enStatus.IS_RELEASED,b.divPressed.style.opacity="0",b.divReleased.style.opacity="1",b.offsetTopWgts(0)):setTimeout(function(){b.elem&&(b._animStatus=a._enStatus.IS_RELEASED,b.divPressed.style.opacity="0",b.divReleased.style.opacity="1",b.offsetTopWgts(0))},50));else if("rectangle"===this.form||"oval"===this.form)this.curState?(this._animStatus=a._enStatus.IS_PRESSED,this.dwnFill&&(this.elem.style.backgroundColor=this.dwnFill),this.dwnStroke&&(this.elem.style.borderColor=this.dwnStroke)):(b=this,
c?(b._animStatus=a._enStatus.IS_RELEASED,b.upFill&&(b.elem.style.backgroundColor=b.upFill),b.upStroke&&(b.elem.style.borderColor=b.upStroke)):setTimeout(function(){b.elem&&(b._animStatus=a._enStatus.IS_RELEASED,b.upFill&&(b.elem.style.backgroundColor=b.upFill),b.upStroke&&(b.elem.style.borderColor=b.upStroke))},50));this._renderMask&a._renderFlags.FILL&&this.updateColor();this._renderMask=0;return!0};a.prototype.setValue=function(c,b,h,d){if("value"==c){if(this.isBadValue(b,!1,h))return!1;b=parseFloat(1==
b?1:0);if(isNaN(b))return!1;b=1<b||0>b?0:b;this.curState!=b&&(this.curState=b,this._renderMask|=a._renderFlags.VALUE,this.render(),this.sendUpdate(c,this.curState,h))}else"fill"==c?(c=!1,isNaN(b)&&(this.isBadValue(b,!0,h)?c=!0:this.fill!=b&&(this.fill=this.validateColor(b)?b:"#000",c=!0)),c&&(this._renderMask|=a._renderFlags.FILL,f.addToRender(this))):l.prototype.setValue.call(this,c,b,h,d);return!0};a.prototype.validateColor=function(c){return 0==c.indexOf("#")&&1<c.length&&8>=c.length||"r"===c.charAt(0)&&
"g"===c.charAt(1)&&"b"===c.charAt(2)?!0:!1};a.prototype.getValue=function(c){return"value"==c?this.curState:l.prototype.getValue.call(this,c)};a.prototype.changeInternalElementsIds=function(){for(var c=this.elem.querySelectorAll(".jm-wgt, .jm-wgt>div"),a=0,b=c.length;a<b;a++){var d=c[a];-1!=d.id.indexOf("_pressed")&&(d.id=d.id.replace(d.id,this.wgtId+"_pressed"));-1!=d.id.indexOf("_released")&&(d.id=d.id.replace(d.id,this.wgtId+"_released"))}};a.prototype.destroy=function(){if(this.destroyed)return!1;
if(!f.browserOptimizations.forceLayers&&0==this.curState&&this._animStatus==a._enStatus.IS_PRESSED)if("standard"===this.form)if(this.isRaster){var c=this.elem.className.split(" "),b=c.indexOf(this.classPressed);-1!=b&&(c.splice(b,1),this.elem.className=c.join(" ")+" "+this.classReleased,this.offsetTopWgts(0))}else this.divPressed.style.opacity="0",this.divReleased.style.opacity="1",this.offsetTopWgts(0);else this.upFill&&(this.elem.style.backgroundColor=this.upFill),this.upStroke&&(this.elem.style.borderColor=
this.upStroke);this.wgtsOnTop=[];this.divReleased=this.divPressed=null;return l.prototype.destroy.call(this)};a.prototype.setParentBounds=function(c,a,h,d,g){b.prototype.setParentBounds.call(this,c,a,h,d,g);this.updateOnResize()};a.prototype.updateOnResize=function(c){b.prototype.updateOnResize.call(this,c);if(!this.imageOpt){(c=this.divPressed.getElementsByTagName("svg"))&&0<c.length&&(c[0].setAttribute("width",this.width.toString()),c[0].setAttribute("height",this.height.toString()));var a=this.divReleased.getElementsByTagName("svg");
c&&0<c.length&&(a[0].setAttribute("width",this.width.toString()),a[0].setAttribute("height",this.height.toString()))}};a.jmType="ButtonWgt";a._renderFlags={VALUE:2,FILL:4};a._enStatus={IS_RELEASED:0,IS_PRESSED:1};return a}(l);f.fn.hmiButton=function(b,a,c,e){return new Zc(this,b,a,c,e)};f.addWidgetDefinition("hmiButton",Zc);var $c=function(b){function a(c,a,h,d,g){c=b.call(this,c.wgtId,a,h,d,g)||this;c.scaleX=1;c.scaleY=1;return c}p(a,b);a.prototype.applyStrokeColor=function(){this.elem.getElementsByTagName("svg")[0].firstElementChild.setAttribute("stroke",
this.strokeColor)};a.prototype.updateSvgLineCode=function(c){var a=this.height+2*this.strokeWidth,b=-this.strokeWidth;c.setAttribute("width",""+(this.width+2*this.strokeWidth));c.setAttribute("height",""+a);c.style.marginLeft=b+"px";c.style.top=b+"px"};a.prototype.updateLineAnchor=function(c){var a=parseFloat(c.getAttribute("width"));c=parseFloat(c.getAttribute("height"));var b,d,g,f,n=this.strokeWidth;switch(this.anchorIdx){case 0:b=0+n;g=0+n;d=a-n;f=c-n;break;case 1:b=0+n;g=c-n;d=a-n;f=0+n;break;
case 2:b=a-n;g=0+n;d=0+n;f=c-n;break;case 3:b=a-n,g=c-n,d=0+n,f=0+n}return{x1:b,x2:d,y1:g,y2:f}};a.prototype.updateLineCode=function(c,a){c.setAttribute("x1",""+a.x1);c.setAttribute("y1",""+a.y1);c.setAttribute("x2",""+a.x2);c.setAttribute("y2",""+a.y2);c.setAttribute("stroke-width",""+this.strokeWidth)};a.prototype.applyStrokeWidth=function(){var c=this.elem.getElementsByTagName("svg")[0],a=c.firstElementChild;this.updateSvgLineCode(c);this.updateLineCode(a,this.updateLineAnchor(c))};a.prototype.render=
function(){b.prototype.render.call(this);if(this._renderMask&a._renderFlags.UPDATESVG&&this.elem.getElementsByTagName("svg")[0]){var c=this.elem.getElementsByTagName("svg")[0];La(c,"top left");da(c,"scale("+this.scaleX+","+this.scaleY+")")}this._renderMask&a._renderFlags.STRK&&this.applyStrokeColor();this._renderMask&a._renderFlags.STRKWIDTH&&this.applyStrokeWidth();this._renderMask=0};a.prototype.setValue=function(c,b,h,d){d=!1;switch(c){case "stroke":this.strokeColor!=b&&"string"==typeof b&&0==
b.indexOf("#")&&1<b.length&&8>=b.length&&(this.strokeColor=b,this._renderMask|=a._renderFlags.STRK,d=!0);break;case "stroke-width":this.strokeWidth!=b&&(this.strokeWidth=b,0==this.strokeWidth&&(this.strokeWidth=1),this._renderMask|=a._renderFlags.STRKWIDTH,d=!0);break;default:l.prototype.setValue.call(this,c,b,h)}d&&f.addToRender(this)};a.prototype.setParentBounds=function(c,a,h,d,g){var f=this.width,n=this.height;b.prototype.setParentBounds.call(this,c,a,h,d,g);this.scaleX*=this.width/f;this.scaleY*=
this.height/n;this.updateOnResize()};a.prototype.updateOnResize=function(c){b.prototype.updateOnResize.call(this,c);this._renderMask|=a._renderFlags.UPDATESVG;f.addToRender(this)};a._renderFlags={UPDATESVG:1,STRK:2,STRKWIDTH:4};a.jmType="LineWgt";return a}(l);f.fn.hmiLine=function(b,a,c,e){return new $c(this,b,a,c,e)};f.addWidgetDefinition("hmiLine",$c);var Aa;(function(b){b[b.VERTICAL=0]="VERTICAL";b[b.HORIZONTAL=1]="HORIZONTAL";b[b.ROUND=2]="ROUND"})(Aa||(Aa={}));var db;(function(b){b[b.TOP_OR_LEFT=
0]="TOP_OR_LEFT";b[b.BOTTOM_OR_RIGHT=1]="BOTTOM_OR_RIGHT";b[b.CENTER=2]="CENTER"})(db||(db={}));var mc=function(b){function a(c,a,h,d,g){c=b.call(this,c.wgtId,a,h,d,g)||this;c.svgRoundGeometry={bg:null,fg:null};c.__renderMask=0;c.invokablePropsList=["alarmMin","alarmMax","stroke","strokeWidth"];c.initialized=!0;c.endAngle=c.endAngle||0;c.startAngle=c.startAngle||0;c.alarmMin=c.alarmMin||0;c.alarmMax=c.alarmMax||0;c.min=c.min||0;c.max=c.max||0;c.form==Aa.VERTICAL||c.form==Aa.HORIZONTAL?c.svgLinearGeometry=
c.elem.querySelector("line"):(c.svgRoundGeometry.bg=c.elem.querySelector("path:nth-child(1)"),c.svgRoundGeometry.fg=c.elem.querySelector("path:nth-child(2)"));return c}p(a,b);a.prototype.render=function(){b.prototype.render.call(this);this._renderMask&a._renderFlags.REDRAW&&this.redraw();this._renderMask&a._renderFlags.STWIDTH&&this.redraw("strokeWidth");this._renderMask&a._renderFlags.STCOLOR&&(this.svgLinearGeometry&&this.svgLinearGeometry.setAttribute("stroke",this.stroke),this.svgRoundGeometry&&
this.svgRoundGeometry.fg&&this.svgRoundGeometry.fg.setAttribute("stroke",this.stroke));if(this._renderMask&a._renderFlags.UPDATESVG&&this.elem.getElementsByTagName("svg")[0]){var c=this.elem.getElementsByTagName("svg")[0];c.style.width=this.width+"px";c.style.height=this.height+"px";this.redraw()}this._renderMask=0};a.prototype._checkLimit=function(c){c>this.max&&(c=this.max);c<this.min&&(c=this.min);return c};a.prototype.redraw=function(c){var a=this.min,b=this.max,d=this.alarmMax;this.alarmMin>
this.alarmMax&&(d=this.alarmMin);d>b&&(d=b);var g=this.alarmMin;this.alarmMin>this.alarmMax&&(g=this.alarmMax);g<a&&(g=a);this.form==Aa.ROUND?this.drawRndScale(a,b,g,d,c):this.form==Aa.HORIZONTAL?this.drawHrzScale(a,b,g,d,c):this.form==Aa.VERTICAL&&this.drawVrtScale(a,b,g,d,c)};a.prototype.drawRndScale=function(c,a,b,d,g){var f=this.cx-this.strokeWidth/2,n=this.cy-this.strokeWidth/2,m=0,l=0;a-=c;0!=a&&(this.reverse?b<d&&(m=this.endAngle-(this.endAngle-this.startAngle)*(d-c)/a,l=this.endAngle-(this.endAngle-
this.startAngle)*(b-c)/a):b<d&&(m=this.startAngle+(this.endAngle-this.startAngle)*(b-c)/a,l=this.startAngle+(this.endAngle-this.startAngle)*(d-c)/a));c=ac(this.cx,this.cy,f,n,this.startAngle,this.endAngle);f=ac(this.cx,this.cy,f,n,m,l);this.svgRoundGeometry.bg&&(this.svgRoundGeometry.bg.setAttribute("d",c),"strokeWidth"===g&&this.svgRoundGeometry.bg.setAttribute("stroke-width",this.strokeWidth.toString()));this.svgRoundGeometry.fg&&(this.svgRoundGeometry.fg.setAttribute("d",f),"strokeWidth"===g&&
this.svgRoundGeometry.fg.setAttribute("stroke-width",this.strokeWidth.toString()))};a.prototype.drawHrzScale=function(c,a,b,d,g){var f=0,n=0,m=0,l=0;a-=c;0!=a&&(0==this.reverse?(f=this.width*(b-c)/a,m=this.width*(d-c)/a):(f=this.width-this.width*(b-c)/a,m=this.width-this.width*(d-c)/a),this.align==db.TOP_OR_LEFT?(n=this.strokeWidth/2,l=this.strokeWidth/2):this.align==db.BOTTOM_OR_RIGHT&&(n=this.height-this.strokeWidth/2,l=this.height-this.strokeWidth/2));this.svgLinearGeometry&&(this.svgLinearGeometry.setAttribute("x1",
f.toString()),this.svgLinearGeometry.setAttribute("y1",n.toString()),this.svgLinearGeometry.setAttribute("x2",m.toString()),this.svgLinearGeometry.setAttribute("y2",l.toString()),"strokeWidth"==g&&(this.svgLinearGeometry.setAttribute("stroke-width",this.strokeWidth.toString()),this.elem.style.height=this.strokeWidth+"px"))};a.prototype.drawVrtScale=function(c,a,b,d,g){var f=0,n=0,m=0,l=0;a-=c;0!=a&&(0==this.reverse?(n=this.height*(b-c)/a,l=this.height*(d-c)/a):(n=this.height-this.height*(b-c)/a,l=
this.height-this.height*(d-c)/a),this.align==db.TOP_OR_LEFT?(f=this.strokeWidth/2,m=this.strokeWidth/2):this.align==db.BOTTOM_OR_RIGHT&&(f=this.width-this.strokeWidth/2,m=this.width-this.strokeWidth/2));this.svgLinearGeometry&&(this.svgLinearGeometry.setAttribute("x1",f.toString()),this.svgLinearGeometry.setAttribute("y1",n.toString()),this.svgLinearGeometry.setAttribute("x2",m.toString()),this.svgLinearGeometry.setAttribute("y2",l.toString()),"strokeWidth"==g&&(this.svgLinearGeometry.setAttribute("stroke-width",
this.strokeWidth.toString()),this.elem.style.width=this.strokeWidth+"px"))};a.prototype.setValue=function(c,b,h,d){d=!1;if(this.isBadValue(b,!1,h))return!1;switch(c){case "min":this.min!=b&&(b>this.max&&(this.max=b),this.min=b,this._renderMask|=a._renderFlags.REDRAW,d=!0,this.sendUpdate(c,this.min,h));break;case "max":this.max!=b&&(b<this.min&&(this.min=b),this.max=b,this._renderMask|=a._renderFlags.REDRAW,d=!0,this.sendUpdate(c,this.max,h));break;case "alarmMax":this.alarmMax!=b&&(this.alarmMax=
parseFloat(b),this._renderMask|=a._renderFlags.REDRAW,d=!0,this.sendUpdate(c,this.alarmMax,h));break;case "alarmMin":this.alarmMin!=b&&(this.alarmMin=parseFloat(b),this._renderMask|=a._renderFlags.REDRAW,d=!0,this.sendUpdate(c,this.alarmMin,h));break;case "stroke-width":0>b&&(b=0);this.strokeWidth!=b&&(this.strokeWidth=parseFloat(b),this._renderMask|=a._renderFlags.STWIDTH,d=!0,this.sendUpdate(c,this.strokeWidth,h));break;case "startAngle":b>this.endAngle&&(b=this.endAngle);this.startAngle!=b&&(this.startAngle=
parseFloat(b),this._renderMask|=a._renderFlags.REDRAW,d=!0);break;case "endAngle":b<this.startAngle?b=this.startAngle:360<b&&(b=360);this.endAngle!=b&&(this.endAngle=parseFloat(b),this._renderMask|=a._renderFlags.REDRAW,d=!0);break;case "stroke":c="#000";this.stroke!=b&&(/^rgb\(\s*\d+,\s*\d+\s*,\s*\d+\s*\)$/.test(b)?c=b:"string"==typeof b&&0==b.indexOf("#")&&1<b.length&&8>=b.length&&(c=b),this.stroke=c,d=!0,this._renderMask|=a._renderFlags.STCOLOR);break;case "reverseScale":if(this.isBadValue(b,!1,
h))return!1;b=parseInt(b);this.reverse!=b&&(this.reverse=b,d=!0,this._renderMask|=a._renderFlags.REDRAW,this.sendUpdate(c,this.reverse,h));break;case "visibility":l.prototype.setValue.call(this,"visibility",b,h);break;default:l.prototype.setValue.call(this,c,b,h)}d&&f.addToRender(this);return!0};a.prototype.setParentBounds=function(c,b,h,d,g){l.prototype.setParentBounds.call(this,c,b,h,d,g);this._renderMask|=a._renderFlags.UPDATESVG;f.addToRender(this)};a.prototype.destroy=function(){return l.prototype.destroy.call(this)};
a._renderFlags={REDRAW:1,STWIDTH:2,STCOLOR:4,UPDATESVG:8};a.jmType="ScaleWgt";return a}(l);Object.defineProperty(mc.prototype,"form",{get:function(){return this._form},set:function(b){switch(b){case "vertical":this._form=Aa.VERTICAL;break;case "horizontal":this._form=Aa.HORIZONTAL;break;case "round":this._form=Aa.ROUND}}});f.fn.hmiScale=function(b,a,c,e){return new mc(this,b,a,c,e)};f.addWidgetDefinition("hmiScale",mc);var nc=function(b){function a(c,a,h,d,g){return b.call(this,c.wgtId,a,h,d,g)||
this}p(a,b);Object.defineProperty(a.prototype,"lang",{get:function(){this._lang||(this._lang=this.parentPage.getExportedLanguage());return this._lang},set:function(c){this._lang=c},enumerable:!0,configurable:!0});a.prototype.hasDynamicVariables=function(){return void 0!=this.variablesMap&&void 0!=this.__texts};a.prototype.textCanContainsVariables=function(c){return void 0!==c&&null!==c&&"string"==typeof c&&-1!=c.indexOf("[")&&-1!=c.indexOf("]")};a.prototype.textsCanContainsVariables=function(c){for(var a=
0,b=c.length;a<b;a++)if(void 0!==c[a]&&null!==c[a]&&-1!=c[a].indexOf("[")&&-1!=c[a].indexOf("]"))return!0;return!1};a.prototype.dynamicVariablesArePresent=function(){return null!=this.variablesMap};a.prototype.variablesAreInitialized=function(){return void 0!==this.variablesState&&null!==this.variablesState};a.prototype.parseNewTextVariables=function(c,a,b){this.unloadAllVariables();var d=this.textLiveTagParser;void 0===d&&(d=this.textLiveTagParser=new (f.import("TextLiveTagParser.ts")));for(var g=
{},k={},n,m=0,l=c.length;m<l;m++)g[m]=d.parseTextVariables(c[m],this.lang),k[m]=d.getVariablesMap(),n=d.getVariables();n?(this.__texts=g,this.variables=n,this.variablesMap=k,null==this.variablesMap||void 0!==a&&!a||this.loadEmbeddedTagDataLinks(void 0===b?-1:b,!0)):(this.prepareTextToRender(g),this.renderText())};a.prototype.loadDynamicTagsForText=function(c,a){void 0!==this.variablesMap&&void 0!==this.__texts&&this.loadEmbeddedTagDataLinks(c,a)};a.prototype.loadEmbeddedTagDataLinks=function(c,a){var b=
this;if(-1===c){var d=function(c){Ud.of(g.variablesMap[c][g.lang]).map(function(d){b.createDataLinksForText(parseInt(c),d,a);return d})},g=this,f;for(f in this.__texts)d(f)}else this.variablesMap[c]&&this.createDataLinksForText(c,this.variablesMap[c][this.lang],a);this.renderText()};a.prototype.createDataLinksForText=function(c,a,b){for(var d=0;d<a.length;d++){var g=a[d];this.addDataLinkToTextVariable(c,g,this.variables[g],b)}};a.prototype.unloadDynamicDataLinks=function(){if(this.variablesState)for(var c in this.variablesState){var a=
this.variablesState[c].link;a&&a.unmount().destroy();this.variablesState[c].link=null}};a.prototype.unloadAllVariables=function(){if(this.variablesState){for(var c in this.variablesState){var a=this.variablesState[c].link;a&&a.unmount().destroy()}this.variablesState=null}this.__texts=this.variablesMap=null};a.prototype.addDataLinkToTextVariable=function(c,b,h,d){h=!1;var g=null;if(void 0===this.variablesState||null===this.variablesState)this.variablesState={};(g=this.variablesState[b])?null==g.link?
(g.link=f.createDataLink(this,null,null).readFromStringAndSetTarget(this.variables[b],this,b,a.defaultFormats).mount().update(),null!==g.value&&this.updateVariableInTexts(b,c),h=!0):(g.pos[c]||(g.pos[c]=this.getVariableOccurencesInText(c,b)),null!==g.value&&(this.updateVariableInTexts(b,c),this.prepareTextToRender(this.getValueOfAllDynamicTexts()))):(g=f.createDataLink(this,null,null).readFromStringAndSetTarget(this.variables[b],this,b,a.defaultFormats).mount(),g={link:g,value:void 0,pos:{}},this.variablesState[b]=
g,g.pos[c]=this.getVariableOccurencesInText(c,b),this.variablesState[b].link.update(),null!==g.value&&this.updateVariableInTexts(b,c),h=!0);h&&d&&this.variablesState[b].link.subscribeForDatasourceNotification()};a.prototype.getVariableOccurencesInText=function(c,a){var b=this.__texts[c],d=a.length,g=b.indexOf(a),f=[];do f.push(g),g=b.indexOf(a,g+d);while(-1!=g);return f};a.prototype.updateVariable=function(c,a){var b=this.variablesState[c];return b&&b.value!==a?(b.value=a,!0):!1};a.prototype.updateVariableInTexts=
function(c,a){var b=!1;if(this.variablesState[c])if(-1==a){var d=this.variablesState[c].pos,g;for(g in d){var f=d[g];this.updateVariableInText(c,parseInt(g),f)&&!b&&(b=!0)}}else d=this.variablesState[c].pos,void 0!=d[a]&&(b=this.updateVariableInText(c,a,d[a]));return b};a.prototype.updateVariableInText=function(c,a,b){if(!b)return!0;for(var d=!1,g=0,f=b.length;g<f;g++){var n=b[g];0<=n&&(d=this.variablesState[c].value,this.__texts[a][n]=null===d||void 0===d?"NaN":d,d=!0)}return d};a.prototype.varToTagName=
function(c,a){return"string"==typeof c&&"$"==c.charAt(0)&&"{"==c.charAt(1)&&"}"==c.charAt(c.length-1)?"["+a[c]+"]":c};a.prototype.getValueOfDynamicText=function(c){var a=this;return this.__texts[c].map(function(c){return a.varToTagName(c,a.variables)}).join("")};a.prototype.getValueOfAllDynamicTexts=function(){var c=this,a={},b;for(b in this.__texts)a[b]=this.__texts[b].map(function(a){return c.varToTagName(a,c.variables)}).join("");return a};a.prototype.isVariableATagInCache=function(c){c=this.variables[c];
var a=c.lastIndexOf("[");-1!=a&&0<a-1&&"\\"!=c.charAt(a-1)&&(c=c.substring(0,a));return c?this.project.hasTagInCache(c):!1};a.prototype.isLiveTagsEnabled=function(){return this.liveTags};a.prototype.renderText=function(){};a.prototype.prepareTextToRender=function(c){return!1};a.defaultFormats=[{feature:'format("#.000000")',tagType:7},{feature:'format("#.000000")',tagType:8}];return a}(l);f.addWidgetDefinition("hmiTextBasedWidget",nc);var sa;(function(b){b[b.NONE=0]="NONE";b[b.CURRENT=1]="CURRENT";
b[b.ALL=2]="ALL"})(sa||(sa={}));var Ub=function(b){function a(c,a,h,d,g){c=b.call(this,c,a,h,d,g)||this;c.setDefaultState();c._renderMask=0;c.addActivationHandler();c.authCode=c.getAuthorizations();c.numStates=c.getSpanElems().length;c.initDataIdxToIdxMap();c.ml=!0;c.invokablePropsList=["fill","fontColor"];return c}p(a,b);a.prototype.addActivationHandler=function(){var c=this,a=f.getEventMgr();a&&(this.activateHandler=function(){c.isLiveTagsEnabled()&&c.hasDynamicVariables()?(c.hasInputKeyboardEnabled()&&
(c.dynamicTagMode=sa.ALL),c.dynamicTagMode==sa.CURRENT?c.loadDynamicTagsForText(c.value):c.loadDynamicTagsForText(-1),c.project.getTagMgr().subscribeDynamicTags()):c.dynamicTagMode=sa.NONE},this.deactivateHandler=function(){c.isLiveTagsEnabled()&&c.hasDynamicVariables()&&c.unloadDynamicDataLinks();c._hideCombobox()},a.on(this.parentPage.elem,"loadWgt",this.activateHandler),a.on(this.parentPage.elem,"unloadWgt",this.deactivateHandler))};a.prototype.setDefaultState=function(){this.value=void 0===this.value?
null:this.value;this.numStates=void 0===this.numStates?0:this.numStates;this.messages=void 0===this.messages?null:this.messages;this.permission=void 0===this.permission?"rw":this.permission;this.editable=void 0===this.editable?!1:this.editable;this.comboBoxStatus=void 0===this.comboBoxStatus?0:this.comboBoxStatus;this.mlAttributeLinked=void 0===this.mlAttributeLinked?!1:this.mlAttributeLinked;this.frameFill=void 0===this.frameFill?"transparent":this.frameFill;this.fontBold=void 0===this.fontBold?
!1:this.fontBold;this.fontUnderline=void 0===this.fontUnderline?!1:this.fontUnderline;this.fontSize=void 0===this.fontSize?null:this.fontSize;this.fontFamily=void 0===this.fontFamily?"":this.fontFamily};a.prototype.getSpanElems=function(){return this.elem.getElementsByTagName("span")};a.prototype.initDataIdxToIdxMap=function(){this.dataIdxToIdx={};for(var c=this.getSpanElems(),a=0;a<c.length;a++){var b=c[a];null!=b&&(b=parseInt(b.getAttribute("data-idx")),isNaN(b)||(this.dataIdxToIdx[b]=a))}};a.prototype.render=
function(){b.prototype.render.call(this);this._renderMask&a._renderFlags.INITWRAP&&(f.browserOptimizations.forceLayers&&($(this.elem).hasClass("jm-hacklayer")||$(this.elem).addClass("jm-hacklayer")),this._createNode(),this._attachEvents());if(this._renderMask&a._renderFlags.VALUE&&0<this.numStates){for(var c=this.getSpanElems(),e,h=0;h<c.length;h++)e=c[h],h==this.dataIdxToIdx[this.value]?"block"!=e.style.display&&(e.style.display="block"):"none"!=e.style.display&&(e.style.display="none");this.combowrap&&
this.updateWrapper()}this._renderMask&a._renderFlags.FNCOLOR&&(this.elem.style.color=this.fill);this._renderMask&a._renderFlags.FNWEIGHT&&(this.elem.style.fontWeight=this.fontBold?"bold":"normal");this._renderMask&a._renderFlags.FNDECORATION&&(this.elem.style.textDecoration=this.fontUnderline?"underline":"none");this._renderMask&a._renderFlags.MSGES&&1!=this.comboBoxStatus&&this.setGroupMessages();this._renderMask&a._renderFlags.UPLANG&&this._updateTextsLanguage();this._renderMask&a._renderFlags.FRCOLOR&&
(this.elem.style.backgroundColor=this.frameFill);if(this._renderMask&a._renderFlags.ALIGN&&(c=this.getSpanElems())&&0<c.length)for(e=0,h=c.length;e<h;e++){var d=c[e];switch(this.align){case "center":d.classList.remove("jm-align-right");d.classList.add("jm-align-"+this.align);break;case "right":d.classList.remove("jm-align-center");d.classList.add("jm-align-"+this.align);break;case "left":d.classList.remove("jm-align-right","jm-align-center")}}if(this._renderMask&a._renderFlags.VALIGN&&(c=this.getSpanElems())&&
0<c.length)for(e=0,h=c.length;e<h;e++)switch(d=c[e],this.valign){case "middle":d.classList.remove("jm-align-top","jm-align-bottom");d.classList.add("jm-align-"+this.valign);break;case "top":d.classList.remove("jm-align-middle","jm-align-bottom");d.classList.add("jm-align-"+this.valign);break;case "bottom":d.classList.remove("jm-align-top","jm-align-middle"),d.classList.add("jm-align-"+this.valign)}this._renderMask&a._renderFlags.FNFAMILY&&(this.elem.style.fontFamily="'"+this.fontFamily+"'");this._renderMask&
a._renderFlags.FNSIZE&&(this.elem.style.fontSize=this.fontSize+"px");this._renderMask&a._renderFlags.UPDATEWRAP&&(this.closeBtn&&this.closeBtn.updateBounds(),this.combowrap&&this.combowrap.updateCustomSelectricSize(),this.combowrap&&this.combowrap.updateCloneBounds());this._renderMask=0};a.prototype.updateSelectedIndex=function(){this.select.selectedIndex=null!=this.dataIdxToIdx[this.value]?this.dataIdxToIdx[this.value]:-1};a.prototype.renderText=function(){this._renderMask|=a._renderFlags.VALUE;
this._renderMask|=a._renderFlags.MSGES;f.addToRender(this)};a.prototype.setValue=function(c,e,h,d){var g=!1;if("value"==c){if(this.isBadValue(e,!1,h))return!1;e=parseFloat(e);if(isNaN(e))return!1;this.value!=e&&(this.value=e,this.select&&this.updateSelectedIndex(),this.isLiveTagsEnabled()&&this.dynamicTagMode==sa.CURRENT&&this.loadDynamicTagsForText(this.value,!0),this._renderMask|=a._renderFlags.VALUE,g=!0,this.sendUpdate(c,this.value,h))}else if("messages"==c)this.messages!=e&&(this.messages="string"==
typeof e?e.split(","):e instanceof Array?e:[""],this.isLiveTagsEnabled()&&this.textsCanContainsVariables(this.messages)?(this.parseNewTextVariables(this.messages),this.prepareTextToRender(this.getValueOfAllDynamicTexts())):this.isLiveTagsEnabled()&&this.dynamicVariablesArePresent()&&this.unloadAllVariables(),this._renderMask|=a._renderFlags.MSGES,g=!0,this.sendUpdate(c,this.messages instanceof Array?this.messages.join(","):this.messages,h));else if("fill"==c||"fontColor"==c)this.isBadValue(e,!0,h)||
this.fill==e||(this.fill=this.parseColor(e),g=!0,this._renderMask|=a._renderFlags.FNCOLOR,this.sendUpdate(c,e,h));else if("frameFill"==c)this.isBadValue(e,!0,h)||this.frameFill==e||(this.frameFill=this.parseColor(e,"transparent"),g=!0,this._renderMask|=a._renderFlags.FRCOLOR,this.sendUpdate(c,e,h));else if("align"==c){if(this.align===e)return!1;this.align!=e&&(this.align=e,g=!0,this._renderMask|=a._renderFlags.ALIGN,this.sendUpdate(c,e,h))}else if("valign"==c){if(this.valign===e)return!1;this.valign!=
e&&(this.valign=e,g=!0,this._renderMask|=a._renderFlags.VALIGN,this.sendUpdate(c,e,h))}else if("fontBold"==c){if(this.fontBold===e)return!1;this.fontBold!=e&&(this.fontBold=e,g=!0,this._renderMask|=a._renderFlags.FNWEIGHT,this.sendUpdate(c,e,h))}else if("fontUnderline"==c){if(this.fontUnderline===e)return!1;this.fontUnderline!=e&&(this.fontUnderline=e,g=!0,this._renderMask|=a._renderFlags.FNDECORATION,this.sendUpdate(c,e,h))}else if("font-size"==c||"fontSize"==c){if(this.isBadValue(e,!1,h))return!1;
e=parseFloat(e);this.fontSize!=e&&(1>e&&(e=1),this.fontSize=e,this._renderMask|=a._renderFlags.FNSIZE,g=!0,this.sendUpdate(c,this.fontSize,h))}else if("font-family"==c||"fontFamily"==c)this.isBadValue(e,!1,h)||this.fontFamily==e||(this.fontFamily=e,this._renderMask|=a._renderFlags.FNFAMILY,g=!0,this.sendUpdate(c,e,h));else if(this.isLiveTagsEnabled()&&0==c.indexOf("${")&&this.variablesAreInitialized()){if(this.isVariableATagInCache(c)&&this.isBadValue(e,!0,h),this.updateVariable(c,e)){h=!1;switch(this.dynamicTagMode){case sa.CURRENT:h=
this.updateVariableInTexts(c,this.value);break;case sa.ALL:h=this.updateVariableInTexts(c,-1)}h&&(g=this.prepareTextToRender(this.getValueOfAllDynamicTexts()))}}else b.prototype.setValue.call(this,c,e,h,d);g&&f.addToRender(this);return!0};a.prototype.prepareTextToRender=function(c){null==this.messages&&(this.messages=[]);for(var b in c)this.messages[this.dataIdxToIdx[b]]=c[b];this._renderMask|=a._renderFlags.MSGES;return!0};a.prototype.parseColor=function(c,a){return/^rgb\(\s*\d+,\s*\d+\s*,\s*\d+\s*\)$/.test(c)?
c:"string"==typeof c&&0==c.indexOf("#")&&1<c.length&&8>=c.length?c:a||"#000"};a.prototype.setGroupMessages=function(){var c=[];if(void 0!=this.messages){var a;a=this.messages;1<a.length?c=a.slice(0):"null"==a[0]?c.push(" "):c.push(a[0]);a=this.getSpanElems();var b=this.min;this.dataIdxToIdx={};for(var d=0;d<c.length;d++){if(a[d])a[d].setAttribute("data-idx",b.toString()),a[d].innerHTML=c[d];else{var g=a[d-1].cloneNode(!1);g.setAttribute("data-idx",b.toString());g.innerHTML=c[d];this.elem.appendChild(g)}this.dataIdxToIdx[b++]=
d}this.numStates=a.length;for(b=0;b<a.length;b++)a[b].style.display=b==this.dataIdxToIdx[this.value]?"block":"none";this.numStates!=c.length&&this.rmUnusedSpan(this.numStates-c.length);this.updateMsgSelect()}};a.prototype.rmUnusedSpan=function(c){for(var a=0;a<c;a++)$("span:last-child",this.elem).remove();this.numStates=this.getSpanElems().length;this.setValue("value",this.value,null)};a.prototype.updateMsgSelect=function(){this.editable&&($(this.select).remove(),this._hideCombobox(),this.combowrap&&
this.combowrap.removeWrapper(),this._createNode())};a.prototype.getValue=function(c){switch(c){case "viewindex":c=this.viewindex;break;case "fill":case "fontColor":c=this.fill;break;case "messages":c=this.messages instanceof Array?this.messages.join(","):this.messages;break;default:c=l.prototype.getValue.call(this,c)}return c};a.prototype.updateLanguage=function(){1!=this.mlAttributeLinked&&(this._renderMask|=a._renderFlags.UPLANG,f.addToRender(this))};a.prototype.getText=function(c){var a=this.getPageMLTextMgr();
return this.isClone&&this.hasDataSourceProp("messages")?this.tableGroupWgt.getText(c):a.getText(c,this,"messages")};a.prototype.getMLIds=function(){return this.isClone&&this.hasDataSourceProp("messages")?this.clMLIds:this.mlIds};a.prototype._updateTextsLanguage=function(){if(1!=this.mlAttributeLinked){var c=this.getPageMLTextMgr(),a=c.getCurrentFont(),b,c=c.getCurrentLanguage();this.mlMap&&(b=this.mlMap[c]);void 0!=b&&(a=b);this.elem.style.fontFamily!=a&&(this.elem.style.fontFamily="'"+a+"'");a=this.getText(0);
if(this.lang!=c){this.lang=c;if(a&&a instanceof Array)this.setValue("messages",a,u.getModule("Tag").QUALITY_GOOD);else{a=this.getMLIds();this.messages=Array(a.length);b=0;for(c=a.length;b<c;b++)this.messages[b]=this.getText(a[b]);this.dynamicVariablesArePresent()&&this.unloadAllVariables();if(this.textsCanContainsVariables(this.messages))switch(this.parseNewTextVariables(this.messages,!1),this.dynamicTagMode){case sa.CURRENT:this.loadDynamicTagsForText(this.value,!0);break;case sa.ALL:this.loadDynamicTagsForText(-1,
!0)}this.setGroupMessages()}this.updateMsgSelect()}}};a.prototype._createNode=function(){var c=this,a,b,d,g,f;this.select=document.createElement("select");for(var n=this.getSpanElems(),m=0;m<this.numStates;m++)f="",b=n[m],d=document.createElement("option"),g=document.createElement("p"),a=parseInt(b.getAttribute("data-idx")),this.viewindex&&(f=""+a+" - "),f+=b.textContent,a=document.createTextNode(f),g.appendChild(a),d.appendChild(g),this.select.appendChild(d);this.select.selectedIndex=this.value;
this._isNativeSelectCompatible()?this.authCode!=this.umgr.getWidgetAuthorizationCodes().RDONLY&&(this.combowrap=new L(this),this.closeBtn=new Lb(this),$(this.closeBtn.elem).on("touchstart click",function(a){a.stopPropagation();c._hideCombobox()}),this.updateWrapper(),this.combowrap.hideWrapper(),this.combowrap.bindEvents()):(this._attachChangeEvent(),this.select.setAttribute("style","position:absolute;width:"+(this.width+2)+"px;height:"+(this.height+2)+"px;left:-1px;top:-1px;z-index:9999;display:none"),
$(this.elem).prepend(this.select))};a.prototype._showCombobox=function(){this._detachEvents();this._closeOpenedSelect();this._isNativeSelectCompatible()?(this.combowrap.showWrapper(),this._addCloseButton()):this.select.style.display="block";this.comboBoxStatus=1};a.prototype._hideCombobox=function(){0!=this.comboBoxStatus&&(this._attachEvents(),this._isNativeSelectCompatible()?(this.combowrap.detachClone(),this.combowrap.hideWrapper(),this._removeCloseButton()):this.select.style.display="none",this.comboBoxStatus=
0)};a.prototype._addCloseButton=function(){this.closeBtn.updateBounds();this.parentWidget instanceof Ea?this.parentWidget.appendToScrollContent(this.closeBtn.elem):this.parentWidget.elem.appendChild(this.closeBtn.elem)};a.prototype._removeCloseButton=function(){this.closeBtn&&$(this.closeBtn.elem).detach()};a.prototype._attachEvents=function(){this.events={mousedown:!0,touchstart:!0}};a.prototype._detachEvents=function(){this.events={mousedown:!1,touchstart:!1}};a.prototype.hasInputKeyboardEnabled=
function(){return this.authCode!=this.umgr.getWidgetAuthorizationCodes().RDONLY&&"r"!=this.permission&&!this.disabled};a.prototype.doMouseUp=function(c,a){a.preventDefault();if(this.authCode==this.umgr.getWidgetAuthorizationCodes().RDONLY||"r"==this.permission||this.disabled)return!1;this._showCombobox();return!0};a.prototype.doMouseDown=function(c,a){a.preventDefault();return"r"==this.permission||this.disabled?!1:this.authCode==this.umgr.getWidgetAuthorizationCodes().RDONLY?(this.project.getValue("onAccessDenied")&&
this.showHideAccessDeniedIcon(),!1):!0};a.prototype.addDataLink=function(c){l.prototype.addDataLink.call(this,c);"value"==c.attr&&this.hasPropInDatalinks("Value");c.tgtWgt==this&&this.initDataLinkSideEffects(c,c.attr)};a.prototype.initDataLinkSideEffects=function(c,b){if("value"==b)if("r"==c.rw)this.permission="r";else{if(this.authCode==this.umgr.getWidgetAuthorizationCodes().FULL||this.authCode==this.umgr.getWidgetAuthorizationCodes().DEFAULT)this.editable=!0,this._renderMask|=a._renderFlags.INITWRAP,
f.addToRender(this),this.hasInputKeyboardEnabled()&&(this.dynamicTagMode=sa.ALL,this.loadDynamicTagsForText(-1))}else"messages"==b&&(this.mlAttributeLinked=!0)};a.prototype._attachChangeEvent=function(){var c=this;$(this.select).change(function(a){c.select.selectedIndex!=c.value&&(c.setValue("value",c.select.selectedIndex,null,null),c.doWriteValue("value",c.select.selectedIndex),c._hideCombobox())})};a.prototype.onChange=function(c){c=this.getSpanElems()[c].getAttribute("data-idx");this.setValue("value",
parseInt(c),null,null);this.doWriteValue("value",parseInt(c));this._hideCombobox()};a.prototype.onClose=function(){this.combowrap&&this.combowrap.detachClone()};a.prototype.updateWrapper=function(){this.updateSelectedIndex();this.combowrap.update(this.select.selectedIndex)};a.prototype._closeOpenedSelect=function(){var c=this.parentPage,b;for(b in c.wgts)c.wgts[b].constructor==a&&c.wgts[b].elem.id!=this.elem.id&&c.wgts[b]._hideCombobox()};a.prototype.setParentBounds=function(c,e,h,d,g){b.prototype.setParentBounds.call(this,
c,e,h,d,g);this._isNativeSelectCompatible()&&(this._renderMask|=a._renderFlags.UPDATEWRAP,f.addToRender(this))};a.prototype.destroy=function(){if(this.destroyed)return!1;this.combowrap&&(this.combowrap.removeObjects(),delete this.combowrap);this._isNativeSelectCompatible()&&this._removeCloseButton();this._detachEvents();return l.prototype.destroy.call(this)};a.jmType="MsgTextWgt";a._renderFlags={VALUE:2,MSGES:4,FNCOLOR:8,INITWRAP:16,UPLANG:32,CREATEBTN:64,FRCOLOR:128,ALIGN:128,VALIGN:256,FNWEIGHT:512,
FNDECORATION:1024,FNSIZE:2048,FNFAMILY:4096,UPDATEWRAP:8192};return a}(nc);f.fn.hmiMsgText=function(b,a,c,e){return new Ub(this,b,a,c,e)};f.addWidgetDefinition("hmiMsgText",Ub);var Ga;(function(b){b[b.BMP=1]="BMP";b[b.SVG=0]="SVG";b[b.CORRUPT=-1]="CORRUPT"})(Ga||(Ga={}));var ad=function(b){function a(c,e,h,d,g){c=b.call(this,c.wgtId,e,h,d,g)||this;c.setDefaultState();c._svgUse=c.elem.getElementsByTagName("use")[0];e=null!==c.elem.getAttribute("data-frame")?parseInt(c.elem.getAttribute("data-frame")):
c.value||0;c._imgRef=c.images[c.continuos?0>e?0:e%c.numStates:e];e!=c.value&&(c._renderMask|=a._renderFlags.VALUE,f.addToRender(c));return c}p(a,b);a.prototype.setDefaultState=function(){this.value=void 0===this.value?null:this.value;this.numStates=void 0===this.numStates?null:this.numStates;this.images=void 0===this.images?null:this.images;this._imgRef=void 0===this._imgRef?null:this._imgRef;this._svgUse=void 0===this._svgUse?null:this._svgUse;this.animate=void 0===this.animate?!1:this.animate;this.updateRate=
void 0===this.updateRate?1E3:this.updateRate;this.animTimer=void 0===this.animTimer?null:this.animTimer;this.animValue=void 0===this.animValue?-1:this.animValue;this._renderMask=0};a.prototype.render=function(){b.prototype.render.call(this);var c;this._renderMask&a._renderFlags.VALUE&&(c=this._changeImage(this.value),null!==c&&this.elem.setAttribute("data-frame",c));this._renderMask&a._renderFlags.ANIMATE&&(c=this._changeImage(this.animValue),null!==c&&this.elem.setAttribute("data-frame",c));this._renderMask=
0};a.prototype.setOptions=function(c){null!=c&&(l.prototype.setOptions.call(this,c),void 0!=c.value&&this.setValue("value",c.value,null),void 0!=c.updateRate&&(this.animInterval=parseInt(c.updateRate)),void 0!=c.animate&&(this.animate=c.animate)&&this.startAnimation())};a.prototype.animateImages=function(){var c=this.animValue+1;this.animValue=c=c>=this.numStates?0:c;this._renderMask|=a._renderFlags.ANIMATE;f.addToRender(this);this.animate&&this.startAnimation()};a.prototype.startAnimation=function(){var c=
this;this.animTimer=window.setTimeout(function(){c.animateImages()},this.updateRate)};a.prototype.stopAnimation=function(){clearTimeout(this.animTimer)};a.prototype.setValue=function(c,b,h,d){if(this.isBadValue(b,!1,h))return!1;if("value"==c||"frame"==c){b="boolean"==typeof b?!0===b?1:0:parseFloat(b);if(isNaN(b))return!1;this.value!=b&&(this.value=b,this.animate&&(this.animValue=b),this._renderMask|=a._renderFlags.VALUE,f.addToRender(this))}else if("animate"==c){b=parseFloat(b);if(isNaN(b))return!1;
this.animate!=b&&(0==b?(this.animate=!1,this.stopAnimation()):(this.animate=!0,0<this.updateRate&&this.startAnimation()),this.sendUpdate(c,b,h))}else if("updateRate"==c){b=parseFloat(b);if(isNaN(b))return!1;0>b&&(b=0);this.updateRate!=b&&(this.updateRate=b,this.stopAnimation(),this.animate&&0!=b&&this.startAnimation(),this.sendUpdate(c,b,h))}else l.prototype.setValue.call(this,c,b,h,d);return!0};a.prototype.getValue=function(c){return"value"==c||"frame"===c?this.value:l.prototype.getValue.call(this,
c)};a.prototype._changeImage=function(c){c=this.continuos?0>c?0:c%this.numStates:c;var a=this.images[c];if(!a)return null;var b=this._imgRef[Ga.BMP],d=this._imgRef[Ga.SVG],g=this.elem.className.split(" ");b?(g.splice(g.indexOf(b),1),a[Ga.CORRUPT]&&(this.elem.className=g.join(" "))):d&&(this._svgUse.style.opacity="0");a[Ga.BMP]?this.elem.className=g.join(" ")+" "+a[1]:a[Ga.SVG]&&(b&&(this.elem.className=g.join(" ")),b=this.isTemplateWgt?"#"+this.parentPage.getPrefix()+"_"+a[Ga.SVG].substring(2):"#"+
a[Ga.SVG],this._svgUse.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",b),this._svgUse.style.opacity="1");this._imgRef=a;return c};a.prototype.destroy=function(){if(this.destroyed)return!1;this._imgRef=this._svgUse=this.images=null;this.animate&&this.stopAnimation();return b.prototype.destroy.call(this)};a._renderFlags={VALUE:1,ANIMATE:2};a.jmType="MultiStateImageWgt";return a}(l);f.fn.hmiMultiStateImage=function(b,a,c,e){return new ad(this,b,a,c,e)};f.addWidgetDefinition("hmiMultiStateImage",
ad);var bd=function(b){function a(c,a,h,d,g){c=b.call(this,c.wgtId,a,h,d,g)||this;c.setDefaultState();c.value=[];c.quality={};c.alarmMgr=f.activeProject.getWidget("_AlarmsMgr",!0);c.tableWgt=g;c.tableIdx=c.tableWgt.addColumnWgt(c);return c}p(a,b);a.prototype.setDefaultState=function(){this.colType=void 0===this.colType?0:this.colType;this.hasChanged=void 0===this.hasChanged?!0:this.hasChanged;this.dataLinkTag=void 0===this.dataLinkTag?null:this.dataLinkTag;this.dataLinkSrc=void 0===this.dataLinkSrc?
null:this.dataLinkSrc;this.visibility=void 0===this.visibility?!0:this.visibility;this.length=void 0===this.length?0:this.length;this.hasQuality=void 0===this.hasQuality?!1:this.hasQuality;this.numberFormat=void 0===this.numberFormat?"DD/MM/YYYY hh:mm:ss":this.numberFormat};a.prototype.render=function(){this._baseRenderMask&this._baseRenderFlags.VISIBLE&&(this.visible?this.elem.style.display="":(this.elem.style.display="none",this.tableWgt.hideColumn(this.tableIdx)));this._baseRenderMask&=~this._baseRenderFlags.VISIBLE;
l.prototype.render.call(this)};a.prototype.addDataLink=function(c){b.prototype.addDataLink.call(this,c);this.initDataLinkSideEffects(c,c.getAttribute())};a.prototype.initDataLinkSideEffects=function(c,a){"value"==a&&(this.dataLinkTag=c.getTag(),this.dataLinkSrc=c.getDataSrc(),this.getDataFromSource(c.getTag()))};a.prototype.getDataFromSource=function(c){var a=this,b=u.getModule("Tag");if("AlarmsMgrWgt"==this.dataLinkSrc.getJMType())if(this.dataLinkSrc.isDataReady()){var d=this.dataLinkSrc.getDataValues(c);
"undefined"!=typeof d&&(this.setValue("value",d,b.QUALITY_GOOD,-1),"alEnable"!=c||this.hasQuality||(this.quality=this.dataLinkSrc.getDataValuesQuality(c),this.hasQuality=!0));this.tableWgt.columnReady(this.wgtId)}else setTimeout(function(){a.getDataFromSource(c)},200);else this.tableWgt.columnReady(this.wgtId)};a.prototype.getDataReference=function(c){return this.dataLinkSrc.getAlarmNameByIndex(c)};a.prototype.getTagLinkedToValue=function(){return this.dataLinkTag};a.prototype.getSrcLinkedToValue=
function(){return this.dataLinkSrc};a.prototype.getValue=function(c,a){var h;return"value"==c?(-1==a?h=this.value:this.value instanceof Array?(h=this.value[a],this.dataLinkSrc&&"AlarmsMgrWgt"==this.dataLinkSrc.getJMType()&&(h=this._replaceLiveData(h,a))):h=this.value,h):"width"==c?this.width:b.prototype.getValue.call(this,c)};a.prototype._replaceLiveData=function(c,a){if("string"==typeof c&&"alDescription"==this.dataLinkTag){var b=this.alarmMgr.getAlarmByIndex(a),d=b.liveData.d,b=b.liveTags,g=this.parentPage.getPageMLTextMgr().getCurrentLanguage(),
d="string"==typeof d[g]?d[d[g]]:d[g];if(null==d)return c;for(var g=null==b?0:b.length,f=0,n=d.length;f<n;f++){var m=new RegExp("\\[\\$"+f+"\\:[-]?\\d*\\]","g"),l=-1,p=c.search(m);if(-1!=p)var l=c.indexOf(":"),q=c.indexOf("]"),l=parseInt(c.substring(l+1,q));q="";-1!=p&&f<g&&(u.getModule("Tag"),q=""===b[f]&&l!=w.STRING?"nan":b[f]);c=c.replace(m,this.formatValue(q,d[f]))}}return c};a.prototype.applyTrasformation=function(c,a){var b=a.indexOf("("),d=a.indexOf(")");if(-1!=b&&-1!=d){var g=a.substring(0,
b),b=a.substring(b+1,d),g=new (f.getActiveProject().getWidgetDefinition("hmi"+g));c=g.execute(null,c,"w",g.getParametersFromString(b))}else-1!=a.indexOf("#")&&(g=f.import("TextFormatUtil"),c=g.format(g.parseFormat(a),c,null,!1));return c};a.prototype.formatValue=function(c,a){var b=Qb.parseString(a);"nan"!==c&&(0!=b.elemList.length||isNaN(c)||0==c%1||(b.elemList=['format("#.000000")']),c=b.elemList.reduce(this.applyTrasformation,c));return c};a.prototype.isEmpty=function(){return 0==this.length};
a.prototype.updateStyle=function(c){!c.longDateFormat&&!c.shortDateFormat||"SHORT-DATE"!=this.numberFormat&&"LONG-DATE"!=this.numberFormat||(this.tableWgt.refreshRequest(),this.hasChanged=!0)};a.prototype.setValue=function(c,a,h,d){if("value"==c)void 0!==d&&(-1==d||a instanceof Array?a instanceof Array?this.value=a:(this.value=a,this.tableWgt.refreshRequest()):this.value&&(this.value[d]=a,"undefined"!=typeof a&&"undefined"!=typeof h&&"number"==typeof d&&(this.quality[d]=h,this.hasQuality=!0)),this.value&&
(this.length=this.value.length)),this.hasChanged=!0;else return b.prototype.setValue.call(this,c,a,h,d);return!0};a.prototype.getQuality=function(c){var a=this.dataLinkSrc.getAlarmNameByIndex(c);return null!=this.dataLinkSrc.getAlarmByName(a).alRemoteEnable&&this.hasQuality?this.quality[c]:u.getModule("Tag").QUALITY_GOOD};a.prototype.destroy=function(){if(this.destroyed)return!1;this.value=this.dataLinkSrc=this.dataLinkTag=this.tableWgt=null;return b.prototype.destroy.call(this)};a.prototype.getType=
function(){return this.colType};a.jmType="ColumnWgt";return a}(l);f.fn.hmiColumn=function(b,a,c,e){return new bd(this,b,a,c,e)};f.addWidgetDefinition("hmiColumn",bd);var cd=function(b){function a(c,a,h,d,g){var k=b.call(this,c.wgtId,a,h,d,g)||this;k.refreshOnSourceChange=function(){if(this.isSourceChanged){var c=[],a,b,e,d=this._rowsToDisplay.length,g=this.typeContainer.HISTORICAL;for(b=0;b<d;b++){a="<tr";e=this.bgColor;this._getBGColorFromAlCache&&(e=this.rowStyle[b][0][0]);var h=this.fgColor;this._getFGColorFromAlCache&&
(h=this.rowStyle[b][0][1]);a+=' style="background-color:'+e+";color:"+h+';"';this.isActiveAlarm&&(g=this.typeContainer.ACTIVE);a+=">";for(e=0;e<this.columnsWgt.length;e++)a+=this.tableContent[e][b];a+="</tr>";c.push(a)}a=this.elem.querySelector(".jm-bodytable").id;var f=this;null==this.clusterize?this.clusterize=new Clusterize({rows:c,scrollId:a,contentId:g+"_"+f.elem.id,rows_in_block:20,blocks_in_cluster:3,show_no_data_row:!1,callbacks:{clusterChanged:function(){f.isActiveAlarm&&(f._updateCheckboxes(),
f._updateUserActions())},clusterWillChange:function(){f.isActiveAlarm&&(f._unbindCheckboxes(),f._unbindUserActions())}}}):this.clusterize.update(c);if(this.authCode!=this.umgr.getWidgetAuthorizationCodes().RDONLY)$(":checkbox",this.elem).on("click",this._updateManager())}this.filterChanged=!1};k.setDefaultState();k.columnsWgt=[];k._rowsToDisplay=[];k._previousRowsToDisplay=[];k.dataSrcs=[];k.alarmsMgr=k.project.getWidget("_AlarmsMgr",!0);void 0!==k.filterString&&k.filterString.toString()!=k._defaultFilter.toString()&&
(k.filterString=new RegExp(h.filterString,"i"));void 0!==k.filterString1&&(k.filterString1=new RegExp(h.filterString1,"i"));k.authCode=k.getAuthorizations();k.isTemplateWgt&&k.setIdForTemplate();k._headerColumns=k.elem.getElementsByTagName("th");k.colsWidth=[];k.pageStart=!1;k.firstRefresh=!1;k.tbBGColor=k.elem.querySelector(".jm-bodytable").style.backgroundColor;k.initializeTable();k.dateFormatter=new Ya;if(c=f.getEventMgr())k.activateHandler=function(){k.load()},k.deactivateHandler=function(){k.unload()},
c.on(k.parentPage.elem,"loadWgt",k.activateHandler),c.on(k.parentPage.elem,"unloadWgt",k.deactivateHandler);k.ml=!0;return k}p(a,b);a.prototype.setDefaultState=function(){this._defaultFilter=void 0===this._defaultFilter?/^((Not Triggered Acked|Not Triggered Not Acked|Triggered).*$)/i:this._defaultFilter;this.filterString=void 0===this.filterString?/^((Not Triggered Acked|Not Triggered Not Acked|Triggered).*$)/i:this.filterString;this.filterString1=void 0===this.filterString1?RegExp(""):this.filterString1;
this.filterCol=void 0===this.filterCol?0:this.filterCol;this.filterCol1=void 0===this.filterCol1?null:this.filterCol1;this.defaultSortCol=void 0===this.defaultSortCol?0:this.defaultSortCol;this.enableSort=void 0===this.enableSort?!1:this.enableSort;this.sortOrder=void 0===this.sortOrder?1:this.sortOrder;this.filterChanged=void 0===this.filterChanged?!0:this.filterChanged;this.timer=void 0===this.timer?null:this.timer;this.isActiveAlarm=void 0===this.isActiveAlarm?null:this.isActiveAlarm;this.autoRefresh=
void 0===this.autoRefresh?!1:this.autoRefresh;this.nColumnEnable=void 0===this.nColumnEnable?0:this.nColumnEnable;this.colsWidth=void 0===this.colsWidth?null:this.colsWidth;this.clusterize=void 0===this.clusterize?null:this.clusterize;this.tbBGColor=void 0===this.tbBGColor?"#ffffff":this.tbBGColor;this.bgColor=void 0===this.bgColor?"#fff":this.bgColor;this.fgColor=void 0===this.fgColor?"#000":this.fgColor;this.subscribed=void 0===this.subscribed?!1:this.subscribed;this._getBGColorFromAlCache=void 0===
this._getBGColorFromAlCache?!1:this._getBGColorFromAlCache;this._getFGColorFromAlCache=void 0===this._getFGColorFromAlCache?!1:this._getFGColorFromAlCache;this._queuedRefreshReq=void 0===this._queuedRefreshReq?!1:this._queuedRefreshReq;this.typeContainer={HISTORICAL:"historical",ACTIVE:"active"};this.invokablePropsList=["tableBGColor"];this._webkitCustomScrollV="WebKit/534.34";this._renderMask=0};a.prototype.load=function(){this.nColumnEnable!=this.columnsWgt.length||this.firstRefresh||(this.refresh(this.autoRefresh),
this.firstRefresh=!0);this.pageStart=!0;var c=this;this.headerClickHandler=function(a){c.orderRows(a.target)};for(var a=0,b=this._headerColumns.length;a<b;a++)this._headerColumns[a].setAttribute("data-colN",a.toString()),this.authCode!=this.umgr.getWidgetAuthorizationCodes().RDONLY&&this._headerColumns[a].addEventListener("click",this.headerClickHandler)};a.prototype.orderRows=function(c){this._headerColumns[this.defaultSortCol].style.textDecoration="";this.defaultSortCol=parseFloat(c.getAttribute("data-colN"));
this.sortOrder=this.sortOrder?0:1;this._headerColumns[this.defaultSortCol].style.textDecoration="underline";this.refresh(!1)};a.prototype.unload=function(){for(var c=0,a=this._headerColumns.length;c<a;c++)this._headerColumns[c].removeEventListener("click",this.headerClickHandler);$(".jm-hmi-msg",this.elem).off("click");this.stopRefresh();$("input:checkbox",this.elem).off("click");this.firstRefresh=!1;c=this.nColumnEnable=0;for(a=this.dataSrcs.length;c<a;c++)this.dataSrcs[c].unsubscribeWgt(this);this.subscribed=
!1};a.prototype.render=function(){l.prototype.render.call(this);this._renderMask&a._renderFlags.REFRESH&&this.refreshOnSourceChange();this._renderMask&a._renderFlags.BGCOLOR&&(this.elem.querySelector(".jm-bodytable").style.backgroundColor=this.tbBGColor);this._renderMask=0};a.prototype.columnReady=function(c){for(var a=this.columnsWgt.length,b=0;b<a;b++)if(this.columnsWgt[b].wgtId==c){this.nColumnEnable++;this.nColumnEnable==a&&this.pageStart&&!this.firstRefresh&&(this.firstRefresh=!0,this.refresh(this.autoRefresh));
break}};a.prototype.getValue=function(c){return"filterString"==c?this.filterString:"filterAttr"==c?(c=this.columnsWgt[this.filterCol])?c.getTagLinkedToValue():"":"filterString1"==c?this.filterString1:"filterAttr1"==c?(c=this.columnsWgt[this.filterCol1])?c.getTagLinkedToValue():"":l.prototype.getValue.call(this,c)};a.prototype.addColumnWgt=function(c){this.colsWidth.push(c.getValue("width"));return this.columnsWgt.push(c)-1};a.prototype.updateData=function(){f.getActivePage().wgtId!=this.parentPage.wgtId&&
this.parentPage.wgtId!=f.getFocusPage().wgtId||this.refresh(this.autoRefresh)};a.prototype.updateSelectColumn=function(){this._updateCheckboxes()};a.prototype.setIdForTemplate=function(){var c=this.elem.children[0].firstChild,a=c.nextSibling,b=a.firstChild;$(c).attr("id","hdr_"+this.wgtId);$(a).attr("id","container_"+this.wgtId);$(b).attr("id","tbl"+this.wgtId)};a.prototype.initializeTable=function(){var c=this.elem.children[0].firstChild,a=$(this.elem.firstElementChild),b=f.browserScrollbarWidth,
d=parseFloat(c.getAttribute("hdr-w")),g=0,k=40,n=$(c).next();-1!=navigator.userAgent.indexOf(this._webkitCustomScrollV)?($(this.elem.childNodes[1]).addClass("webkitbar"),n.addClass("webkitbar")):k=b;g="none"!=c.childNodes[0].style.display?this.height-28:this.height;a.scrollLeft(0);d>=this.width?n.css({height:g-b+"px",width:d+"px","padding-right":k+"px"}):(n.css("width","100%"),n.css("height",g));this.authCode==this.umgr.getWidgetAuthorizationCodes().RDONLY&&(c=this.elem.getElementsByClassName("clusterize"),
a=this.elem.getElementsByClassName("clusterize-scroll"),c[0].className+=" lockscrollx",a[0].className+=" lockscrolly")};a.prototype.setValue=function(c,b,h,d){null!=this.elem&&(-1<c.indexOf("filterString")?null!=b&&String(new RegExp(b))!=String(this[c])&&(this[c]=new RegExp(b),this.filterChanged=!0,this.refresh(!1)):"tableBGColor"==c?this.isBadValue(b,!0,h)||this.tbBGColor==b||(this.tbBGColor="number"==typeof b?"#000":b,this._renderMask|=a._renderFlags.BGCOLOR,f.addToRender(this)):"bgColor"==c?this._getBGColorFromAlCache||
this.isBadValue(b,!0,h)||this.bgColor==b||(this.bgColor="number"==typeof b?"#000":b,this._renderMask|=a._renderFlags.REFRESH,f.addToRender(this)):"fgColor"!=c||this._getFGColorFromAlCache||this.isBadValue(b,!0,h)||this.fgColor==b||(this.fgColor="number"==typeof b?"#000":b,this._renderMask|=a._renderFlags.REFRESH,f.addToRender(this)))};a.prototype.refreshRequest=function(){var c=this;0==this._queuedRefreshReq&&(this._queuedRefreshReq=!0,setTimeout(function(){c.refresh(!1);c._queuedRefreshReq=!1},0))};
a.prototype.hideColumn=function(c){var a=this.elem.querySelector(".jm-bodytable").getElementsByTagName("th");null!=a&&null!=a[c]&&"none"!=a[c].style.display&&(a[c].style.display="none")};a.prototype.refresh=function(c){var b=this;if(this.elem){this.tableContent=[];this.isSourceChanged=!1;0<this.columnsWgt.length&&(this._previousRowsToDisplay=this._rowsToDisplay.slice(),this._filterColumn(),this._sortColumn());0==this._rowsToDisplay.length&&0<this._previousRowsToDisplay.length&&(this.isSourceChanged=
!0);this.rowStyle=Array(this._rowsToDisplay.length);for(var h=this._rowsToDisplay.length,d=this.columnsWgt.length,g=0;g<d;g++){this.tableContent[g]=[];for(var k=0;k<h;k++){var n=this.columnsWgt[g];"alSelect"==n.dataLinkTag&&(this.checkboxColumnWgt=n);if(n.hasChanged||this.filterChanged||this._rowsToDisplay[k]!=this._previousRowsToDisplay[k])this.isSourceChanged=!0;var m=this._rowsToDisplay[k],l=n.getValue("value",m),p="text-overflow:ellipsis;";0==n.visible&&(p+="display:none;");switch(n.getType()){case 2:p+=
"text-align:center;word-break:break-all;";n.getQuality(m).isQualityGood()?(l="<input type='checkbox' data-datalink='"+n.getTagLinkedToValue()+"' data-tableid=\""+this.elem.id+'" data-dataref="'+n.getDataReference(m)+'" '+(l?"checked=true":""),this.authCode==this.umgr.getWidgetAuthorizationCodes().RDONLY&&(l+=" disabled "),l+=" />"):l="<div class='jm-bad jm-align-center' style='position:relative'></div>";this.tableContent[g][k]='<td style="'+p+'">'+l+"</td>";break;case 4:this.tableContent[g][k]=p?
'<td style="'+p+'">':"<td>";var q,p=typeof l;"string"==p||"number"==p?q=new Date(l):"undefined"!=typeof l&&(q=new Date(l.format()));q=this.isActiveAlarm?this.getLocalDate(q):new Date(l);l={longDateFormat:this.project.getValue("longDateFormat"),shortDateFormat:this.project.getValue("shortDateFormat"),serverOffset:this.project.getSystemPropertiesMgr().getServerOffset()};this.dateFormatter.setDate(q);this.dateFormatter.setFormat(n.numberFormat,l);l=this.dateFormatter.formatDateTime("local");this.tableContent[g][k]+=
l;this.tableContent[g][k]+="</td>";break;case 5:this.tableContent[g][k]=p?'<td style="'+p+'">':"<td>";0!==l&&void 0!=l&&(l=document.createElement("div"),$(l).css({width:"15px",height:"15px",margin:"0 auto",display:"block","background-size":"contain",opacity:"0.7"}),l.setAttribute("class",n.imgPath+" jm-hmi-img"),l.setAttribute("data-dataref",n.getDataReference(m)),this.tableContent[g][k]+=l.outerHTML);this.tableContent[g][k]+="</td>";break;default:this.tableContent[g][k]=p?'<td style="'+p+'">':"<td>",
this.tableContent[g][k]=l instanceof Date?this.tableContent[g][k]+l.getTime():this.tableContent[g][k]+(void 0===l?"":l),this.tableContent[g][k]+="</td>"}"alState"!=n.getTagLinkedToValue()||this.rowStyle[k]||(this.rowStyle[k]=[2],this.isActiveAlarm?this.rowStyle[k][0]=[this.alarmsMgr.getDataValues("BGColor")[m],this.alarmsMgr.getDataValues("FGColor")[m]]:(l=n.getSrcLinkedToValue().getAlarmNameByIndex(m),m=n.getSrcLinkedToValue().getAlarmStateCodeByIndex(m),m=this.alarmsMgr.getAlarmByName(l).getColorsByStateCode(m),
this.rowStyle[k][0]=[m.bg,m.fg]));n.hasChanged=!1}}this._renderMask|=a._renderFlags.REFRESH;f.addToRender(this);c&&(this.timer=window.setTimeout(function(){b.refresh(c)},3E3))}};a.prototype._setUserAction=function(c,a){var b=this.alarmsMgr.getAlarmByName(c).userActions,d;for(d in b)if(b[d].t==f.actionMgr.enActionType.JS)f.doAction(a,b[d]);else{var g=f.getAction("hmiAction"+b[d].c);g.setParameters(b[d]);f.doAction(a,g)}};a.prototype._updateUserActions=function(){var c=this;if(this.authCode!=this.umgr.getWidgetAuthorizationCodes().RDONLY)$(".jm-hmi-img",
this.elem).on("click",function(){c._setUserAction($(this).data("dataref"),c.elem.id)})};a.prototype._unbindUserActions=function(){$(".jm-hmi-img",this.elem).off()};a.prototype.clear=function(){null!=this.clusterize&&this.clusterize.update([])};a.prototype._updateCheckboxes=function(){var c,a,b,d=$("input:checkbox[data-datalink]");this.checkboxColumnWgt&&(this.checkboxColumnWgt.hasChanged=!0);if(this.authCode!=this.umgr.getWidgetAuthorizationCodes().RDONLY)$(":checkbox",this.elem).on("click",this._updateManager());
if(null!=this.clusterize){c=d.length;for(var g=0;g<c;g++)a=d[g].getAttribute("data-dataref"),b=d[g].getAttribute("data-datalink"),a=this.alarmsMgr.getAlarmByName(a),(a.isDirty(b)?a.getDirtyValue(b):a.getValue(b))?d[g].setAttribute("checked",!0):d[g].removeAttribute("checked")}};a.prototype._unbindCheckboxes=function(){$(":checkbox",this.elem).off()};a.prototype.addDataLink=function(c){l.prototype.addDataLink.call(this,c);this.dataSrcs.push(c.dataSrc);if(0==this.subscribed){this.isActiveAlarm="AlarmsMgrWgt"==
c.dataSrc.getJMType();var a=$("tbody",this.elem);this.isActiveAlarm?a.attr("id",this.typeContainer.ACTIVE+"_"+this.elem.id):a.attr("id",this.typeContainer.HISTORICAL+"_"+this.elem.id);c.dataSrc.subscribeWgt(this,function(){});this.subscribed=!0}var a=c.getAttribute(),b=c.getDataSrc().getJMType();c=c.getTag();if("BGColor"==c&&"bgColor"==a&&"AlarmsMgrWgt"==b||"alBGColor"==c&&"bgColor"==a&&"EventBufferWgt"==b)this._getBGColorFromAlCache=!0;if("FGColor"==c&&"fgColor"==a&&"AlarmsMgrWgt"==b||"alFGColor"==
c&&"fgColor"==a&&"EventBufferWgt"==b)this._getFGColorFromAlCache=!0};a.prototype.addBlink=function(c){var a,b;if("activeTable"==this.typeTable){for(var d=0;d<this._rowsToDisplay.length;d++)this._rowsToDisplay[d]==c&&(b=d+1);c=$(this.elem).find("tr").eq(b).children();a=c.not("td:nth-child(1)").not("td:nth-child(8)");$(a).fadeToggle(700,function(){$(a).fadeToggle(800)})}};a.prototype.stopRefresh=function(){"number"==typeof this.timer&&(clearTimeout(this.timer),delete this.timer)};a.prototype._filterColumn=
function(){this._rowsToDisplay=[];if(this.columnsWgt[0].isEmpty())return!1;for(var c=0;c<this.columnsWgt[0].value.length;c++){var a=!1,b=this.columnsWgt[this.filterCol].value[c];"alEnable"==this.columnsWgt[this.filterCol].dataLinkTag?(b=this.alarmsMgr.getAlarmByName(this.alarmsMgr.getAlarmName(c)),b=b.alEnable,b=this.filterString.test(b)||this.filterString.test(b?"1":"0")):b=this.filterString.test(b);b&&(null==this.filterCol1?a=!0:(b=this.columnsWgt[this.filterCol1].value[c],"alEnable"==this.columnsWgt[this.filterCol1].dataLinkTag?
(b=this.alarmsMgr.getAlarmByName(this.alarmsMgr.getAlarmName(c)),b=b.alEnable,a=this.filterString1.test(b)||this.filterString1.test(b?"1":"0")):this.filterString1.test(b)&&(a=!0)));a?this._rowsToDisplay.push(c):(a=this.getDatalink("selectionAttr"))&&"AlarmsMgrWgt"==a.dataSrc.getJMType()&&a.dataSrc.updateAlarmByIndex(c,a.tag,!1)}return!0};a.prototype._sortColumn=function(){for(var c=[],a={},b=0,d=!0,b=0;b<this._rowsToDisplay.length;b++){if(this.enableSort)a=this.columnsWgt[this.defaultSortCol].value[this._rowsToDisplay[b]];
else if(a=this.columnsWgt[this.defaultSortCol].getSrcLinkedToValue().getUnorderedPosition(this._rowsToDisplay[b]),null==a){d=!1;break}a={index:this._rowsToDisplay[b],value:a};c.push(a)}if(d){var g=this.sortOrder,f=this.enableSort;c.sort(function(c,a){if(f&&1==g){var b=a;a=c;c=b}return"string"==typeof c.value?c.value.localeCompare(a.value):c.value-a.value});for(b=0;b<this._rowsToDisplay.length;b++)this._rowsToDisplay[b]=c[b].index}};a.prototype.deleteTable=function(c){if(0==c)$("table tbody",this.elem).children().remove();
else for(var a=$("table tr",this.elem).length-1,b=c;b<a;b++)$("table tbody tr:eq("+c+")",this.elem).remove()};a.prototype._updateManager=function(){var c=this;return function(){var a=$(this);a.prop("checked",this.checked);var b=a.data("dataref"),a=a.data("datalink");"alSelect"==a?c.alarmsMgr.setSelectAlarm(b,this.checked):"alEnable"==a&&c.alarmsMgr.setEnableAlarm(b,this.checked)}};a.prototype._tableRowToAlarmIndex=function(c){return this._rowsToDisplay[c]};a.prototype.getLocalDate=function(c){if(void 0===
c)return new Date(0);var a=moment().utcOffset();return new Date(c.getTime()+6E4*a)};a.prototype.updateLanguage=function(){var c=this.getPageMLTextMgr(),a=c.getCurrentFont(),b;this.mlMap&&(b=this.mlMap[c.getCurrentLanguage()]);void 0!=b&&(a=b);b=$(".jm-text",this.elem);a&&$("#container_"+this.wgtId).css("font-family",a);for(var a=0,d=b.length;a<d;a++){var g=this.parentWidget.getWidget(b[a].id).mlIds[0],g=c.getText(g);null!=g&&(b[a].childNodes[0].textContent=g)}};a.prototype.destroy=function(){if(this.destroyed)return!1;
this._headerColumns=null;this.clusterize&&(this.clusterize.destroy(!0),this.clusterize=null);this.isActiveAlarm&&(this._unbindCheckboxes(),this._unbindUserActions());b.prototype.unbindEvents.call(this,{loadWgt:this.activateHandler,unloadWgt:this.deactivateHandler});this.alarmsMgr=this._rowsToDisplay=this._previousRowsToDisplay=this.tableContent=this.rowStyle=this.dataSrcs=null;return b.prototype.destroy.call(this)};a.jmType="TableWgt";a._renderFlags={REFRESH:1,BGCOLOR:2};return a}(l);f.fn.hmiTable=
function(b,a,c,e){return new cd(this,b,a,c,e)};f.addWidgetDefinition("hmiTable",cd);var za=function(b){function a(c,a,h,d,g){var f=b.call(this)||this;f.wgtId=c;f.studioId=a;f.parentPage=d;f.parentWidget=g;f.parentWidget&&(c=f.parentWidget.getGraphicModule())&&c.addXForm(f.wgtId,f);for(var n in h)f[n]=h[n];f.dLink=null;return f}p(a,b);a.prototype.setDLink=function(c){this.dLink=c;this.updateDataLink()};a.prototype.updateDataLink=function(){if(null!=this.dLink){var c=this.dLink.tagIndex,a=f.cache.getTag(this.dLink.tag);
a&&this.dLink.setWgtValue(a.value instanceof Array?a.value[c]:a.value,c,a.getQuality())}};a.prototype.addDataLink=function(c){b.prototype.addDataLink.call(this,c)};a.prototype.addOptions=function(c){if(null!=c)for(var a in c)this[a]=c[a]};a.prototype.getGraphicModule=function(){return this.parentWidget.getGraphicModule()};a.prototype.getParametersFromString=function(c){return{}};a.prototype.destroy=function(){this.dLink=null;b.prototype.destroy.call(this)};return a}(Zb);f.fn.hmiXform=function(b,a,
c,e){return new za(this,b,a,c,e)};f.addWidgetDefinition("hmiXform",za);var lc=function(b){function a(c,a,h,d,g){c=b.call(this,c?c.wgtId:null,a,h,d,g)||this;c.parameters="";c.$Vars={};c.map$AttrLink={};c.num$AttrLink=0;return c}p(a,b);a.prototype.setValue=function(c,a){void 0===a||0!=c.indexOf("$")||null!=this.$Vars[c]&&this.$Vars[c]==a||(this.$Vars[c]=a,null!=this.map$AttrLink[c]&&this.updateExpressionParams())};a.prototype.updateExpressionParams=function(){var c=u.getModule("Tag");this.parameters=
"var ";var a=0,b=this.num$AttrLink-1,d;for(d in this.map$AttrLink){var g=this.map$AttrLink[d];this.parameters=g.tagType===w.INT64?this.parameters+(d+"=fromString('"+this.$Vars[d]+"')"):g.tagType===w.UINT64?this.parameters+(d+"=fromString('"+this.$Vars[d]+"',true,10)"):g.tagType===w.STRING?this.parameters+(d+"='"+this.$Vars[d]+"'"):"string"===typeof this.$Vars[d]?this.parameters+(d+" = '"+this.$Vars[d]+"'"):this.parameters+(d+" = "+this.$Vars[d]);this.parameters=a==b?this.parameters+";":this.parameters+
", ";a++}null!=this.dLink&&this.dLink.setWgtValue(void 0,void 0,c.QUALITY_GOOD)};a.prototype.getCompiledExpression=function(){return this.compiledExpression};a.prototype.getValue=function(){return{compiledExpression:this.compiledExpression}};a.prototype.addDataLink=function(c){b.prototype.addDataLink.call(this,c);this.initDataLinkSideEffects(c,c.attr)};a.prototype.initDataLinkSideEffects=function(c,a){0==a.indexOf("$")&&(null==this.map$AttrLink[a]&&this.num$AttrLink++,this.map$AttrLink[a]=c,void 0!==
this.$Vars[a]&&this.updateExpressionParams())};a.prototype.removeDataLink=function(c){0==c.attr.indexOf("$")&&(delete this.map$AttrLink[c.attr],this.num$AttrLink--);b.prototype.removeDataLink.call(this,c)};a.prototype.unsubscribeDataLink=function(c){this.removeDataLink(c)};a.prototype.execute=function(c,a,b,d){c=a;if(null!=d){d="(function(){"+this.parameters+"return "+d.compiledExpression+"; })();";try{c=eval(d)}catch(g){}}return c};a.prototype.writeToString=function(c,a){var b="="+this.compiledExpression+
";[",d=0;if(this.dataLinks)for(var g in this.dataLinks){var f=this.dataLinks[g].writeToString(),b=b+((0==d?"":";")+f);d++}return b+"]"};a.prototype.readFromString=function(c,a){for(var h=0,d=c.length,g=0,k=0;g<d;){var n=c[g];if("'"==n||'"'==n){for(var m=n,n=g+1,l=!1;n<d;){if(c[n]==m&&"\\"!=c[n-1]){l=!0;g=n;break}n++}if(!l)return null}else if(";"==n&&"\\"!=c[g-1])this.compiledExpression=c.substr(0,g),k++;else if("["==n&&(0<g?"\\"!=c[g-1]:1)){do{n=g+1;k="";for(m=0;n<d;){l=c[n];if(";"==l&&"\\"!=c[n-
1]){g=n;break}else if("["==l&&"\\"!=c[n-1])m++;else if("]"==l&&"\\"!=c[n-1])if(0<m)m--;else{g=n+1;break}k+=l;n++}0!=k.length&&(n=f.createDataLink(this,null,null),n.readFromString(k),n.mount(),n.update(),b.prototype.addDataLink.call(this,n),h++)}while(g<d);break}g++}};return a}(za);f.fn.hmiFormulaXForm=function(b,a,c,e){return new lc(this,b,a,c,e)};f.addWidgetDefinition("hmiFormulaXForm",lc);var dd=function(b){function a(c,a,h,d,g){return b.call(this,c?c.wgtId:null,a,h,d,g)||this}p(a,b);a.prototype.setValue=
function(c,a){this[c.toLowerCase()]=a;isNaN(this.bitIndex)||b.prototype.updateDataLink.call(this)};a.prototype.getValue=function(){return{bitIndex:this.bitIndex}};a.prototype.execute=function(c,a,b,d){var g=a;0!=a%1&&(a=Math.round(a));if(null!=d){d=parseInt(d.bitIndex);g=1<<d;if("w"==b)return b=c.getTagValue(),c=u.getModule("Tag").getNumberOfBits(c.getTagType())-1,0>a||1<a||d>c?b:1==a?b|g:b&~g;g=(a&g)>>d}return g};a.prototype.writeToString=function(c,a){return""+this.bitIndex};a.prototype.readFromString=
function(c){c&&b.prototype.addOptions.call(this,{bitIndex:parseInt(c)})};a.prototype.getParametersFromString=function(c){return{strXForm:parseInt(c)}};return a}(za);f.fn.hmiBitIndexXForm=function(b,a,c,e){return new dd(this,b,a,c,e)};f.addWidgetDefinition("hmiBitIndexXForm",dd);var ed=function(b){function a(c,a,h,d,g){return b.call(this,c?c.wgtId:null,a,h,d,g)||this}p(a,b);a.prototype.setValue=function(c,a){this[c.toLowerCase()]=a;isNaN(this.byteIndex)||b.prototype.updateDataLink.call(this)};a.prototype.getValue=
function(){return{byteIndex:this.byteIndex}};a.prototype.execute=function(c,a,b,d){var g=a,f=!1;0!=a%1&&(a=Math.round(a));if(null!=d){d=8*parseInt(d.byteIndex);var n;32<=d?f=!0:n=255<<d;g=0;g=c.getTagValue();if("w"==b){if(f)return g;g=(g&~n)+(a<<d)}else if(f){if(64<=d)return 0;if(56<=d&&0>g)return-1;n=this._leftShift(255,d);g=this._rightShift(this._and(a,n),d)}else g=(a&n)>>>d}return g};a.prototype._leftShift=function(c,a){return c*Math.pow(2,a)};a.prototype._rightShift=function(c,a){return c/Math.pow(2,
a)};a.prototype._and=function(c,a){for(var b=0,d=0,g=0;64>g;){var f=c&1073741823&a;c=Math.floor(c/1073741824);a=Math.floor(a/1073741824);for(var n=b++;n--;)f*=1073741824;d+=f;g+=30}return d};a.prototype._not=function(c){0>c&&(c>>>=0);for(var a=0,b=0;0!=c;){var d=~(1073741823&c);c=Math.floor(c/1073741824);for(var g=a++;g--;)d*=1073741824;b+=d}return b};a.prototype.writeToString=function(c,a){return""+this.byteIndex};a.prototype.readFromString=function(c){c&&b.prototype.addOptions.call(this,{byteIndex:parseInt(c)})};
a.prototype.getParametersFromString=function(c){return{byteIndex:parseInt(c)}};return a}(za);f.fn.hmiByteIndexXForm=function(b,a,c,e){return new ed(this,b,a,c,e)};f.addWidgetDefinition("hmiByteIndexXForm",ed);var fd=function(b){function a(c,a,h,d,g){return b.call(this,c?c.wgtId:null,a,h,d,g)||this}p(a,b);a.prototype.setValue=function(c,a){this[c.toLowerCase()]=a;this.colorPalette&&this.colorMap&&this.updateDataLink()};a.prototype.getValue=function(){return{colorPalette:this.colorPalette,colorMap:this.colorMap}};
a.prototype.execute=function(c,a,b,d){c=d.colorPalette;d=d.colorMap;b=c.length;return null==a||null==c||0==c.length||1==c.length&&""==c[0]?null:null!=d?c[this.getPaletteIndexFromColorMap(a,d)%b]:c[this.getPaletteIndexFromPalette(a)%b]};a.prototype.isValueInInterval=function(c,a){return a>=c.min&&a<=c.max?!0:!1};a.prototype.getIntervalMinMax=function(c){return{min:parseFloat(c.split("-")[0]),max:parseFloat(c.split("-")[1])}};a.prototype.isSingleValueValid=function(c,a){if(isNaN(parseFloat(c))&&a==
c)return!0;var b=parseFloat(c);return 1E-5>=Math.abs(a-b)?!0:!1};a.prototype.getPaletteIndexFromPalette=function(c){return"string"==typeof c?isNaN(parseFloat(c))?0:parseFloat(c):c};a.prototype.getPaletteIndexFromColorMap=function(c,a){for(var b=null,d=0;d<a.length;d++)for(var g=a[d].v.split(","),f=0;f<g.length;f++){var n=g[f].trim();if(-1!=n.indexOf("-")){n=this.getIntervalMinMax(n);if(this.isValueInInterval(n,c))return a[d].i;c>n.max&&(b=d)}else if(this.isSingleValueValid(n,c))return a[d].i}return"string"==
typeof c?isNaN(parseFloat(c))?0:parseFloat(c):null==b?c:b};a.prototype.writeToString=function(c,a){var b=[],d,g,f;for(f in this.colorMap)d=this.colorMap[f].v,g=this.colorPalette[f],b.push(d+g);return b.join()};a.prototype.readFromString=function(c){b.prototype.addOptions.call(this,this.getParametersFromString(c))};a.prototype.getParametersFromString=function(c){if(c){c=c.split(",");var a=[],b;for(b in c)a.push({i:Number(b),v:c[b][0]}),c[b]=c[b].substring(1);return{colorMap:a,colorPalette:c}}return{}};
return a}(za);f.fn.hmiColorPaletteCustomXForm=function(b,a,c,e){return new fd(this,b,a,c,e)};f.addWidgetDefinition("hmiColorPaletteCustomXForm",fd);var gd=function(b){function a(c,a,h,d,g){return b.call(this,c?c.wgtId:null,a,h,d,g)||this}p(a,b);a.prototype.setValue=function(c,a){this[c.toLowerCase()]=a;isNaN(this.inputMin)||isNaN(this.inputMax)||isNaN(this.outputMin)||isNaN(this.outputMax)||b.prototype.updateDataLink.call(this)};a.prototype.getValue=function(){return{inputMin:this.inputMin,inputMax:this.inputMax,
outputMin:this.outputMin,outputMax:this.outputMax}};a.prototype.execute=function(c,a,b,d){var g,f;"w"==b?(c=this.outputMin,d=this.outputMax,b=this.inputMin,f=this.inputMax):(c=this.inputMin,d=this.inputMax,b=this.outputMin,f=this.outputMax);0!=d-c&&(g=(f-b)/(d-c),g=g*a+(b-g*c));return g};a.prototype.writeToString=function(c,a){return""+this.inputMin+","+this.inputMax+","+this.outputMin+","+this.outputMax};a.prototype.readFromString=function(c){c&&(c=c.split(","),b.prototype.addOptions.call(this,{inputMin:Number(c[0]),
inputMax:Number(c[1]),outputMin:Number(c[2]),outputMax:Number(c[3])}))};a.prototype.getParametersFromString=function(c){return c?(c=c.split(","),{inputMin:Number(c[0]),inputMax:Number(c[1]),outputMin:Number(c[2]),outputMax:Number(c[3])}):{}};return a}(za);f.fn.hmiRangeXForm=function(b,a,c,e){return new gd(this,b,a,c,e)};f.addWidgetDefinition("hmiRangeXForm",gd);var hd=function(b){function a(c,a,h,d,g){return b.call(this,c?c.wgtId:null,a,h,d,g)||this}p(a,b);a.prototype.setValue=function(c,a){this[c.toLowerCase()]=
a;isNaN(this.scale)||isNaN(this.mod)||isNaN(this.offset)||b.prototype.updateDataLink.call(this)};a.prototype.getValue=function(){return{scale:this.scale,offset:this.offset,mod:this.mod}};a.prototype.addDataLink=function(c){b.prototype.addDataLink.call(this,c);this.initDataLinkSideEffects(c,c.attr)};a.prototype.initDataLinkSideEffects=function(c,a){};a.prototype.execute=function(c,a,b,d){c=d.scale;var g=d.mod;d=d.offset;var f=a;c=c||1;g=g||1;d=d||0;if(a instanceof Array)if(a[0]instanceof Object)for(var n=
0,m=a.length;n<m;n++)f[n].v=this.scaleValue(b,c,d,g,a[n].v);else for(n=0,m=a.length;n<m;n++)f[n]=this.scaleValue(b,c,d,g,a[n]);else f=this.scaleValue(b,c,d,g,a);return f};a.prototype.scaleValue=function(c,a,b,d,g){"w"==c?0!=a&&(g=d/a*(g-b)):0!=d&&(g=a/d*g+b);return g};a.prototype.writeToString=function(c,a){var b="";if(this.dataLinks)for(var d in this.dataLinks){var g=this.dataLinks[d];switch(g.attr){case "Scale":b+=this.scale+"["+g.getTag()+"],";break;case "Mod":b+=this.mod+"["+g.getTag()+"],";break;
case "Offset":b+=this.offset+"["+g.getTag()+"]"}}else b+=this.scale+","+this.mod+","+this.offset;return b};a.prototype.readFromString=function(c){if(c){c=c.split(",");for(var a=void 0,h=void 0,d=void 0,g=void 0,k=void 0,n=k=g=void 0,m=void 0,g=!1,l=0;l<c.length;l++){switch(l){case 0:n=c[0];break;case 2:n=c[1];break;case 1:n=c[2]}(g=-1==n.indexOf("[")?!1:!0)?(g=n.indexOf("[")+1,k=n.indexOf("]"),g=n.substring(g,k),m=parseFloat(n.split("[")[0]),k=f.createDataLink(this,null,null),k.readFromString(g),
this.addDataLink(k),k.update(),k.mount()):m=parseFloat(n);a=0==l?m:a;h=1==l?m:h;d=2==l?m:d}b.prototype.addOptions.call(this,{scale:a,offset:h,mod:d})}};a.prototype.getParametersFromString=function(c){return c?(c=c.split(","),{scale:c[0],mod:c[1],offset:c[2]}):{}};return a}(za);f.fn.hmiScaleXForm=function(b,a,c,e){return new hd(this,b,a,c,e)};f.addWidgetDefinition("hmiScaleXForm",hd);var id=function(b){function a(c,a,h,d,g){return b.call(this,c?c.wgtId:null,a,h,d,g)||this}p(a,b);a.prototype.getValue=
function(){return{format:this.format}};a.prototype.addDataLink=function(c){b.prototype.addDataLink.call(this,c);this.initDataLinkSideEffects(c,c.attr)};a.prototype.initDataLinkSideEffects=function(c,a){};a.prototype.execute=function(c,a,b,d){(c=d.format)&&'"'==c.charAt(0)&&'"'==c.charAt(d.format.length-1)&&(c=c.substring(1,d.format.length-1));var g=f.import("TextFormatUtil"),k=g.parseFormat(c);return a instanceof Array?a.map(function(c){return g.format(k,c,null,!1)}):g.format(k,a,null,!1)};a.prototype.writeToString=
function(c,a){return"format("+this.format+")"};a.prototype.readFromString=function(c){void 0!=c&&b.prototype.addOptions.call(this,{format:c})};a.prototype.getParametersFromString=function(c){return{format:c}};return a}(za);f.fn.hmiFormatXForm=function(b,a,c,e){return new id(this,b,a,c,e)};f.addWidgetDefinition("hmiformat",id);var Ea=function(b){function a(c,a,h,d,g){var k=b.call(this,c,a,h,d,g)||this;k.currSelRow=-1;k.prevSelRow=-1;k.filterColName="";k.filterSrcType="";k.finishedCloning=!1;k.isSettingModel=
!1;k.clearDOM=!1;k.sortedWidgets=[];k.updateScrollContent=!1;k.proxyTable=null;k.rowsToRender=new Map;k.rowsToRemove=new Map;c=k.wgtId+"_proxy";a=f.import("TableGroupController");h=f.import("DynamicTableGrid");k.tableController=new a;k.dynamicGridInstance=new h;k.invokablePropsList=k.invokablePropsList.concat(["model","tableModel","currentRow","precachedPages"]);k.proxyTable=new Vb(c,c,{tableGroup:k},d,d);k.loadInitDOMStructure();f.getEventMgr()&&(k.activateHandler=function(){return k.load()},k.deactivateHandler=
function(){return k.unload()},b.prototype.bindEvents.call(k,{loadWgt:k.activateHandler,unloadWgt:k.deactivateHandler}));return k}p(a,b);a.prototype.load=function(){b.prototype.executeActivationCallback.call(this)&&(this.events={mousedown:!0,touchstart:!0},this.isWgtActive=!0,this.dataSource&&this.dataSource.parentPage instanceof Za&&this.dataSource.notifyUpdate())};a.prototype.unload=function(){if(b.prototype.executeDeactivationCallback.call(this)){if(this.scrollbarInstance){var c=this.scrollbarInstance.getOffset();
this.xScroll=c.x;this.yScroll=c.y;this.scrollbarInstance.removeListener();this.prevSelRow=this.currSelRow=-1}this.removeDataSrcSubscription();this.events={mousedown:!1,touchstart:!1};this.isWgtActive=!1}};a.prototype.removeDataSrcSubscription=function(){this.dataSource&&this.dataSource.unsubscribeWgt(this.proxyTable)};a.prototype.doMouseUp=function(c,a){if(a){var b=a.target.classList.contains("scrollbar-track"),d=a.target.classList.contains("scrollbar-thumb");b||d||c.wgt.isInHeader||(b=this.tableController.getRowIndexByRowYPosition(c.y),
0>b&&b>this.tableController.getRowsNumber()&&(b=-1),this.setValue("currentRow",b,null,null))}};a.prototype.deactivateWidgetPrototypes=function(){for(var c in this.wgts)this.wgts[c].deactivateWidgetPrototypes()};a.prototype.invalidateMtxChain=function(){this.initInvMtxChain=!1;var c=this.tableController.getViewMap(),a;for(a in c){var b=c[a].getWidgets(),d;for(d in b){var g=b[d];g.initInvMtxChain=!1;g.wgts&&g.invalidateMtxChain()}}};a.prototype.loadInitDOMStructure=function(){this.fragment=document.createDocumentFragment();
var c=document.createElement("div"),a=document.createElement("div");c.id=this.wgtId+".header";c.style.position="relative";c.style.width=this.width+"px";a.id=this.wgtId+".body";a.style.position="relative";a.style.width=this.width+"px";a.style.height=this.height+"px";a.style.overflow="hidden";this.fragment.appendChild(c);this.fragment.appendChild(a);this.renderDynamicHeaderGridElement();this.renderDynamicTableGridElement()};a.prototype.deleteOutRows=function(){var c=this.elem.querySelector("#"+CSS.escape(this.wgtId+
".table-grid")),a=this.scrollbarInstance.getContentEl();this.rowsToRemove.forEach(function(b){var d=b.getWidgets(),g=b.getGraphicGridRow();if(b.isWgtsInDOM){for(var f in d){var n=a.querySelector("#"+CSS.escape(d[f].wgtId));null!=n&&a.contains(n)&&a.removeChild(n)}c.contains(g)&&c.removeChild(g);b.isWgtsInDOM=!1;b.isGridInDOM=!1}})};a.prototype.renderTableBodyGrid=function(c,a){this.dynamicGridInstance.applyRowElementStyles(this,c);a.appendChild(c.getGraphicGridRow());c.isGridInDOM=!0};a.prototype.renderTableBodyWidgets=
function(c,a){var b=c.getWidgets(),d;for(d in b){var g=b[d],f=g.getParentBounds(this),n=c.getTop()+g.getLayout().tMargin;g.setParentBounds(f.x,n,f.width,f.height,this);g.updateLanguage();a.appendChild(g.elem)}c.isWgtsInDOM=!0};a.prototype.renderTableBody=function(){var c=this,a=this.elem.querySelector("#"+CSS.escape(this.wgtId+".table-grid")),b=this.getGLColProps(),d=this.getGridColsNumber();this.clearDOM&&(this.clearTableHeaderDOM(),this.clearTableBodyDOM(),this.clearDOM=!1);a&&(a.style.left=b[0].colPos+
"px",a.style.width=b[d].colPos-b[0].colPos+"px");var g=document.createDocumentFragment(),f=document.createDocumentFragment(),b=this.scrollbarInstance.getContentEl();this.rowsToRender.forEach(function(a){c.renderTableBodyGrid(a,g);c.renderTableBodyWidgets(a,f)});a.appendChild(g);b.appendChild(f)};a.prototype.renderTableHeaderGrid=function(){var c=this.elem.querySelector("#"+CSS.escape(this.wgtId+".table-grid-header")),a=this.tableHeaderRow.getGraphicGridRow(),b=this.getGLColProps(),d=this.getGridColsNumber();
c&&(c.style.left=b[0].colPos+"px",c.style.width=b[d].colPos-b[0].colPos+"px");this.dynamicGridInstance.applyRowElementStyles(this,this.tableHeaderRow);c.appendChild(a)};a.prototype.renderTableHeaderWidgets=function(){for(var c=this.tableHeaderRow,a=this.elem.querySelector("#"+CSS.escape(this.wgtId+".header")),b=c.getWidgets(),d=document.createDocumentFragment(),g=0;g<b.length;g++){var f=b[g],n=f.getParentBounds(this),m=c.getTop(),l=c.getHeight();f.setParentBounds(n.x,m,n.width,l,this);d.appendChild(f.elem)}a.appendChild(d)};
a.prototype.renderTableHeader=function(){var c=this.elem.querySelector("#"+CSS.escape(this.wgtId+".header")),a=this.elem.querySelector("#"+CSS.escape(this.wgtId+".body"));this.clearTableHeaderDOM();if(c){var b=this.getHeaderHeight();c.style.display="block";c.style.height=b+"px";c.style.width=this.scrollContentWidth+"px";a.style.height=this.height-b+"px";this.renderTableHeaderGrid();this.renderTableHeaderWidgets()}};a.prototype.renderHeaderScroll=function(){this.scrollbarInstance&&this.hasHeader()&&
(this.elem.querySelector("#"+CSS.escape(this.wgtId+".header")).style.left=-this.scrollbarInstance.getOffset().x+"px")};a.prototype.clearTableHeaderDOM=function(){if(this.hasHeader()){var a=this.elem.querySelector("#"+CSS.escape(this.wgtId+".header")),b=this.elem.querySelector("#"+CSS.escape(this.wgtId+".table-grid-header"));null!==a&&null!==b&&(a.innerHTML="",b.innerHTML="",a.appendChild(b))}};a.prototype.clearTableBodyDOM=function(){var a=this.scrollbarInstance.getContentEl(),b=this.elem.querySelector("#"+
CSS.escape(this.wgtId+".table-grid"));null!==a&&null!==b&&(a.innerHTML="",b.innerHTML="",a.appendChild(b))};a.prototype.updateBodySize=function(){var a=this.elem.querySelector("#"+CSS.escape(this.wgtId+".body"));a&&(a.style.width=this.width+"px",a.style.height=this.height-this.getHeaderHeight()+"px")};a.prototype.updateHeaderSize=function(){var a=this.elem.querySelector("#"+CSS.escape(this.wgtId+".header"));a&&(a.style.width=this.width+"px")};a.prototype.updateScrollContentSize=function(){this.updateScrollContent&&
this.scrollbarInstance&&(this.scrollbarInstance.setContentSize({height:this.scrollContentHeight}),this.scrollbarInstance.update(),this.updateScrollContent=!1)};a.prototype.updateDOMStructure=function(){if(this.fragment){this.clearDOM&&(this.elem.innerHTML="");var a=this.fragment.querySelector("#"+CSS.escape(this.wgtId+".body"));a.style.width=this.width+"px";a.style.height=this.height+"px";this.elem.appendChild(this.fragment);this.createScrollbar(a);this.scrollbarInstance.addListener(this.scrollCallback.bind(this));
this.dynamicGridInstance.applyExternalBorderStyles(this)}this.fragment=null};a.prototype.renderDynamicHeaderGridElement=function(){var a=this.fragment.querySelector("#"+CSS.escape(this.wgtId+".header")),b=this.fragment.querySelector("#"+CSS.escape(this.wgtId+".table-grid-header"));b||(b=document.createElement("div"),b.id=this.wgtId+".table-grid-header",b.classList.add("jm-dynamic-grid-header"),a.appendChild(b))};a.prototype.renderDynamicTableGridElement=function(){var a=this.fragment.querySelector("#"+
CSS.escape(this.wgtId+".body")),b=this.fragment.querySelector("#"+CSS.escape(this.wgtId+".table-grid"));b||(b=document.createElement("div"),b.id=this.wgtId+".table-grid",b.classList.add("jm-dynamic-grid"),a.appendChild(b))};a.prototype.renderSelection=function(){this.dynamicGridInstance.changeRowBackgroundColor(this)};a.prototype.render=function(){b.prototype.render.call(this);if(this.tableRenderMask&a._renderFlagsTableGroup.UPHEADERSIZE){if(this.isSettingModel)return;this.updateHeaderSize()}if(this.tableRenderMask&
a._renderFlagsTableGroup.UPBODYSIZE){if(this.isSettingModel)return;this.updateBodySize()}if(this.tableRenderMask&a._renderFlagsTableGroup.UPSCROLLCONTENTSIZE){if(this.isSettingModel)return;this.updateScrollContentSize()}if(this.tableRenderMask&a._renderFlagsTableGroup.RENDERVIEW){if(this.isSettingModel)return;this.updateDOMStructure();this.deleteOutRows();this.renderTableBody();this.resetRowMaps()}this.tableRenderMask&a._renderFlagsTableGroup.RENDERSELECTION&&this.renderSelection();this.tableRenderMask&
a._renderFlagsTableGroup.RENDERHEADER&&this.renderTableHeader();this.tableRenderMask&a._renderFlagsTableGroup.RENDERSCROLLHEADER&&this.renderHeaderScroll();this.tableRenderMask=0};a.prototype.renderView=function(){this.tableRenderMask|=a._renderFlagsTableGroup.RENDERVIEW;this.tableRenderMask|=a._renderFlagsTableGroup.UPSCROLLCONTENTSIZE;f.addToRender(this)};a.prototype.renderHeader=function(){this.tableRenderMask|=a._renderFlagsTableGroup.RENDERHEADER;f.addToRender(this)};a.prototype.scrollHeader=
function(){this.tableRenderMask|=a._renderFlagsTableGroup.RENDERSCROLLHEADER;$hmi.addToRender(this)};a.prototype.setTableBorder=function(a){this.elem.style.border=a};a.prototype.setScrollContentSize=function(a,b){a&&(this.scrollContentWidth=a);b&&(this.scrollContentHeight=b)};a.prototype.setRowTopBottomBounds=function(a){var b=a.getWidgets(),h;for(h in b){var d=b[h],g=a.getIndex(),f=this.tableController.getTableGeometryMap(),n=a.getTStroke(),m=a.getBStroke(),l=a.isHeader?0:f.getRowTop(g),g=a.isHeader?
this.getHeaderHeight():f.getRowHeight(g),f=l,p=g,l=l+n,g=g-n-m;a.setTop(l);a.setGeometryTop(f);a.setHeight(g);a.setGeometryHeight(p);d.top=l;d.height=g}};a.prototype.addTableHeaderRow=function(a){this.tableHeaderRow=a;this.setRowTopBottomBounds(a);this.renderHeader()};a.prototype.addTableRow=function(a){this.rowsToRender.set(a.getIndex(),a);this.rowsToRemove.delete(a.getIndex());this.setRowTopBottomBounds(a)};a.prototype.removeTableRow=function(a){this.rowsToRemove.set(a.getIndex(),a);this.rowsToRender.delete(a.getIndex())};
a.prototype.resetRowMaps=function(){this.rowsToRender.clear();this.rowsToRemove.clear()};a.prototype.deactivateDelegates=function(){f.evtMgr.trigger(this.elem,"unloadWgt")};a.prototype.activateDelegates=function(){f.evtMgr.trigger(this.elem,"loadWgt")};a.prototype.getDynamicGrid=function(){return this.dynamicGridInstance};a.prototype.getPrecachedPages=function(){return this.precachedPages};a.prototype.getSortedProtoWidgets=function(){return this.sortedWidgets};a.prototype.getSelRowIndex=function(){return this.currSelRow};
a.prototype.getPrevSelRowIndex=function(){return this.prevSelRow};a.prototype.getRowAtIndex=function(a){return this.tableController.getRowAtIndex(a)};a.prototype.getModelTotalHeight=function(){return this.tableController.getTotalHeight()};a.prototype.getHeaderHeight=function(){return this.tableController.getHeaderHeight()};a.prototype.getRowPrototypeHeight=function(a){return this.tableController.getRowPrototypeHeight(this,a)};a.prototype.getHeader=function(){return this.tableController.getHeader()};
a.prototype.hasHeader=function(){return this.tableController.hasHeader()};a.prototype.getXScrollPosition=function(){return this.scrollbarInstance?this.scrollbarInstance.getOffset().x:0};a.prototype.getYScrollPosition=function(){return this.scrollbarInstance?this.scrollbarInstance.getOffset().y:0};a.prototype.getWidgetsOfRow=function(a){var b=[],h;for(h in this.wgts){var d=this.wgts[h],g=this.getGridSize(),g=d.getGridPosition(g),f=g.cOcc;g.rOcc==a&&b.splice(f-1,0,d)}return b};a.prototype.findNestedWgt=
function(a,b){if(a.wgtId==b)return a;if(null!=a.wgts)for(var h in a.wgts){var d=this.findNestedWgt(a.wgts[h],b);if(null!=d)return d}return null};a.prototype.getWidget=function(a,e,h){h=b.prototype.getWidget.call(this,a,e,h);if(null!==h)return h;var d=this.tableController.getViewMap(),g=this.tableController.getHeader(),f;for(f in d){e=d[f].getWidgets();for(var n in e)if(h=this.findNestedWgt(e[n],a),null!=h)return h}if(null!=g){e=g.getWidgets();for(var m in e)if(f=e[m],f=this.findNestedWgt(e[m],a),
null!=f)return f}return null};a.prototype.updateLanguage=function(){this.dataSource&&this.dataSource.updateLanguage()};a.prototype.getText=function(a,b){return this.tableController.getText(a,b)};a.prototype.hasModel=function(){return null!=this.tableController.getModel()?!0:!1};a.prototype.setParentBounds=function(c,e,h,d,g){b.prototype.setParentBounds.call(this,c,e,h,d,g);this.updateScrollContent=!0;this.tableRenderMask|=a._renderFlagsTableGroup.UPHEADERSIZE;this.tableRenderMask|=a._renderFlagsTableGroup.UPBODYSIZE;
this.tableRenderMask|=a._renderFlagsTableGroup.UPSCROLLCONTENTSIZE;$hmi.addToRender(this)};a.prototype.updateGeometry=function(){this.initGridLayout();this.gridLayoutInstance.applyAlgorithm(this);this.update()};a.prototype.executeGridLayout=function(){this.updateGeometry()};a.prototype.setXScroll=function(a){this.xScroll=a};a.prototype.setYScroll=function(a){this.yScroll=a};a.prototype.fetchMore=function(){this.finishedCloning&&this.dataSource&&"TableTrendSrcWgt"===this.dataSource.getJMType()&&this.dataSource.fetchMore()};
a.prototype.scrollTo=function(a,b){this.tableController.scrollTo(this,a,b)};a.prototype.scrollTable=function(a){var b=this.tableController.getStartIndex(),b=this.tableController.getTableGeometryMap().getRowTop(b+a);null===b&&(b=0<a?this.getModelTotalHeight():0);this.scrollbarInstance.scrollTo(this.xScroll,b)};a.prototype.resetScrollbarPosition=function(){this.scrollbarInstance&&(this.setXScroll(0),this.setYScroll(0),this.setValue("relHorScrollPos",0,null,null),this.setValue("relVerScrollPos",0,null,
null),this.scrollbarInstance.scrollTo(0,0))};a.prototype.pushModelFragment=function(){this.isSettingModel=this.updateScrollContent=!0;this.redefineTableGeometry();this.finishedCloning=this.isSettingModel=!1};a.prototype.setModel=function(){this.isSettingModel=!0;this.updateGeometry();this.finishedCloning=this.isSettingModel=!1};a.prototype.redefineTableGeometry=function(){this.tableController.defineNewGeometry(this);this.scrollTo(this.yScroll,!0)};a.prototype.updateTableHeader=function(a){this.tableController.destroyHeaderDelegates();
this.tableController.setNewHeader(a);this.tableController.installTableHeader(this)};a.prototype.update=function(){this.updateScrollContent=this.clearDOM=!0;this.resetRowMaps();this.tableHeaderRow=null;this.tableController.update(this);this.scrollTo(this.yScroll,!0)};a.prototype.addWidget=function(a,e){b.prototype.addWidget.call(this,a,e);this.disabled&&e.setValue("disabled",1,null,null);var h=e.getLayout(),d=h.rOcc-1,h=h.cOcc-1;null==this.sortedWidgets[d]&&(this.sortedWidgets[d]=[]);this.sortedWidgets[d].splice(h,
0,e)};a.prototype.scrollCallback=function(){if(!this.isSettingModel){if(0<this.activeElements.length)for(var a in this.activeElements)this.activeElements[a].remove();this.scrollbarInstance&&(a=this.scrollbarInstance.getLimit(),this.setXScroll(this.scrollbarInstance.getScrollLeft()),this.setYScroll(this.scrollbarInstance.getScrollTop()),this.setValue("relHorScrollPos",this.xScroll/a.x,null,null),this.setValue("relVerScrollPos",this.yScroll/a.y,null,null),this.scrollHeader(),this.fetchMore(),this.scrollTo(this.yScroll))}};
a.prototype.subscribeProxyToDataSrc=function(a){a.dataSrc.subscribeWgt(this.proxyTable,null)};a.prototype.addDataLink=function(a){b.prototype.addDataLink.call(this,a);switch(a.attr){case "tableModel":this.subscribeProxyToDataSrc(a);this.dataSource=a.dataSrc;break;case "filter":this.filterColName=a.tag;this.filterSrcType=a.srcType;break;case "rowsBg":this.rowsBgTag=a.tag}};a.prototype.getOffsetTop=function(){return this.hasHeader()?this.getHeaderHeight():0};a.prototype.getOffsetLeft=function(){return 0};
a.prototype.getProject=function(){return f.getActiveProject()};a.prototype.getDataSource=function(){return this.dataSource};a.prototype.getProxyTable=function(){return this.proxyTable};a.prototype.getModel=function(){return this.proxyTable.getModel()};a.prototype.getProxyModel=function(){return this.proxyTable.getProxyModel()};a.prototype.hasRowAtIndex=function(a){return 0<=a&&a<this.getGridRowsNumber()};a.prototype.setValue=function(c,e,h,d){var g=!1;switch(c){case "model":case "tableModel":if(void 0!==
e&&e instanceof Array){if(0===e.length)return;this.proxyTable.setInputModel(e);this.sendUpdate(c,e,h)}break;case "currentRow":this.currSelRow!==e&&(this.prevSelRow=this.currSelRow,this.currSelRow=e,this.tableRenderMask|=a._renderFlagsTableGroup.RENDERSELECTION,this.sendUpdate(c,this.currSelRow,h),g=!0);break;case "precachedPages":e!==this.precachedPages&&(0>e?e=0:4<e&&(e=4),this.precachedPages=e,this.sendUpdate(c,this.precachedPages,h));break;default:b.prototype.setValue.call(this,c,e,h,d)}g&&f.addToRender(this)};
a.prototype.getValue=function(a){switch(a){case "model":case "tableModel":return this.proxyTable.getModel();case "currentRow":return this.currSelRow;case "precachedPages":return this.precachedPages;default:return b.prototype.getValue.call(this,a)}};a.prototype.appendToScrollContent=function(a){this.scrollbarInstance&&this.scrollbarInstance.getContentEl().appendChild(a)};a.prototype.destroy=function(){b.prototype.destroy.call(this);this.tableController.destroyHeaderDelegates();this.tableController.destroyBodyDelegates();
this.tableController=null;return!0};a._renderFlagsTableGroup={RENDERVIEW:1,RENDERSELECTION:2,RENDERHEADER:4,RENDERSCROLLHEADER:8,UPHEADERSIZE:16,UPBODYSIZE:32,UPSCROLLCONTENTSIZE:64};a.jmType="TableGroupWgt";return a}(Na);f.fn.hmiTableGroupWgt=function(b,a,c,e){return new Ea(this,b,a,c,e)};f.addWidgetDefinition("hmiTableGroupWgt",Ea);var Cb=function(b){function a(a,e,h,d,g){var k=b.call(this,a.wgtId,e,h,d,g)||this;k.unsubscribeDynamicTags=function(){var a=this;this.dynamicTagMgr.unsubscribeTags(function(c){return!a.isTagSubscribeInActiveGroup(c)})};
k.dataLinks={};k.activeCgiGroups={};a=f.import("DynamicTagSubscriber.ts");k.dynamicTagMgr=new a;k.core=$hmi;k.status=0;k.sbsQueue=[];k.initPromiseReady();if(!f.enablePjctWidgetServerReq)return k;k.parentWidget.waitWgtReady().then(function(){k.srv=k.parentWidget.getCommunticationObj();k.dynamicTagMgr.setServerInterface(k.srv);k.srv.getConf().then(function(a){k.readConfiguration(a)}).catch(function(){f.getAction("hmiActionShowMessage").execute(null,{msg:"Error loading groups configuration file. Reloading..."},
3);setTimeout(function(){this.project.getCommunticationObj().loadIndex()},2E3)})});return k}p(a,b);a.prototype.readConfiguration=function(a){var b=this;this.groupsInfo=a["groups.json"];this.status=1;this.srv.getConf("tags.json").then(function(a){b.tagsInfo=a["tags.json"];b.status=2;b.resolveWgtReady(!0);if(!f.isTestModeActive()){b.srv.subscribeNotification("tags",function(a){b.onDataReady(a)});a=0;for(var c=b.sbsQueue.length;a<c;a++)b.cerateSubscription(b.sbsQueue[a].sbsWgtId,b.sbsQueue[a].pageObj);
b.sbsQueue=[];b.sendNotification("tagmgrready")}}).catch(function(){f.getAction("hmiActionShowMessage").execute(null,{msg:"Error loading tags configuration file. Reloading..."},3);setTimeout(function(){this.project.getCommunticationObj().loadIndex()},2E3)})};a.prototype.getGroupInfo=function(a){return this.groupsInfo[a]};a.prototype.getTagInfo=function(a){return this.tagsInfo?this.tagsInfo[a]:null};a.prototype.isReady=function(){return 2==this.status};a.prototype.subscribeForTagsNotification=function(a){this.srv.subscribeTags(a)};
a.prototype.unsubscribeForTagsNotification=function(a){this.srv.unsubscribeTags(a)};a.prototype.subscribeGroup=function(a,b,h){void 0===h&&(h=!0);2==this.status?this.cerateSubscription(a,b,h):this.sbsQueue.push({sbsWgtId:a,pageObj:b})};a.prototype.cerateSubscription=function(a,b,h){if(this.groupsInfo[a]){var d=new Hb({wgtId:a},a,{groupName:a,pollRate:this.pollRate,tagMgr:this,tags:this.groupsInfo[a].tgs},b,b),g=this.activeCgiGroups[a];b=b.wgtId;if(null==g)this.activeCgiGroups[a]={group:d,status:h,
pages:[b],groupId:a};else{null!=g.group&&d.setCallbackId(g.group.getCallbackId());g.group=d;var f=g.pages;-1==f.indexOf(b)&&f.push(b);g.status=!0}h&&(a=this.srv.subscribeGroups([a],null),d.setCallbackId(a))}};a.prototype.onDataReady=function(a){for(var b,h=[],d=0,g=a.length;d<g;d++)b=a[d],this.core.updateTagsCache(b.n,b)&&h.push(b);a=h;this.sendNotification("indexedtagsetready",a);d=0;for(h=a.length;d<h;d++){b=f.cache.getTag(a[d].n);var g=b.getValue(),k=this.dataLinks[b.name];if(k)for(var n=0,m=k.length;n<
m;n++)if(b.isQualityGood()){var l=0;0!=k[n].tagIndex?l=k[n].tagIndex:k[n].tgtWgt.index&&(l=k[n].tgtWgt.index);if(Array.isArray(g))if("Index"==k[n].attr)k[n].setWgtValue(g,l,b.getQuality(),null,b.ts);else if(-1==l)k[n].setWgtValue(g,l,b.getQuality());else if(void 0==g[l]){var p=u.getModule("Quality");k[n].setWgtValue(g[l],l,new p(0),null,b.ts)}else k[n].setWgtValue(g[l],l,b.getQuality(),null,b.ts);else k[n].setWgtValue(g,-1,b.getQuality(),null,b.ts)}else k[n].setWgtValue(null,-1,b.getQuality(),null,
b.ts)}};a.prototype.isTagSubscribeInActiveGroup=function(a){for(var b in this.activeCgiGroups){var h=this.activeCgiGroups[b],d=h.group;if(h.status&&null!==d&&d.containsTag(a))return!0}return!1};a.prototype.isTagSubscribed=function(a){return this.isTagSubscribeInActiveGroup(a)||this.dynamicTagMgr.isTagSubscribed(a)};a.prototype.addDataLink=function(a){var b=this,h=a.tag;if(!this.isTagSubscribeInActiveGroup(h)){var d=this.project.getPageMgr();d.isPrecaching()?d.waitPrecacheEnd().then(function(){b.dynamicTagMgr.addTag(h)}):
this.dynamicTagMgr.addTag(h)}this.dataLinks[h]?(d=this.dataLinks[h],a.hasStructuredTag()&&d[d.length-1]===a||d.push(a)):(this.dataLinks[h]=[],this.dataLinks[h].push(a))};a.prototype.removeDataLink=function(a){var b=this.dataLinks[a.tag],h=null;if(null!=b){for(var d=0,g=b.length;d<g;d++)if(b[d].getId()==a.getId()){h=d;break}null!=h&&(b.splice(h,1),0==b.length&&delete this.dataLinks[a.tag])}this.dynamicTagMgr.removeTag(a.tag)};a.prototype.subscribeDataLink=function(a){this.addDataLink(a)};a.prototype.unsubscribeDataLink=
function(a){this.removeDataLink(a)};a.prototype.updateDataLink=function(a){var b=u.getModule("Tag"),h=f.cache.getTag(a.tag),d=a.tagIndex;void 0==d&&(d=-1);h?this.sendUpdate(a.tag,h.getValue(d),h.getQuality(),d):this.sendUpdate(a.tag,"",b.QUALITY_GOOD,d)};a.prototype.subscribeDynamicTags=function(){var a=this;this.dynamicTagMgr.subscribeTags();var b=this.project.getPageMgr();b.isPrecaching()&&b.waitPrecacheEnd().then(function(){a.dynamicTagMgr.subscribeTags()})};a.prototype.subscribePageGroups=function(a){for(var b in this.activeCgiGroups){var h=
this.activeCgiGroups[b];if(h&&-1!=h.pages.indexOf(a)&&0==h.status){var d=f.getFocusPage();h.group=new Hb({wgtId:h.groupId},h.groupId,{groupName:h.groupId,pollRate:this.pollRate,tagMgr:this,tags:this.groupsInfo[h.groupId].tgs},d,d);d=this.srv.subscribeGroups([h.groupId],null);h.group.setCallbackId(d);h.status=!0}}};a.prototype.unsubscribePageGroups=function(a){for(var b in this.activeCgiGroups)if(-1!=this.activeCgiGroups[b].pages.indexOf(a)){var h=this.activeCgiGroups[b].group.getCallbackId();this.srv.unsubscribeGroups([h]);
this.activeCgiGroups[b].status=!1;this.activeCgiGroups[b].group=null}};a.prototype.setValue=function(a,b,h,d){var g=f.cache.getTag(a),k=null,n;d?(k=new B,d=void 0,g&&(d=g.clone()),k=this.setTagValue(a,b,h,k,!1,d)):g&&this.dataLinks[a]&&(d=g.getQuality(),n=void 0,g.value instanceof Array&&0<=h?(g=f.cache.getTag(a).clone(!1),h<g.value.length&&(g.value[h]=parseFloat(b),n=g.value)):n=b,n=new (u.getModule("Tag"))(a,h,n,"S_OK"),n.setQuality(d),f.cache.updateTag(a,n)&&this.sendUpdate(a,b,d,h));return null===
k?n?(a=new B(n.getQuality(),n.getValue(),n.getValueType(),"S_OK",n.ts),Promise.resolve(a)):Promise.resolve(null):k};a.prototype.setTagValue=function(a,b,h,d,g,f){var n=this,m=u.getModule("Tag");if(this.tagsInfo[a]){var l=m.getTypeRange(this.tagsInfo[a].t);null!=l&&(b<l.min?b=l.max-Math.abs(l.min-b):b>l.max&&(b=l.min+Math.abs(b-(l.max+1))));this.tagsInfo[a].t==w.TIME&&("string"==typeof b&&(b=parseInt(b)),b=(new Date(1E3*b)).toISOString())}return g?this.srv.writeTag(new m(a,h),b,d,!0):this.srv.writeTag(new m(a,
h),b,d,!1).then(function(a){return n.processWriteTagResponse(a,f)})};a.prototype.processWriteTagResponse=function(a,b){if(null!=a&&null!=a.tgs[0]){var h=a.tgs[0],d=x.getCode(h.code),g=void 0;if(!h.code||0<d){if(!h.code||x.getCode(h.readCode)==x.status.S_OK)return g={n:h.name,v:{q:h.quality,v:h.value,ts:h.ts,idx:h.idx}},this.onDataReady([g]),d=f.cache.getTag(h.name),new B(d.getQuality(),d.getValue(),d.getValueType(),h.code,d.ts)}else switch(d){case x.status.E_WRITE_FORBIDDEN:if(b)return g={n:b.name,
v:{q:b.quality.getValue(),v:b.value,ts:b.ts,idx:b.index}},this.onDataReady([g]),d=f.cache.getTag(h.name),new B(d.getQuality(),d.getValue(),d.getValueType(),h.code,d.ts)}}return null};a.prototype.sendUpdate=function(a,b,h,d){var g=this.dataLinks[a],f=new (u.getModule("Quality"))(0);if(g)for(var n=0,m=g.length;n<m;n++){var l=0;-1!=g[n].tagIndex?l=g[n].tagIndex:g[n].tgtWgt.index&&(l=g[n].tgtWgt.index);if(g[n].tag==a)if(g[n].dataSrc.getValue(g[n].tag)instanceof Array){if(-1==d||-1==l||d==l){var p=g[n].dataSrc.getValue(g[n].tag).length;
0>l||l>p-1?g[n].setWgtValue(b,l,f):g[n].setWgtValue(b,l,h)}}else g[n].setWgtValue(b,l,h)}};a.prototype.getTagValue=function(a,b){var h=this,d=u.getModule("Tag");if("undefined"!=typeof f.getTagFromCache(a)){var g=f.getTagFromCache(a),d=g.getValue();d.constructor==Array&&-1!=b&&(g=new B,g.setValue(d[b]));return $.Deferred().resolve(g)}return this.srv.readTag(new d(a,b)).then(function(d){return d?d:h.getTagValue(a,b)})};a.prototype.getValue=function(a,b){var h=u.getModule("Tag"),d=this,g=f.cache.getTag(a);
return g?(void 0==b&&(b=-1),g.getValue(b)):this.srv.readTag(new h(a,0)).then(function(b){return b&&b.getMessageStatus().getValue()!=x.status.E_TIMEOUT?b.getValue():d.getValue(a)})};a.prototype.stepTag=function(a,b,h,d,g){return this.srv.stepTags([{name:a,arrayIndex:b,params:{s:h,no:g?1:0,l:d}}])};a.prototype.toggleTag=function(a,b,h){return this.srv.toggleBitTags([{name:a,arrayIndex:b,params:{i:h}}])};a.prototype.setBitTag=function(a,b,h){return this.srv.setBitTags([{name:a,arrayIndex:b,params:{i:h}}])};
a.prototype.resetBitTag=function(a,b,h){return this.srv.resetBitTags([{name:a,arrayIndex:b,params:{i:h}}])};a.jmType="TagMgrWgt";return a}(l);f.fn.hmiTagMgr=function(b,a,c,e){return new Cb(this,b,a,c,e)};f.addWidgetDefinition("hmiTagMgr",Cb);var Jc=function(){function b(){this.style=document.getElementById("jm-dyn-style");null===this.style&&(this.style=document.createElement("style"),this.style.setAttribute("id","jm-dyn-style"),document.head.appendChild(this.style));this.sheet=this.style.sheet}b.prototype.selector=
function(a,c){this.sheet.insertRule(a+" { "+c+" }",this.sheet.cssRules.length);return a};b.prototype.removeStyleRule=function(a){for(var c=this.sheet.cssRules,b=0,h=c.length;b<h;b++){var d=c[b];if(1==d.type&&d.selectorText==a)return this.sheet.deleteRule(b),!0}return!1};b.prototype.removeKeyframesRule=function(a){for(var c=this.sheet.cssRules,b=0,h=c.length;b<h;b++){var d=c[b];if(7==d.type&&d.name==a)return this.sheet.deleteRule(b),!0}return!1};return b}(),Ib;(function(b){b[b.TOP=0]="TOP";b[b.MIDDLE=
1]="MIDDLE";b[b.BOTTOM=2]="BOTTOM"})(Ib||(Ib={}));var Jb;(function(b){b[b.LEFT=0]="LEFT";b[b.CENTER=1]="CENTER";b[b.RIGHT=2]="RIGHT"})(Jb||(Jb={}));var oc;(function(b){b[b.NOWRAP=0]="NOWRAP";b[b.NORMAL=1]="NORMAL"})(oc||(oc={}));var ga;(function(b){b[b.NONE=0]="NONE";b[b.SLOW=1]="SLOW";b[b.NORMAL=2]="NORMAL";b[b.FAST=3]="FAST"})(ga||(ga={}));var jd=function(b){function a(c,e,h,d,g){c=b.call(this,c,e,h,d,g)||this;c.setDefaultState();c.textCnt=c.elem.getElementsByClassName("jm-text")[0];c.color=c.textCnt.style.color;
c.ml=!0;if(c.hasDynamicVariables()||c.scrollMode!=ga.NONE)c.addActivationHandler(),c.scrollMode!=ga.NONE&&(c._renderMask|=a._renderFlags.SCROLL,f.addToRender(c));return c}p(a,b);a.prototype.addActivationHandler=function(){var c=this;f.getEventMgr()&&(this.activateHandler=function(){b.prototype.executeActivationCallback.call(c)&&(c.isLiveTagsEnabled()&&c.hasDynamicVariables()&&(c.loadDynamicTagsForText(0),c.project.getTagMgr().subscribeDynamicTags()),c.scrollMode!=ga.NONE&&(c._renderMask|=a._renderFlags.SCROLL,
f.addToRender(c)),c.isWgtActive=!0)},this.deactivateHandler=function(){b.prototype.executeDeactivationCallback.call(c)&&(c.isLiveTagsEnabled()&&c.hasDynamicVariables()&&c.unloadDynamicDataLinks(),c.scrollMode!=ga.NONE&&c.disableScroll&&(c.currentScrollSpeed=0,c.disableScroll(),c.writeText(c.text)),c.isWgtActive=!1)},b.prototype.bindEvents.call(this,{loadWgt:this.activateHandler}),b.prototype.bindEvents.call(this,{unloadWgt:this.deactivateHandler}))};a.prototype.setDefaultState=function(){this.text=
void 0!==this.text?this.text:null;this.color=void 0!==this.color?this.color:null;this.fontFamily=void 0!==this.fontFamily?this.fontFamily:null;this.masked=void 0!==this.masked?this.masked:null;this.currentScrollSpeed=void 0!==this.currentScrollSpeed?this.currentScrollSpeed:0;this.scrollMode=void 0!==this.scrollMode?this.scrollMode:0;this.disableScroll=void 0!==this.disableScroll?this.disableScroll:null;this.invokablePropsList=["fill","fontColor"];this._renderMask=0};a.prototype.render=function(){b.prototype.render.call(this);
if(this._renderMask&a._renderFlags.VALUE){var c=null===this.text?"":this.text;this.masked?this.writeMaskedText(c):this.writeText(c)}this._renderMask&a._renderFlags.FNCOLOR&&(this.textCnt.style.color=this.color);this._renderMask&a._renderFlags.FNFAMILY&&(this.textCnt.style.fontFamily="'"+this.fontFamily+"'");this._renderMask&a._renderFlags.SCROLL&&this.renderScrolling();this._renderMask=0};a.prototype.renderScrolling=function(){var c=0;if(0!=this.scrollMode){switch(this.scrollMode){case ga.SLOW:c=
a.SPEED.SLOW;break;case ga.NORMAL:c=a.SPEED.NORMAL;break;case ga.FAST:c=a.SPEED.FAST}0!=this.currentScrollSpeed&&null!=this.disableScroll&&this.disableScroll();this.enableScrolling(this.elem,this.textCnt,c)}else null!=this.disableScroll&&this.disableScroll();this.currentScrollSpeed=c};a.prototype.writeText=function(a){if(-1==a.indexOf("&#xa;"))this.textCnt&&(this.textCnt.innerHTML="<p>"+a+"</p>");else{a=a.split("&#xa;");for(var b="",h=0,d=a.length;h<d;h++)b+="<p>"+a[h]+"</p>";this.textCnt.innerHTML=
b}};a.prototype.writeMaskedText=function(a){a=a.toString().length;for(var b="",h=0;h<a;h++)b+=this.maskChar;this.writeText(b)};a.prototype.setValue=function(c,e,h,d){var g=!1;switch(c){case "value":case "text":if(this.isBadValue(e,!0,h))return!1;this.text!=e&&(this.isLiveTagsEnabled()&&this.textCanContainsVariables(e)?this.parseNewTextVariables([e]):(this.isLiveTagsEnabled()&&this.dynamicVariablesArePresent()&&this.unloadAllVariables(),g=this.prepareToRender(e)),this.sendUpdate(c,this.text,h));break;
case "fill":case "fontColor":this.color!=e&&(d="#000",this.isBadValue(e,!0,h)||(/^rgb\(\s*\d+,\s*\d+\s*,\s*\d+\s*\)$/.test(e)?d=e:"string"==typeof e&&0==e.indexOf("#")&&1<e.length&&8>=e.length&&(d=e)),this.color!=d&&(this.color=d,this._renderMask|=a._renderFlags.FNCOLOR,0!=this.scrollMode&&(this._renderMask|=a._renderFlags.SCROLL),g=!0,this.sendUpdate(c,d,h)));break;case "font-family":this.isBadValue(e,!1,h)||this.fontFamily==e||(this.fontFamily=e,this._renderMask|=a._renderFlags.FNFAMILY,0!=this.scrollMode&&
(this._renderMask|=a._renderFlags.SCROLL),g=!0,this.sendUpdate(c,e,h));break;case "masked":this.masked!=e&&void 0!=e&&(this.masked=e,this._renderMask|=a._renderFlags.VALUE,0!=this.scrollMode&&(this._renderMask|=a._renderFlags.SCROLL),g=!0,this.sendUpdate(c,this.masked,h));break;case "scrollMode":if(this.scrollMode!=e&&void 0!=e){switch(e){case ga.NORMAL:case ga.FAST:case ga.SLOW:this.scrollMode=e;break;default:this.scrollMode=ga.NONE}this._renderMask|=a._renderFlags.SCROLL;g=!0;this.sendUpdate(c,
this.scrollMode,h);this.activateHandler||this.addActivationHandler()}break;default:this.isLiveTagsEnabled()&&0==c.indexOf("${")&&this.variablesAreInitialized()?(e=void 0===e?null:e,this.isVariableATagInCache(c)&&this.isBadValue(e,!0,h),this.updateVariable(c,e)&&(this.updateVariableInTexts(c,0),g=this.prepareToRender(this.getValueOfDynamicText(0)),this.sendUpdate("text",this.text,h,d))):b.prototype.setValue.call(this,c,e,h,d)}g&&f.addToRender(this);return!0};a.prototype.getValue=function(a){return"value"==
a?this.text:"fill"==a||"fontColor"==a?this.color?this.color:this.elem.style.color:l.prototype.getValue.call(this,a)};a.prototype.renderText=function(){this._renderMask|=a._renderFlags.VALUE;f.addToRender(this)};a.prototype.prepareTextToRender=function(a){return a&&a[0]?this.prepareToRender(a[0]):!1};a.prototype.prepareToRender=function(c){if(void 0===c)return!1;c=null!=c?c.toString():"";return this.text===c?!1:this.text!=c?(this.text=c,this._renderMask|=a._renderFlags.VALUE,0!=this.scrollMode&&(this._renderMask|=
a._renderFlags.SCROLL),!0):!1};a.prototype.getText=function(a){var b=this.getPageMLTextMgr();return this.isClone&&this.hasDataSourceProp("text")?this.tableGroupWgt.getText(this,a):b.getText(a,this,"jm-text")};a.prototype.getMLIds=function(){return this.isClone&&this.hasDataSourceProp("text")?this.clMLIds:this.mlIds};a.prototype.updateLanguage=function(a){if(!this.hasTextPropInDatalinks&&!this.hasValuePropInDatalinks){var b=this.getPageMLTextMgr(),h=this.getMLIds(),h=this.getText(h[0]),d=b.getCurrentFont(),
g,b=b.getCurrentLanguage();this.mlMap&&(g=this.mlMap[b]);void 0!=g&&(d=g);d!=this.fontFamily&&this.setValue("font-family",d,null,null);if(null!=h&&this.text!=h&&this.lang!=b||a)this.lang=b,this.setValue("text",h,null,null)}};a.prototype.addDataLink=function(a){b.prototype.addDataLink.call(this,a);this.initDataLinkSideEffects(a,a.attr)};a.prototype.initDataLinkSideEffects=function(a,b){"value"!=b&&"text"!=b||this.hasPropInDatalinks("Text")};a.prototype.destroy=function(){this.textCnt=null;this.unloadAllVariables();
b.prototype.unbindEvents.call(this,{loadWgt:this.activateHandler});b.prototype.unbindEvents.call(this,{unloadWgt:this.deactivateHandler});return b.prototype.destroy.call(this)};a.prototype.getVerticalAlignment=function(){var a=this.textCnt.className;return-1!=a.indexOf("jm-align-top")?Ib.TOP:-1!=a.indexOf("jm-align-middle")?Ib.MIDDLE:-1!=a.indexOf("jm-align-bottom")?Ib.BOTTOM:0};a.prototype.getHorizantalAlignment=function(){var a=this.textCnt.className;return-1!=a.indexOf("jm-align-left")?Jb.LEFT:
-1!=a.indexOf("jm-align-center")?Jb.CENTER:-1!=a.indexOf("jm-align-right")?Jb.RIGHT:0};a.prototype.enableSingleLineScrolling=function(a,b,h){var d=new Jc,g=this.wgtId,f=b.getElementsByTagName("p")[0],n=parseFloat(a.style.width.split("px")[0]);a=f.scrollWidth;if(n>=a)return function(){};f.textContent=this.text+this.text;b=Math.round(b.textContent.length*h);var m="jm-scroll-kf-"+g;d.selector("@keyframes "+m,"0% {\n\t\t\t\t-moz-transform: translateX(0px);\n\t\t\t\t/* Firefox bug fix */\n\t\t\t\t-webkit-transform: translateX(0px);\n\t\t\t\t/* Firefox bug fix */\n\t\t\t\ttransform: translateX(0px);\n\t\t\t}\n\t\t\t100% {\n\t\t\t\t-moz-transform: translateX(-"+
a+"px);\n\t\t\t\t/* Firefox bug fix */\n\t\t\t\t-webkit-transform: translateX(-"+a+"px);\n\t\t\t\t/* Firefox bug fix */\n\t\t\t\ttransform: translateX(-"+a+"px);\n\t\t\t}");var l="jm-scroll-"+g;d.selector("."+l,"\n\t\t\twhite-space: nowrap;\n\t\t\t-moz-transform: translateX(0px);\n\t\t\t-webkit-transform: translateX(0px);\n\t\t\ttransform: translateX(0px);\n\t\t\t-moz-animation: "+m+" "+b+"s linear infinite;\n\t\t\t-webkit-animation: "+m+" "+b+"s linear infinite;\n\t\t\tanimation: "+m+" "+b+"s linear infinite;\n\t\t\t");
(g=f.getAttribute("class"))?f.setAttribute("class",g+" "+l):f.setAttribute("class"," "+l);return function(){d.removeKeyframesRule(m);d.removeStyleRule("."+l);f.setAttribute("class",f.getAttribute("class").replace(" "+l,""))}};a.prototype.isMultiLineText=function(a){a=a.getElementsByTagName("p");return 1<a.length||this.wrap==oc.NORMAL&&(this.elem.style["white-space"]="no-wrap",a=a[0].scrollWidth,this.elem.style["white-space"]="normal",this.width>=a)?!0:!1};a.prototype.enableScrolling=function(a,b,
h){this.isMultiLineText(b)?this.enableMultiLinesScrolling(a,b,h):this.disableScroll=this.enableSingleLineScrolling(a,b,h)};a.prototype.scrollMLTexts=function(a,b,h,d,g){var f=this;if(g){var n=h.getElementsByTagName("p"),m=n.length;if(1==m)g=n[0],g.textContent=g.textContent.substring(1)+g.textContent.charAt(0);else{a.appendChild(h);0==n.length&&(n=a.firstChild.getElementsByTagName("p"));g=n[0];if(0!=g.textContent.length)n=n[n.length-1],m=g.textContent.charAt(0),g.textContent=g.textContent.substring(1),
n.textContent+=m;else{for(g=0;g<m-1;g++)n[g].textContent=n[g+1].textContent;n[m-1].textContent=""}b.appendChild(h)}this.animationTime=Date.now()}var l;this.scrollMode!=ga.NONE&&(l=requestAnimationFrame(function(){Date.now()-f.animationTime>=d?f.scrollMLTexts(a,b,h,d,!0):f.scrollMLTexts(a,b,h,d,!1)}));this.disableScroll=function(){cancelAnimationFrame(l)}};a.prototype.enableMultiLinesScrolling=function(c,b,h){var d=document.createDocumentFragment();switch(h){case a.SPEED.SLOW:h=1E3*h+200;break;case a.SPEED.NORMAL:h=
1E3*h+100;break;case a.SPEED.FAST:h=1E3*h+25}this.scrollMLTexts(d,c,b,h,!0)};a._renderFlags={VALUE:2,FNCOLOR:4,FNFAMILY:8,SCROLL:16};a.jmType="LabelWgt";a.SPEED={NORMAL:.1,SLOW:.2,FAST:.025};return a}(nc);f.fn.hmiLabel=function(b,a,c,e){return new jd(this,b,a,c,e)};f.addWidgetDefinition("hmiLabel",jd);var kd=function(b){function a(a,e,h,d,g){var k=b.call(this,a,e,h,d,g)||this;if(!$hmi.enablePjctWidgetServerReq)return k;k.initPromiseReady();$hmi.isTestModeActive()||k.parentWidget.waitWgtReady().then(function(){k._srv=
f.getActiveProject().getCommunticationObj();k._srv.getConf().then(function(a){a=a["trends.json"];k._commonTSTitle=a.commonTSTitle;k._conf=a.trends;k._mlTexts=a.mlTexts;k.resolveWgtReady(!0)}).catch(function(){f.getAction("hmiActionShowMessage").execute(null,{msg:"Error loading trends configuration. Reloading..."},3);setTimeout(function(){location.href=window.location.protocol+"//"+location.host+"/index.html"},2E3)})});return k}p(a,b);a.prototype.escapeString=function(a){return a.replace(/(\\\[)/g,
"\\\\[").replace(/(\\\])/g,"\\\\]")};a.prototype.moveTrendWindow=function(a,b,h){a=this.getWidgetSubscribed(a);"page"===h?a.moveTrendWindow(b,{x:a.xPageSize,y:a.y1-a.y0}):a.moveTrendWindow(b,{x:a.xPageSize/10,y:(a.y1-a.y0)/10})};a.prototype.showTrendCursor=function(a,b){var h=this.getWidgetSubscribed(a);if(h){var d=h.getGridWgt();d&&(d.setCursorVisibility(b),h.isScatter()&&(b||h.resetXYCursorValues(),h.refreshCurves()))}};a.prototype.scrollTrendCursor=function(a,b,h,d){if(a=this.getWidgetSubscribed(a)){var g=
a.getGridWgt();g&&(g.scrollTrendCursor(b,h,d),a.isScatter()&&a.refreshCurves())}};a.prototype.scrollTrendToTime=function(a,b,h){this.getWidgetSubscribed(a).scrollTrendToTime(b,h)};a.prototype.refreshTrend=function(a){a=this.getWidgetSubscribed(a);for(var b in a.getAllSubscriptions()){var h=a.getWidgetSubscribed(b);(h instanceof F||h instanceof S)&&h.refreshTrend()}};a.prototype.zoomTrendWindow=function(a,b,h){a=this.getWidgetSubscribed(a);h?a.zoomX(b):a.zoomY(b)};a.prototype.resetZoom=function(a,
b){this.getWidgetSubscribed(a).resetZoom(b)};a.prototype.changePageDuration=function(a,b){this.getWidgetSubscribed(a).changePageDuration(b)};a.prototype.pauseTrend=function(a){this.getWidgetSubscribed(a).stopTrendTimer()};a.prototype.resumeTrend=function(a){this.getWidgetSubscribed(a).resumeTrendTimer()};a.prototype.getCommunticationObj=function(){return this._srv};a.prototype.getSubscribedWgtId=function(a){var b=this.getAllSubscriptions();if(b)for(var h in b){var d=b[h].getWidget();if(d.studioId==
a&&d.parentPage.wgtId===f.getFocusPage().wgtId)return h}return null};a.prototype.restoreTrendDefault=function(a){(a=this.getWidgetSubscribed(a))&&a.restoreDefault()};a.prototype.setTrendView=function(a,b,h,d,g){(a=this.getWidgetSubscribed(a))&&a.setView(b,h,d,g)};a.prototype.getTrendConfiguration=function(a){return this._conf[a]};a.prototype.getMLTexts=function(){return this._mlTexts};a.prototype.getTitleValue=function(a,b){var h=f.getActiveProject().getMultiLanguageMgr(),d=this.getSubTrendMLIds(a,
b),g=null;if(void 0===d)return this.escapeString(b);var d=d[0],k;for(k in this._mlTexts[d]){var l=h.getLangCodeFromLangId(k);null===g&&(g={_c:"ml",mltext:{}});g.mltext[l]=""===this._mlTexts[d][k]?this.escapeString(b):this._mlTexts[d][k]}return g};a.prototype.getSubTrendMLIds=function(a,b){if(void 0!==this._conf[a].subtrends[b]&&this._conf[a].subtrends[b].mlData)return this._conf[a].subtrends[b].mlData.mlIds};a.prototype.getSubTrendMLVariables=function(a,b){if(void 0!==this._conf[b].subtrends[a]&&
this._conf[b].subtrends[a].mlData)return this._conf[b].subtrends[a].mlData.lD};a.prototype.getSubTrendConfiguration=function(a,b){return this._conf&&this._conf[a]&&this._conf[a].subtrends?this._conf[a].subtrends[b]:{}};a.prototype.getSubTrends=function(a){return this._conf&&this._conf[a]?this._conf[a].subtrends:{}};a.prototype.getSubTrendDataFormat=function(a,b){var h=this._conf[a].subtrends[b],d={};h.numberFormat&&(d.numberFormat=h.numberFormat);h.ldValue&&(d.ldValue=Number(h.ldValue));h.ddValue&&
(d.ddValue=Number(h.ddValue));h.ldTag&&(d.ldTag=h.ldTag);h.ddTag&&(d.ddTag=h.ddTag);h.customValue&&(d.customValue=h.customValue);h.customTag&&(d.customTag=h.customTag);return d};a.prototype.getCommonTSTitleConf=function(){return this._commonTSTitle};a.prototype.getConfiguration=function(){return this._conf};a.prototype.hasTrendConfiguration=function(a){return void 0!==this._conf[a]};a.prototype.hasHighResolutionSampling=function(a){return this._conf[a].hr};a.prototype.getSamplingTime=function(a){return this._conf[a].st};
a.jmType="TrendMgrWgt";return a}(l);f.fn.hmiTrendMgr=function(b,a,c,e){return new kd(this,b,a,c,e)};f.addWidgetDefinition("hmiTrendMgr",kd);var ca=function(b){function a(a,e,h,d,g){a=b.call(this,a.wgtId,e,h,d,g)||this;a.setDefaultState();e=a.elem.getElementsByTagName("span");a.border=a.stroke+"px solid "+a.strokeColor;a.fontSize=parseFloat(e[0].style.fontSize)||parseFloat(a.elem.style.fontSize);a.fontColor=e[0].style.color;a.kpdType=h.keypad;a.parseFormat();a.triggerRenderField();f.getEventMgr()&&
(a.activateHandler=a.getActivateHandler(),b.prototype.bindEvents.call(a,{loadWgt:a.activateHandler}));return a}p(a,b);a.prototype.setDefaultState=function(){this.rw=void 0!==this.rw?this.rw:this instanceof pc?"r":"rw";this.format=void 0!==this.format?this.format:"#";this.decimalDigits=void 0!==this.decimalDigits?parseInt(this.decimalDigits):null;this.leadingDigits=void 0!==this.leadingDigits?parseInt(this.leadingDigits):null;this.value=void 0!==this.value?this.value:null;this.min=void 0!==this.min?
this.min:null;this.max=void 0!==this.max?this.max:null;this.frame=void 0!==this.frame?this.frame:0;this.stroke=void 0!==this.stroke?this.stroke:1;this.strokeColor=void 0!==this.strokeColor?this.strokeColor:"#000";this.backgroundColor=void 0!==this.backgroundColor?this.backgroundColor:null;this.maskChar=void 0!==this.maskChar?this.maskChar:"*";this.keypad=void 0!==this.keypad?this.keypad:0;this.invokablePropsList=["value","min","max","fill","fontColor"];this._keypadMask=this._renderMask=0};a.prototype.getActivateHandler=
function(){var a=this;return function(){a.events={mousedown:!0,touchstart:!0};if(a.formatOptions.formatType==R.NUMBER){var b=a.project.getValue("fieldsStyle"),h=!1;a.formatStyle.decimalSymbol!=b.decimalSymbol&&(a.formatStyle.decimalSymbol=b.decimalSymbol,h=!0);a.formatStyle.thousandSymbol!=b.thousandSymbol&&(a.formatStyle.thousandSymbol=b.thousandSymbol,h=!0);a.formatStyle.digitsGrouping!=b.digitsGrouping&&(a.formatStyle.digitsGrouping=b.digitsGrouping,h=!0);h&&a.triggerRenderField()}}};a.prototype.addDataLink=
function(a){b.prototype.addDataLink.call(this,a);this.initDataLinkSideEffects(a,a.attr)};a.prototype.initDataLinkSideEffects=function(a,b){"value"==b&&(this.rw=a.rw,"w"!=this.rw&&"rw"!=this.rw&&(this.events={}))};a.prototype.doMouseUp=function(c,b){if(f.isTestModeActive()||this.getAuthorizations()!=this.umgr.getWidgetAuthorizationCodes().RDONLY)if("w"===this.rw||"rw"===this.rw)this._renderMask|=a._renderFlags.KEYPAD,1==this.keypad?(this._keypadMask|=a._renderKeypad.KEYPAD_NUM,f.addToRender(this)):
2==this.keypad&&(this._keypadMask|=a._renderKeypad.KEYPAD_TXT,f.addToRender(this))};a.prototype.destroy=function(){b.prototype.unbindEvents.call(this,{loadWgt:this.activateHandler});return b.prototype.destroy.call(this)};a.prototype.escapeRegExpChar=function(a){return-1!="\\^$*+?.".split("").indexOf(a)?"\\"+a:a};a.prototype._getCurrentKeyValue=function(a){a=this.elem.getElementsByTagName("span");var b="";if(0==a.length)return"";b=a[0].textContent;this.formatOptions.formatType==R.NUMBER&&(this.showThousandSeparator&&
this.formatStyle.thousandSymbol&&(b=b.replace(new RegExp(this.escapeRegExpChar(this.formatStyle.thousandSymbol),"g"),"")),"."!=this.formatStyle.decimalSymbol&&(b=b.replace(this.formatStyle.decimalSymbol,".")));return b};a.prototype.getInputFormatPattern=function(){var a=this.formatOptions;if(a.formatType==R.NUMBER)switch(a.numericFormat){case M.HEXL:case M.HEXU:return"hex";case M.EXP:case M.EXPD:return"exp"}return""};a.prototype.showKeyPad=function(c,b){if(this.disabled)return!1;var h=(new Mc(document,
Modernizr.inputtypes)).createKeyboard(this,b,this.getInputFormatPattern(),this._getCurrentKeyValue(c[0]),"");h.show();this._renderMask|=a._renderFlags.FOCUS;var d=this;h.onSave(function(a,c,b){var e=c,f=!0;"number"==a&&(e=parseFloat(c),e<d.min||e>d.max)&&(f=!1);f&&(e=d._formatInputValue(a,e,b),d.setValue("value",e,null,0,-1),d.doWriteValue("value",d.value));h.hide()});h.onCancel(function(){h.hide()});h.onKeyUp(function(a){13===a.keyCode?$("#jm-save").click():27===a.keyCode&&$("#jm-discard").click()});
return!0};a.prototype.keypadWriteValue=function(){this.doWriteValue("value",this.value)};a.prototype.getVerticalAlignment=function(){var a=this.elem.childNodes[1].getAttribute("class");return-1!=a.indexOf("jm-align-top")?"top":-1!=a.indexOf("jm-align-middle")?"middle":-1!=a.indexOf("jm-align-bottom")?"bottom":""};a.prototype._formatInputValue=function(a,b,h){a=this.formatOptions;a.formatType==R.NUMBER&&(a.numericFormat==M.HEXL||a.numericFormat==M.HEXU?b=/^([0-9a-f])+$/ig.test(b)?parseInt("0x"+b):
this.value:null!==this.min&&null!==this.max&&(a.numericFormat!=M.EXP&&a.numericFormat!=M.EXPD||"."==this.formatStyle.decimalSymbol||(b=b.replace(this.formatStyle.decimalSymbol,".")),b=parseFloat(b),b=b<this.min||b>this.max?this.value:b));return b};a.prototype.maskedValue=function(a){var b="";a=this.formatOptions.formatType==R.TEXT?a.length:this.formatText(a).toString().length;for(var h=0;h<a;h++)b+=this.maskChar;return b};a.prototype.writeText=function(a){null==a&&(a="");void 0!==this.elem.childNodes[1]&&
(this.elem.childNodes[1].textContent=a)};a.prototype.render=function(){b.prototype.render.call(this);f.browserOptimizations.forceLayers&&(this.$elem.hasClass("jm-hacklayer")||this.$elem.addClass("jm-hacklayer"));if(this._renderMask&a._renderFlags.VALUE)if(this.formatOptions.formatType==R.TEXT){var c=null===this.value?"":this.value;this.masked?this.writeText(this.maskedValue(c)):this.writeText(c)}else this.formatOptions.formatType==R.NUMBER&&(c=null===this.value?"":this.formatText(this.value),this.masked?
this.writeText(this.maskedValue(c)):this.writeText(c));this._renderMask&a._renderFlags.FRAME&&(this.frame?(this.elem.style.border=this.border,this.elem.style["background-color"]=this.backgroundColor):(this.elem.style.border="",this.elem.style["background-color"]=""));this._renderMask&a._renderFlags.FILL&&(this.elem.querySelector(".jm-text").style.color=this.fontColor);this._renderMask&a._renderFlags.FNSIZE&&(this.elem.querySelector(".jm-text").style.fontSize=this.fontSize+"px");this._renderMask&a._renderFlags.FRCOLOR&&
this.updateBorder();this._renderMask&a._renderFlags.FRSIZE&&this.updateBorder();this._renderMask&a._renderFlags.FRFILL&&(this.elem.style.backgroundColor=this.backgroundColor);if(this._renderMask&a._renderFlags.KEYPAD){switch(this._keypadMask){case a._renderKeypad.KEYPAD_TXT:this.showKeyPad(this.$elem,"text");break;case a._renderKeypad.KEYPAD_NUM:this.showKeyPad(this.$elem,"number")}this._keypadMask=0}this._renderMask&a._renderFlags.FOCUS&&(c=document.getElementById("jm-nField"))&&(c.focus(),c.select());
if(this._renderMask&a._renderFlags.ALIGN)switch(c=this.elem.childNodes[1],this.align){case "center":c.classList.remove("jm-align-right");c.classList.add("jm-align-"+this.align);break;case "right":c.classList.remove("jm-align-center");c.classList.add("jm-align-"+this.align);break;case "left":c.classList.remove("jm-align-right","jm-align-center")}if(this._renderMask&a._renderFlags.VALIGN)switch(c=this.elem.childNodes[1],this.valign){case "middle":c.classList.remove("jm-align-top","jm-align-bottom");
c.classList.add("jm-align-"+this.valign);break;case "top":c.classList.remove("jm-align-middle","jm-align-bottom");c.classList.add("jm-align-"+this.valign);break;case "bottom":c.classList.remove("jm-align-top","jm-align-middle"),c.classList.add("jm-align-"+this.valign)}this._renderMask=0};a.prototype.updateBorder=function(){this.border=this.stroke+"px solid "+this.strokeColor;this.$elem.css("border",this.border)};a.prototype.setFormatValue=function(c,b){if(this.isBadValue(c,!1,b))return!1;this.value!==
c&&(this.value=c,"boolean"==typeof c&&(this.value=1==c?1:0),this._renderMask|=a._renderFlags.VALUE,f.addToRender(this));return!0};a.prototype.validateColor=function(a){return void 0==a?!1:0==a.indexOf("#")&&1<a.length&&8>=a.length||"r"===a.charAt(0)&&"g"===a.charAt(1)&&"b"===a.charAt(2)?!0:!1};a.prototype.setValue=function(c,b,h,d,g){g=!1;var k="#000";if(null!=this.elem){if("value"==c){var n=this.value;b instanceof Array&&(b=0>d||d>b.length?"":b[d]);if(this.setFormatValue(b,h))this.value!=n&&(n=this.value,
this.value instanceof Date&&(n=this.value.getTime()/1E3),this.sendUpdate(c,n,h));else return!1}else if("usingFormat"==c)b!=this.format&&void 0!==b&&(this.format=b,this.parseFormat(),this.triggerRenderField(),this.sendUpdate(c,this.format,h));else if("decimalDigits"==c)b!=this.decimalDigits&&void 0!==b&&(b=10<b||0>b?this.decimalDigits:b,n=this.formatOptions,n.decimalPlaces=this.decimalDigits=b,this.format=f.import("TextFormatUtil").generateDynamicFormat(n),this.parseFormat(),this.triggerRenderField(),
this.sendUpdate(c,this.decimalDigits,h));else if("leadingDigits"==c)b!=this.leadingDigits&&void 0!==b&&(b=10<b||0>b?this.leadingDigits:b,n=this.formatOptions,n.leadingDigits=this.leadingDigits=b,this.format=f.import("TextFormatUtil").generateDynamicFormat(n),this.parseFormat(),this.triggerRenderField(),this.sendUpdate(c,this.leadingDigits,h));else if("frame"==c){if(this.isBadValue(b,!1,h))return!1;b=parseFloat(b);this.frame!=b&&(this.frame=b,this._renderMask|=a._renderFlags.FRAME,g=!0,this.sendUpdate(c,
this.frame,h))}else if("min"==c){if(this.isBadValue(b,!1,h))return!1;parseFloat(b)!=this.min&&(this.min=parseFloat(b),this.sendUpdate(c,this.min,h))}else if("max"==c){if(this.isBadValue(b,!1,h))return!1;parseFloat(b)!=this.max&&(this.max=parseFloat(b),this.sendUpdate(c,this.max,h))}else if("fill"==c||"fontColor"==c)isNaN(b)&&(this.isBadValue(b,!0,h)?(this.fontColor=k,g=!0):this.fontColor!=b&&(this.fontColor=this.validateColor(b)?b:k,g=!0,this.sendUpdate(c,this.fontColor,h))),g&&(this._renderMask|=
a._renderFlags.FILL);else if("font-size"==c||"fontSize"==c){if(this.isBadValue(b,!1,h))return!1;n=parseFloat(b);this.fontSize!=n&&(this.fontSize=parseFloat(b),this._renderMask|=a._renderFlags.FNSIZE,g=!0,this.sendUpdate(c,this.fontSize,h))}else if("frameColor"==c)isNaN(b)?this.isBadValue(b,!0,h)?(this.strokeColor=k,g=!0):this.strokeColor!=b&&(this.strokeColor=this.validateColor(b)?b:k,g=!0,this.sendUpdate(c,this.strokeColor,h)):(this.strokeColor=k,g=!0),g&&(this._renderMask|=a._renderFlags.FRCOLOR);
else if("frameSize"==c){if(this.isBadValue(b,!1,h))return!1;b=parseFloat(b);1>b&&(b=1);b!=this.stroke&&(this.stroke=b,this._renderMask|=a._renderFlags.FRSIZE,g=!0,this.sendUpdate(c,this.stroke,h))}else if("frameFill"==c)k="trasparent",isNaN(b)&&void 0!=b?this.isBadValue(b,!0,h)?(this.backgroundColor=k,g=!0):this.backgroundColor!=b&&(this.backgroundColor=this.validateColor(b)?b:k,g=!0,this.sendUpdate(c,this.backgroundColor,h)):(this.backgroundColor=k,g=!0),g&&(this._renderMask|=a._renderFlags.FRFILL);
else if("Index"==c)for(n in d=this.index=parseInt(b),this.dataLinks)k=this.dataLinks[n],b=k.dataSrc.getValue(k.tag),b instanceof Array&&!isNaN(d)&&k.attr!=c&&(k=u.getModule("Quality"),d>b.length-1||0>d?this.setValue("value",b[d],new k(0),0,-1):this.setValue("value",b[d],h,0,-1));else if("masked"==c)this.masked!=b&&(this.masked=b,this._renderMask|=a._renderFlags.VALUE,g=!0,this.sendUpdate(c,this.masked,h));else if("align"==c){if(this.align===b)return!1;this.align!=b&&(this.align=b,g=!0,this._renderMask|=
a._renderFlags.ALIGN,this.sendUpdate(c,b,h))}else if("valign"==c){if(this.valign===b)return!1;this.valign!=b&&(this.valign=b,g=!0,this._renderMask|=a._renderFlags.VALIGN,this.sendUpdate(c,b,h))}else"showThousandSeparator"==c?this.showThousandSeparator!=b&&(this.showThousandSeparator=b,this._renderMask|=a._renderFlags.VALUE,this.sendUpdate(c,b,h),g=!0):l.prototype.setValue.call(this,c,b,h,d);g&&f.addToRender(this)}return!0};a.prototype.getValue=function(a){return"value"==a?this.value instanceof Date?
this.value.getTime()/1E3:this.value:"format"==a?this.format:"decimalDigits"==a?this.decimalDigits:"leadingDigits"==a?this.leadingDigits:"fill"==a||"fontColor"==a?this.fontColor?this.fontColor:this.elem.style.color:b.prototype.getValue.call(this,a)};a.prototype.triggerRenderField=function(){"undefined"!=typeof this.value&&this.formatOptions.formatType!=R.TEXT&&(this._renderMask|=a._renderFlags.VALUE,f.addToRender(this))};a.prototype.updateStyle=function(a){if(a.decimalSymbol||a.thousandSymbol||a.digitsGrouping)a=
this.project?this.project.getValue("fieldsStyle"):null,this.formatStyle={decimalSymbol:a.decimalSymbol,thousandSymbol:a.thousandSymbol,digitsGrouping:a.digitsGrouping},this.triggerRenderField()};a.prototype.formatText=function(a){-1!=this.formatOptions.oldDigitsGrouping&&(this.formatStyle.digitsGrouping=this.formatOptions.oldDigitsGrouping);return f.import("TextFormatUtil").formatText(this.formatOptions,a,this.formatStyle,this.showThousandSeparator)};a.prototype.parseFormat=function(){var a=this.project?
this.project.getValue("fieldsStyle"):null;this.formatStyle={decimalSymbol:a.decimalSymbol,thousandSymbol:a.thousandSymbol,digitsGrouping:a.digitsGrouping};this.formatOptions=f.import("TextFormatUtil").parseFormat(this.format);this.decimalDigits=this.formatOptions.decimalPlaces;this.leadingDigits=this.formatOptions.leadingDigits;-1!=this.formatOptions.oldDigitsGrouping&&(this.showThousandSeparator=!0)};a._renderFlags={VALUE:2,FRAME:4,FILL:8,FNSIZE:16,FRCOLOR:32,FRSIZE:64,FRFILL:128,KEYPAD:256,FOCUS:512,
ALIGN:1024,VALIGN:2048,FORMAT:4096};a._renderKeypad={KEYPAD_NUM:8,KEYPAD_TXT:16,KEYPAD_HIDE:32};a.jmType="NumericWgt";return a}(l);f.fn.hmiNumeric=function(b,a,c,e){return new ca(this,b,a,c,e)};f.addWidgetDefinition("hmiNumeric",ca);var pc=function(b){function a(a,e,h,d,g){a=b.call(this,a,e,h,d,g)||this;a.keyboardInputFormat="YYYY-MM-DD HH:mm:ss";a.updateDOMReference();return a}p(a,b);a.prototype.getActivateHandler=function(){var a=this,e=b.prototype.getActivateHandler.call(this);return function(){e();
switch(a.format){case "LONG-DATE":a.projectConf.longDateFormat!=a.project.getValue("longDateFormat")&&a.parseFormat();break;case "SHORT-DATE":a.projectConf.shortDateFormat!=a.project.getValue("shortDateFormat")&&a.parseFormat()}}};a.prototype.doMouseUp=function(c,b){(f.isTestModeActive()||this.getAuthorizations()!=this.umgr.getWidgetAuthorizationCodes().RDONLY)&&("w"===this.rw||"rw"===this.rw)&&this.dataLinks&&0<this.countDataLinks()&&null!=this.datetimeField&&(this._renderMask|=a._renderFlags.KEYPAD,
this._keypadMask|=a._renderKeypad.KEYPAD_DATETIME,f.addToRender(this))};a.prototype.setDefaultState=function(){b.prototype.setDefaultState.call(this);this.timeSpec=void 0!==this.timeSpec?this.timeSpec:null};a.prototype.parseFormat=function(){this.projectConf={longDateFormat:this.project.getValue("longDateFormat"),shortDateFormat:this.project.getValue("shortDateFormat"),serverOffset:this.project.getSystemPropertiesMgr().getServerOffset()};this.formatOptions=f.import("TextFormatUtil").parseDateTimeFormat(this.format,
this.projectConf);this._renderMask|=ca._renderFlags.VALUE;this.core.addToRender(this)};a.prototype.updateStyle=function(a){(a.longDateFormat||a.shortDateFormat)&&this.parseFormat()};a.prototype.updateDOMReference=function(){this.datetimeField=this.elem.querySelector(".jm-hmi-datetime")};a.prototype._getCurrentKeyValue=function(a){return moment(a.textContent,this.formatOptions.format).format(this.keyboardInputFormat)};a.prototype.formatKeyboardInput=function(a,b,h){return"datetime"==a?(h=this.keyboardInputFormat.split(" "),
a=h[0],h=h[1],b.date||(b.date=moment(this.value).format(a)),b.time||(b.time=moment(this.value).format(h)),moment(b.date+" "+b.time,this.keyboardInputFormat).toDate()):new Date};a.prototype.keypadWriteValue=function(){var a=this.value;this.formatOptions.formatType==R.DATETIME&&(a=Math.round(this.getTimeForSever()/1E3));this.doWriteValue("value",a)};a.prototype.getTimeForSever=function(){var a=this.value.getTime();switch(this.timeSpec){case "global":return a-6E4*(new Date).getTimezoneOffset();case "server":return a-=
6E4*this.project.getSystemPropertiesMgr().getServerOffset(),a-6E4*(new Date).getTimezoneOffset()}return a};a.prototype.removeChildNodes=function(a){for(a=a.childNodes;0<a.length;)a[0].parentNode.removeChild(a[0])};a.prototype.render=function(){if(this._renderMask&ca._renderFlags.VALUE&&this.formatOptions.formatType==R.DATETIME){var c=f.import("TextFormatUtil").formatDateTime(this.value,this.timeSpec,this.formatOptions,this.projectConf),e=this.elem.querySelector(".jm-hmi-datetime");null!=e&&(e.textContent=
c)}if(this._renderMask&ca._renderFlags.KEYPAD){switch(this._keypadMask){case a._renderKeypad.KEYPAD_DATETIME:this.showKeyPad(this.datetimeField,"datetime")}this._keypadMask=0}this._renderMask&ca._renderFlags.FOCUS&&((c=document.getElementById("jm-nFiledDate"))&&c.select&&(c.focus(),c.select()),(c=document.getElementById("jm-nFiledTime"))&&c.select&&(c.focus(),c.select()));b.prototype.render.call(this);this._renderMask=0};a.prototype.setDateTimeValue=function(a,b,h){if(void 0==a)return!1;if(void 0==
h||0==h||"string"==typeof h)h=-1;b=$.type(a);if("date"!=b)if("number"==b){if(a=new Date(1E3*a),"date"!=$.type(a))return!1}else"string"==b?""===a?a=new Date(0):(a=new Date(a),isNaN(a.getTime())&&(a=a.setTime(0))):a=a.toDate();this.value!==a&&(this.value=a,-1!=h&&this.project&&this.project.getSystemPropertiesMgr().setValue("System Time",Math.round(this.getTimeForSever()/1E3)),this._renderMask|=ca._renderFlags.VALUE,f.addToRender(this));return!0};a.prototype.setValue=function(a,e,h,d,g){if(null!=this.elem)if("value"==
a)d=this.value,this.setDateTimeValue(e,h,g)&&this.value!=d&&(e=this.value,this.value instanceof Date&&(e=this.value.getTime()/1E3),this.sendUpdate(a,e,h));else return b.prototype.setValue.call(this,a,e,h,d,g);return!0};a.prototype.getAttrValueTagType=function(){var a=this.getDatalink("value");return a?a.tagType:null};a.prototype.getAttrValueDataSource=function(){var a=this.getDatalink("value");return a?a.dataSrc:null};a.prototype.syncTimeWithSever=function(a,b){switch(this.timeSpec){case "global":return a-
6E4*b;case "server":a-=6E4*b;var h=this.project.getSystemPropertiesMgr();h&&(h=h.getServerOffset(),720<h&&(h-=65536),a-=6E4*h)}return a};a.prototype.showKeyPad=function(a,b){var h=this;if(this.disabled)return!1;var d=this._getCurrentKeyValue(a),g=(new Mc(document,Modernizr.inputtypes)).createKeyboard(this,b,this.formatOptions.format,d,this.keyboardInputFormat);g.show();this._renderMask|=ca._renderFlags.FOCUS;g.onSave(function(a,c,b){c=h.formatKeyboardInput(a,c,b);a=c.getTime();c=c.getTimezoneOffset();
b=h.getAttrValueTagType();var e=h.getAttrValueDataSource();null!==b&&b!==w.TIME&&"SysPropMgrWgt"!=e.getJMType()?a=h.syncTimeWithSever(a,c):h.formatOptions.formatType==R.DATETIME&&(a=h.syncTimeWithSever(a,c));h.setValue("value",new Date(a),null,0,-1);a=Math.round(a/1E3);h.doWriteValue("value",a);g.hide()});g.onCancel(function(){g.hide()});g.onKeyUp(function(a){13===a.keyCode?$("#jm-save").click():27===a.keyCode&&$("#jm-discard").click()});return!0};a._renderKeypad=Oa({},ca._renderKeypad,{KEYPAD_DATETIME:2});
return a}(ca);f.fn.hmiDateTime=function(b,a,c,e){return new pc(this,b,a,c,e)};f.addWidgetDefinition("hmiDateTime",pc);var ld=function(b){function a(a,e,h,d,g){return b.call(this,a.wgtId,e,h,d,g)||this}p(a,b);a.prototype.setDefaultOption=function(a,e){switch(a){case "variables":this.map=new Map(e);break;default:b.prototype.setDefaultOption.call(this,a,e)}};a.prototype.setValue=function(a,b,h){if(h.isQualityGood()){var d=this.map.get(a);void 0!==d&&d!=b&&(this.map.set(a,b),this.sendUpdate(a,b,h))}};
a.prototype.getValue=function(a){return this.map&&this.map.get(a)};a.prototype.destroy=function(){return this.destroyed?!1:b.prototype.destroy.call(this)};a.prototype.setParentBounds=function(a,b,h,d,g){};a.prototype.getParentBounds=function(a){return{x:0,y:0,width:0,height:0}};a.jmType="VariablesWgt";return a}(l);$hmi.fn.hmiVariablesWgt=function(b,a,c,e){return new ld(this,b,a,c,e)};$hmi.addWidgetDefinition("hmiVariablesWgt",ld);var D;(function(b){b[b.HISTORY=0]="HISTORY";b[b.REALTIME=1]="REALTIME";
b[b.SCATTER=2]="SCATTER"})(D||(D={}));var Nb=function(b){function a(a,e,h,d,g){var k=b.call(this,a.wgtId,e,h,d,g)||this;k.setDefaultState();k.ySize=k._initYZoom=k.y1-k.y0;if(k.trendType==D.SCATTER)k.endTime=k.stopTime,k._initXZoom=k.endTime-k.startTime,void 0==k.y0&&(k.y0=0);else if(k.trendType==D.REALTIME||k.trendType==D.HISTORY)k._initXZoom=k.getPDIndex(k.pageDuration);k._dStartTime=k.startTime;k._dEndTime=k.endTime;k._dY0=k.y0;k._dY1=k.y1;k._dYSize=k.ySize;k._dPageDuration=k.pageDuration;f.cache.hasWgtProps(k.elem.id)&&
k.loadCachedValues();k._initWindowView();k._isPaused=!1;k._initialized=!1;k._updateXDuration=!1;k._forceBoundsUpdate=!1;k._prevXDiff=-1;k._prevYDiff=-1;k.events={mousedown:!0,touchstart:!0};if(a=f.getEventMgr())k.activateHandler=function(){l.prototype.executeActivationCallback.call(k)&&(k.load(),k.isWgtActive=!0)},k.deactivateHandler=function(){l.prototype.executeActivationCallback.call(k)&&(k.load(),k.isWgtActive=!0)},a.on(k.parentPage.elem,"loadWgt",k.activateHandler),a.on(k.parentPage.elem,"unloadWgt",
k.deactivateHandler);return k}p(a,b);a.prototype.setDefaultState=function(){this.pageDuration=void 0===this.pageDuration?3E5:this.pageDuration;this.updateInterval=void 0===this.updateInterval?1E3:this.updateInterval;this.startTime=void 0===this.startTime?0:this.startTime;this.endTime=void 0===this.endTime?1E3:this.endTime;this.ySize=void 0===this.ySize?100:this.ySize;this.y0=void 0===this.y0?0:this.y0;this.y1=void 0===this.y1?100:this.y1;this.isPrt=void 0===this.isPrt?!1:this.isPrt;this.maxXZoom=
void 0==this.maxXZoom?20:this.maxXZoom;this.xStart=void 0===this.xStart?null:this.xStart;this.xEnd=void 0===this.xEnd?null:this.xEnd;this.yStart=void 0===this.yStart?null:this.yStart;this.yEnd=void 0===this.yEnd?null:this.yEnd;this.moveX=void 0===this.moveX?!1:this.moveX;this.moveY=void 0===this.moveY?!1:this.moveY;this.gridXTickDivider=void 0===this.gridXTickDivider?null:this.gridXTickDivider;this._renderMask=0;this._mvPoint={endX:null,endY:null};this.timer=null};a.prototype.showBackground=function(){if(this.isPrt||
this.isScatter())this.elem.style.boxSizing="border-box",this.elem.style.backgroundColor=this.fill,this.elem.style.border="1px solid "+this.stroke};a.prototype._initWindowView=function(){this.isScatter()?(this.endTime=this.stopTime,this.xPageSize=this.endTime-this.startTime):(this.endTime=(new Date).getTime(),this.startTime=this.endTime-this.pageDuration,this.xPageSize=this.pageDuration);this.bands&&!this.isScatter()&&(this.clBand=new Da(this.wgtId+"_cb",{width:this.width,height:this.height,minX:this.startTime,
maxX:this.endTime,minY:this.y0||0,maxY:this.y1||100,bands:this.bands}))};a.prototype.load=function(){var a=this.project.getTrendMgr();if(a&&(a.subscribeWgt(this,function(){}),this.getAllSubscriptions()))switch(this.trendType){case D.SCATTER:this.update();this.drawCurves();break;case D.REALTIME:case D.HISTORY:0===this.maxInSeconds&&this.startAutoUpdate()}};a.prototype.startAutoUpdate=function(){var a=this;null==this.timer&&(this.update(),this.drawCurves(),this.timer=window.setInterval(function(){a.update();
a.drawCurves()},this.updateInterval))};a.prototype.stopAutoUpdate=function(){null!==this.timer&&(clearInterval(this.timer),this.timer=null)};a.prototype.drawCurves=function(){this._renderMask|=a._renderFlags.CURVES;f.addToRender(this)};a.prototype._draw=function(){var a=0,b=this.getAllSubscriptions(),h;for(h in b){var d=b[h].getWidget();if("TrendCurveWgt"==d.getJMType()||"XYCurveWgt"==d.getJMType())0==a&&d.clearCanvas(),d.renderCurve(),a++}};a.prototype.loadCachedValues=function(){var a=f.cache.getWgtProp(this.elem.id,
"xDuration"),b=f.cache.getWgtProp(this.elem.id,"yDuration");this.isScatter()?(this.pageDuration=a,this.startTime=f.cache.getWgtProp(this.elem.id,"min"),this.stopTime=f.cache.getWgtProp(this.elem.id,"max")):(this.pageDuration=1E3*this.getPDFromIndex(a),this._zXIdx=f.cache.getWgtProp(this.elem.id,"xZoom"));this.ySize=b;this.y0=f.cache.getWgtProp(this.elem.id,"y0");this.isScatter()?this.y1=f.cache.getWgtProp(this.elem.id,"y1"):this.y1=this.y0+this.ySize};a.prototype._initGraph=function(a){null==this.gridXTickDivider&&
(this.gridXTickDivider=this.grid.getValue("gridX"));this.setValue("min",a.xStart,null);this.setValue("max",a.xEnd,null);this.setValue("y0",a.yStart,null);this.setValue("y1",a.yEnd,null);this._initialized=!0};a.prototype.getNextMinute=function(a){a=new Date(a);a.setMinutes(a.getMinutes()+1);a.setSeconds(0);return a.getTime()};a.prototype.updateXDuration=function(a,b){var h,d;this.trendType==D.SCATTER?(h=a,d=a+this.xPageSize):(h=this.xPageSize/(this.gridXTickDivider-1),d=this._tCurrent<a?this._tCurrent+
h:this.getNextMinute(b),h=d-this.xPageSize);this.setValue("min",h,null);this.setValue("max",d,null);this._updateXDuration=!1};a.prototype.updateYDuration=function(a,b){var h;h=a+this.ySize;this.setValue("y0",a,null);this.setValue("y1",h,null);this._updateYDuration=!1};a.prototype.updateDuration=function(){this._updateXDuration&&this.updateXDuration(this.startTime,this.endTime);this._updateYDuration&&this.updateYDuration(this.y0,this.y1)};a.prototype.updateWindowView=function(a,b,h,d){this.setValue("max",
b,null);this.setValue("min",a,null);this.setValue("y0",h,null);this.setValue("y1",d,null)};a.prototype.updateScatter=function(a,b){this.calculateSpaceWindow(a);this.updateDuration();this._initialized||this._initGraph(a);this.grid&&this.grid.isCursorVisible()&&this.setValue("cursor-timestamp",this.grid.getXCursor(),null);this._initialized&&(this._forceBoundsUpdate=!0,this.updateWindowView(this.startTime,this.endTime,this.y0,this.y1))};a.prototype.updateRealTime=function(a){this.enableTimeWindow(a);
this.updateDuration();this._initialized||(0===this.maxInSeconds&&6E4<this.pageDuration&&(a.xEnd=6E4*Math.floor((a.xEnd+6E4)/6E4),a.xStart=a.xEnd-this.xPageSize),this._initGraph(a));this.grid&&this.setValue("cursor-timestamp",this.grid.getXCursor(),null);if(this._initialized){var b=void 0,h=void 0;a.pEnd?(b=a.xStart,h=a.xEnd,0===this.maxInSeconds&&(h=6E4*Math.floor((h+6E4)/6E4),b=h-this.xPageSize),this._forceBoundsUpdate=!1):(0!==this.maxInSeconds?(b=a.xStart,h=a.xEnd):(b=this.startTime,h=this.endTime),
a.yStart=this.y0,a.yEnd=this.y1,this._forceBoundsUpdate=!0);this.updateWindowView(b,h,a.yStart,a.yEnd)}};a.prototype.updateHistoric=function(a){this.enableTimeWindow(a);this.updateDuration();if(this._initialized){var b=void 0,h=void 0;a.pEnd?(b=this.xPageSize/(this.gridXTickDivider-1),h=a.xEnd+b,b=a.xStart+b,this._forceBoundsUpdate=!1):(0!==this.maxInSeconds?(b=a.xStart,h=a.xEnd):(b=this.startTime,h=this.endTime),a.yStart=this.y0,a.yEnd=this.y1,this._forceBoundsUpdate=!0);this.updateWindowView(b,
h,a.yStart,a.yEnd)}else 0===this.maxInSeconds&&6E4<this.pageDuration&&(a.xEnd=6E4*Math.floor((a.xEnd+6E4)/6E4),a.xStart=a.xEnd-this.xPageSize),this._initGraph(a);this.grid&&this.setValue("cursor-timestamp",this.grid.getXCursor(),null)};a.prototype.update=function(){var a={xStart:0,xEnd:0,yStart:0,yEnd:0};switch(this.trendType){case D.REALTIME:this.updateRealTime(a);break;case D.HISTORY:this.updateHistoric(a);break;case D.SCATTER:this.updateScatter(a)}};a.prototype.calculateSpaceWindow=function(a){a.xStart=
this.startTime;a.xEnd=this.startTime+this.xPageSize;a.yStart=this.y0;a.yEnd=this.y1;return a};a.prototype.enableTimeWindow=function(a){if(0!==this.maxInSeconds){var b=1E3*this.maxInSeconds;a.xStart=b-this.xPageSize;a.xEnd=b;a.yStart=this.y0;a.yEnd=this.y0+this.ySize;a.pEnd=!1;return a}var h,d;h=(h=this.project.getSystemPropertiesMgr())?h.getTime():(new Date).getTime();var g=this.isTrendPageEnded();this._tCurrent=h;g||(0==this.startPoint&&(b=h,d=h+this.xPageSize),1==this.startPoint&&(b=h-this.xPageSize/
2,d=h+this.xPageSize/2));if(g||2==this.startPoint)b=h-this.xPageSize,d=h;a.xStart=b;a.xEnd=d;a.yStart=this.y0;a.yEnd=this.y0+this.ySize;a.pEnd=g;return a};a.prototype.isTrendPageEnded=function(){var a=!1;if(this._tCurrent){var b=Math.round(this._tCurrent/1E3),h=Math.round(this.endTime/1E3);b==h&&(a=!0)}return a};a.prototype.getGridWgt=function(){return this.grid};a.prototype.render=function(){b.prototype.render.call(this);this._renderMask&a._renderFlags.CLBANDS&&this.bands&&!this.isScatter()&&this._initialized&&
(this.clBand.setXRange(this.startTime,this.endTime),this.clBand.setYRange(this.y0,this.y1),this.clBand.drawBands());this._renderMask&a._renderFlags.BGCOLOR&&(this.elem.style.backgroundColor=this.fill);this._renderMask&a._renderFlags.STROKE&&(this.elem.style.boxSizing="border-box",this.elem.style.border="solid",this.elem.style.borderWidth="1px",this.elem.style.borderColor=this.stroke);this._renderMask&a._renderFlags.UPDATECBCANVAS&&this.clBand.updateSize(this.width,this.height);if(this._renderMask&
a._renderFlags.MOVE||this._renderMask&a._renderFlags.CURVES){var c=!1;this.moveX&&(this._updateXRange(),this.moveX=!1,c=!0);this.moveY&&(this._updateYRange(),this.moveY=!1,c=!0);c&&this.sendUpdate("maxInSeconds",Math.floor(this.endTime/1E3));this._draw()}this._renderMask=0};a.prototype.refreshCurves=function(){this._renderMask|=a._renderFlags.CURVES;f.addToRender(this)};a.prototype.setValue=function(c,e,h,d){d=!1;if(this.isBadValue(e,!1,h))return!1;switch(c){case "min":e="string"==typeof e?parseFloat(e):
e;this.startTime!=e&&(this.startTime=e,this.clBand&&(this._renderMask|=a._renderFlags.CLBANDS,d=!0),this.trendType==D.SCATTER&&(this.xPageSize=this.endTime-this.startTime,this._renderMask|=a._renderFlags.CURVES,d=!0),this.sendUpdate(c,this.startTime,h));this._forceBoundsUpdate&&this.sendUpdate(c,this.startTime,h);break;case "max":e="string"==typeof e?parseFloat(e):e;this.endTime!=e&&(this.endTime=e,this.clBand&&(this._renderMask|=a._renderFlags.CLBANDS,d=!0),this.trendType==D.SCATTER?(this.xPageSize=
this.endTime-this.startTime,this._renderMask|=a._renderFlags.CURVES,d=!0):this.sendUpdate("maxInSeconds",Math.floor(this.endTime/1E3),h),this.sendUpdate(c,this.endTime,h));this._forceBoundsUpdate&&this.sendUpdate(c,this.endTime,h);break;case "y0":e="string"==typeof e?parseFloat(e):e;this.y0!=e&&(this.y0=e,this.clBand&&(this._renderMask|=a._renderFlags.CLBANDS,d=!0),this.trendType==D.SCATTER&&(this.ySize=this.y1-this.y0,this._renderMask|=a._renderFlags.CURVES,d=!0),this.sendUpdate(c,this.y0,h));this._forceBoundsUpdate&&
this.sendUpdate(c,this.y0,h);break;case "y1":e="string"==typeof e?parseFloat(e):e;this.y1!=e&&(this.y1=e,this.clBand&&(this._renderMask|=a._renderFlags.CLBANDS,d=!0),this.trendType==D.SCATTER&&(this.ySize=this.y1-this.y0,this._renderMask|=a._renderFlags.CURVES,d=!0),this.sendUpdate(c,this.y1,h));this._forceBoundsUpdate&&this.sendUpdate(c,this.y1,h);break;case "fill":this.fill!=e&&(this.fill=e,this._renderMask|=a._renderFlags.BGCOLOR,d=!0,this.sendUpdate(c,this.fill,h));break;case "stroke":e="string"==
typeof e?parseFloat(e):e;this.stroke!=e&&(this.stroke=e,this._renderMask|=a._renderFlags.STROKE,d=!0,this.sendUpdate(c,this.stroke,h));break;case "pageDuration":e="string"==typeof e?parseFloat(e):e;if(this.pageDuration!=e){var g;this.trendType==D.REALTIME||this.trendType==D.HISTORY?1>e||e>this.maxXZoom?(e=-1,g=0):(this._zXIdx=e,g=1E3*this.getPDFromIndex(e)):this.trendType==D.SCATTER&&(g=e);this.pageDuration=this.xPageSize=g;this._updateXDuration=!0;this.clBand&&(this._renderMask|=a._renderFlags.CLBANDS,
d=!0);this.sendUpdate(c,e,h)}break;case "ySize":e="string"==typeof e?parseFloat(e):e;this.ySize!=e&&(this.ySize=e,this._updateYDuration=!0,this.sendUpdate(c,this.ySize,h));break;case "cursor-timestamp":this.cursorTimestamp!=e&&(this.cursorTimestamp=e,this.sendUpdate(c,this.trendType==D.SCATTER?this.cursorTimestamp:new Date(this.cursorTimestamp),h));break;case "maxInSeconds":this.maxInSeconds!=e&&(0!==this.maxInSeconds&&0===e?(this.maxInSeconds=e,this._initialized=!1,this.startAutoUpdate()):(this.maxInSeconds=
e,0!=this.maxInSeconds&&(this.stopAutoUpdate(),this.update(),this.drawCurves())),this.sendUpdate("maxInSeconds",e,h),this.clBand&&(this._renderMask|=a._renderFlags.CLBANDS,d=!0));default:b.prototype.setValue.call(this,c,e,h)}d&&f.addToRender(this);return!0};a.prototype.sendUpdateExceptCurveWgt=function(a,b,h){var d;if(this.dataLinks)for(var g in this.dataLinks)d=this.dataLinks[g],d.tag===a&&d.tgtWgt!==this&&"TrendCurveWgt"!=d.tgtWgt.getJMType()&&d.setWgtValue(b,void 0,h)};a.prototype.sendUpdateCurveWgt=
function(a,b){var h;if(this.dataLinks)for(var d in this.dataLinks)h=this.dataLinks[d],"min"===h.tag&&h.tgtWgt!==this&&"TrendCurveWgt"==h.tgtWgt.getJMType()&&h.tgtWgt.updateMinMax(a,b)};a.prototype._updateXRange=function(){this.sendUpdateExceptCurveWgt("min",this.startTime,null);this.sendUpdateExceptCurveWgt("max",this.endTime,null);this.sendUpdateCurveWgt(this.startTime,this.endTime)};a.prototype._updateYRange=function(){this.sendUpdate("y0",this.y0,null);this.sendUpdate("y1",this.y1,null)};a.prototype.getValue=
function(a){if("min"==a)return this.startTime;if("max"==a)return this.endTime;if("pageDuration"==a){a=this.getPDIndex(this.pageDuration);if(1>a||a>this.maxXZoom)a=-1;return a}return"cursor-timestamp"==a?this.cursorTimestamp:"maxInSeconds"==a?Math.round(this.endTime/1E3):this[a]?this[a]:l.prototype.getValue.call(this,a)};a.prototype.forceUpdate=function(){return this._forceBoundsUpdate};a.prototype.doMouseDown=function(a){this._mvPoint.endX=this.endTime;this._mvPoint.endY=this.y1};a.prototype.doMouseUp=
function(a){this._prevYDiff=this._prevXDiff=-1;this._mvPoint.endX=null;this._mvPoint.endY=null};a.prototype.doMouseMove=function(c){var b=c.deltaX,h=c.deltaY;if(this._initialized)if(c.nxtPoints)this._handlePinchEvent(c);else if(0!=b&&(b=Math.round(this._mvPoint.endX-this.xPageSize*b/this.width),c=Math.round(b-this.xPageSize),this.startTime!=c&&(this.startTime=c),this.endTime!=b&&(this.endTime=b),this.moveX=!0),0!=h&&(c=this._mvPoint.endY+this.ySize*h/this.height,h=c-this.ySize,this.y0!=h&&(this.y0=
h),this.y1!=c&&(this.y1=c),this.moveY=!0),this.moveX||this.moveY)this._renderMask|=a._renderFlags.MOVE,f.addToRender(this)};a.prototype._handlePinchEvent=function(a){var b=Math.abs(a.nxtPoints.x-a.x);a=Math.abs(a.nxtPoints.y-a.y);var h=!1,d=!1;0<this._prevXDiff&&(h=!0);0<this._prevYDiff&&(d=!0);(h||d)&&this.zoomOnPinchAction(h,d,b-this._prevXDiff,a-this._prevYDiff);this._prevXDiff=b;this._prevYDiff=a};a.prototype.zoomOnPinchAction=function(a,b,h,d){null!=a&&(h=h/(this.width/(this.endTime-this.startTime))/
2,a=this.startTime+h,h=this.endTime-h,this.setValue("min",a,null),this.setValue("max",h,null),this.xPageSize=this.endTime-this.startTime,this.ySize=this.y1-this.y0);null!=b&&(h=d/(this.height/(this.y1-this.y0))/2,b=this.y0+h,d=this.y1-h,this.setValue("y0",b,null),this.setValue("y1",d,null),this.ySize=this.y1-this.y0);this.drawCurves()};a.prototype.changePageDuration=function(a){this.isScatter()||this.setValue("pageDuration",a,null)};a.prototype.resetXYCursorValues=function(){var a=this.getAllSubscriptions(),
b;for(b in a){var h=a[b].getWidget();"XYCurveWgt"==h.getJMType()&&h.resetCursorValue()}};a.prototype.moveTrendWindow=function(a,b){switch(a){case "left":this.setValue("min",this.startTime-b.x,null);this.setValue("max",this.endTime-b.x,null);break;case "right":this.setValue("min",this.startTime+b.x,null);this.setValue("max",this.endTime+b.x,null);break;case "up":this.setValue("y0",this.y0+b.y,null);this.setValue("y1",this.y1+b.y,null);break;case "down":this.setValue("y0",this.y0-b.y,null),this.setValue("y1",
this.y1-b.y,null)}this.drawCurves()};a.prototype.scrollTrendToTime=function(a,b){var h,d;if(void 0!=b&&!this.isScatter()){b*=1E3;switch(a){case 0:h=b;d=b+this.xPageSize;break;case 1:h=b-this.xPageSize/2;d=b+this.xPageSize/2;break;case 2:h=b-this.xPageSize,d=b}this.setValue("min",h,null);this.setValue("max",d,null)}this.drawCurves()};a.prototype.zoomX=function(a){var b;if(this.trendType==D.REALTIME||this.trendType===D.HISTORY)this._zXIdx||(this._zXIdx=this._initXZoom),this._zXIdx=a?1<this._zXIdx?this._zXIdx-
1:this._zXIdx:this._zXIdx<=this.maxXZoom?this._zXIdx+1:this._zXIdx,this.setValue("pageDuration",this._zXIdx,null),this.drawCurves();this.trendType==D.SCATTER&&(this.endTime>=this.startTime&&(a?this.setValue("max",this.endTime-(this.endTime-this.startTime)/3):this.setValue("max",this.startTime+3*(this.endTime-this.startTime)/2),b=this.endTime-this.startTime),this.setValue("pageDuration",b,null),this.drawCurves())};a.prototype.zoomY=function(a){var b;this.y1>=this.y0&&(D.SCATTER?(b=this.y1-this.y0,
a?this.setValue("y1",this.y1-b/3):this.setValue("y1",this.y0+3*b/2),this.setValue("ySize",this.y1-this.y0,null),this.update(),this.drawCurves()):(b=a?this.ySize-this.ySize/3:this.ySize+this.ySize/2,this.setValue("ySize",b,null)))};a.prototype.resetZoom=function(a){if(a){if(this.trendType==D.REALTIME||this.trendType==D.HISTORY)this._zXIdx=this._initXZoom;this.setValue("pageDuration",this._initXZoom,null)}else this.setValue("ySize",this._initYZoom,null);this.update();this.drawCurves()};a.prototype.getPDIndex=
function(c){for(var b in a.xDurationMap)if(a.xDurationMap[b]==Math.round(c/1E3))return parseInt(b);return null};a.prototype.resumeTrendTimer=function(){this._tCurrent>this.endTime&&(this._initialized=!1);this._isPaused=!1;this.load()};a.prototype.stopTrendTimer=function(){this._isPaused=!0;this.stopAutoUpdate()};a.prototype.getPDFromIndex=function(c){return a.xDurationMap[c]};a.prototype.isRealtime=function(){return this.trendType==D.REALTIME};a.prototype.isScatter=function(){return this.trendType==
D.SCATTER};a.prototype.isHistorical=function(){return this.trendType==D.HISTORY};a.prototype.getTrendType=function(){return this.trendType};a.prototype.isInitialized=function(){return this._initialized};a.prototype.isOnPause=function(){return this._isPaused};a.prototype.restoreDefault=function(){if(this.trendType==D.HISTORY||this.trendType==D.REALTIME){var a=this.enableTimeWindow({xStart:0,xEnd:0,yStart:0,yEnd:0});this.setValue("min",a.xStart);this.setValue("max",a.xEnd)}else this.trendType==D.SCATTER&&
(this.setValue("min",this._dStartTime),this.setValue("max",this._dEndTime));this.setValue("y0",this._dY0);this.setValue("y1",this._dY1);this.update();this.trendType!=D.HISTORY&&this.trendType!=D.REALTIME||this.drawCurves()};a.prototype.setView=function(a,b,h,d){if(this.trendType==D.HISTORY||this.trendType==D.REALTIME)b*=1E3,a*=1E3;h===d&&0===h&&(h=this._dY0,d=this._dY1);a===b&&0===a&&(this.trendType==D.HISTORY||this.trendType==D.REALTIME?(this.pageDuration=this.xPageSize=this._dPageDuration,b=this.enableTimeWindow({xStart:0,
xEnd:0,yStart:0,yEnd:0}),a=b.xStart,b=b.xEnd):this.trendType==D.SCATTER&&(a=this._dStartTime,b=this._dEndTime));this.setValue("min",a);this.setValue("max",b);this.pageDuration=this.xPageSize=b-a;this.setValue("y0",h);this.setValue("y1",d);this.ySize=d-h;this.update();this.trendType!=D.HISTORY&&this.trendType!=D.REALTIME||this.drawCurves()};a.prototype.unload=function(){clearInterval(this.timer);this.timer=null;var a=this.elem.id;switch(this.trendType){case D.SCATTER:f.cache.setWgtProp(a,"xDuration",
this.xPageSize);f.cache.setWgtProp(a,"min",this.startTime);f.cache.setWgtProp(a,"max",this.endTime);f.cache.setWgtProp(a,"y1",this.y1);break;case D.REALTIME:case D.HISTORY:f.cache.setWgtProp(a,"xDuration",this.getPDIndex(this.pageDuration)),f.cache.setWgtProp(a,"xZoom",this._zXIdx)}f.cache.setWgtProp(a,"y0",this.y0);f.cache.setWgtProp(a,"yDuration",this.ySize);this.clBand&&this.clBand.clearCanvasContext();this.project.getTrendMgr().unsubscribeWgt(this)};a.prototype.destroy=function(){if(this.destroyed)return!1;
this.unload();b.prototype.unbindEvents.call(this,{loadWgt:this.activateHandler,unloadWgt:this.deactivateHandler});return b.prototype.destroy.call(this)};a.prototype.subscribeWgt=function(a,e){b.prototype.subscribeWgt.call(this,a,e);"GridWgt"==a.getJMType()&&(this.grid=a)};a.jmType="TrendWindowWgt";a.xDurationMap={1:60,2:300,3:600,4:1800,5:3600,6:7200,7:14400,8:28800,9:43200,10:86400,11:172800,12:432E3,13:604800,14:1209600,15:2419200,16:7776E3,17:15552E3,18:31536E3,19:63072E3,20:157766400};a._renderFlags=
{CLBANDS:2,BGCOLOR:4,STROKE:8,CURVES:16,MOVE:32,UPDATECBCANVAS:64};return a}(l);f.fn.hmiTrendWindowWgt=function(b,a,c,e){return new Nb(this,b,a,c,e)};f.addWidgetDefinition("hmiTrendWindowWgt",Nb);var md=function(b){function a(a,e,h,d,g){a=b.call(this,a,e,h,d,g)||this;a.value=f.cache.getWgtProp(a.wgtId,"value");return a}p(a,b);a.prototype.render=function(){if(this._renderMask&ca._renderFlags.VALUE){if(this.formatOptions.formatType==R.TEXT&&null!=this.value)switch(this.ebt){case 0:this.writeText(this.value);
break;case 1:this.writeText("");break;case 2:this.writeText(this.maskedValue(this.value))}this._renderMask=0<this._renderMask?this._renderMask-=ca._renderFlags.VALUE:0}b.prototype.render.call(this)};a.prototype.setValue=function(a,e,h,d){if(null!=this.elem){var g=!1;switch(a){case "editType":this.ebt!=e&&(this.ebt=e,this._renderMask|=ca._renderFlags.VALUE,g=!0,this.sendUpdate(a,this.ebt,h));break;case "value":this.value!=e&&(this.value=e,this._renderMask|=ca._renderFlags.VALUE,f.cache.setWgtProp(this.wgtId,
"value",this.value),g=!0,this.sendUpdate(a,this.value,h));break;case "Color":this.backgroundColor!=e&&(this.backgroundColor=e,this._renderMask|=ca._renderFlags.FRFILL,g=!0,this.sendUpdate(a,this.backgroundColor,h))}g&&f.addToRender(this);"font-size"!=a&&"fill"!=a&&"fontColor"!=a||b.prototype.setValue.call(this,a,e,h,d)}return!0};a.prototype.destroy=function(){return b.prototype.destroy.call(this)};a.prototype.showKeyPad=function(a,e){return this.disabled?!1:b.prototype.showKeyPad.call(this,a,"password")};
a.jmType="EditBoxWgt";return a}(ca);f.fn.hmiEditBoxWgt=function(b,a,c,e){return new md(this,b,a,c,e)};f.addWidgetDefinition("hmiEditBoxWgt",md);var Pb=function(b){function a(a,e,h,d,g){var k=b.call(this,a.wgtId,e,h,d,g)||this;k.setDefaultState();k.initPromiseReady();k._initialized=!1;k._isDefaultUser=!1;k._isChangePasswdAction=!1;k._logOffTimer={};if(!f.enablePjctWidgetServerReq)return k.parentWidget.waitWgtReady().then(function(){k.srv=f.getActiveProject().getCommunticationObj()}),k;k.infologin=
{};k.commoninfo={};k._homepages={};k.parentWidget.waitWgtReady().then(function(){k.srv=f.activeProject.getCommunticationObj();k.srv.getConf().then(function(a){a=k._deepFreeze(a["usermgmt.json"]);k._securityEnable=a.securityEnable;k._forceRemoteLogin=a.forceRemoteLogin;a.common&&(k.commoninfo.pwdd=a.common.pwdDuration);if(k._securityEnable){k._loadGroupObject();var c=k._getUserInfos(a);if(null!=c){var b=c.grobj;k._initialized=!0;k._auth=b.authUI;k._homepages=b.homepages;k._useLastVisitedPage=b.useLastVisitedPage;
a.defUsr==c.name&&a.defUsrGrp==c.grname&&(k._isDefaultUser=!0);k.currentUser.username=c.name;k.currentUser.group=c.grname;k.currentUser.idxot=c.idxot;k.currentUser.exception=c.exception;k.sendNotification("login");""!=f.urlParameters.token&&(k.currentToken=f.urlParameters.token);k._updateCurrentUser();k.saveValue("_hmiusergroup");b.timers&&k.startTimer(null!=b.timers[c.idxot]?b.timers[c.idxot]:c.idxot,function(){f.getAction("hmiActionLogOut").execute()})}else f.getAction("hmiActionLogOut").execute()}else k._initialized=
!0;k.resolveWgtReady(!0)}).catch(function(){f.getAction("hmiActionShowMessage").execute(null,{msg:"Error loading user management map. Reloading..."},3);setTimeout(function(){f.getAction("hmiActionLogOut").execute()},1E3)})});return k}p(a,b);a.prototype.setDefaultState=function(){this.templatesDir=void 0===this.templatesDir?"../umtemplates/":this.templatesDir;this.currentUser={username:"",group:"",idxot:""}};a.prototype.getValue=function(a){return"username"==a?this.currentUser.username:"group"==a?
this.currentUser.group:"ClientID"==a?parseInt(this.infologin.clientID):null};a.prototype._getUserInfos=function(a){var b;if(""!=f.urlParameters.usr){var h=!1,d;for(d in a)if("object"==typeof a[d]&&a[d].users){var g=a[d].users.indexOf(f.urlParameters.usr);if(-1!=g){b={name:f.urlParameters.usr,grname:d,grobj:a[d],idxot:g,exception:a[d].exceptions[g]};h=!0;break}}h||(b={name:f.urlParameters.usr,grname:f.urlParameters.g,grobj:a[f.urlParameters.g],idxot:f.urlParameters.ot,exception:!1})}else if(null!=
this._hmiusergroup)b={},b.name=this._hmiusergroup.lastUser,b.grname=this._hmiusergroup.lastGroup,b.grobj=a[this._hmiusergroup.lastGroup],b.idxot=this._hmiusergroup.lastOt,b.exception=this._hmiusergroup.lastException,this.infologin.clientID=this._hmiusergroup.lastClientID;else if(this.srv.isLogged())if(a.defUsr&&a.defUsrGrp)b={name:a.defUsr,grname:a.defUsrGrp,grobj:a[a.defUsrGrp],idxot:a[a.defUsrGrp].users.indexOf(a.defUsr),exception:a[a.defUsrGrp].exceptions.indexOf(a.defUsr)};else return null;else return null;
return b};a.prototype._deepFreeze=function(a){for(var b in a)"object"==typeof a[b]&&null!==a[b]&&this._deepFreeze(a[b]);return Object.freeze(a)};a.prototype._updateCurrentUser=function(){null==this._hmiusergroup?this._hmiusergroup={lastUser:this.currentUser.username,lastGroup:this.currentUser.group,lastOt:this.currentUser.idxot,lastException:this.currentUser.exception,grps:[],lastClientID:this.infologin.clientID}:(this._hmiusergroup.lastUser=this.currentUser.username,this._hmiusergroup.lastGroup=
this.currentUser.group,this._hmiusergroup.lastOt=this.currentUser.idxot,this._hmiusergroup.lastException=this.currentUser.exception,this._hmiusergroup.lastClientID=this.infologin.clientID)};a.prototype._storeGroup=function(a){for(var b=!0,h=0;h<this._hmiusergroup.grps.length;h++){var d=this._hmiusergroup.grps[h];if(d.name==a.name&&d.pjct==a.pjct){this._hmiusergroup.grps.splice(h,1,a);b=!1;break}}b&&this._hmiusergroup.grps.push(a);return this.saveValue("_hmiusergroup")};a.prototype._storeObject=function(){this._hmiusergroup=
this.loadValue("_hmiusergroup");this._updateCurrentUser();this._storeGroup({page:{id:f.getActivePage().studioId,type:f.getActivePage().constructor==Za?0:1},pjct:f.activeProject.studioId,name:this.currentUser.group})};a.prototype.loadLastPageUsed=function(){var a=f.activeProject.studioId,b=this.currentUser.group;if(null!=this._hmiusergroup)for(var h in this._hmiusergroup.grps){var d=this._hmiusergroup.grps[h];if(d.name==b&&d.pjct==a&&1==d.page.type)return d.page.id}return null};a.prototype.storeLastPageUsed=
function(){this._storeObject()};a.prototype._loadGroupObject=function(){(this._hmiusergroup=this.loadValue("_hmiusergroup"))&&void 0===this.infologin.clientID&&(this.infologin.clientID=this._hmiusergroup.lastClientID)};a.prototype.getWidgetTreeAuthorizations=function(c){var b=this._isWidgetInMap(c);return b==a.wgtAuth.DEFAULT&&c.parentWidget?this.getWidgetTreeAuthorizations(c.parentWidget):b};a.prototype.getActionTreeAuthorizations=function(c,b,h){return this._isActionInMap(c,b,h)==a.actAuth.DEFAULT&&
c.parentWidget?this.getActionTreeAuthorizations(c.parentWidget,b,h):this._isActionInMap(c,b,h)};a.prototype._isWidgetInMap=function(c){if(null!=this._auth.widgets){if(c.parentPage){var b=c.isTemplateWgt?c.parentPage.templateStudioId:c.parentPage.studioId;if(this._auth.widgets[b]&&null!=this._auth.widgets[b][c.studioId])return this._auth.widgets[b][c.studioId]}if(null!=this._auth.widgets[c.studioId]&&null!=this._auth.widgets[c.studioId][c.studioId])return this._auth.widgets[c.studioId][c.studioId];
if(null!=this._auth.widgets[c.elem.dataset.widget])return this._auth.widgets[c.elem.dataset.widget];if(c.ctype&&null!=this._auth.widgets[c.ctype])return this._auth.widgets[c.ctype]}return a.wgtAuth.DEFAULT};a.prototype._isActionInMap=function(c,b,h){if(null!=this._auth.actions){if(c.parentPage){var d=c.isTemplateWgt?c.parentPage.templateStudioId:c.parentPage.studioId;if(this._auth.actions[d]){if(null!=this._auth.actions[d][h])return this._auth.actions[d][h][c.studioId];if(null!=this._auth.actions[d][d])return this._auth.actions[d][d];
if(null!=c.module){var g=c.getGraphicModule();if(g&&(d=this._auth.actions[d][g.studioId],null!==d))return d}}}return null!=this._auth.actions[c.studioId]&&null!=this._auth.actions[c.studioId][h]?this._auth.actions[c.studioId][h][c.studioId]:null!=this._auth.actions[b]?this._auth.actions[b]:a.actAuth.DEFAULT}};a.prototype.startTimer=function(a,b){0<a&&(this._logOffTimer.callback=b,this._logOffTimer.interval=6E4*a,this._logOffTimer.timer=setTimeout(this._logOffTimer.callback,this._logOffTimer.interval))};
a.prototype.resetTimer=function(){this._logOffTimer.timer&&(clearTimeout(this._logOffTimer.timer),this._logOffTimer.timer=setTimeout(this._logOffTimer.callback,this._logOffTimer.interval))};a.prototype.loadUMForm=function(a,b){this._isChangePasswdAction=!0;(new (f.actionMgr.getActionDefinition("hmiActionLoadPage"))).execute(a,{pg:b})};a.prototype.changePwdAction=function(){var c=this.currentUser.username;if("changepassword"==f.getActivePage().studioId.toLowerCase()){var b=this.getFormFields(),h=null==
b[0].getValue("value")?"":b[0].getValue("value"),d=null==b[1].getValue("value")?"":b[1].getValue("value"),g=null==b[2].getValue("value")?"":b[2].getValue("value");if(d!=g)this.printMessage(a.changePswdServerCodeMap["#E_PASS_DONT_MATCH"]),this.clearFormFields([b[1],b[2]]);else{var k=this;this.srv.changePwd(c,h,d,!1).then(function(c){null!=a.changePswdServerCodeMap[c.code]&&("#S_OK"==c.code?f.enablePjctWidgetServerReq?f.getAction("hmiActionLogOut").execute():-1==f.urlParameters.code?f.getAction("hmiActionLogOut").execute():
k.project.getCommunticationObj().loadIndex():(k.printMessage(a.changePswdServerCodeMap[c.code]),k.clearFormFields([b[0],b[1],b[2]])))})}}};a.prototype.getFormFields=function(){var a=[];if("changepassword"==f.getActivePage().studioId.toLowerCase()){var b=null==f.getActivePage().getWidget("oldpassword_edit",!0)?f.getActivePage().getWidget("ChangePwdEditWgt1.oldpassword_edit",!0):f.getActivePage().getWidget("oldpassword_edit",!0),h=null==f.getActivePage().getWidget("newpassword_edit",!0)?f.getActivePage().getWidget("ChangePwdEditWgt1.newpassword_edit",
!0):f.getActivePage().getWidget("newpassword_edit",!0),d=null==f.getActivePage().getWidget("confirmpassword_edit",!0)?f.getActivePage().getWidget("ChangePwdEditWgt1.confirmpassword_edit",!0):f.getActivePage().getWidget("confirmpassword_edit",!0);a.push(b);a.push(h);a.push(d);a.push(f.getActivePage().getWidget("error_msg",!0))}return a};a.prototype.isUMTemplate=function(a){a instanceof Array&&(a=a[0]);var b=a.split("/");1<b.length&&(a=b[b.length-1]);return-1!=f.umTemplates.indexOf(a)?!0:!1};a.prototype.getMappedErrorCode=
function(c){switch(f.getActivePage().studioId){case "changepassword":return a.changePswdServerCodeMap[a.serverCodes[parseInt(c)]];default:return-1}};a.prototype.printMessage=function(c){if(null!=c){var b=f.getActivePage().getWidget("error_msg",!0);b.constructor==Ub?b.setValue("value",c,null,null):b.setValue("value",a.backwardCompatibilityChangePwdMsg[c],null,null)}};a.prototype.checkMessages=function(){if(null!=f.urlParameters.code&&!this._isChangePasswdAction){var a=f.getActivePage().studioId;this.isUMTemplate(a)&&
this.printMessage(this.getMappedErrorCode(f.urlParameters.code))}};a.prototype.clearFormFields=function(a){var b=u.getModule("Tag"),h;for(h in a){var d=a[h];d.constructor==Ub?d.setValue("value",-1,b.QUALITY_GOOD):d.setValue("value","",b.QUALITY_GOOD)}};a.prototype.clearAll=function(){this.clearFormFields(this.getFormFields())};a.prototype.isDataReady=function(){return this._initialized};a.prototype.getHomePage=function(a){if(null!=a&&(a=this._homepages[a])){var b=a.indexOf(".jmx");return-1==a.indexOf(".jmx")?
a:a.substring(0,b)}return null};a.prototype.useLastGroupPage=function(){return this._useLastVisitedPage};a.prototype.getAuthorizationMap=function(){return this._auth};a.prototype.isSecurityEnabled=function(){return this._securityEnable};a.prototype.isDefaultUser=function(){return this._isDefaultUser};a.prototype.isForceRemoteLoginEnabled=function(){return this._forceRemoteLogin};a.prototype.setCurrentUser=function(a){this.currentUser.username=a};a.prototype.setPwdDuration=function(a){this.infologin.exDur=
a};a.prototype.setDayRemainigs=function(a){this.infologin.exDays=a};a.prototype.setClientID=function(a){this.infologin.clientID=a};a.prototype.getWidgetAuthorizationCodes=function(){return a.wgtAuth};a.prototype.getActionAuthorizationCodes=function(){return a.actAuth};a.wgtAuth={HIDE:0,RDONLY:1,FULL:2,DEFAULT:3};a.actAuth={NOTALLOWED:0,ALLOWED:1,DEFAULT:2};a.jmType="UserGroupMgrWgt";a.serverCodes={1:"#S_OK",2:"#S_OK_PWD_WILL_EXPIRE",3:"#S_OK_NEED_PASWD_CHANGE",50:"#E_FAIL",49:"#E_USER_DONT_EXIST",
48:"#E_GROUP_DONT_EXIST",47:"#E_NO_GROUP_SPECIFIED",46:"#E_USER_ALREADY_EXIST",45:"#E_PASS_DONT_MATCH",44:"#E_UNAUTHORIZED_USER",43:"#E_NO_SESSION_EXIST",42:"#E_SESSION_EXPIRED",41:"#E_SESSION_ALREADY_EXIST",40:"#E_LOGIN_FAIL",39:"#E_RE_LOGIN_ATTEMPT",38:"#E_NEED_LOGIN",37:"#E_TOO_MANY_USERS",36:"#E_FTP_READ_FORBIDDEN",35:"#E_FTP_WRITE_FORBIDDEN",34:"#E_NOT_ALLOWED",33:"#E_INVALIDARG",32:"#E_ILLEGAL_FORMAT",31:"#E_ACCES_DENIED",30:"#E_CHANGE_PASSWORD",29:"#E_MUST_CONTAIN_SPECIAL_CHAR",28:"#E_MUST_CONTAIN_NUMBERS",
27:"#E_PASSWORD_TOO_SHORT",26:"#E_SIMILAR_PREV_PSWD",25:"#E_PASSWORD_EXPIRED",24:"#UM_E_MUST_CONTAIN_NUMBERS_AND_SP_CHAR",23:"#UM_E_MUST_CONTAIN_CASE",22:"#UM_E_MUST_CONTAIN_NUMBERS_AND_CASE",21:"#UM_E_MUST_CONTAIN_SP_CHAR_AND_CASE",20:"#UM_E_MUST_CONTAIN_NUMBERS_SPCHAR_AND_CASE"};a.changePswdServerCodeMap={"#S_OK":0,"#S_OK_PWD_WILL_EXPIRE":14,"#E_PASS_DONT_MATCH":6,"#E_NOT_ALLOWED":6,"#E_CHANGE_PASSWORD":13,"#E_MUST_CONTAIN_SPECIAL_CHAR":9,"#E_MUST_CONTAIN_NUMBERS":8,"#E_PASSWORD_TOO_SHORT":7,"#E_SIMILAR_PREV_PSWD":10,
"#E_PASSWORD_EXPIRED":13,"#UM_E_MUST_CONTAIN_NUMBERS_AND_SP_CHAR":21,"#UM_E_MUST_CONTAIN_CASE":22,"#UM_E_MUST_CONTAIN_NUMBERS_AND_CASE":23,"#UM_E_MUST_CONTAIN_SP_CHAR_AND_CASE":24,"#UM_E_MUST_CONTAIN_NUMBERS_SPCHAR_AND_CASE":25};a.backwardCompatibilityChangePwdMsg=";Error : You are not authorized. Please contact administrator;Error : Connection lost with the Runtime. Please verify the Runtime status;Error : The username or password you entered is incorrect;Error : The password entered is incorrect;Error : Action cannot be executed;Error : Passwords do not match;Error: Password length too short;Error: Password must contain numbers;Error: Password must contain special characters;Error: Password must be different than previous passwords;Error : User already exist;Error:Password cannot be empty;Error: Your password has expired;Warning: Your password will expire soon".split(";");
return a}(l);f.fn.hmiUserGroupMgr=function(b,a,c,e){return new Pb(this,b,a,c,e)};f.addWidgetDefinition("hmiUserGroupMgr",Pb);var kc=function(b){function a(a,e,h,d,g){var k=b.call(this,a.wgtId,e,h,d,g)||this;k.srv=k.project.getTrendMgr().getCommunticationObj();if(a=f.getEventMgr())k.activateHandler=function(){return k.load()},k.deactivateHandler=function(){return k.unload()},a.on(k.parentPage.elem,"loadWgt",k.activateHandler),a.on(k.parentPage.elem,"unloadWgt",k.deactivateHandler);return k}p(a,b);
a.prototype.load=function(){this.enabled=!0};a.prototype.unload=function(){this.enabled=!1};a.prototype.subscribeDataLink=function(a){var e=a.getTargetWidget();this.project.getTrendMgr().hasTrendConfiguration(e.getTrendNamePrefix())&&this.srv.subscribeTrend(e,function(b,d){a.setWgtValue(d,void 0,void 0)});b.prototype.subscribeDataLink.call(this,a)};a.prototype.unsubscribeDataLink=function(a){var e=a.getTargetWidget();this.project.getTrendMgr().hasTrendConfiguration(e.getTrendNamePrefix())&&e instanceof
Sb&&this.srv.unsubscribeTrend(e);b.prototype.unsubscribeDataLink.call(this,a)};a.prototype.destroy=function(){if(this.destroyed)return!1;var a=f.getEventMgr();a.off(this.parentPage.elem,"loadWgt",this.activateHandler);a.off(this.parentPage.elem,"unloadWgt",this.deactivateHandler);this.unload();return b.prototype.destroy.call(this)};a.prototype.updateBufferTimeDuration=function(a){this.srv.updateTrendSubscription(a)};a.jmType="IdalTrendWgt";return a}(l);f.fn.hmiIdalTrendWgt=function(b,a,c,e){return new kc(this,
b,a,c,e)};f.addWidgetDefinition("hmiIdalTrendWgt",kc);var od=function(b){function a(a,e,h,d,g){var k=b.call(this,a.wgtId,e,h,d,g)||this;k.hasTableSubscription=!1;k.hasDataSrcSubscription=!1;if(void 0===k.evType||void 0===k.subType)return k;k.setDefaultState();k.vars={alAlarmID:[],alDateTime:[],alDescription:[],alEventType:[],alName:[],alState:[],alStateCode:[],alValue:[],evTimestamp:[],evDate:[],evTime:[],min:k.min,max:k.max,eventCount:0,PageDuration:k.PageDuration};k.srv=f.getActiveProject().getCommunticationObj();
k.alMgr=f.activeProject.getAlarmsMgr();k.currLangId=f.activeProject.getMultiLanguageMgr().curLangId;f.getEventMgr()&&(k.activateHandler=function(){k.load()},k.deactivateHandler=function(){k.unload()},b.prototype.bindEvents.call(k,{loadWgt:k.activateHandler}),b.prototype.bindEvents.call(k,{unloadWgt:k.deactivateHandler}));k.ml=!0;return k}p(a,b);a.prototype.setInitStopTime=function(){var a=f.getActiveProject().getSystemPropertiesMgr().getValue("System Time");this.setValue("max",a,null,null)};a.prototype.subscribeWgt=
function(a,b){a&&(void 0===this._subscriptions[a.wgtId]?this._subscriptions[a.wgtId]=new Va(a,b):this._subscriptions[a.wgtId].addCallback(b))};a.prototype.setDefaultState=function(){var a=f.cache.getWgtProp(this.wgtId,"PageDuration");null!=a?this.PageDuration=a:void 0!==this.defDur&&0<=this.defDur&&(this.PageDuration=this.getPageDurantion(this.defDur));this.PageDuration=void 0!=this.PageDuration?this.PageDuration:2;a=f.getActiveProject().getSystemPropertiesMgr().getValue("System Time");this.max=void 0!==
this.max?this.max:Math.ceil(a);0==this.getTimeFrame()?this.min=void 0!==this.min?this.min:Math.round(a-60):this.min=this.max-this.getTimeFrame();this.eventCount=void 0!==this.eventCount?this.eventCount:0;this.evType=14;this.subType=void 0!=this.subType?this.subType:1;this.currEvtId=void 0!==this.currEvtId?this.currEvtId:null};a.prototype.load=function(){var a=this,b=f.getActiveProject().getSystemPropertiesMgr().getValue("System Time");this.max=Math.ceil(b);this.min=this.max-this.getTimeFrame();this.alarmEvent=
new nd(this.evType,this.subType,this.min,this.max,this.wgtId,this.buffName);if(this.srv.getConnectionStatus())this.subscribeEvent();else this.srv.onConnectionReady(function(){return a.subscribeEvent()})};a.prototype.subscribeEvent=function(){var a=this;this.currEvtId=this.srv.subscribeEvent(this.alarmEvent,function(b){a.onDataReady(b)})};a.prototype.updateDataSources=function(){for(var a in this._subscriptions){var b=this._subscriptions[a];if("TableHistoricAlarmSrcWgt"===b.w.getJMType())b.getCallbacks()[0]()}};
a.prototype.unload=function(){this.srv.unsubscribeEvent(this.alarmEvent)};a.prototype.onDataReady=function(a){var b=this.eventCount=a.length,h,d=0;this.setPrevVars();this.emptyVars();for(var g=0;g<b;g++){h=this.vars;var f=a[g];if(14==f.type&&(1==f.evtType||4==f.evtType)){var f=f.data,l=this.alMgr.getAlarmById(f.id);if(null!=l){h.alAlarmID.push(f.id);var m=f.ts;h.alDateTime.push(m);h.evTimestamp.push(m);var p=(new Ya(new Date(m),"DD/MM/YYYY hh:mm:ss")).formatDateTimeValue().split(" ");h.evDate.push(p[0]);
h.evTime.push(p[1]);p=l.alDescription;"undefined"!=typeof this.alMgr.getAlarmsConfiguration().mlTexts[p]&&(p=this.alMgr.getAlarmsConfiguration().mlTexts[p][this.currLangId]);if(l.liveData)var q=l.liveData.d,t=this.parentPage.getPageMLTextMgr().getCurrentLanguage(),u=void 0,u="string"==typeof q[t]?q[q[t]]:q[t],p=this.alMgr.replaceHistLiveTags(p,u,f.d);h.alDescription.push(p);h.alEventType.push(this._getEventType(f.t));h.alName.push(l.alName);h.alState.push(this._getAlarmState(f.st));h.alStateCode.push(f.st);
h.alValue.push(f.v);0==g&&(d=m)}}}0==b?this.clearTables():this.updateDataTables();0==this.PageDuration&&this.setValue("min",d/1E3)};a.prototype.isDataReady=function(){return!0};a.prototype.getDataValues=function(a){return this.vars[a]};a.prototype.getAlarmNameByIndex=function(a){a=this.vars.alName[a];return null!=a?a:"nodata"};a.prototype.getAlarmStateCodeByIndex=function(a){return this.vars.alStateCode[a]};a.prototype._getEventType=function(a){switch(a){case 1:return"Triggered";case 2:return"Not Triggered";
case 4:return"Acked";case 8:return"Reset";case 16:return"Enabled";case 32:return"Disabled";case 64:return"Flag Trigger Condition Changed";default:return""}};a.prototype._getAlarmState=function(a){switch(a){case 0:return"Not Triggered";case 1:return"Disabled";case 2:return"Triggered";case 3:return"Triggered Not Acked";case 4:return"Not Triggered Acked";case 5:return"Not Triggered Not Acked";case 6:return"Triggered Acked";default:return""}};a.prototype.getUnorderedPosition=function(a){return null};
a.prototype.updateDataTables=function(){var a=!1,b;for(b in this.dataLinks){var h=this.dataLinks[b].tag;if(this.vars[h]instanceof Array){if(this.eventCount){$.isEmptyObject(this.prevVars)||this.eventCount==this.prevVars.alAlarmID.length||(this.prevVars={},a=!0);for(var d=0;d<this.eventCount&&!a;d++){var g=$.isEmptyObject(this.prevVars),f=g||this.vars[h][d]!=this.prevVars[h][d]&&!moment.isMoment(this.vars[h][d])&&!moment.isMoment(this.prevVars[h][d]),g=g||moment.isMoment(this.vars[h][d])&&moment.isMoment(this.prevVars[h][d])&&
!this.vars[h][d].isSame(this.prevVars[h][d]);if(f||g)a=!0}}else"PageDuration"==h&&this.prevVars[h]!=this.vars[h]&&(a=!0);if(a)break}}if(a){for(var l in this.dataLinks)a=this.dataLinks[l],this.vars[a.tag]instanceof Array&&a.setWgtValue(this.vars[a.tag],-1);this.clearTables();this.updateTables()}};a.prototype.getValue=function(a){return"PageDuration"==a?this.PageDuration:"min"==a?this.min:"max"==a?this.max:"PageDuration"==a?this.PageDuration:void 0!==this.vars[a]?this.vars[a]:l.prototype.getValue.call(this,
a)};a.prototype.setValue=function(a,b,h,d){var g=this;d=!1;h=u.getModule("Tag").QUALITY_GOOD;if(-1<a.indexOf("PageDuration")){a="All"==b?0:parseInt(b,10);if(a==this.PageDuration)return!0;this.PageDuration=a;this.vars.PageDuration=this.PageDuration;f.cache.setWgtProp(this.wgtId,"PageDuration",this.PageDuration);this.min=this.max-this.getTimeFrame();d=!0;this.sendUpdate("min",new Date(1E3*this.min),h,-1);this.sendUpdate("PageDuration",this.PageDuration,h,-1)}else if("min"==a)this.min=0===b?1:b,this.sendUpdate("min",
new Date(1E3*this.min),h,-1);else if("max"==a||"MaxInSeconds"==a)this.max=b,this.min=this.max-this.getTimeFrame(),d=!0,this.sendUpdate("max",new Date(1E3*this.max),h,-1),this.sendUpdate("min",new Date(1E3*this.min),h,-1);d&&(this.srv.unsubscribeEvent(this.alarmEvent),this.alarmEvent.setStartTime(this.min),this.alarmEvent.setEndTime(this.max),this.currEvtId=this.srv.subscribeEvent(this.alarmEvent,function(a){g.onDataReady(a)}),this.updateDataSources());return!0};a.prototype.sendUpdate=function(a,b,
h,d){var g;if(this.dataLinks)for(var f in this.dataLinks)g=this.dataLinks[f],g.tag===a&&g.tgtWgt!==this&&g.setWgtValue(b,d,h,h)};a.prototype.setPrevVars=function(){this.prevVars={};for(var a in this.vars)0<this.vars[a].length&&(this.prevVars[a]=this.vars[a].slice())};a.prototype.emptyVars=function(){this.vars={alAlarmID:[],alDateTime:[],alDescription:[],alEventType:[],alName:[],alState:[],alStateCode:[],alTime:[],alValue:[],evDate:[],evTime:[],evTimestamp:[],min:this.vars.min,max:this.vars.max,eventCount:0,
PageDuration:this.PageDuration}};a.prototype.updateLanguage=function(){var a=this.getPageMLTextMgr().getCurrentLanguage();if(a!=this.currLangId){for(var b=f.getWidget("_AlarmsMgr",!0),h=0,d=this.vars.alName.length;h<d;h++){var g=b.getAlarmByName(this.vars.alName[h]);this.vars.alDescription[h]=b.alarmsConf.mlTexts[g.alDescription][a]}this.currLangId=a;this.updateDataTables()}};a.prototype.getTimeFrame=function(){var c=a.timeFrame[this.PageDuration];return 0==c?this.max-1:void 0!==c?c:0};a.prototype.getPageDurantion=
function(c){for(var b in a.timeFrame)if(c==a.timeFrame[b])return parseInt(b);return 1};a.prototype.updateTables=function(){var a=this.getAllSubscriptions();if(a)for(var b in a){var h=a[b].getWidget();"TableWgt"==h.getJMType()&&h.updateData()}};a.prototype.clearTables=function(){var a=this.getAllSubscriptions();if(a)for(var b in a){var h=a[b].getWidget();"TableWgt"==h.getJMType()&&h.clear()}};a.prototype.getStartTime=function(a){return a?this.min:this.max};a.prototype.getStopTime=function(a){return a?
this.max:this.min};a.prototype.getEventType=function(){return this.evType};a.prototype.getSubType=function(){return this.subType};a.prototype.getEventBufferName=function(){return this.buffName};a.prototype._isInt=function(a){return 0===a%1};a.prototype.destroy=function(){if(this.destroyed)return!1;this.vars=null;this.setPrevVars();return this.destroyed=!0};a.timeFrame={0:0,1:60,2:300,3:600,4:1800,5:3600,6:7200,7:14400,8:28800,9:43200,10:86400,11:172800,12:432E3,13:604800,14:1209600,15:2419200};a.jmType=
"EventBufferWgt";return a}(l);f.fn.hmiEventBufferWgt=function(b,a,c,e){return new od(this,b,a,c,e)};f.addWidgetDefinition("hmiEventBufferWgt",od);var Vb=function(b){function a(a,e,h,d,g){a=b.call(this,a,e,h,d,g)||this;a.debounceTime=300;a.model=[];a.proxyModel=[];a.timer=null;a.queue=[];return a}p(a,b);a.prototype.getFilter=function(a){void 0===a._f&&(a._f=!0);"number"===typeof a._f&&(a._f=Boolean(a._f));"string"===typeof a._f&&(a._f=isNaN(Number(a._f))?!0:Boolean(Number(a._f)));return a._f};a.prototype.createDatalink=
function(a,b){try{var h=f.createDataLink(this,null,{attr:"filter-"+a});h.readFromString(b);h.mount();h.update()}catch(d){f.showErrorMessage(this.studioId,"TableGroupProxy: createDatalink() function",d.message)}};a.prototype.parseModel=function(a){var b=[],h=this.model;a&&(h=a);for(var d=0;d<h.length;d++)if(0!==d||a){var g=this.getFilter(h[d]);!0===g?b.push(Oa({},h[d])):g instanceof Object&&this.createDatalink(d,g.v)}else b.push(Oa({},h[d]));this.proxyModel=a?this.proxyModel.concat(b):b};a.prototype.updateProxyFilters=
function(){for(this.proxyModel=this.model.slice();0<this.queue.length;){var a=this.queue.shift();this.proxyModel[a.row]&&(this.proxyModel[a.row]._f=a.value)}};a.prototype.updateProxyModel=function(){for(var a=[],b=0;b<this.proxyModel.length;b++)(this.proxyModel[b]._f||0===b)&&a.push(this.proxyModel[b]);this.proxyModel=a};a.prototype.debounce=function(a,b){this.timer&&clearTimeout(this.timer);this.timer=setTimeout(function(){a()},b)};a.prototype.activateProxyParser=function(){this.unmountLinks();this.parseModel();
this.tableGroup.setModel()};a.prototype.setInputModel=function(a){this.setModel(a);this.activateProxyParser()};a.prototype.pushInputModelFragment=function(a){this.concatModel(a);this.parseModel(a);this.tableGroup.pushModelFragment()};a.prototype.setValue=function(a,b,h,d){var g=this;-1!==a.indexOf("filter")&&(a=Number(a.split("-")[1]),this.queue.push({row:a,value:Boolean(b)}),this.debounce(function(){g.updateProxyFilters();g.updateProxyModel();g.tableGroup.setModel();g.queue=[]},this.debounceTime))};
a.prototype.resetModel=function(){this.setModel([])};a.prototype.pushRowModel=function(a){this.model.push(a)};a.prototype.concatModel=function(a){this.model=this.model.concat(a)};a.prototype.setModel=function(a){this.model=a};a.prototype.getModel=function(){return this.model};a.prototype.getProxyModel=function(){return this.proxyModel};a.prototype.getTableGroup=function(){return this.tableGroup};a.prototype.destroy=function(){b.prototype.destroy.call(this);this.proxyModel=this.model=null;clearTimeout(this.timer);
return!0};return a}(l);f.fn.hmiTableGroupProxy=function(b,a,c,e){return new Vb(this,b,a,c,e)};f.addWidgetDefinition("hmiTableGroupProxy",Vb);var pd=function(b){function a(a,e,h,d,g){var k=b.call(this,a.wgtId,e,h,d,g)||this;k.initPromiseReady();$hmi.isTestModeActive()||k.parentWidget.waitWgtReady().then(function(){k._srv=f.activeProject.getCommunticationObj();k._srv.getConf().then(function(a){k._conf=a[k.configFileName];k.resolveWgtReady(!0)}).catch(function(){f.getAction("hmiActionShowMessage").execute(null,
{msg:"Error loading audit trail configuration."},3);k.resolveWgtReady(!0)})});return k}p(a,b);a.prototype.isAuditTrailEnabled=function(){return this._conf.enable};a.prototype.getConf=function(){return this._conf};return a}(l);f.fn.hmiAuditTrailMgrWgt=function(b,a,c,e){return new pd(this,b,a,c,e)};f.addWidgetDefinition("hmiAuditTrailMgrWgt",pd);var Eb=function(b){function a(c,e,h,d,g){c=b.call(this,c.wgtId,e,h,d,g)||this;c.duration=a.pageDurationMap[c.pageDuration];return c}p(a,b);a.prototype.setInitStopTime=
function(){var a=f.getActiveProject().getSystemPropertiesMgr().getValue("System Time");this.setValue("MaxInSeconds",a,null,null)};a.prototype.updateSubscriptions=function(){for(var a in this._subscriptions)this._subscriptions[a].w.fetchData&&this._subscriptions[a].w.fetchData()};a.prototype.setValue=function(c,e,h,d){switch(c){case "PageDuration":this.pageDuration!=e&&(this.pageDuration=e,this.duration=a.pageDurationMap[this.pageDuration],this.startTime=0===this.duration?1:this.stopTime-this.duration,
this.sendUpdate("min",this.startTime,null),this.sendUpdate("max",this.stopTime,null));break;case "MaxInSeconds":this.stopTime!=e&&(this.stopTime=e,this.startTime=0===this.duration?1:this.stopTime-this.duration,this.sendUpdate("min",this.startTime,null),this.sendUpdate("max",this.stopTime,null));break;case "dateFormat":this.dateFormat!=e&&(this.dateFormat=e);break;case "timeSpec":this.timeSpec!=e&&(this.timeSpec=e);break;default:b.prototype.setValue.call(this,c,e,h,d)}this.updateSubscriptions()};a.prototype.getValue=
function(a){switch(a){case "PageDuration":return this.pageDuration;case "max":case "MaxInSeconds":return this.stopTime;case "min":case "StartTime":return this.startTime;case "duration":return this.duration;default:return b.prototype.getValue.call(this,a)}};a.prototype.getStartTime=function(a){return a?this.startTime:this.stopTime};a.prototype.getStopTime=function(a){return a?this.stopTime:this.startTime};a.prototype.getTimeFrame=function(){return this.duration};a.prototype.getEventType=function(){return this.evType};
a.prototype.getSubType=function(){return this.subType};a.prototype.getEventBufferName=function(){return this.eventBuffer};a.prototype.setParentBounds=function(a,b,h,d,g){};a.prototype.getParentBounds=function(a){return{x:0,y:0,width:0,height:0}};a.pageDurationMap={0:0,1:60,2:300,3:600,4:1800,5:3600,6:7200,7:14400,8:28800,9:43200,10:86400,11:172800,12:432E3,13:604800,14:1209600,15:2419200,16:7776E3,17:15552E3,18:31536E3,19:63072E3,20:157766400};return a}(l);f.fn.hmiAuditBufferWgt=function(b,a,c,e){return new Eb(this,
b,a,c,e)};f.addWidgetDefinition("hmiAuditBufferWgt",Eb);var qd=function(){function b(a,b,e,h,d,g){this.returnTS=!0;this.deltaTime=this.nEvents=0;this.bounds=!1;this.eventType=a;this.subType=b;this.startTime=e;this.endTime=h;this.bufferId=d;this.bufferName=g}b.prototype.setEventType=function(a){this.eventType=a};b.prototype.setSubType=function(a){this.subType=a};b.prototype.setStartTime=function(a){this.startTime=a};b.prototype.setEndTime=function(a){this.endTime=a};b.prototype.setBufferId=function(a){this.bufferId=
a};b.prototype.setBufferName=function(a){this.bufferName=a};b.prototype.getEventType=function(){return this.eventType};b.prototype.getSubType=function(){return this.subType};b.prototype.getStartTime=function(){return this.startTime};b.prototype.getEndTime=function(){return this.endTime};b.prototype.getBufferId=function(){return this.bufferId};b.prototype.getBufferName=function(){return this.bufferName};b.prototype.toURL=function(){return"eventType="+this.eventType+"&subType="+this.subType+"&returnTS="+
this.returnTS+"&startTime="+this.startTime+"&endTime="+this.endTime+"&nEvents="+this.nEvents+"&deltaTime="+this.deltaTime+"&bounds="+this.bounds};return b}(),qc=function(){return function(){this.visible=!0}}(),rd=function(b){function a(a,e,h,d,g){var k=b.call(this,a.wgtId,e,h,d,g)||this;k.setDefaultState();k.timer=null;k.currip=null;k.injectAuthScript();f.getEventMgr()&&(k.activateHandler=function(){k.imageElem=k.elem.firstElementChild;k.initEventHandlers();var a=navigator.userAgent;-1==a.indexOf("Trident")&&
-1==a.indexOf("Edge")&&-1==a.indexOf("MSIE")||!k.isMjpeg?k.start():k.showIEMjpeg()},k.deactivateHandler=function(){l.prototype.executeDeactivationCallback.call(k)&&(k.stop(),k.isWgtActive=!1)},b.prototype.bindEvents.call(k,{loadWgt:k.activateHandler,unloadWgt:k.deactivateHandler}));return k}p(a,b);a.prototype.setDefaultState=function(){this.rate=void 0!==this.rate?this.rate:5E3;this.mjpgrate=void 0!==this.mjpgrate?this.mjpgrate:5E3;this.user=void 0!==this.user?this.user:"";this.pwd=void 0!==this.pwd?
this.pwd:"";this.mjpegip=void 0!==this.mjpegip?this.mjpegip:"";this.isMjpeg=void 0!==this.isMjpeg?this.isMjpeg:!1;this._renderMask=0};a.prototype.injectAuthScript=function(){var a=document.createElement("script");a.src=this.ip||this.mjpegip;document.head.appendChild(a);document.head.removeChild(a)};a.prototype.initEventHandlers=function(){var b=this;this.imageElem.onerror=function(){null==document.getElementById(b.wgtId+".nosignal")&&(b._renderMask|=a._renderFlags.ADDNOSIGNAL,f.addToRender(b))};this.imageElem.onload=
function(){null!=document.getElementById(b.wgtId+".nosignal")&&(b._renderMask|=a._renderFlags.RMNOSIGNAL,f.addToRender(b))}};a.prototype.createNoSignalHTMLElement=function(){var a=document.createElement("div"),b=document.createElement("h1");b.setAttribute("class","jm-h1");a.setAttribute("id",this.wgtId+".nosignal");a.style.width="100%";a.style.height="100%";a.style.backgroundColor="black";a.style.textAlign="center";a.style.position="absolute";a.style.left="0px";a.style.top="0px";b.style.color="blue";
b.style.position="relative";b.style.top="50%";b.appendChild(document.createTextNode("NO SIGNAL"));a.appendChild(b);return a};a.prototype.appendNoSignalElement=function(){this.elem.getElementsByTagName("img")[0].style.display="none";this.elem.appendChild(this.createNoSignalHTMLElement())};a.prototype.removeNoSignalElement=function(){this.elem.getElementsByTagName("img")[0].style.display="block";this.elem.removeChild(document.getElementById(this.wgtId+".nosignal"))};a.prototype.render=function(){b.prototype.render.call(this);
this._renderMask&a._renderFlags.JPGREFRESH&&this.refreshJPEG();this._renderMask&a._renderFlags.MJPGREFRESH&&this.refreshMJPEG();this._renderMask&a._renderFlags.ADDNOSIGNAL&&this.appendNoSignalElement();this._renderMask&a._renderFlags.RMNOSIGNAL&&this.removeNoSignalElement();this._renderMask=0};a.prototype.showIEMjpeg=function(){var a=$(this.elem).children(),b;b='<object id="Player" standby="Loading Axis Media Control components..." border="0" codeBase="/activex/AMC.cab#version=6,0,6,7" classid="CLSID:DE625294-70E6-45ED-B895-CFFA13AEB044" style="width:100%;height:100%;"><param name="StretchToFit" value="-1">'+
('<param name="MediaURL" value="'+this.mjpegip+'">');b+='<param name="AutoStart" value="-1"></object>';a.replaceWith(b)};a.prototype.setOptions=function(a){null!=a&&(void 0!=a.user&&(this.user=a.user),void 0!=a.pwd&&(this.pwd=a.pwd),void 0!=a.rate&&(this.rate=a.rate),void 0!=a.mjpegip&&(this.mjpegip=a.mjpegip),void 0!=a.ip&&(this.ip=a.ip))};a.prototype.refreshMJPEG=function(){this.imageElem&&(this.imageElem.src=this.currip)};a.prototype.refreshJPEG=function(){this.imageElem&&(this.imageElem.src=this.currip+
"?v="+(new Date).getTime())};a.prototype.start=function(){if(!this.bAltIPAddr){var b=this;this.timer&&clearInterval(this.timer);this.currip=this.ip?this.ip:this.mjpegip;this.mjpegip?(this._renderMask|=a._renderFlags.MJPGREFRESH,f.addToRender(this),this.timer=window.setInterval(function(){b._renderMask|=a._renderFlags.MJPGREFRESH;f.addToRender(b)},this.mjpgrate)):(this._renderMask|=a._renderFlags.JPGREFRESH,f.addToRender(this),this.timer=window.setInterval(function(){b._renderMask|=a._renderFlags.JPGREFRESH;
f.addToRender(b)},b.rate))}};a.prototype.stop=function(){this.timer&&clearInterval(this.timer);this.imageElem&&(this.imageElem.src="",this.imageElem.onerror=null,this.imageElem=this.imageElem.onload=null)};a.prototype.setValue=function(a,e,h,d,g){d=!1;switch(a){case "user":void 0!=e&&e!=this.user&&(this.user=e,d=!0);break;case "pwd":void 0!=e&&e!=this.pwd&&(this.pwd=e,d=!0);break;case "rate":void 0!=e&&e!=this.rate&&(this.rate=e,d=!0);break;case "mjpegip":case "alt-ipaddress":void 0!=e&&e!=this.mjpegip&&
(this.mjpegip=e,d=!0);break;case "ip":void 0!=e&&e!=this.ip&&(this.ip=e,d=!0);break;default:return b.prototype.setValue.call(this,a,e,h)}d&&(this.deactivateHandler(),this.activateHandler())};a.prototype.getValue=function(a){switch(a){case "user":return this.user;case "pwd":return this.pwd;case "rate":return this.rate;case "mjpegip":case "alt-ipaddress":return this.mjpegip;case "ip":return this.ip;default:return b.prototype.getValue.call(this,a)}};a.prototype.destroy=function(){if(this.destroyed)return!1;
b.prototype.unbindEvents.call(this,{loadWgt:this.activateHandler,unloadWgt:this.deactivateHandler});return b.prototype.destroy.call(this)};a._renderFlags={JPGREFRESH:1,MJPGREFRESH:2,ADDNOSIGNAL:4,RMNOSIGNAL:8};a.jmType="IPCameraWgt";return a}(l);f.fn.hmiIPCamera=function(b,a,c,e){return new rd(this,b,a,c,e)};f.addWidgetDefinition("hmiIPCamera",rd);var sd=function(b){function a(c,e,h,d,g){c=b.call(this,c.wgtId,e,h,d,g)||this;c.setDefaultValues();c.itemData=0;c.select=c.elem.childNodes[1];c.count=c.select.childNodes.length;
c.authCode=c.getAuthorizations();c.isNotNative=c._isNativeSelectCompatible();c.index||(c.index=0);if(0>c.index||c.index>c.count-1)c.index=-1;c.index!=c.select.selectedIndex&&(c.index=c.select.selectedIndex);c.keyValue=c.listData.split(",")[c.index];c.list instanceof Array||(c.list=c.list.split(","));c.textValue=c.list[c.index];c._hasEmptyElem=!1;c.ml=!0;c.events={mousedown:!0,touchstart:!0};c.authCode==c.umgr.getWidgetAuthorizationCodes().RDONLY&&(c.enable=!1,c._renderMask|=a._renderFlags.DIS);c._renderMask|=
a._renderFlags.INITWRAP;f.addToRender(c);return c}p(a,b);a.prototype.setDefaultValues=function(){this.select=void 0!==this.select?this.select:null;this.enable=void 0!==this.enable?this.enable:!0;this.lData=void 0!==this.lData?this.lData:null;this.keyValue=void 0!==this.keyValue?this.keyValue:null;this.textValue=void 0!==this.textValue?this.textValue:null;this.isML=!0};a.prototype._initSelectEvents=function(){var a=this;$(this.select).change(function(){a.onChange()})};a.prototype._initSelectricWrapper=
function(){this.combowrap=new L(this);this.updateWrapper();this.getAuthorizations()!=this.umgr.getWidgetAuthorizationCodes().RDONLY&&this.combowrap.bindEvents()};a.prototype.doMouseDown=function(a){};a.prototype.doMouseUp=function(a){};a.prototype.isWgtEventsPreventDefault=function(){return this.isNotNative};a.prototype.render=function(){b.prototype.render.call(this);this._renderMask&a._renderFlags.INITWRAP&&(f.browserOptimizations.forceLayers&&($(this.elem).hasClass("jm-hacklayer")||$(this.elem).addClass("jm-hacklayer")),
this.isNotNative?this._initSelectricWrapper():this._initSelectEvents());this._renderMask&a._renderFlags.NATIVECOMBOBOUNDS&&(this.select.style.width=this.width+"px",this.select.style.height=this.height+"px");this._renderMask&a._renderFlags.UPDATE&&this.updateValue();this._renderMask&a._renderFlags.CHANGE&&(this._hasEmptyElem&&($("option[value='empty']",this.select).remove(),this._hasEmptyElem=!1),this.select.selectedIndex=this.index);if(this._renderMask&a._renderFlags.EMPTY){if(!this._hasEmptyElem){var c=
document.createElement("option");c.setAttribute("value","empty");c.setAttribute("selected","selected");c.setAttribute("style","display:none");$(this.select).prepend(c)}this.index=-1;this._hasEmptyElem=!0;this.select.selectedIndex=this.index}this._renderMask&a._renderFlags.DIS&&(this.enable?($(this.select).removeAttr("disabled"),this.combowrap&&this.combowrap.bindEvents()):(this.combowrap&&this.combowrap.unbindEvents(),$(this.select).attr("disabled","")));this._renderMask&a._renderFlags.DATA&&this.setListData();
if(this._renderMask&a._renderFlags.FILL){$(this.select).children().remove();c=document.createElement("option");c.setAttribute("value","empty");c.setAttribute("selected","selected");c.setAttribute("style","display:none");if(this.list){var e=this.list,h=document.createDocumentFragment(),d;if(0>this.index||this.index>this.count-1)$(h).append(c),this._hasEmptyElem=!0,this.index=-1;for(var g=0,k=this.count;g<k;g++)d=document.createElement("option"),c=document.createTextNode(e[g]),$(d).append(c),$(h).append(d);
$(this.select).prepend(h)}else $(this.select).prepend(c);this.select.selectedIndex=this.index}this.combowrap&&this.updateWrapper();this._renderMask=0};a.prototype.addDataLink=function(a){b.prototype.addDataLink.call(this,a);this.initDataLinkSideEffects(a,a.attr)};a.prototype.initDataLinkSideEffects=function(b,e){if("index"==e&&"r"==b.rw||this.authCode==this.umgr.getWidgetAuthorizationCodes().RDONLY)this.enable=!1,this._renderMask|=a._renderFlags.DIS,f.addToRender(this);"list"==e&&this.hasPropInDatalinks("List")};
a.prototype.setValue=function(c,e,h,d){var g=!1;if(this.isBadValue(e,!1,h))return!1;"index"==c&&void 0!==e?(this.index=Math.round(e),g=!0,this._renderMask=0>this.index||this.index>this.count-1?this._renderMask|a._renderFlags.EMPTY:this._renderMask|a._renderFlags.CHANGE,(c=this.select.options[this.index])?(e=this.listData.split(","),this.keyValue=void 0!==e[this.index]?e[this.index]:"",this.textValue=c.textContent):this.textValue=this.keyValue="",this.sendUpdate("data",this.keyValue,h),this.doWriteValue("data",
this.keyValue),this.sendUpdate("text",this.textValue,h)):"disabled"==c&&void 0!==e?this.enable!=!e&&(this.enable=!e,g=!0,this._renderMask|=a._renderFlags.DIS,this.sendUpdate(c,this.enable,h)):"data"==c?this.lData!=e&&(this.lData=e,g=!0,this._renderMask|=a._renderFlags.DATA,this.doWriteValue(c,this.lData),this.sendUpdate(c,this.lData,h)):"list"==c?this.list!=e&&(this.list=void 0!=e?e instanceof Array?e:e.split(","):"",this.count=this.list.length,g=!0,this._renderMask|=a._renderFlags.FILL,this.sendUpdate(c,
this.list instanceof Array?this.list.join(","):this.list,h)):b.prototype.setValue.call(this,c,e,h,d);g&&f.addToRender(this);return!0};a.prototype.setListData=function(){var a,b,h;a=this.select.childNodes;b=a.length;for(var d=this.listData.split(","),g=0;g<b;g++){var f=a[g].getAttribute("value");if(d[f]==this.lData){h=g;break}}void 0!=h&&(this.index=this.select.selectedIndex=h,this.doWriteValue("index",h))};a.prototype.getValue=function(a){switch(a){case "itemData":case "data":return this.keyValue;
case "index":return this.index;case "list":return this.list instanceof Array?this.list.join(","):this.list;case "text":return this.textValue;default:return l.prototype.getValue.call(this,a)}};a.prototype.updateValue=function(){var a=u.getModule("Tag");this.index=this.select.selectedIndex;this._hasEmptyElem&&0<this.index&&--this.index;this.doWriteValue("index",this.index);this.sendUpdate("index",this.index,a.QUALITY_GOOD);this.keyValue=this.listData.split(",")[this.index];this.doWriteValue("data",
this.keyValue);this.sendUpdate("data",this.keyValue,a.QUALITY_GOOD);this.doWriteValue("itemData",this.keyValue);this.sendUpdate("itemData",this.keyValue,a.QUALITY_GOOD);this.textValue=this.list[this.index];this.doWriteValue("text",this.textValue);this.sendUpdate("text",this.textValue,a.QUALITY_GOOD)};a.prototype.getText=function(a){var b=this.getPageMLTextMgr();return this.isClone&&this.hasDataSourceProp("list")?this.tableGroupWgt.getText(a):b.getText(a,this,"list")};a.prototype.getMLIds=function(){return this.isClone&&
this.hasDataSourceProp("list")?this.clMLIds:this.mlIds};a.prototype.updateLanguage=function(){var a=u.getModule("Tag");if(!this.hasListPropInDatalinks&&this.isML){var b=this.getPageMLTextMgr().getCurrentFont();b&&(this.combowrap?this.combowrap.updateFont(b):this.elem.style.fontFamily="'"+b+"'");var b=this.getMLIds(),h=this.getText(b[0]);if(null!=h){var d=[];if(h instanceof Array)d=h;else for(h=0;h<b.length;h++)d.push(this.getText(b[h]));this.setValue("list",d,a.QUALITY_GOOD)}this.combowrap&&this.updateWrapper()}};
a.prototype.onChange=function(b){this.isNotNative&&(this.index=this.select.selectedIndex=b);this._renderMask|=a._renderFlags.UPDATE;f.addToRender(this)};a.prototype.onClose=function(){this.isNotNative&&this.combowrap&&this.combowrap.detachClone()};a.prototype.updateWrapper=function(){this.combowrap&&(this.combowrap.refresh(),this.combowrap.update(this.index))};a.prototype.setParentBounds=function(a,e,h,d,g){b.prototype.setParentBounds.call(this,a,e,h,d,g);this.updateOnResize()};a.prototype.updateOnResize=
function(c){b.prototype.updateOnResize.call(this,c);this.combowrap?(this.removeComboWrapper(),this._renderMask|=a._renderFlags.INITWRAP):this._renderMask|=a._renderFlags.NATIVECOMBOBOUNDS;f.addToRender(this)};a.prototype.destroy=function(){if(this.destroyed)return!1;b.prototype.destroy.call(this);this.removeComboWrapper();return!0};a.prototype.removeComboWrapper=function(){this.combowrap?(this.combowrap.removeObjects(),delete this.combowrap,$(this.elem).append(this.select)):$(this.select).off()};
a.jmType="ComboBoxWgt";a._renderFlags={CHANGE:1,DIS:2,DATA:4,EMPTY:8,UPDATE:16,FILL:32,INITWRAP:64,NATIVECOMBOBOUNDS:128};return a}(l);f.fn.hmiComboBox=function(b,a,c,e){return new sd(this,b,a,c,e)};f.addWidgetDefinition("hmiComboBox",sd);var Y;(function(b){b[b.HISTORY=0]="HISTORY";b[b.REALTIME=1]="REALTIME"})(Y||(Y={}));var Sb=function(b){function a(a,e,h,d,g){a=b.call(this,a.wgtId,e,h,d,g)||this;a.setDefaultState();a.trnWndId&&(a.trnWnd=a.parentWidget.getWidgetByCondition(function(a){return"TrendWindowWgt"==
a.getJMType()}),a.trnWnd.subscribeWgt(a,function(){}));a.srv=f.getActiveProject().getCommunticationObj();a.bufferType==Y.REALTIME?(a.samplingTime*=1E3,a.timerRealTime=null):a.bufferType==Y.HISTORY&&(a.refreshHistory=3E3,a.isDirty=!0);var k=a;f.getEventMgr()&&(k=a,a.activateHandler=function(){l.prototype.executeActivationCallback.call(k)&&(k.load(),k.isWgtActive=!0)},a.deactivateHandler=function(){l.prototype.executeDeactivationCallback.call(k)&&(k.unload(),k.isWgtActive=!1)},b.prototype.bindEvents.call(a,
{loadWgt:a.activateHandler,unloadWgt:a.deactivateHandler}));return a}p(a,b);a.prototype.setDefaultState=function(){this.bufferSize=void 0!==this.bufferSize?this.bufferSize:1E3;this.bufferType=void 0!==this.bufferType?this.bufferType:1;this.dynamicTrendName="";this.hasDynamicTrendName=!1;this.nPoints=void 0!==this.nPoints?this.nPoints:0;this.nextInsert=void 0!==this.nextInsert?this.nextInsert:0;this.isCyclic=void 0!==this.isCyclic?this.isCyclic:!1;this.startTimeIdx=void 0!==this.startTimeIdx?this.startTimeIdx:
0;this.stopTimeIdx=void 0!==this.stopTimeIdx?this.stopTimeIdx:0;this.value=void 0!==this.value?this.value:null;this.timerRealTime=void 0!==this.timerRealTime?this.timerRealTime:null;this.currValueTs=void 0!==this.currValueTs?this.currValueTs:null;this.lastReadTagTs=void 0!==this.lastReadTagTs?this.lastReadTagTs:null;this.outOfSyncGap=void 0!==this.outOfSyncGap?this.outOfSyncGap:0;this.rIdal=void 0!==this.rIdal?this.rIdal:null;this.hTrendName=void 0!==this.hTrendName?this.hTrendName:null;this.hTrendPrefix=
void 0!==this.hTrendPrefix?this.hTrendPrefix:null;this.hStartTime=void 0!==this.hStartTime?this.hStartTime:null;this.hEndTime=void 0!==this.hEndTime?this.hEndTime:null;this.hMaxNSamples=void 0!==this.hMaxNSamples?this.hMaxNSamples:0};a.prototype.load=function(){this.buffer=Array(this.bufferSize);this.auxBuff=[];this.nextInsert=0;this.bufferType==Y.REALTIME&&(this.isCyclic=!0,this.startRealTimeSampling())};a.prototype.unload=function(){null!==this.timerRealTime&&(window.clearInterval(this.timerRealTime),
this.timerRealTime=null);this.auxBuff=this.buffer=null};a.prototype.startRealTimeSampling=function(){var a=this;null===this.timerRealTime&&(this.timerRealTime=window.setInterval(function(){var b,h=Date.now();a.currValueTs!=a.lastReadTagTs?(b=(new Date(a.currValueTs)).getTime(),a.outOfSyncGap=h-b,a.lastReadTagTs=a.currValueTs):b=h-a.outOfSyncGap;a.addPoint(b,a.value,a.currValueQuality);b=a._orderByTime();a.sendUpdate("web-value",b,null)},this.samplingTime))};a.prototype.addPoint=function(a,b,h){this.nextInsert<
this.bufferSize&&(this.buffer[this.nextInsert]=new V(a,b,h),this.stopTimeIdx=this.nextInsert);this.nextInsert++;this.nPoints++;this.nPoints>=this.bufferSize&&(this.nPoints=this.bufferSize,this.isCyclic&&this.nextInsert>=this.bufferSize&&(this.nextInsert=0),this.isCyclic&&(this.startTimeIdx=this.nextInsert))};a.prototype.addDataLink=function(a){b.prototype.addDataLink.call(this,a);"trend"==a.attr&&(this.hasDynamicTrendName=!0)};a.prototype.setValue=function(a,b,h,d,g){switch(a){case "Value":this.currValueQuality=
h;if(this.hasDynamicTrendName&&h&&!h.isQualityGood()||this.isBadValue(b,!1,h))return this.value=void 0,!1;switch(this.bufferType){case Y.REALTIME:if(this.value!=b||this.currValueTs!=g)this.value=b,this.currValueTs=g,this.sendUpdate(a,this.value,h);break;case Y.HISTORY:if(this.buffer=b)this.generateGhostBufferSamples(),this.sendUpdate("web-value",this.auxBuff,null)}break;case "trend":if(h&&!h.isQualityGood())return!1;this.bufferType==Y.REALTIME?this.dynamicTrendName!=b&&(this.dynamicTrendName=b,this.clearBufferData(),
this.updateRealTimeValueDataLink(this.dynamicTrendName)):this.bufferType==Y.HISTORY&&this.dynamicTrendName!=b&&(this.dynamicTrendName=b,this.clearBufferData(),this.hTrendName=b,this.updateHistoricValueDataLink(this.dynamicTrendName))}return!0};a.prototype.updateHistoricValueDataLink=function(a){for(var b in this.dataLinks){var h=this.dataLinks[b],d=h.getDataSrc();if("Value"==h.getAttribute()&&d.getUserId()!=this.studioId){h.unmount();h.updateDataSourceAttribute(a,-1);h.mount();break}}};a.prototype.updateRealTimeValueDataLink=
function(a){var b=this,h=!1,d;for(d in this.dataLinks){var g=this.dataLinks[d],f=g.getDataSrc();if("Value"==g.getAttribute()&&f.getUserId()!=this.studioId){g.updateDataSourceAttribute(a,-1);"TagMgrWgt"==f.getJMType()&&(f.isTagSubscribed(a)||f.subscribeDynamicTags());g.update();h=!0;break}}h||(h=this.project.getPageMgr())&&(h.isPrecaching()?h.waitPrecacheEnd().then(function(){return b.createRealTimeValueDataLink(a)}):this.createRealTimeValueDataLink(a))};a.prototype.createRealTimeValueDataLink=function(a){var b=
this.project.getTagMgr();f.createDataLink(this,b,{rw:"r",attr:"Value",tag:a,srcType:"Tag",dataSource:"_TagMgr",_tag:"",tagIndex:-1,wT:0}).update().mount();b.subscribeDynamicTags()};a.prototype.clearBufferData=function(){for(var a in this.dataLinks){var b=this.dataLinks[a];if(b.getDataSrc().getUserId()==this.studioId&&"Value"==b.getTag()){a=b.getTargetWidget();this.bufferType==Y.REALTIME?"TrendCurveWgt"==a.getJMType()&&(null!==this.timerRealTime&&(window.clearInterval(this.timerRealTime),this.timerRealTime=
null),this.value=void 0,this.currValueTs=null,this.buffer=Array(this.bufferSize),this.auxBuff=[],this.nextInsert=0,this.lastReadTagTs=this.currValueTs=null,this.outOfSyncGap=0,this.sendUpdate("web-value",this.buffer,null),this.startRealTimeSampling()):this.bufferType==Y.HISTORY&&(this.buffer=[],this.auxBuff=[],this.nextInsert=0,this.sendUpdate("web-value",this.buffer,null));break}}};a.prototype.generateGhostBufferSamples=function(){var a=!1,b=this.buffer.length;this._prevQuality=this._prevValue=this._prevTimeStamp=
null;this.auxBuff=[];for(--b;0<=b&&(0==b&&(a=!0),this.addBufferPoint(this.buffer[b],a));b--);};a.prototype.addBufferPoint=function(a,b){var f=u.import("Quality"),d=!1;if(!this.buffer)return d;var g=1E3*a.rts,k=a.v,f=new f(a.q),l=0,l=this.deltaTime,m=this.getTrendST(),p;1E3>m&&(m=1E3);l=Math.max(m,l);if(!this._prevTimeStamp)return d=this.inflateAndAddPoint(g,k,f),this._prevTimeStamp=g,this._prevValue=k,this._prevQuality=f,d;var m=this.hEndTime,q;q=(q=this.project.getSystemPropertiesMgr())?q.getTime():
(new Date).getTime();b?(p=g-this._prevTimeStamp,p>l&&(p=this._prevTimeStamp+p/l*l,p=g-p<=l/2?p-l:p,p<this._prevTimeStamp&&(p+=l),p>=this._prevTimeStamp&&p<=g&&(d=this.inflateAndAddPoint(p,this._prevValue,this._prevQuality))),k!=this._prevValue?d=this.inflateAndAddPoint(g,k,f):m<q-l&&(d=this.inflateAndAddPoint(g,k,f))):(p=g-this._prevTimeStamp,p>l&&(p=this._prevTimeStamp+p/l*l,p=g-p<=l/2?p-l:p,p<this._prevTimeStamp&&(p+=l),p>=this._prevTimeStamp&&p<=g&&this.inflateAndAddPoint(p,this._prevValue,this._prevQuality)),
d=this.inflateAndAddPoint(g,k,f),this._prevTimeStamp=g,this._prevValue=k,this._prevQuality=f);return d};a.prototype.inflateAndAddPoint=function(a,b,f){b=new V(a,b,f);f=this.hEndTime-this.hStartTime;if(a<this.hStartTime-f)0==this.auxBuff.length?this.auxBuff.push(b):this.auxBuff[0]=b;else{if(a>this.hEndTime+f)return this.auxBuff.push(b),!1;this.auxBuff.push(b)}return!0};a.prototype.getTrendST=function(){if(this.hTrendName)return $hmi.activeProject.getWidget("_TrendMgr",!0).getConfiguration()[this.hTrendPrefix].st};
a.prototype.getValue=function(a){if("Value"==a)return this.bufferType==Y.REALTIME?this.value:this.buffer;if("trend"==a){if(this.bufferType==Y.REALTIME)return this.dynamicTrendName}else return b.prototype.getValue.call(this,a)};a.prototype._orderByTime=function(){return 0==this.startTimeIdx?this.buffer.slice(0,this.stopTimeIdx+1):this.buffer.slice(this.startTimeIdx,this.bufferSize).concat(this.buffer.slice(0,this.stopTimeIdx+1))};a.prototype.subscribeDataLink=function(a){b.prototype.subscribeDataLink.call(this,
a);if(this.bufferType==Y.HISTORY){var e=a.dataSrc;e&&"IdalTrendWgt"==e.getJMType()&&"Value"==a.attr&&(this.rIdal=e,this.hTrendName=a.tag,this.hTrendPrefix=this.hTrendName.split(".")[0])}this.bufferType!=Y.REALTIME&&this.bufferType!=Y.HISTORY||a.tgtWgt.constructor!=F||"web-value"==a.attr||f.createDataLink(a.tgtWgt,this,{rw:a.rw,attr:"web-value",tag:"web-value",srcType:a.srcType,tagIndex:-1,xforms:a.xforms}).mount()};a.prototype.setHistoricParams=function(a,b,f){null==this.hStartTime&&(this.startThr=
a);null==this.hEndTime&&(this.endThr=b);var d=this.hEndTime-this.hStartTime;this.hStartTime=a;this.hEndTime=b;this.hMaxNSamples=f;this.rIdal&&(this.hStartTime<this.startThr-d/2||this.hEndTime>this.endThr+d/2||this.endThr-this.startThr!=b-a)&&(this.rIdal.updateBufferTimeDuration(this),this.startThr=a,this.endThr=b)};a.prototype.setDeltaTime=function(a){this.deltaTime=a};a.prototype.isHistoric=function(){return this.bufferType==Y.HISTORY};a.prototype.getStartTime=function(){return this.hStartTime};
a.prototype.getStopTime=function(){return this.hEndTime};a.prototype.getTrendName=function(){return this.hTrendName};a.prototype.getTrendNamePrefix=function(){return this.hTrendPrefix};a.prototype.getMaxSamplesNum=function(){return this.hMaxNSamples};a.prototype.getDeltaTime=function(){return this.deltaTime};a.prototype.destroy=function(){if(this.destroyed)return!1;this.unload();b.prototype.unbindEvents.call(this,{loadWgt:this.activateHandler,unloadWgt:this.deactivateHandler});return this.destroyed=
!0};a.jmType="TrendBufferWgt";return a}(l);f.fn.hmiTrendBufferWgt=function(b,a,c,e){return new Sb(this,b,a,c,e)};f.addWidgetDefinition("hmiTrendBufferWgt",Sb);var We=function(b){function a(a,e,f,d,g,k){return b.call(this,a,e,f,d,g,k)||this}p(a,b);return a}(qd),Xe="FTP HTTP CGI SOAP ICEE LOCAL SYSTEM_IDAL".split(" "),Ye="LOGIN LOGOUT ACK_ALARM ACTIVATE_ALARM ENABLE_ALARM DEACTIVATE_ALARM RESET_ALARM WRITE_TAG DISABLE_ALARM DOWNLOAD_RECIPE UPLOAD_RECIPE DUMP_RECIPE RESTORE_RECIPE RESET_RECIPE RENAME_RECIPE RENAME_RECIPE_SET RENAME_RECIPE_ELEMENT ADD_RECIPE_SET DEL_RECIPE_SET DUMP_ALL_RECIPE RESTORE_ALL_RECIPE RESET_ALL_RECIPE DATATRANSFER_WRITE_TAG CHANGE_PASSWORD ADDUSER DELETEUSER EDITUSER DUMP_TREND_BUFFER DUMP_ALARM_BUFFER DUMP_AUDIT_BUFFER DELETE_TREND_BUFFER DELETE_ALARM_BUFFER DELETE_AUDIT_BUFFER SYSTEM_RESET SYSTEM_RESTART SYSTEM_POWERON SYSTEM_UPDATE SYSTEM_BACKUP FTP_GET FTP_PUT OPEN_TEXT_EDITOR SAVE_TEXT_EDITOR LOG_MESSAGE DOWNLOAD_PROJECT SHOW_PROJECT_MANAGER SHOW_SYSTEM_SETTINGS PRINT_GFX_REPORT PRINT_EVENT PRINT_TEXT PRINT_BYTE PRINT_ABORT PRINT_PAUSE PRINT_RESUME PRINT_EMPTY_QUEUE RECIPE_WRITE_TAG SYSTEM_TIMECHANGE MOUNT_DEVICE".split(" "),
td=function(b){function a(a,e){var f=b.call(this)||this;f.date="";f.information="";f.interface="";f.operation="";f.recordId="";f.status="";f.time="";f.formattedTS="";f.userName="";if(e){var d=a.getFormattedTimestamp(1E3*e.ts),g=e.v_r[2].split(";");f.type=e.t;f.subtype=e.s;f.archiveType=e.at;f.recordId=e.id.toString();f.formattedTS=d.full;f.date=d.date;f.time=d.time;f.interface=Xe[Number(e.v_r[0])];f.operation=Ye[Number(e.v_r[1])];d=Number(g.shift());f.status=t.PROXY_S_OK==d?"S_OK":t.PROXY_E_FAIL==
d?"E_FAIL":t.PROXY_E_INVALIDARG==d?"E_INVALIDARG":t.PROXY_S_NODATA==d?"S_NODATA":t.PROXY_S_MOREDATA==d?"S_MOREDATA":t.PROXY_S_INACTIVE_NEED_NOTIFY==d?"S_INACTIVE_NEED_NOTIFY":t.PROXY_S_NEED_NOTIFY==d?"S_NEED_NOTIFY":t.PROXY_S_NEEDNOT_NOTIFY==d?"S_NEEDNOT_NOTIFY":t.PROXY_S_OK_PWD_WILL_EXPIRE==d?"S_OK_PWD_WILL_EXPIRE":t.PROXY_S_OK_NEED_PASWD_CHANGE==d?"S_OK_NEED_PASWD_CHANGE":t.PROXY_E_UNKNOWNTAG==d?"E_UNKNOWNTAG":t.PROXY_E_UNKNOWNGROUP==d?"E_UNKNOWNGROUP":t.PROXY_E_UNKNOWNTREND==d?"E_UNKNOWNTREND":
t.PROXY_E_UNKNOWNALARM==d?"E_UNKNOWNALARM":t.PROXY_E_INACTIVETAG==d?"E_INACTIVETAG":t.PROXY_E_INACTIVEGROUP==d?"E_INACTIVEGROUP":t.PROXY_E_INACTIVEALARM==d?"E_INACTIVEALARM":t.PROXY_E_READ_FORBIDDEN==d?"E_READ_FORBIDDEN":t.PROXY_E_WRITE_FORBIDDEN==d?"E_WRITE_FORBIDDEN":t.PROXY_E_BORDERS_EXCEEDED==d?"E_BORDERS_EXCEEDED":t.PROXY_E_NOT_BINDED_TO_PROTOCOL==d?"E_NOT_BINDED_TO_PROTOCOL":t.PROXY_E_NOT_BINDED_TO_TAG==d?"E_NOT_BINDED_TO_TAG":t.PROXY_METHOD_NOT_SUPPORTED==d?"METHOD_NOT_SUPPORTED":t.PROXY_E_NONEXISTING_SUBTYPE==
d?"E_NONEXISTING_SUBTYPE":t.PROXY_E_NONEXISTING_TYPE==d?"E_NONEXISTING_TYPE":t.PROXY_E_UNKNOWNARCHIVE==d?"E_UNKNOWNARCHIVE":t.PROXY_E_NO_OBJECTS_FOUND==d?"E_NO_OBJECTS_FOUND":t.PROXY_E_CONFIGMODE_REQUIRED==d?"E_CONFIGMODE_REQUIRED":t.PROXY_E_COULD_NOT_START==d?"E_COULD_NOT_START":t.PROXY_E_COULD_NOT_STOP==d?"E_COULD_NOT_STOP":t.PROXY_E_COULD_NOT_RELOAD_FROM_FILE==d?"E_COULD_NOT_RELOAD_FROM_FILE":t.PROXY_E_COULD_NOT_RESET_WARM==d?"E_COULD_NOT_RESET_WARM":t.PROXY_E_COULD_NOT_RESET_COLD==d?"E_COULD_NOT_RESET_COLD":
t.PROXY_E_COULD_NOT_RESET_HARD==d?"E_COULD_NOT_RESET_HARD":t.PROXY_E_MODE_SWITCH_ALREADY_UNDERWAY==d?"E_MODE_SWITCH_ALREADY_UNDERWAY":t.PROXY_E_ALREADYINOPERATINGMODE==d?"E_ALREADYINOPERATINGMODE":t.PROXY_E_ALREADYINCONFIGMODE==d?"E_ALREADYINCONFIGMODE":t.PROXY_E_FILENOTEXIST==d?"E_FILENOTEXIST":t.PROXY_E_FILEOPENFAIL==d?"E_FILEOPENFAIL":t.PROXY_E_FILEREADFAIL==d?"E_FILEREADFAIL":t.PROXY_E_PATHCREATEFAIL==d?"E_PATHCREATEFAIL":t.PROXY_E_FILECREATEFAIL==d?"E_FILECREATEFAIL":t.PROXY_E_FILEWRITEFAIL==
d?"E_FILEWRITEFAIL":t.PROXY_E_PROPERTYMAP_FILE_NOT_FOUND==d?"E_PROPERTYMAP_FILE_NOT_FOUND":t.PROXY_E_PROPERTY_NOT_MAPPED==d?"E_PROPERTY_NOT_MAPPED":t.PROXY_E_RESOURCE_LOCATOR_NOT_FOUND==d?"E_RESOURCE_LOCATOR_NOT_FOUND":t.PROXY_E_INVALID_PROPERTY==d?"E_INVALID_PROPERTY":t.PROXY_E_UNKNOWN_GROUP_TYPE==d?"E_UNKNOWN_GROUP_TYPE":t.PROXY_E_CONFIG_FILE_NOT_FOUND==d?"E_CONFIG_FILE_NOT_FOUND":t.PROXY_E_ALREADYEXISTS==d?"E_ALREADYEXISTS":t.PROXY_E_INVALID_RESOURCE_LOCATOR==d?"E_INVALID_RESOURCE_LOCATOR":t.PROXY_E_NO_PROPERTY_FOUND==
d?"E_NO_PROPERTY_FOUND":t.PROXY_E_PARAMETER_DOES_NOT_EXIST==d?"E_PARAMETER_DOES_NOT_EXIST":t.PROXY_E_MODULE_NOT_PRESENT_FOR_THIS_PARAMETER==d?"E_MODULE_NOT_PRESENT_FOR_THIS_PARAMETER":t.PROXY_E_REQUIRE_DEINIT==d?"E_REQUIRE_DEINIT":t.PROXY_E_UNAUTHORIZED_USER==d?"E_UNAUTHORIZED_USER":t.PROXY_E_FORBIDDEN==d?"E_FORBIDDEN":t.PROXY_E_PROXY_NOT_INITED==d?"E_PROXY_NOT_INITED":t.PROXY_E_UNKNOWNLEASEID==d?"E_UNKNOWNLEASEI":t.PROXY_E_INACTIVETREND==d?"E_INACTIVETREND":t.PROXY_E_COMM_BUSY==d?"E_COMM_BUSY":t.PROXY_E_NO_SESSION_EXIST==
d?"E_NO_SESSION_EXIST":t.PROXY_E_PASS_DONT_MATCH==d?"E_PASS_DONT_MATCH":t.PROXY_E_USER_ALREADY_EXIST==d?"E_USER_ALREADY_EXIST":t.PROXY_E_NO_GROUP_SPECIFIED==d?"E_NO_GROUP_SPECIFIED":t.PROXY_E_GROUP_DONT_EXIST==d?"E_GROUP_DONT_EXIST":t.PROXY_E_USER_DONT_EXIST==d?"E_USER_DONT_EXIST":t.PROXY_E_ALARM_NOTENABLED==d?"E_ALARM_NOTENABLED":t.PROXY_E_UNKNOWN_SUBSCRIPTION==d?"E_UNKNOWN_SUBSCRIPTION":t.PROXY_E_SESSION_EXPIRED==d?"E_SESSION_EXPIRED":t.PROXY_E_SESSION_ALREADY_EXIST==d?"E_SESSION_ALREADY_EXIS":
t.PROXY_E_LOGIN_FAIL==d?"E_LOGIN_FAIL":t.PROXY_E_RE_LOGIN_ATTEMPT==d?"E_RE_LOGIN_ATTEMPT":t.PROXY_E_NEED_LOGIN==d?"E_NEED_LOGIN":t.PROXY_E_FTP_READ_FORBIDDEN==d?"E_FTP_READ_FORBIDDEN":t.PROXY_E_FTP_WRITE_FORBIDDEN==d?"E_FTP_WRITE_FORBIDDEN":t.PROXY_E_SIMILAR_PREV_PSWD==d?"E_SIMILAR_PREV_PSWD":t.PROXY_E_PASSWORD_TOO_SHORT==d?"E_PASSWORD_TOO_SHORT":t.PROXY_E_MUST_CONTAIN_NUMBERS==d?"E_MUST_CONTAIN_NUMBERS":t.PROXY_E_MUST_CONTAIN_SPECIAL_CHAR==d?"E_MUST_CONTAIN_SPECIAL_CHAR":t.PROXY_E_CHANGE_PASSWORD==
d?"E_CHANGE_PASSWORD":t.PROXY_E_ACCES_DENIED==d?"E_ACCES_DENIED":t.PROXY_E_ILLEGAL_FORMAT==d?"E_ILLEGAL_FORMAT":t.PROXY_E_NOT_ALLOWED==d?"E_NOT_ALLOWED":t.PROXY_E_PASSWORD_EXPIRED==d?"E_PASSWORD_EXPIRED":"E_FAIL";f.userName=g.shift();f.information=g.join(";")}else f.recordId=a.getTitleValue("recordID"),f.interface=a.getTitleValue("Interface"),f.operation=a.getTitleValue("Operation"),f.status=a.getTitleValue("Status"),f.userName=a.getTitleValue("UserName"),f.information=a.getTitleValue("Information"),
f.formattedTS=a.getTitleValue("Timestamp"),f.date=a.getTitleValue("Date"),f.time=a.getTitleValue("Time");return f}p(a,b);a.prototype.getDynamicFieldData=function(a){return"Operation"===a?this.operation:"Interface"===a?this.interface:"Timestamp"===a?this.formattedTS:"Status"===a?this.status:"Date"===a?this.date:"Time"===a?this.time:"recordID"===a?this.recordId.toString():"UserName"===a?this.userName:"Information"===a?this.information:""};a.prototype.getBGColor=function(){return"trasparent"};a.prototype.setVisibility=
function(a){this.visible=a};a.prototype.getVisibility=function(){return this.visible};return a}(qc),t;(function(b){b[b.PROXY_E_MUST_CONTAIN_NUMBERS_AND_SP_CHAR=-84]="PROXY_E_MUST_CONTAIN_NUMBERS_AND_SP_CHAR";b[b.PROXY_E_UNIMPLEMENTED=-83]="PROXY_E_UNIMPLEMENTED";b[b.PROXY_E_OPERATION_TIMEOUTED=-80]="PROXY_E_OPERATION_TIMEOUTED";b[b.PROXY_E_DEBUGGER_ACTIVE=-79]="PROXY_E_DEBUGGER_ACTIVE";b[b.PROXY_E_TOO_MANY_USERS=-78]="PROXY_E_TOO_MANY_USERS";b[b.PROXY_E_PASSWORD_EXPIRED=-77]="PROXY_E_PASSWORD_EXPIRED";
b[b.PROXY_E_SIMILAR_PREV_PSWD=-76]="PROXY_E_SIMILAR_PREV_PSWD";b[b.PROXY_E_PASSWORD_TOO_SHORT=-75]="PROXY_E_PASSWORD_TOO_SHORT";b[b.PROXY_E_MUST_CONTAIN_NUMBERS=-74]="PROXY_E_MUST_CONTAIN_NUMBERS";b[b.PROXY_E_MUST_CONTAIN_SPECIAL_CHAR=-73]="PROXY_E_MUST_CONTAIN_SPECIAL_CHAR";b[b.PROXY_E_CHANGE_PASSWORD=-72]="PROXY_E_CHANGE_PASSWORD";b[b.PROXY_E_ACCES_DENIED=-71]="PROXY_E_ACCES_DENIED";b[b.PROXY_E_ILLEGAL_FORMAT=-70]="PROXY_E_ILLEGAL_FORMAT";b[b.PROXY_E_NOT_ALLOWED=-69]="PROXY_E_NOT_ALLOWED";b[b.PROXY_E_FTP_WRITE_FORBIDDEN=
-68]="PROXY_E_FTP_WRITE_FORBIDDEN";b[b.PROXY_E_FTP_READ_FORBIDDEN=-67]="PROXY_E_FTP_READ_FORBIDDEN";b[b.PROXY_E_NEED_LOGIN=-66]="PROXY_E_NEED_LOGIN";b[b.PROXY_E_RE_LOGIN_ATTEMPT=-65]="PROXY_E_RE_LOGIN_ATTEMPT";b[b.PROXY_E_LOGIN_FAIL=-64]="PROXY_E_LOGIN_FAIL";b[b.PROXY_E_SESSION_ALREADY_EXIST=-63]="PROXY_E_SESSION_ALREADY_EXIST";b[b.PROXY_E_SESSION_EXPIRED=-62]="PROXY_E_SESSION_EXPIRED";b[b.PROXY_E_NO_SESSION_EXIST=-61]="PROXY_E_NO_SESSION_EXIST";b[b.PROXY_E_PASS_DONT_MATCH=-60]="PROXY_E_PASS_DONT_MATCH";
b[b.PROXY_E_USER_ALREADY_EXIST=-59]="PROXY_E_USER_ALREADY_EXIST";b[b.PROXY_E_NO_GROUP_SPECIFIED=-58]="PROXY_E_NO_GROUP_SPECIFIED";b[b.PROXY_E_GROUP_DONT_EXIST=-57]="PROXY_E_GROUP_DONT_EXIST";b[b.PROXY_E_USER_DONT_EXIST=-56]="PROXY_E_USER_DONT_EXIST";b[b.PROXY_E_ALARM_NOTENABLED=-55]="PROXY_E_ALARM_NOTENABLED";b[b.PROXY_E_UNKNOWN_SUBSCRIPTION=-54]="PROXY_E_UNKNOWN_SUBSCRIPTION";b[b.PROXY_E_COMM_BUSY=-53]="PROXY_E_COMM_BUSY";b[b.PROXY_E_INACTIVETREND=-52]="PROXY_E_INACTIVETREND";b[b.PROXY_E_UNKNOWNLEASEID=
-51]="PROXY_E_UNKNOWNLEASEID";b[b.PROXY_E_PROXY_NOT_INITED=-50]="PROXY_E_PROXY_NOT_INITED";b[b.PROXY_E_FORBIDDEN=-49]="PROXY_E_FORBIDDEN";b[b.PROXY_E_UNAUTHORIZED_USER=-48]="PROXY_E_UNAUTHORIZED_USER";b[b.PROXY_E_REQUIRE_DEINIT=-47]="PROXY_E_REQUIRE_DEINIT";b[b.PROXY_E_MODULE_NOT_PRESENT_FOR_THIS_PARAMETER=-46]="PROXY_E_MODULE_NOT_PRESENT_FOR_THIS_PARAMETER";b[b.PROXY_E_PARAMETER_DOES_NOT_EXIST=-45]="PROXY_E_PARAMETER_DOES_NOT_EXIST";b[b.PROXY_E_NO_PROPERTY_FOUND=-44]="PROXY_E_NO_PROPERTY_FOUND";
b[b.PROXY_E_INVALID_RESOURCE_LOCATOR=-43]="PROXY_E_INVALID_RESOURCE_LOCATOR";b[b.PROXY_E_ALREADYEXISTS=-42]="PROXY_E_ALREADYEXISTS";b[b.PROXY_E_CONFIG_FILE_NOT_FOUND=-41]="PROXY_E_CONFIG_FILE_NOT_FOUND";b[b.PROXY_E_UNKNOWN_GROUP_TYPE=-40]="PROXY_E_UNKNOWN_GROUP_TYPE";b[b.PROXY_E_INVALID_PROPERTY=-39]="PROXY_E_INVALID_PROPERTY";b[b.PROXY_E_RESOURCE_LOCATOR_NOT_FOUND=-38]="PROXY_E_RESOURCE_LOCATOR_NOT_FOUND";b[b.PROXY_E_PROPERTY_NOT_MAPPED=-37]="PROXY_E_PROPERTY_NOT_MAPPED";b[b.PROXY_E_PROPERTYMAP_FILE_NOT_FOUND=
-36]="PROXY_E_PROPERTYMAP_FILE_NOT_FOUND";b[b.PROXY_E_FILEWRITEFAIL=-35]="PROXY_E_FILEWRITEFAIL";b[b.PROXY_E_FILECREATEFAIL=-34]="PROXY_E_FILECREATEFAIL";b[b.PROXY_E_PATHCREATEFAIL=-33]="PROXY_E_PATHCREATEFAIL";b[b.PROXY_E_FILEREADFAIL=-32]="PROXY_E_FILEREADFAIL";b[b.PROXY_E_FILEOPENFAIL=-31]="PROXY_E_FILEOPENFAIL";b[b.PROXY_E_FILENOTEXIST=-30]="PROXY_E_FILENOTEXIST";b[b.PROXY_E_ALREADYINCONFIGMODE=-29]="PROXY_E_ALREADYINCONFIGMODE";b[b.PROXY_E_ALREADYINOPERATINGMODE=-28]="PROXY_E_ALREADYINOPERATINGMODE";
b[b.PROXY_E_MODE_SWITCH_ALREADY_UNDERWAY=-27]="PROXY_E_MODE_SWITCH_ALREADY_UNDERWAY";b[b.PROXY_E_COULD_NOT_RESET_HARD=-26]="PROXY_E_COULD_NOT_RESET_HARD";b[b.PROXY_E_COULD_NOT_RESET_COLD=-25]="PROXY_E_COULD_NOT_RESET_COLD";b[b.PROXY_E_COULD_NOT_RESET_WARM=-24]="PROXY_E_COULD_NOT_RESET_WARM";b[b.PROXY_E_COULD_NOT_RELOAD_FROM_FILE=-23]="PROXY_E_COULD_NOT_RELOAD_FROM_FILE";b[b.PROXY_E_COULD_NOT_STOP=-22]="PROXY_E_COULD_NOT_STOP";b[b.PROXY_E_COULD_NOT_START=-21]="PROXY_E_COULD_NOT_START";b[b.PROXY_E_CONFIGMODE_REQUIRED=
-20]="PROXY_E_CONFIGMODE_REQUIRED";b[b.PROXY_E_NO_OBJECTS_FOUND=-19]="PROXY_E_NO_OBJECTS_FOUND";b[b.PROXY_E_UNKNOWNARCHIVE=-18]="PROXY_E_UNKNOWNARCHIVE";b[b.PROXY_E_NONEXISTING_TYPE=-17]="PROXY_E_NONEXISTING_TYPE";b[b.PROXY_E_NONEXISTING_SUBTYPE=-16]="PROXY_E_NONEXISTING_SUBTYPE";b[b.PROXY_METHOD_NOT_SUPPORTED=-15]="PROXY_METHOD_NOT_SUPPORTED";b[b.PROXY_E_NOT_BINDED_TO_TAG=-14]="PROXY_E_NOT_BINDED_TO_TAG";b[b.PROXY_E_NOT_BINDED_TO_PROTOCOL=-13]="PROXY_E_NOT_BINDED_TO_PROTOCOL";b[b.PROXY_E_BORDERS_EXCEEDED=
-12]="PROXY_E_BORDERS_EXCEEDED";b[b.PROXY_E_WRITE_FORBIDDEN=-11]="PROXY_E_WRITE_FORBIDDEN";b[b.PROXY_E_READ_FORBIDDEN=-10]="PROXY_E_READ_FORBIDDEN";b[b.PROXY_E_INACTIVEALARM=-9]="PROXY_E_INACTIVEALARM";b[b.PROXY_E_INACTIVEGROUP=-8]="PROXY_E_INACTIVEGROUP";b[b.PROXY_E_INACTIVETAG=-7]="PROXY_E_INACTIVETAG";b[b.PROXY_E_UNKNOWNALARM=-6]="PROXY_E_UNKNOWNALARM";b[b.PROXY_E_UNKNOWNTREND=-5]="PROXY_E_UNKNOWNTREND";b[b.PROXY_E_UNKNOWNGROUP=-4]="PROXY_E_UNKNOWNGROUP";b[b.PROXY_E_UNKNOWNTAG=-3]="PROXY_E_UNKNOWNTAG";
b[b.PROXY_E_INVALIDARG=-2]="PROXY_E_INVALIDARG";b[b.PROXY_E_FAIL=-1]="PROXY_E_FAIL";b[b.PROXY_S_OK_NEED_PASWD_CHANGE=0]="PROXY_S_OK_NEED_PASWD_CHANGE";b[b.PROXY_S_OK_PWD_WILL_EXPIRE=1]="PROXY_S_OK_PWD_WILL_EXPIRE";b[b.PROXY_S_NEEDNOT_NOTIFY=2]="PROXY_S_NEEDNOT_NOTIFY";b[b.PROXY_S_NEED_NOTIFY=3]="PROXY_S_NEED_NOTIFY";b[b.PROXY_S_INACTIVE_NEED_NOTIFY=4]="PROXY_S_INACTIVE_NEED_NOTIFY";b[b.PROXY_S_MOREDATA=5]="PROXY_S_MOREDATA";b[b.PROXY_S_NODATA=6]="PROXY_S_NODATA";b[b.PROXY_S_OK=7]="PROXY_S_OK"})(t||
(t={}));var Yb=function(){function b(a){this.getRecipesConf=function(){return this._getConf("recipes.json")};this.getTableDataSource=function(a){return $.ajax({type:"GET",dataType:"json",url:this.webProjectUrl+"/datasources/"+a})};this.configuration={};this.defConf=null;this.projectPath="";this.loginStatus=!1;this.conf={exception:{ipad1:!1},ssemode:0};this.url=window.location.protocol+"//"+window.location.host;this.pathName=window.location.pathname;this.projectName=a.projectName;var b=-1,b=this.pathName.indexOf("/web/web/pages");
-1==b&&(b=this.pathName.indexOf("/web/web/umtemplates"));-1==b&&(b=this.pathName.indexOf("/web/web/_"));this.endpoint="";-1<b&&(b=this.pathName.substring(0,b).split("/"),this.endpoint=b.slice(0,b.length-1).join("/"),this.url+=this.endpoint);for(var e in a)this[e]=a[e]}b.prototype.loadLoginUI=function(a,b){location.href=this.url+"/index.html"+(a?"?denyDefUser=true":"?denyDefUser=false")+(b?"&forceLogin=true":"&forceLogin=false")};b.prototype.loadIndex=function(){location.href=this.url+"/index.html"};
b.prototype.getProjectInformation=function(){var a=this;return-1!=this[this.active].status?this.getProperty("projectRelativePath",!1).then(function(b){var e=b.getMessageStatus().getValue();e==x.status.S_OK?(a.projectPath=b.getValue().substring(10),a.webProjectUrl=a.url+"/"+a.projectPath+"/web/web",a.loginStatus=!0):e==x.status.E_PROPERTY_NOT_MAPPED&&(a.webProjectUrl=a.url+"/web",a.loginStatus=!0)},function(b){b.getMessageStatus().getValue()==x.status.E_NEED_LOGIN&&(location.href=a.url+a.getLoginRoute())}):
Promise.resolve(void 0)};b.prototype.getOptions=function(){return this.conf};b.prototype.setUrl=function(a){this.url=a};b.prototype.isLogged=function(){return this.loginStatus};b.prototype.getProperty=function(a,b){return A({url:this.url+"/cgi/getProperties",data:"n=1&it1="+a,async:!b,cache:!1}).then(function(a){var b=new na;a=a.split("\t");var c=a[1].trim();return"S_OK"==c?b.setState(a[0],a[2],c):b.setState(a[0],null,c)},function(a){var b=new na;return a.responseText?b.setState(null,null,a.responseText.trim().replace("#",
"")):b.setState(null,null,"E_TIMEOUT")})};b.prototype.activateTag=function(a,b,e){return A({type:"POST",url:this.url+"/cgi/"+(b?"":"de")+"activateTags",data:"n=1&t1="+a,async:e})};b.prototype.activateTagSync=function(a,b){return Z({type:"GET",url:this.url+"/cgi/"+(b?"":"de")+"activateTags",data:"n=1&t1="+a,cache:!1})};b.prototype.requestConf=function(){this.defConf=A({type:"GET",url:this.webProjectUrl+"/config/conf.json",cache:!1}).then(function(a){return a?JSON.parse(a):{}})};b.prototype.getConf=
function(){return this.defConf};b.prototype.getAlarmConf=function(){return A({type:"GET",url:this.webProjectUrl+"/config/alarms.json",cache:!1}).then(function(a){return null!=a?JSON.parse(a):{}},function(){return{}})};b.prototype._getConf=function(a){return A({type:"GET",url:this.webProjectUrl+"/config/"+a,cache:!1}).then(function(a){return a?JSON.parse(a):{}})};b.prototype.getPropsMap=function(){return this._getConf("propsMap.json")};b.prototype.getGroupsConf=function(){return this._getConf("groups.json")};
b.prototype.getTagsConf=function(){return this._getConf("tags.json")};b.prototype.getTrendsConf=function(){return this._getConf("trends.json")};b.prototype.readTags=function(a,b){for(var e="",f=a.length,d=0;d<f;d++)e+="&t"+(d+1)+"="+a[d];var e="n="+f+e+"&nocache=1",g=this,k=u.getModule("Tag");return this.activateTags(a,b).then(function(a){if(0<=a.indexOf("S_OK"))return $.ajax({type:"POST",dataType:"json",url:g.url+"/cgi/readTags.json",data:e,async:!b})}).then(function(a){var b=[];if(null!=a)for(var c=
0;c<a.tgs.length;c++){var d=a.tgs[c];b.push((new k).setState(d.name,-1,d.value,d.code,d.quality))}return b}).catch(function(a){return[]})};b.prototype.activateTags=function(a,b){return this._activateTags(a,!0,b)};b.prototype.deactivateTags=function(a,b){return this._activateTags(a,!1,b)};b.prototype._activateTags=function(a,b,e){for(var f="",d=a.length,g=0;g<d;g++)f+="&t"+(g+1)+"="+a[g];return A({type:"POST",url:this.url+"/cgi/"+(b?"":"de")+"activateTags",data:"n="+d+f,async:!e})};b.prototype.readTag=
function(a){return this._readTagsJsonAsynch(a.name,a.index)};b.prototype.readTagSync=function(a){return this._readTagsJsonSync(a.name,a.index)};b.prototype._readTagsJsonSync=function(a,b){var e=this.url+"/cgi/readTags.json",f="returnType=true&returnTS=true&n=1&t1="+encodeURIComponent(a)+"."+b+"&nocache=1",d=new B,g=this.activateTagSync(a,!0);200<=g.status&&400>g.status?(g=g.data,0<=g.indexOf("S_OK")?(e=Z({url:e,data:f}),200<=e.status&&400>e.status?(e=e.data,null!=e?(e=JSON.parse(e).tgs[0],d.setState(e.quality,
e.value,e.type,e.code,e.ts),this.activateTag(a,!1,!0)):d.setMessageCode(x.status.E_FAIL)):d.setMessageCode(x.status.E_TIMEOUT)):0<=g.indexOf("E_UNKNOWNTAG")?d.setMessageCode(x.status.E_UNKNOWNTAG):d.setMessageCode(x.status.E_FAIL)):d.setMessageCode(x.status.E_TIMEOUT);return d};b.prototype._readTagsJsonAsynch=function(a,b){var e=this.url+"/cgi/readTags.json",h="returnType=true&returnTS=true&n=1&t1="+encodeURIComponent(a)+"."+b+"&nocache=1",d=this;return this.activateTag(a,!0,!0).then(function(a){if(0<=
a.indexOf("S_OK"))return $.getJSON(e,h);if(0<=a.indexOf("E_UNKNOWNTAG")){a=a.split("\t");var b=new x("E_UNKNOWNTAG");f.showErrorMessage("ServerInterface","ActivateTag",b.toString()+": "+a[0])}return null}).then(function(b){var c=new B;null!=b&&(b=b.tgs[0],c.setState(b.quality,b.value,b.type,b.code,b.ts),d.activateTag(a,!1,!0));return c}).catch(function(){var a=new B;a.setMessageCode(x.status.E_TIMEOUT);return a})};b.prototype.writeTag=function(a,b,e,f){return f?this._writeTagSync(a,b,e):this._writeTagAsync(a,
b,e)};b.prototype._writeTagAsync=function(a,b,e){a="n=1&t1="+encodeURIComponent(a.name)+"."+a.index+"&v1="+encodeURIComponent(b)+"&nocache=1";return A({type:"POST",url:this.url+"/cgi/writeTags.json",data:a,timeout:3E4,async:!0}).then(function(a){if(null!=a){var b=JSON.parse(a);e.setState(b.tgs[0])}return b})};b.prototype._writeTagSync=function(a,b,e){e=this.url+"/cgi/writeTags.json";b="n=1&t1="+encodeURIComponent(a.name)+"."+a.index+"&v1="+encodeURIComponent(b)+"&nocache=1";a=new B;e=Z({url:e,data:b});
200<=e.status&&400>e.status?(e=e.data,null!=e?(e=JSON.parse(e).tgs[0],a.setState(e.quality,e.value,e.type,e.code,e.ts)):a.setMessageCode(x.status.E_FAIL)):a.setMessageCode(x.status.E_TIMEOUT);return a};b.prototype.readGroup=function(a,b,e){return e?this.readGroupJsonSync(a,b):this.readGroupJsonAsync(a,b)};b.prototype.readGroupJsonAsync=function(a,b){return A({type:"GET",url:this.url+"/cgi/readGroups.json",data:"n=1&gr1="+encodeURIComponent(a),cache:!1,timeout:12E3}).then(function(a){return a?(a=JSON.parse(a).gs[0],
b.setState(a.g.name,a.g.code,a.tgs),b):{}})};b.prototype.readGroupJsonSync=function(a,b){return $.ajax({type:"GET",dataType:"JSON",url:this.url+"/cgi/readGroups.json",data:"n=1&gr1="+encodeURIComponent(a),cache:!1,timeout:12E3,async:!1}).then(function(a){if(a){a=JSON.parse(a);var f=a.gs[0];b.setState(f.g.name,f.g.code,f.tgs);return a}return{}})};b.prototype.readGroups=function(a,b,e){return e?this.readGroupsSync(a,b):this.readGroupsAsync(a,b)};b.prototype.readGroupsSync=function(a,b){for(var e=this,
f=a.length,d="",g=1;g<=f;g++)d+="gr"+g+"="+a[g-1],g!=f&&(d+="&");return $.ajax({type:"GET",dataType:"JSON",url:this.url+"/cgi/readGroups.json",data:"n="+f+"&"+encodeURIComponent(d),cache:!1,timeout:12E3,async:!1}).then(function(a){a&&e.consumeReadGroups(a,b);return b})};b.prototype.readGroupsAsync=function(a,b){for(var e=this,f=a.length,d="",g=1;g<=f;g++)d+="gr"+g+"="+a[g-1],g!=f&&(d+="&");return A({type:"GET",url:this.url+"/cgi/readGroups.json",data:"n="+f+"&"+encodeURIComponent(d),cache:!1,async:!0,
timeout:12E3}).then(function(a){a&&(a=JSON.parse(a),e.consumeReadGroups(a,b));return b})};b.prototype.consumeReadGroups=function(a,b){for(var e=u.getModule("Tag"),f=0;f<a.gs.length;f++){var d=a.gs[f],g=[];if(d.tgs)for(var k=d.tgs.length,l=0;l<k;l++){var m=d.tgs[l];g.push((new e).setState(m.name,-1,m.value,m.code,m.quality))}b[f].setState(d.g.name,d.g.code,g)}};b.prototype.activateGroup=function(a,b,e){return e?this._activateGroupsJsonSync([a],[b],!0):this._activateGroupsJsonAsync([a],[b],!0)};b.prototype.deactivateGroup=
function(a,b,e){return e?this._activateGroupsJsonSync([a],[b],!1):this._activateGroupsJsonAsync([a],[b],!1)};b.prototype.activateGroups=function(a,b,e){return e?this._activateGroupsJsonSync(a,b,!0):this._activateGroupsJsonAsync(a,b,!0)};b.prototype.deactivateGroups=function(a,b,e){return e?this._activateGroupsJsonSync(a,b,!1):this._activateGroupsJsonAsync(a,b,!1)};b.prototype._activateGroupsJsonAsync=function(a,b,e){for(var f=this,d=this.url,g=a.length,k="",l=1;l<=g;l++)k+="gr"+l+"="+a[l-1],l!=g&&
(k+="&");return A({type:"GET",url:e?d+"/cgi/activateGroups.json":d+"/cgi/deactivateGroups.json",data:"n="+g+"&"+encodeURIComponent(k),async:!0}).then(function(a){a&&(a=JSON.parse(a),f.consumeActivateGroupResponse(a,e,b));return b})};b.prototype._activateGroupsJsonSync=function(a,b,e){for(var f=this,d=this.url,g=a.length,k="",l=1;l<=g;l++)k+="gr"+l+"="+a[l-1],l!=g&&(k+="&");return $.ajax({type:"GET",dataType:"JSON",url:e?d+"/cgi/activateGroups.json":d+"/cgi/deactivateGroups.json",data:"n="+g+"&"+encodeURIComponent(k),
cache:!1,timeout:12E3,async:!1}).then(function(a){f.consumeActivateGroupResponse(a,e,b);return b})};b.prototype.consumeActivateGroupResponse=function(a,b,e){if(a)for(var f=0;f<a.gs.length;f++){var d=a.gs[f];b&&e[f].setState(d.name,d.code,null)}};b.prototype.getDLSSettings=function(a){return A({type:"GET",url:this.url+"/cgi/getDLSSettings",async:!a}).then(function(a){a=a.split("\n");var b={};"#S_OK"==a[0]?(b.status=a[0],b.stdoff=parseFloat(a[1]),b.stdw=parseFloat(a[2]),b.stdd=parseFloat(a[3]),b.stdm=
parseFloat(a[4]),b.stdhh=parseFloat(a[5]),b.stdmm=parseFloat(a[6]),b.dlsoff=parseFloat(a[7]),b.dlsw=parseFloat(a[8]),b.dlsd=parseFloat(a[9]),b.dlsm=parseFloat(a[10]),b.dlshh=parseFloat(a[11]),b.dlsmm=parseFloat(a[12]),b.mode=parseFloat(a[13])):b.status=a[0];return b})};b.prototype.getLocalTime=function(a){return A({type:"GET",url:this.url+"/cgi/getLocalTime",async:!a}).then(function(a){a=a.split("\n");var b={};"#S_OK"==a[0]?(b.status=a[0],b.time=a[1]):b.status=a[0];return b})};b.prototype.setLocalTime=
function(a,b,e,f,d,g,k){return A({type:"GET",url:this.url+"/cgi/setLocalTime",data:"sec="+a+"&min="+b+"&hour="+e+"&day="+f+"&month="+d+"&year="+g,async:!k}).then(function(a){return{status:a}})};b.prototype.getTime=function(a){return A({type:"GET",url:this.url+"/cgi/getTime?nocache=1",async:!a}).then(function(a){a=a.split("\n");var b={};"#S_OK"==a[0]?(b.status=a[0],b.time=1E3*parseFloat(a[1])):b.status=a[0];return b})};b.prototype.setTime=function(a,b){return A({type:"GET",url:this.url+"/cgi/setTime",
data:"time="+a,async:!b}).then(function(a){return{status:a}})};b.prototype.readAlarms=function(a,b){for(var e="",f=0,d=a.length,g=0;g<d;g++)e+="&al"+ ++f+"="+a[g];return A({type:"POST",url:this.url+"/cgi/readAlarms",data:"n="+f+e,timeout:12E3,async:!b}).then(function(a){return a})};b.prototype.resetAlarms=function(a,b){for(var e="",f=0,d=a.length,g=0;g<d;g++)e+="&al"+ ++f+"="+a[g];return A({type:"POST",url:this.url+"/cgi/resetAlarms",data:"n="+f+e,async:!b})};b.prototype.acknowledgeAlarms=function(a,
b){for(var e="",f=0,d=a.length,g=0;g<d;g++)e+="&al"+ ++f+"="+a[g];return A({type:"POST",url:this.url+"/cgi/acknowledgeAlarms",data:"n="+f+e,async:!b})};b.prototype.enableAlarms=function(a,b,e){for(var f="",d=0,g=a.length,k=0;k<g;k++)f+="&al"+ ++d+"="+a[k];return A({type:"POST",url:this.url+"/cgi/enableAlarms",data:"n="+d+f+"&enableflag="+b,async:!e})};b.prototype.saveConfiguration=function(a){return A({type:"GET",url:this.url+"/cgi/saveConfiguration",cache:!1,async:!a})};b.prototype.readEvent=function(a,
b){return this._GET(this.url+"/cgi/readEvent.json",a.toURL(),!1)};b.prototype.getLoginRoute=function(){var a="_web";/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)?a="_mobi":/iPad|RIM Tablet OS/i.test(navigator.userAgent)&&(a="_tablet");return"/public/"+a+"login.html?_="+(new Date).getTime()};b.prototype.deleteEventArchive=function(a){return A({type:"GET",url:this.url+"/cgi/deleteEventArchive",data:"archive="+a,timeout:12E3})};b.prototype.deleteTrend=function(a,b){return this._GET(this.url+
"/cgi/deleteTrendFile.json","tr="+encodeURIComponent(a),b)};b.prototype.dumpTrend=function(a,b){var e=this.url+"/cgi/dumpTrendFile.json",f="tr="+encodeURIComponent(a.n)+"&folder="+a.f+"&dformat="+a.fmt+"&dtPrefix="+a.dt+"&localTs="+a.dts;a.fnformat&&(f+="&fformat="+encodeURIComponent(a.fnformat));a.csvfields&&(f+="&csvfields="+a.csvfields);a.csvlogs&&(f+="&csvlogs="+a.csvlogs);a.dtformat&&(f+="&dtformat="+a.dtformat);a.langcode&&(f+="&lang="+a.langcode);return this._POST(e,f,b)};b.prototype.readTrend=
function(a,b,e,f,d){a="tr="+encodeURIComponent(a)+"&returnTS=true&returnRT=false&startTime="+parseInt((b/1E3).toString())+"&endTime="+parseInt((e/1E3).toString());a=f?a+("&nSamples="+f):a+"&nSamples=0";a=(d?a+("&deltaTime="+d):a+"&deltaTime=0")+"&bounds=true";var g=u.getModule("Quality");return A({type:"GET",url:this.url+"/cgi/readTrend.json",data:a,timeout:12E3}).then(function(a){a=JSON.parse(a);var b={n:a.n,d:null};if("S_OK"==a.code||"S_MOREDATA"==a.code){var c=a.d.length;b.d=Array(c);for(var d=
0;d<c;d++){var e=a.d[d],f=new g(e.q);f.isQualityBad()&&(e.v=void 0);b.d[d]=new V(1E3*e.rts,e.v,f)}}return{s:b,c:a.code}})};b.prototype._GET=function(a,b,e){return this._request("GET",a,b,e)};b.prototype._POST=function(a,b,e){return this._request("POST",a,b,e)};b.prototype._request=function(a,b,e,f){return A({type:a,url:b,data:e,cache:!1,timeout:12E3,async:!f}).then(function(a){return JSON.parse(a)})};b.prototype._GET_SYNC=function(a,b){var e=Z({type:"GET",url:a,data:b,cache:!1,timeout:12E3});return JSON.parse(e.data)};
b.prototype.downloadRecipe=function(a,b,e){return this._GET(this.url+"/cgi/downloadRecipe.json","rc="+a+"&st="+b,e)};b.prototype.uploadRecipe=function(a,b,e){return this._GET(this.url+"/cgi/uploadRecipe.json","rc="+a+"&st="+b,e)};b.prototype.setCurrentRecipe=function(a,b,e){var f=this.url+"/cgi/setCurrRecipe.json";a="rc="+a;null!==b&&void 0!==b&&(a+="&st="+b);return this._GET(f,a,e)};b.prototype.setRecipeSet=function(a,b,e){return this._GET(this.url+"/cgi/setRecipeSet.json","rc="+a+"&st="+b,e)};b.prototype.resetRecipe=
function(a,b){return this._GET(this.url+"/cgi/resetRecipe.json","rc="+a,b)};b.prototype.getRecipeList=function(a){return this._GET(this.url+"/cgi/getRecipeList.json","",a).then(function(a){return"S_OK"==a.code?a.rc:null})};b.prototype.addRecipeDataSet=function(a,b,e,f,d){return this._GET(this.url+"/cgi/addRecipeDataSet.json","rc="+a+"&cp="+b+"&ns="+e+"&nt="+f,d)};b.prototype.delRecipeDataSet=function(a,b,e){return this._GET(this.url+"/cgi/delRecipeDataSet.json","rc="+a+"&s="+b,e)};b.prototype.dumpRecipeData=
function(a,b,e,f,d,g,k,l){var m=this.url+"/cgi/dumpRecipe.json";a="rc="+a+"&ds="+b+"&path="+encodeURIComponent(e)+"&fname="+encodeURIComponent(f)+"&dt="+g+"&ts="+k;void 0!=d&&(a+="&tname="+d);return this._GET(m,a,l)};b.prototype.restoreRecipeData=function(a,b,e,f,d,g,k,l){var m=this.url+"/cgi/restoreRecipe.json";a="rc="+a+"&st="+b+"&path="+encodeURIComponent(e)+"&fname="+encodeURIComponent(f)+"&rt="+k+"&browse="+g;void 0!=d&&(a+="&tname="+d);return this._GET(m,a,l)};b.prototype.getRecipeSetList=function(a,
b){return this._GET(this.url+"/cgi/getRecipeSets.json","rc="+a,b)};b.prototype._decodeRecipe=function(a){var b;a.p&&a.p.s&&a.p.s.el?b=new ta(a.p.s.el.id,a.p.s.el.n,a.p.s.el.v):a.p&&a.p.s?b=new oa(a.p.s.id,a.p.s.n,a.p.s.v):a.p&&(b=new ha(a.p.id,a.p.n,a.p.status,a.p.slist,a.p.selset,a.p.lastset));return b};b.prototype.getRecipeParams=function(a,b,e){var f=this.url+"/cgi/getRecipeParams.json",d="";"all"==b&&(d="rc="+a+"&getid=true&getlastdwnset=true&getselset=true&getstatus=true&getsetlist=true");var g=
this;return this._GET(f,d,e).then(function(a){if("S_OK"==a.code)return g._decodeRecipe(a)})};b.prototype.setRecipeParam=function(a,b,e){return this._GET(this.url+"/cgi/setRecipeParam.json","rc="+a+"&v="+b,e)};b.prototype.setRecipeSetParam=function(a,b,e,f,d){return this._GET(this.url+"/cgi/setRecipeSetParam.json","rc="+a+"&s="+b+"&a="+e+"&v="+f,d)};b.prototype.setRecipeElemParam=function(a,b,e,f,d,g){return this._GET(this.url+"/cgi/setRecipeElemParam.json","rc="+a+"&s="+b+"&e="+e+"&a="+f+"&v="+d,
g)};b.prototype._getRFlag=function(a){var b="";a=a.toLowerCase();"name"==a?b+="&getname=true":"status"==a?b+="&getstatus=true":"value"==a&&(b+="&getvalue=true");return b};b.prototype.getRecipeParam=function(a,b,e){var f=this,d=this.url+"/cgi/getRecipeParams.json",g="&getid=true"+this._getRFlag(b);return e?(a=this._GET_SYNC(d,"rc="+a+g))&&"S_OK"==a.code?{v:this._decodeRecipe(a)[b]}:{err:a.code}:this._GET(d,"rc="+a+g,e).then(function(a){return a&&"S_OK"==a.code?{v:f._decodeRecipe(a)[b]}:{err:a.code}})};
b.prototype.getRecipeSetParam=function(a,b,e,f){var d=this,g=this.url+"/cgi/getRecipeSetsParams.json",k="&getid=true"+this._getRFlag(e);return f?(a=this._GET_SYNC(g,"rc="+a+"&st="+b+k))&&"S_OK"==a.code?{v:this._decodeRecipe(a)[e]}:{err:a.code}:this._GET(g,"rc="+a+"&st="+b+k,!1).then(function(a){return a&&"S_OK"==a.code?{v:d._decodeRecipe(a)[e]}:{err:a.code}})};b.prototype.getRecipeElemParam=function(a,b,e,f){var d=this.url+"/cgi/getRecipeSetsParams.json",g="&getid=true&getelems=true"+this._getRFlag(f);
return(a=this._GET_SYNC(d,"rc="+a+"&st="+b+"&i="+e+g))&&"S_OK"==a.code?{v:this._decodeRecipe(a)[f]}:{err:a.code}};b.prototype.changePwd=function(a,b,e,f){return this._GET(this.url+"/cgi/changePassword","username="+a+"&oldpswd="+b+"&newpswd="+e,f)};b.prototype.logOut=function(){this.loginStatus=!1;return $.ajax({type:"GET",url:this.url+"/cgi/logout",cache:!1})};b.prototype.getResource=function(a){return A({type:"GET",url:"../modules/resources/"+a,cache:!1})};b.prototype.getPrecachedPages=function(){var a=
window.location.href.substring(0,window.location.href.lastIndexOf("/")+1);return A({type:"GET",url:a+"precached.html",cache:!1}).then(function(a){var b=document.createElement("div");b.innerHTML=a;return b})};b.formatTagOperationRequest=function(a){var b=Array(a.length+1);b[0]="n="+a.length;return a.reduce(function(a,b,c){c+=1;a[c]="t"+c+"="+b.name;void 0!==b.arrayIndex&&(a[c]+="."+b.arrayIndex);b=b.params;for(var g in b)a[c]+="&"+g+c+"="+b[g];return a},b).join("&")};b.prototype.stepTags=function(a){a=
b.formatTagOperationRequest(a);return A({type:"POST",url:this.url+"/cgi/stepTags.json",data:a,timeout:3E4,async:!0}).then(function(a){return null!=a?JSON.parse(a):null})};b.prototype.stepTagsSync=function(a){a=b.formatTagOperationRequest(a);a=Z({type:"POST",url:this.url+"/cgi/stepTags.json",data:a});return a.data?JSON.parse(a.data):null};b.prototype.setBitTags=function(a){a=b.formatTagOperationRequest(a);return A({type:"POST",url:this.url+"/cgi/setBitTags.json",data:a,timeout:3E4,async:!0}).then(function(a){return null!=
a?JSON.parse(a):null})};b.prototype.setBitTagsSync=function(a){a=b.formatTagOperationRequest(a);a=Z({type:"POST",url:this.url+"/cgi/setBitTags.json",data:a});return a.data?JSON.parse(a.data):null};b.prototype.resetBitTags=function(a){a=b.formatTagOperationRequest(a);return A({type:"POST",url:this.url+"/cgi/resetBitTags.json",data:a,timeout:3E4,async:!0}).then(function(a){return null!=a?JSON.parse(a):null})};b.prototype.resetBitTagsSync=function(a){a=b.formatTagOperationRequest(a);a=Z({type:"POST",
url:this.url+"/cgi/resetBitTags.json",data:a});return a.data?JSON.parse(a.data):null};b.prototype.toggleBitTags=function(a){a=b.formatTagOperationRequest(a);return A({type:"POST",url:this.url+"/cgi/toggleBitTags.json",data:a,timeout:3E4,async:!0}).then(function(a){return null!=a?JSON.parse(a):null})};b.prototype.toggleBitTagsSync=function(a){a=b.formatTagOperationRequest(a);a=Z({type:"POST",url:this.url+"/cgi/toggleBitTags.json",data:a});return a.data?JSON.parse(a.data):null};b.prototype.getClientID=
function(){return A({type:"GET",url:this.url+"/cgi/getClientID.json"}).then(function(a){return null!=a?JSON.parse(a):null})};b.prototype.subscribeNotification=function(a,b){return null};b.prototype.unsubscribeNotification=function(a,b){};b.prototype.subscribeAlarms=function(a,b){return null};b.prototype.subscribeEvent=function(a,b){return null};b.prototype.unsubscribeEvent=function(a){};b.prototype.subscribeGroups=function(a,b){return null};b.prototype.unsubscribeGroups=function(a){};b.prototype.subscribeTags=
function(a,b){return null};b.prototype.unsubscribeTags=function(a){};b.prototype.subscribeRecipe=function(a,b){return null};b.prototype.subscribeRecipeSetList=function(a,b){return null};b.prototype.subscribeRecipeSet=function(a,b,e){return null};b.prototype.subscribeRecipeSetElem=function(a,b,e,f){return null};b.prototype.isSessionAlive=function(){return null};b.prototype.getConnectionStatus=function(){return null};b.prototype.onConnectionReady=function(a){};b.prototype.enableOption=function(a){};
b.prototype.subscribeTrend=function(a,b){return null};b.prototype.unsubscribeTrend=function(a,b){return null};b.prototype.readSubTrends=function(a,b){};b.prototype.updateTrendSubscription=function(a){};b.prototype.unsubscribeRecipeSetList=function(a){};b.prototype.unsubscribeRecipe=function(a){};b.prototype.unsubscribeRecipeSet=function(a,b){};b.prototype.unsubscribeRecipeSetElem=function(a,b,e){};b.prototype.setRecipeNotificationRate=function(a){};return b}(),Ba;(function(b){b[b.ASCENDING=0]="ASCENDING";
b[b.DESCENDING=1]="DESCENDING"})(Ba||(Ba={}));var Ja;(function(b){b[b.HEADER=0]="HEADER";b[b.BODY=1]="BODY"})(Ja||(Ja={}));var eb=function(b){function a(a,e,h,d,g){var k=b.call(this,a.wgtId,e,h,d,g)||this;k.rawModel=[];k.dtlkList=[];k.table=null;k.proxyTable=null;k.isTableDataSource=!0;k.initDateFormatter();"TableDataSrcWgt"===k.getJMType()&&(k.initDateFormatter(),k.initPromiseReady(),k.initRawModel());f.getEventMgr()&&(k.activateHandler=function(){b.prototype.executeActivationCallback.call(k)&&(k.isWgtActive=
!0,k.load())},k.deactivateHandler=function(){b.prototype.executeDeactivationCallback.call(k)&&(k.isWgtActive=!1,k.unload())},b.prototype.bindEvents.call(k,{loadWgt:k.activateHandler,unloadWgt:k.deactivateHandler}));return k}p(a,b);a.prototype.load=function(){var a=this;this.waitWgtReady().then(function(){a.updateModels()})};a.prototype.unload=function(){};a.prototype.updateModels=function(){for(var a in this._subscriptions){var b=this._subscriptions[a].w,f=this.createModel(b);b.setInputModel(f)}};
a.prototype.initDateFormatter=function(){this.dateFormat&&(this.dateFormatter=new Ya,this.dateFormatter.setFormat(this.dateFormat,{longDateFormat:this.project.getValue("longDateFormat"),shortDateFormat:this.project.getValue("shortDateFormat"),serverOffset:this.project.getSystemPropertiesMgr().getServerOffset()}))};a.prototype.notifyUpdate=function(){this.load()};a.prototype.getFormattedTimestamp=function(a,b){this.dateFormatter.setDate(a);b&&this.dateFormatter.showMilliSeconds();var f=this.dateFormatter.formatDateTime(this.timeSpec),
d=this.dateFormatter.formatDateTimeAndSplit(this.timeSpec);return{date:d[0],time:d[1],full:f}};a.prototype.getRawModel=function(){var a=this;$hmi.activeProject.getCommunticationObj().getTableDataSource(this.fileName).then(function(b){a.rawModel=Object.freeze(b);a.resolveWgtReady(!0)},function(){f.getAction("hmiActionShowMessage").execute(null,{msg:"Error loading table raw model !"},3);a.resolveWgtReady(!0)})};a.prototype.initRawModel=function(){var a=this;!$hmi.isTestModeActive()&&this.parentWidget instanceof
Za?this.parentWidget.waitWgtReady().then(function(){a.getRawModel()}):this.getRawModel()};a.prototype.formatProperty=function(a,b){var f=a.getAttribute(),d=a.tgtWgt.studioId,g=b.studioId,k="",l=d.indexOf(g);-1!=l&&(k+=d.substr(l+g.length+1),k+=""==k?f:"."+f);return k};a.prototype.getFilterValue=function(a,b){var f=a.getTableGroup();if("Formula"===f.filterSrcType){var f=f.getDatalink("filter").xforms[0],d=f.getCompiledExpression(),g=[],k;for(k in f.dataLinks){var l=f.dataLinks[k],m=b[l.tag];void 0!==
m?m instanceof Object?g.push(m.v+l.attr):d=d.replace(l.attr,m):g.push(l.writeToString())}return 0===g.length?eval(d):{_c:"dl",v:"="+d+";["+g.join(";")+"]"}}return b[f.filterColName]};a.prototype.populateModelBody=function(a,b,f){f=f?f:this.rawModel;var d=[],g=a.getTableGroup(),k;for(k in f){var l=f[k],m=l.rT,p=this.dtlkList[m]||[],q={};if(g.hasRowAtIndex(m)){this.hasStaticHeader&&b&&0===Number(k)&&(q._h=!0);q._t=m;q._v=[];g.rowsBgTag&&(q._bg=l[g.rowsBgTag]);q._f=this.getFilterValue(a,l);for(m=0;m<
p.length;m++){var t=p[m].getTag();q._v.push(l[t])}d.push(q)}}return d};a.prototype.generatePropsHeader=function(a){this.dtlkList=[];a=a.getTableGroup().getSortedProtoWidgets();var b={_h:[]},f;for(f in a){b._h[f]=[];for(var d in a[f]){var g=b._h[f][d]=[],k=a[f][d],l=[];k.getDataLinksByDataSrc(this,l);for(var m=0;m<l.length;m++){var p=l[m];g.push(this.formatProperty(p,k));null==this.dtlkList[f]&&(this.dtlkList[f]=[]);this.dtlkList[f].push(p)}}}return[b]};a.prototype.createModel=function(a,b){var f=
[],f=f.concat(this.generatePropsHeader(a));return f=f.concat(this.populateModelBody(a,!0))};a.prototype.injectBgColor=function(a,b){a._bg=b.getBGColor()};a.prototype.injectValue=function(a,b,f){a._v.push(b.getDynamicFieldData(f))};a.prototype.injectFilter=function(a,b,f){};a.prototype.injectTamplateValues=function(a,b,f,d){a=this.dtlkList[d];this.injectBgColor(f,b);for(var g in a)this.injectValue(f,b,a[g].tag),void 0===f._h&&this.injectFilter(f,b,a[g].tag)};a.prototype.addPropsToJSONModel=function(a){a.pushRowModel(this.generatePropsHeader(a)[0])};
a.prototype.addTemplateToJSONModel=function(a,b,f){var d={_t:f,_v:[],_f:!0};0===f&&(d._h=!0);this.injectTamplateValues(a,b,d,f);a.pushRowModel(d)};a.prototype.getTitleValue=function(a){var b=this.isTemplateWgt?this.parentPage.getTemplateMLTextMgr():this.parentPage.getPageMLTextMgr(),f=b.getMultiLanguagesMgr();return b.texts[this.mlTextsMap[a]][f.curLangId]};a.prototype.setParentBounds=function(a,b,f,d,g){};a.prototype.getParentBounds=function(a){return{x:0,y:0,width:0,height:0}};a.prototype.update=
function(){this.updateModels()};a.prototype.updateLanguage=function(){this.update()};a.prototype.destroy=function(){this.proxyTable=this.table=this.rawModel=null;return b.prototype.destroy.call(this)};a.jmType="TableDataSrcWgt";return a}(l);f.fn.hmiTableDataSrcWgt=function(b,a,c,e){return new eb(this,b,a,c,e)};f.addWidgetDefinition("hmiTableDataSrcWgt",eb);var ud=function(b){function a(a,e,h,d,g){a=b.call(this,a,e,h,d,g)||this;a.sortingMode=0;a.srv=f.activeProject.getCommunticationObj();a.auditMgr=
f.activeProject.getWidget("_AuditTrailMgr",!0);a.auditBuffer=null;a.init=!1;a.enabled=!1;return a}p(a,b);a.prototype.load=function(){if(this.enabled=this.auditMgr.isAuditTrailEnabled())this.auditBuffer=f.getWidget(this.bufferId,!0),this.auditBuffer.subscribeWgt(this,function(){}),this.dateFormat=this.auditBuffer.getValue("dateFormat"),this.auditBuffer.setInitStopTime(),this.initDateFormatter(),this.initAuditEvent(),this.init=!0,this.fetchData()};a.prototype.unload=function(){};a.prototype.injectFilter=
function(a,b,f){this.filterCol1===f&&(a._f=a._f&&(new RegExp(this.filterExp1,"i")).test(b.getDynamicFieldData(f)));this.filterCol2===f&&(a._f=a._f&&(new RegExp(this.filterExp2,"i")).test(b.getDynamicFieldData(f)));b.setVisibility(a._f)};a.prototype.initAuditEvent=function(){var a=this.auditBuffer.getEventType(),b=this.auditBuffer.getSubType(),f=this.auditBuffer.getStartTime(0===this.sortingMode),d=this.auditBuffer.getStopTime(0===this.sortingMode),g=this.bufferId,k=this.auditBuffer.getEventBufferName();
this.auditEvent=new We(a,b,f,d,g,k)};a.prototype.updateTimeRange=function(){this.auditEvent.setStartTime(this.auditBuffer.getStartTime(0===this.sortingMode));this.auditEvent.setEndTime(this.auditBuffer.getStopTime(0===this.sortingMode))};a.prototype.updateJSONModel=function(a,b){a.resetModel();this.addPropsToJSONModel(a);this.hasStaticHeader&&this.addTemplateToJSONModel(a,new td(this),Ja.HEADER);for(var f=0;f<b.length;f++)this.addTemplateToJSONModel(a,new td(this,b[f]),Ja.BODY);a.activateProxyParser()};
a.prototype.updateSubscriptions=function(a){for(var b in this._subscriptions)this.updateJSONModel(this._subscriptions[b].w,a)};a.prototype.fetchData=function(){var a=this;this.init&&(this.updateTimeRange(),this.srv.readEvent(this.auditEvent,null).then(function(b){var f=b.st;if(18!==b.t)throw"Wrong event archive";a.updateSubscriptions("S_NODATA"===f?[]:b.data)}).catch(function(a){f.getAction("hmiActionShowMessage").execute(null,{msg:"Fetch audits failed: "+a},3)}))};a.prototype.updateLanguage=function(){this.fetchData()};
a.prototype.updateStyle=function(a){!a.longDateFormat&&!a.shortDateFormat||"SHORT-DATE"!=this.dateFormat&&"LONG-DATE"!=this.dateFormat||(this.dateFormatter.setFormat(this.dateFormat,{longDateFormat:this.project.getValue("longDateFormat"),shortDateFormat:this.project.getValue("shortDateFormat"),serverOffset:this.project.getSystemPropertiesMgr().getServerOffset()}),this.fetchData())};a.prototype.setValue=function(a,e,f,d){var g=!1;switch(a){case "sortingMode":e!==this.sortingMode&&(this.sortingMode=
e);break;case "hasStaticHeader":e!==this.hasStaticHeader&&(this.hasStaticHeader=e);break;case "filterCol1":e!==this.filterCol1&&(this.filterCol1=e,g=!0);break;case "filterCol2":e!==this.filterCol2&&(this.filterCol2=e,g=!0);break;case "filterExp1":e!==this.filterExp1&&(this.filterExp1=e,g=!0);break;case "filterExp2":e!==this.filterExp2&&(this.filterExp2=e,g=!0);break;default:b.prototype.setValue.call(this,a,e,f,d)}g&&this.fetchData()};a.jmType="TableAuditSrcWgt";return a}(eb);f.fn.hmiTableAuditSrcWgt=
function(b,a,c,e){return new ud(this,b,a,c,e)};f.addWidgetDefinition("hmiTableAuditSrcWgt",ud);var cc=function(){function b(a,b,e,f){this._data=b;this._code=a||"";this._name=e||"";this._format=f||"";this.parseNumberFormat()}b.prototype.getStatusCode=function(){return this._code};b.prototype.getData=function(){return this._data};b.prototype.getName=function(){return this._name};b.prototype.getDataLength=function(){return this._data.length};b.prototype.getSecondsOfSample=function(a){return a.rts};b.prototype.getMillisecondsOfSample=
function(a){return a.ms};b.prototype.getDataQuality=function(a){return new (u.getModule("Quality"))(a.q)};b.prototype.formatText=function(a){return f.import("TextFormatUtil").formatText(this._options,a,null,!1)};b.prototype.getFormattedDataValue=function(a){return this.getDataQuality(a).isQualityBad()?b.DATA_MSG.NO_DATA:this.formatText(a.v)};b.prototype.getLastSampleTS=function(){return this._data[this._data.length-1].ms};b.prototype.setData=function(a){this._data=a};b.prototype.pushData=function(a){this._data=
this._data.concat(a)};b.prototype.addDecimalDigitsToFormat=function(a,b){a+=".";for(var e=0;e<b;e++)a+="#";return a};b.prototype.addLeadingDigitsToFormat=function(a,b){for(var e=1;e<b;e++)a="0"+a;return a};b.prototype.getDynamicFormat=function(){var a=this._format,a=0<=a.indexOf("h")?"#h":0<=a.indexOf("H")?"#H":"#";void 0!==this._decimalDigits&&"#"===a&&0<this._decimalDigits&&(a=this.addDecimalDigitsToFormat(a,this._decimalDigits));void 0!==this._leadingDigits&&0<this._leadingDigits&&(a=this.addLeadingDigitsToFormat(a,
this._leadingDigits));return a};b.prototype.parseNumberFormat=function(){this._options=f.import("TextFormatUtil").parseFormat(this._format)};b.prototype.setUsingFormat=function(a){this._format=a;this.parseNumberFormat()};b.prototype.setDecimalDigits=function(a){this._decimalDigits=a;this._format=this.getDynamicFormat();this.parseNumberFormat()};b.prototype.setLeadingDigits=function(a){this._leadingDigits=a;this._format=this.getDynamicFormat();this.parseNumberFormat()};b.DATA_MSG={NO_DATA:"No data"};
return b}(),vd=function(b){function a(c,e,h,d,g){c=b.call(this,c,e,h,d,g)||this;c.protoRawHeaderObj={};c.protoRawBodyObj={};c.protoRowHeight=0;c.rawModelBody=[];c.subTrendsData={};c.sIdx=0;c.eIdx=0;c.datalinksMap={};c.isValid=!1;c.initDateFormatter();c.srv=f.getActiveProject().getCommunticationObj();c.trendMgr=f.getActiveProject().getWidget("_TrendMgr",!0);c.trendMgr.hasTrendConfiguration(c.trendName)&&(c.samplingTime=c.trendMgr.getSamplingTime(c.trendName),c.highResolution=c.trendMgr.hasHighResolutionSampling(c.trendName),
c.isValid=!0);c.trendMgr.subscribeWgt(c,function(){});c.duration=a.pageDurationMap[c.pageDuration];c.createDatalinks();return c}p(a,b);a.prototype.subscribeWgt=function(a,b){a&&(void 0===this._subscriptions[a.wgtId]?this._subscriptions[a.wgtId]=new Va(a,b):this._subscriptions[a.wgtId].addCallback(b),a instanceof Vb&&(this.proxyTable=a))};a.prototype.load=function(){var a=this;f.activeProject.getTrendMgr().waitWgtReady().then(function(){a.setValue("stopTime",Math.ceil((new Date).getTime()/1E3),null,
null);a.isValid?(a.createProtoRawObjects(),a.fetchData(!0)):(a.updateRawModel(),a.updateTargetModel())})};a.prototype.unload=function(){};a.prototype.getNMaxSamples=function(){return Math.round(1E3*this.duration/this.samplingTime)};a.prototype.initLastSampleTS=function(){this.sortingMode===Ba.ASCENDING?this.lastTS=this.startTime:this.sortingMode===Ba.DESCENDING&&(this.lastTS=this.stopTime)};a.prototype.createProtoRawObjects=function(){for(var a in this.dataLinks){var b=this.dataLinks[a],f=b.tgtWgt.getLayout();
null!==f&&(f=f.rOcc,1===f?(this.protoRawHeaderObj.rT=0,this.protoRawHeaderObj[b.tag]=this.trendMgr.getTitleValue(this.getTrendName(),b.tag)):2===f&&(this.protoRawBodyObj.rT=1,this.protoRawBodyObj[b.tag]="",this.protoRowHeight=this.proxyTable.getTableGroup().getRowPrototypeHeight(1)))}this.rawModel[0]=this.protoRawHeaderObj};a.prototype.updateRawModelBody=function(){this.rawModelBody=[];for(var a,b=this.sIdx;b<this.eIdx;b++){var f=Oa({},this.protoRawBodyObj),d;for(d in this.subTrendsData){a=this.subTrendsData[d];
var g=a.getName(),k=a.getData()[b],l=cc.DATA_MSG.NO_DATA;if(k){var l=a.getMillisecondsOfSample(k),m=this.getFormattedTimestamp(l,this.highResolution),l=a.getFormattedDataValue(k);f.TimeStamp=m.full;f[g]=l}}this.rawModelBody.push(f)}this.updateLastSampleTS(a)};a.prototype.updateLastSampleTS=function(a){a&&(this.sortingMode===Ba.ASCENDING?this.lastTS=a.getLastSampleTS()+(this.samplingTime-1):this.sortingMode===Ba.DESCENDING&&(this.lastTS=a.getLastSampleTS()-(this.samplingTime-1)))};a.prototype.updateRawModel=
function(){this.updateRawModelBody();this.rawModel=this.rawModel.concat(this.rawModelBody)};a.prototype.updateRawModelData=function(a,b){for(var f=0;f<b;f++)for(var d=0;d<a.length;d++){var g=a[d],k=this.subTrendsData[g],l=this.hasStaticHeader?this.rawModel[f+1]:this.rawModel[f];l&&(l[g]=k.getFormattedDataValue(k.getData()[f]))}};a.prototype.updateTargetModel=function(a){this.isFetchEnabled&&!a?0==this.sIdx?(a=this.createModel(this.proxyTable),this.proxyTable.setInputModel(a)):(a=this.populateModelBody(this.proxyTable,
!1,this.rawModelBody),this.proxyTable.pushInputModelFragment(a)):(a=this.createModel(this.proxyTable),this.proxyTable.setInputModel(a))};a.prototype.needAFetchMore=function(){return this.isFetchEnabled&&this.protoRowHeight*this.rawModel.length<this.proxyTable.getTableGroup().height};a.prototype.fetchData=function(a){var b=this;this.isValid&&(a&&this.resetRawModel(),this.srv.readSubTrends(this,function(f,d){for(var g=0;g<d.length;g++){var k=d[g],l=k.n,m=k.c,k=k.d,p=b.subTrendsData[l],q=b.trendMgr.getSubTrendDataFormat(b.getTrendName(),
l);void 0===p?(b.sIdx=0,p=new cc(m,k,l,q.numberFormat),b.subTrendsData[l]=p):p&&a?(b.sIdx=0,p.setData(k)):p&&!a&&(b.sIdx=p.getDataLength(),p.pushData(k));b.eIdx=b.sIdx+k.length}b.updateRawModel();b.needAFetchMore()&&b.fetchMore();b.updateTargetModel(a)}))};a.prototype.updateSubTrendsFormat=function(a,b){var f=[],d=0,g;for(g in this.datalinksMap){var k=this.datalinksMap[g],l;for(l in k){var m=this.subTrendsData[g];m&&0===d&&(d=m.getDataLength());k[l].attr===a&&null!=m&&("leadingDigits"===a?m.setLeadingDigits(b):
"decimalDigits"===a?m.setDecimalDigits(b):"usingFormat"===a&&m.setUsingFormat(b),f.push(g))}}this.updateRawModelData(f,d);f=this.createModel(this.proxyTable);1<f.length&&this.proxyTable.setInputModel(f)};a.prototype.getNextMinute=function(){var a=new Date;a.setMinutes(a.getMinutes()+1);a.setSeconds(0);return a.getTime()};a.prototype.setValue=function(c,e,f,d){var g=!1;switch(c){case "pageDuration":this.pageDuration!=e&&(this.pageDuration=Number(e),this.duration=a.pageDurationMap[this.pageDuration],
this.rawModel=this.hasStaticHeader?[this.rawModel[0]]:[],this.setValue("StartTime",Math.ceil(this.stopTime/1E3)-this.duration,null,null),this.sendUpdate("pageDuration",this.pageDuration,f),g=!0);break;case "stopTime":e*=1E3;this.stopTime!=e&&(this.stopTime=e<this.startTime?this.getNextMinute():e,this.setValue("StartTime",Math.ceil(this.stopTime/1E3)-this.duration,null,null),this.sendUpdate("stopTime",Math.ceil(this.stopTime/1E3),f),g=!0);break;case "StartTime":e*=1E3;this.startTime!=e&&(this.startTime=
0<this.duration?0>=e?(new Date).getTime():e:1,this.initLastSampleTS(),this.sendUpdate("StartTime",Math.ceil(this.startTime/1E3),f));break;case "leadingDigits":void 0!==e&&this.updateSubTrendsFormat(c,e);break;case "decimalDigits":void 0!==e&&this.updateSubTrendsFormat(c,e);break;case "usingFormat":void 0!==e&&this.updateSubTrendsFormat(c,e);break;default:b.prototype.setValue.call(this,c,e,f,d)}g&&this.fetchData(!0)};a.prototype.getValue=function(a){if("StartTime"===a)return Math.ceil(this.startTime/
1E3);if("stopTime"===a)return Math.ceil(this.stopTime/1E3);if("pageDuration"===a)return this.pageDuration;b.prototype.getValue.call(this,a)};a.prototype.getStartTime=function(){return this.isFetchEnabled&&this.sortingMode===Ba.ASCENDING?this.lastTS:this.startTime};a.prototype.getStopTime=function(){return this.isFetchEnabled&&this.sortingMode===Ba.DESCENDING?this.lastTS:this.stopTime};a.prototype.getTrendName=function(){return this.trendName};a.prototype.getMaxSamplesNum=function(){return this.isFetchEnabled?
this.fetchRows:0};a.prototype.getDeltaTime=function(){return 0};a.prototype.getBoundsValue=function(){return!1};a.prototype.getTSSortingMode=function(){return this.sortingMode};a.prototype.stopFetching=function(){return this.rawModelBody.length>=this.getNMaxSamples()||this.sortingMode===Ba.ASCENDING&&Math.abs(this.stopTime-this.lastTS)<=this.samplingTime||this.sortingMode===Ba.DESCENDING&&Math.abs(this.startTime-this.lastTS)<=this.samplingTime?!0:!1};a.prototype.fetchMore=function(){this.isValid&&
this.isFetchEnabled&&!this.stopFetching()&&this.fetchData()};a.prototype.createDatalinks=function(){var a=f.getActiveProject().getWidget("_TagMgr",!0),b=this.trendMgr.getSubTrends(this.getTrendName()),h;for(h in b){var d=b[h],g=void 0,k=void 0;d.ldTag&&(g=d.ldTag,k="leadingDigits");d.ddTag&&(g=d.ddTag,k="decimalDigits");d.customTag&&(g=d.customTag,k="usingFormat");g&&(void 0===this.datalinksMap[h]&&(this.datalinksMap[h]=[]),this.datalinksMap[h].push(f.hmiAttach(this,a.wgtId,{tag:g,srcType:"Tag",rw:"rw",
attr:k,tagType:"",wT:0})))}};a.prototype.getSubTrendMLVariables=function(a,b){return this.trendMgr.getSubTrendMLVariables(a,this.getTrendName())};a.prototype.refresh=function(){this.setValue("stopTime",Math.ceil((new Date).getTime()/1E3),null,null)};a.prototype.moveBackward=function(){0<this.duration&&this.setValue("stopTime",Math.ceil(this.startTime/1E3),null,null)};a.prototype.moveForward=function(){0<this.duration&&this.setValue("stopTime",Math.ceil(this.stopTime/1E3)+this.duration,null,null)};
a.prototype.destroy=function(){b.prototype.destroy.call(this)};a.prototype.resetRawModel=function(){this.rawModel=this.hasStaticHeader?0<this.rawModel.length?[this.rawModel[0]]:[]:[]};a.prototype.updateStyle=function(a){!a.longDateFormat&&!a.shortDateFormat||"SHORT-DATE"!=this.dateFormat&&"LONG-DATE"!=this.dateFormat||(this.dateFormatter.setFormat(this.dateFormat,{longDateFormat:this.project.getValue("longDateFormat"),shortDateFormat:this.project.getValue("shortDateFormat"),serverOffset:this.project.getSystemPropertiesMgr().getServerOffset()}),
this.update())};a.prototype.update=function(){this.resetRawModel();this.updateRawModel();this.updateTargetModel(!0)};a.prototype.updateLanguage=function(){this.update()};a.jmType="TableTrendSrcWgt";a.pageDurationMap={0:0,1:60,2:300,3:600,4:1800,5:3600,6:7200,7:14400,8:28800,9:43200,10:86400,11:172800,12:432E3,13:604800,14:1209600,15:2419200,16:7776E3,17:15552E3,18:31536E3,19:63072E3,20:157766400};return a}(eb);f.fn.hmiTableTrendSrcWgt=function(b,a,c,e){return new vd(this,b,a,c,e)};f.addWidgetDefinition("hmiTableTrendSrcWgt",
vd);var xd=function(b){function a(a,e,h,d,g){a=b.call(this,a,e,h,d,g)||this;a.srv=f.activeProject.getCommunticationObj();a.eventBuffer=null;a.sortingMode=0;a.idalEvents=[];a.init=!1;a.filterKeys="alTS alDateTime alName alEventType alState alValue alDescription alGroups alBGColor alFGColor alAlarmID alPLCDateTime alIsTriggered alCustomField1 alCustomField2".split(" ");return a}p(a,b);a.prototype.load=function(){var a=this;f.activeProject.getWidget("_AlarmsMgr",!0).waitWgtReady().then(function(){a.eventBuffer=
f.getWidget(a.bufferId,!0);a.eventBuffer.subscribeWgt(a,a.fetchData.bind(a));a.dateFormat=a.eventBuffer.getValue("dateFormat");a.timeSpec=a.eventBuffer.getValue("timeSpec");a.eventBuffer.setInitStopTime();a.initDateFormatter();a.initAlarmEvent();a.init=!0;a.fetchData()})};a.prototype.unload=function(){};a.prototype.injectFilter=function(a,b,f){this.filterCol1===f&&(a._f=a._f&&(new RegExp(this.filterExp1,"i")).test(b.getDynamicFieldData(f)));this.filterCol2===f&&(a._f=a._f&&(new RegExp(this.filterExp2,
"i")).test(b.getDynamicFieldData(f)));b.setVisibility(a._f)};a.prototype.initAlarmEvent=function(){var a=this.eventBuffer.getEventType(),b=this.eventBuffer.getSubType(),f=this.eventBuffer.getStartTime(0===this.sortingMode),d=this.eventBuffer.getStopTime(0===this.sortingMode),g=this.bufferId,k=this.eventBuffer.getEventBufferName();this.alarmEvent=new nd(a,b,f,d,g,k)};a.prototype.updateTimeRange=function(){this.alarmEvent.setStartTime(this.eventBuffer.getStartTime(0===this.sortingMode));this.alarmEvent.setEndTime(this.eventBuffer.getStopTime(0===
this.sortingMode))};a.prototype.updateJSONModel=function(a,b){a.resetModel();this.addPropsToJSONModel(a);this.hasStaticHeader&&this.addTemplateToJSONModel(a,new wd(this),Ja.HEADER);for(var f=0;f<b.length;f++)this.addTemplateToJSONModel(a,new wd(this,b[f]),Ja.BODY);a.activateProxyParser()};a.prototype.updateSubscriptions=function(a){for(var b in this._subscriptions)this.updateJSONModel(this._subscriptions[b].w,a)};a.prototype.fetchData=function(){var a=this;this.init&&(this.updateTimeRange(),this.srv.readEvent(this.alarmEvent,
null).then(function(b){var f=b.st;if(14!==b.t)throw"Wrong event archive";a.updateSubscriptions("S_NODATA"===f?[]:b.data)}).catch(function(a){f.getAction("hmiActionShowMessage").execute(null,{msg:"Fetch alarms failed: "+a},3)}))};a.prototype.updateLanguage=function(){this.fetchData()};a.prototype.updateStyle=function(a){!a.longDateFormat&&!a.shortDateFormat||"SHORT-DATE"!=this.dateFormat&&"LONG-DATE"!=this.dateFormat||(this.dateFormatter.setFormat(this.dateFormat,{longDateFormat:this.project.getValue("longDateFormat"),
shortDateFormat:this.project.getValue("shortDateFormat"),serverOffset:this.project.getSystemPropertiesMgr().getServerOffset()}),this.fetchData())};a.prototype.setValue=function(a,e,f,d){var g=!1;switch(a){case "sortingMode":e!==this.sortingMode&&(this.sortingMode=e);break;case "hasStaticHeader":e!==this.hasStaticHeader&&(this.hasStaticHeader=e);break;case "filterCol1Idx":e!==this.filterCol1Idx&&(this.filterCol1Idx=e,this.filterCol1=this.filterKeys[Number(this.filterCol1Idx)],g=!0);break;case "filterCol2Idx":e!==
this.filterCol2Idx&&(this.filterCol2Idx=e,this.filterCol2=this.filterKeys[Number(this.filterCol2Idx)],g=!0);break;case "filterExp1":e!==this.filterExp1&&(this.filterExp1=e,g=!0);break;case "filterExp2":e!==this.filterExp2&&(this.filterExp2=e,g=!0);break;default:b.prototype.setValue.call(this,a,e,f,d)}g&&this.fetchData()};a.jmType="TableHistoricAlarmSrcWgt";return a}(eb);f.fn.hmiTableHistoricAlarmSrcWgt=function(b,a,c,e){return new xd(this,b,a,c,e)};f.addWidgetDefinition("hmiTableHistoricAlarmSrcWgt",
xd);var nd=function(b){function a(a,e,f,d,g,k){return b.call(this,a,e,f,d,g,k)||this}p(a,b);a.prototype.getId=function(){return String(this.eventType+this.subType+this.startTime+this.endTime)};return a}(qd),wd=function(b){function a(a,e){var h=b.call(this)||this;h.alAlarmID="";h.alBGColor="";h.alCustomField1="";h.alCustomField2="";h.alDateTime="";h.alDescription="";h.alEventType="";h.alFGColor="";h.alGroups="";h.alIsTriggered="";h.alName="";h.alPLCDateTime="";h.alState="";h.alTS="";h.alValue="";if(e){var d=
e.v,g=f.activeProject.getAlarmsMgr();h.stateCode=d.st;h.id=d.id;h.ts=e.ts;h.ms=e.ms;h.srcWgt=a;h.alName=g.getAlarmNameById(d.id);h.alValue=d.v.toString();h.alAlarmID=d.id.toString();h.alPLCDateTime=d.ts.toString();h.alEventType=g.getEventTypeString(e.t);h.alGroups=g.getAlarmProp(h.alName,"gr");h.setDateTimeFields();h.setFieldsLiveTags(d.d);h.setIsTriggeredAsString();h.setStateAsString();h.setColorsAsString()}else h.alName=a.getTitleValue("alName"),h.alTS=a.getTitleValue("alTS"),h.alValue=a.getTitleValue("alValue"),
h.alDescription=a.getTitleValue("alDescription"),h.alAlarmID=a.getTitleValue("alAlarmID"),h.alDateTime=a.getTitleValue("alDateTime"),h.alIsTriggered=a.getTitleValue("alIsTriggered"),h.alState=a.getTitleValue("alState"),h.alCustomField1=a.getTitleValue("alCustomField1"),h.alCustomField2=a.getTitleValue("alCustomField2"),h.alFGColor=a.getTitleValue("alFGColor"),h.alBGColor=a.getTitleValue("alBGColor"),h.alGroups=a.getTitleValue("alGroups"),h.alPLCDateTime=a.getTitleValue("alPLCDateTime"),h.alEventType=
a.getTitleValue("alEventType");return h}p(a,b);a.prototype.setDateTimeFields=function(){var a=1E3*this.ts+this.ms;this.alTS=this.srcWgt.getFormattedTimestamp(a).full;this.alDateTime=a.toString()};a.prototype.setFieldsLiveTags=function(a){var b=f.activeProject.getAlarmsMgr(),h=b.getAlarmById(this.id.toString());a||(a=h.getValue("liveTags"));var d=h.getDescriptionText(),g=h.getCustomField1Text(),k=h.getCustomField2Text(),l=h.getDescriptionTags(),m=h.getCustomField1Tags(),h=h.getCustomField2Tags();this.alDescription=
b.replaceHistLiveTags(d,l,a);this.alCustomField1=b.replaceHistLiveTags(g,m,a);this.alCustomField2=b.replaceHistLiveTags(k,h,a)};a.prototype.setStateAsString=function(){this.alState=f.activeProject.getAlarmsMgr().getAlarmById(this.id.toString()).stateToString(this.stateCode)};a.prototype.setColorsAsString=function(){var a=f.activeProject.getAlarmsMgr().getAlarmById(this.id.toString()).getColorsByStateCode(this.stateCode);this.alBGColor=a.bg;this.alFGColor=a.fg};a.prototype.setIsTriggeredAsString=function(){this.alIsTriggered=
f.activeProject.getAlarmsMgr().getAlarmById(this.id.toString()).isTriggered()?"1":"0"};a.prototype.getDynamicFieldData=function(a){switch(a){case "alAlarmID":return this.alAlarmID;case "alBGColor":return this.alBGColor;case "alCustomField1":return this.alCustomField1;case "alCustomField2":return this.alCustomField2;case "alDateTime":return this.alDateTime;case "alDescription":return this.alDescription;case "alEventType":return this.alEventType;case "alFGColor":return this.alFGColor;case "alGroups":return this.alGroups;
case "alIsTriggered":return this.alIsTriggered;case "alName":return this.alName;case "alPLCDateTime":return this.alPLCDateTime;case "alState":return this.alState;case "alTS":return this.alTS;case "alValue":return this.alValue;default:return""}};a.prototype.getBGColor=function(){return this.alBGColor};a.prototype.setVisibility=function(a){this.visible=a};a.prototype.getVisibility=function(){return this.visible};return a}(qc),zd=function(b){function a(a,e,f,d,g){a=b.call(this,a,e,f,d,g)||this;a.init=
!1;a.visibleAlarms=[];a.filterKeys="alName alGroups alSelect alEnable alValue alState alDescription alDate alTime alSeverity alDateTime alUserAction comment BGColor FGColor alCustomField1 alCustomField2".split(" ");return a}p(a,b);a.prototype.load=function(){var a=this,b=f.activeProject.getAlarmsMgr();b.subscribeWgt(this,this.notifyUpdate.bind(this));b.waitWgtReady().then(function(){a.init=!0;a.notifyUpdate()})};a.prototype.unload=function(){f.activeProject.getAlarmsMgr().unsubscribeWgt(this)};a.prototype.injectFilter=
function(a,b,f){var d=this.filterKeys[Number(this.filterCol2)];this.filterKeys[Number(this.filterCol1)]===f&&(a._f=a._f&&(new RegExp(this.filterExp1,"i")).test(b.getDynamicFieldData(f)));d===f&&(a._f=a._f&&(new RegExp(this.filterExp2,"i")).test(b.getDynamicFieldData(f)));b.setVisibility(a._f)};a.prototype.updateJSONModel=function(a){var b=f.activeProject.getAlarmsMgr().getAlarmsBuffer();this.visibleAlarms=[];a.resetModel();this.addPropsToJSONModel(a);this.hasStaticHeader&&this.addTemplateToJSONModel(a,
new yd(this),Ja.HEADER);for(var h in b){var d=new yd(this,b[h].al);this.addTemplateToJSONModel(a,d,Ja.BODY);this.addToVisibleAlarms(d)}a.activateProxyParser()};a.prototype.updateSubscriptions=function(){for(var a in this._subscriptions)this.updateJSONModel(this._subscriptions[a].w)};a.prototype.addToVisibleAlarms=function(a){a.getVisibility()&&this.visibleAlarms.push(a.getAlarmName())};a.prototype.notifyUpdate=function(){this.init&&this.updateSubscriptions()};a.prototype.setValue=function(a,e,f,d){var g=
!1;switch(a){case "hasStaticHeader":e!==this.hasStaticHeader&&(this.hasStaticHeader=e);g=!0;break;case "filterCol1":e!==this.filterCol1&&(this.filterCol1=e,g=!0);break;case "filterCol2":e!==this.filterCol2&&(this.filterCol2=e,g=!0);break;case "filterExp1":e!==this.filterExp1&&(this.filterExp1=e,g=!0);break;case "filterExp2":e!==this.filterExp2&&(this.filterExp2=e,g=!0);break;default:b.prototype.setValue.call(this,a,e,f,d)}g&&this.notifyUpdate()};a.prototype.updateLanguage=function(){this.notifyUpdate()};
a.prototype.updateStyle=function(a){this.notifyUpdate()};a.prototype.selectAllAlarmsOnSrc=function(){f.activeProject.getAlarmsMgr().doSelectAlarms(this.visibleAlarms)};a.jmType="hmiTableAlarmSrcWgt";return a}(eb);f.fn.hmiTableAlarmSrcWgt=function(b,a,c,e){return new zd(this,b,a,c,e)};f.addWidgetDefinition("hmiTableAlarmSrcWgt",zd);var yd=function(b){function a(a,e){var h=b.call(this)||this;h.alCustomField1="";h.alCustomField2="";h.alTime="";h.alDate="";h.alDescription="";h.alGroups="";h.alName="";
h.alState="";h.alValue="";h.alSeverity="";h.comment="";h.BGColor="transparent";e?(f.activeProject.getAlarmsMgr(),h.stateCode=e.alState,h.alName=e.alName,h.BGColor=e.BGColor,h.alValue=e.alValue,h.alSeverity=e.alSeverity,h.alGroups=e.getValue("alGroups"),h.alState=e.stateToString(h.stateCode),h.alarm=e,h.setDateTimeFields(),h.setFieldsDatalinks(),h.setFieldsLiveTags()):(h.BGColor=a.getTitleValue("BGColor"),h.alCustomField1=a.getTitleValue("alCustomField1"),h.alCustomField2=a.getTitleValue("alCustomField2"),
h.alDate=a.getTitleValue("alDate"),h.alDateTime=a.getTitleValue("alDateTime"),h.alDescription=a.getTitleValue("alDescription"),h.FGColor=a.getTitleValue("FGColor"),h.alGroups=a.getTitleValue("alGroups"),h.alName=a.getTitleValue("alName"),h.alState=a.getTitleValue("alState"),h.alValue=a.getTitleValue("alValue"),h.alEnable=a.getTitleValue("alEnable"),h.alSelect=a.getTitleValue("alSelect"),h.alSeverity=a.getTitleValue("alSeverity"),h.alTime=a.getTitleValue("alTime"),h.alUserAction=a.getTitleValue("alUserAction"),
h.comment=a.getTitleValue("comment"));return h}p(a,b);a.prototype.setDateTimeFields=function(){if(this.alarm.alDateTime){var a=new Date(this.alarm.alDateTime),a=new Date(a.getTime()-6E4*a.getTimezoneOffset()),b=new Ya(a,"DD MMM YYYY");this.alDateTime=Math.round(a.getTime()/1E3);this.alDate=b.formatDateTimeValue();b.setFormat("hh:mm:ss");this.alTime=b.formatDateTimeValue()}};a.prototype.setFieldsDatalinks=function(){var a=f.activeProject.getAlarmsMgr().getIndexOfAlarm(this.alName);this.alUserAction=
{_c:"dl",v:"alUserAction["+a+"]:_AlarmsMgr|R/W"};this.alSelect={_c:"dl",v:"alSelect["+a+"]:_AlarmsMgr|R/W"};this.alEnable={_c:"dl",v:"alEnable["+a+"]:_AlarmsMgr|R/W"};this.FGColor={_c:"dl",v:"FGColor["+a+"]:_AlarmsMgr|R/W"}};a.prototype.setFieldsLiveTags=function(){var a=f.activeProject.getAlarmsMgr(),b=this.alarm.getValue("liveTags"),h=this.alarm.getDescriptionText(),d=this.alarm.getCustomField1Text(),g=this.alarm.getCustomField2Text(),k=this.alarm.getDescriptionTags(),l=this.alarm.getCustomField1Tags(),
m=this.alarm.getCustomField2Tags();this.alDescription=a.replaceHistLiveTags(h,k,b);this.alCustomField1=a.replaceHistLiveTags(d,l,b);this.alCustomField2=a.replaceHistLiveTags(g,m,b)};a.prototype.getAlarmName=function(){return this.alName};a.prototype.getDynamicFieldData=function(a){switch(a){case "BGColor":return this.BGColor;case "alCustomField1":return this.alCustomField1;case "alCustomField2":return this.alCustomField2;case "alDate":return this.alDate;case "alDateTime":return this.alDateTime;case "alDescription":return this.alDescription;
case "FGColor":return this.FGColor;case "alGroups":return this.alGroups;case "alName":return this.alName;case "alState":return this.alState;case "alValue":return this.alValue;case "alEnable":return this.alEnable;case "alSelect":return this.alSelect;case "alSeverity":return this.alSeverity;case "alTime":return this.alTime;case "alUserAction":return this.alUserAction;case "comment":return this.comment;default:return""}};a.prototype.getBGColor=function(){return this.BGColor};a.prototype.setVisibility=
function(a){this.visible=a};a.prototype.getVisibility=function(){return this.visible};return a}(qc);N.prototype._generateGetterAndSetter=function(b){return{get:function(){return this.wgt.getValue(b)},set:function(a){this.wgt.setValue(b,a)}}};N.prototype._generateFun=function(b){var a=this.wgt;return function(){return a[b].apply(a,arguments)}};Object.defineProperty(N.prototype,"objectName",{get:function(){return this.wgt.studioId}});Object.defineProperty(N.prototype,"id",{get:function(){return this.wgt.studioId}});
Object.defineProperty(N.prototype,"Id",{get:function(){return this.wgt.studioId}});Object.defineProperty(N.prototype,"x",{get:function(){return parseFloat(this.wgt.getValue("x"))},set:function(b){this.wgt.setValue("x",b)}});Object.defineProperty(N.prototype,"y",{get:function(){return parseFloat(this.wgt.getValue("y"))},set:function(b){"number"==typeof b&&this.wgt.setValue("y",b)}});Object.defineProperty(N.prototype,"width",{get:function(){var b=f.getActivePage();return b.isFitToSizeEnable()?Number(Math.round(this.wgt.boundingRect.width/
b.getScaleFactors().x+"e3")+"e-3"):this.wgt.boundingRect.width},set:function(b){2>b&&(b=2);var a=f.getActivePage(),c=this.wgt.boundingRect.height;a.isFitToSizeEnable()&&(c=Number(Math.round(c/a.getScaleFactors().y+"e3")+"e-3"));this.wgt.setParentBounds(this.wgt.left,this.wgt.top,b,c,this.wgt.parentWidget)}});Object.defineProperty(N.prototype,"height",{get:function(){var b=f.getActivePage();return b.isFitToSizeEnable()?Number(Math.round(this.wgt.boundingRect.height/b.getScaleFactors().y+"e3")+"e-3"):
this.wgt.boundingRect.height},set:function(b){2>b&&(b=2);var a=f.getActivePage(),c=this.wgt.boundingRect.width;a.isFitToSizeEnable()&&(c=Number(Math.round(c/a.getScaleFactors().x+"e3")+"e-3"));this.wgt.setParentBounds(this.wgt.left,this.wgt.top,c,b,this.wgt.parentWidget)}});Object.defineProperty(N.prototype,"opacity",{get:function(){return parseFloat(this.wgt.getValue("opacity"))},set:function(b){"number"==typeof b&&this.wgt.setValue("opacity",b)}});Object.defineProperty(N.prototype,"rotation",{get:function(){return parseFloat(this.wgt.getValue("currentRot"))},
set:function(b){"number"==typeof b&&this.wgt.setValue("rot",b)}});Object.defineProperty(N.prototype,"value",{get:function(){return this.wgt.getValue("value")},set:function(b){this.wgt.setValue("value",b)}});Object.defineProperty(N.prototype,"userValue",{get:function(){return this.wgt._userValue},set:function(b){this.wgt._userValue=b}});N.prototype.getProperty=function(b,a){return this[b]?this[b]:this.wgt.getProperty(b,a)};N.prototype.getParameter=function(b,a){return this.getProperty(b,a)};N.prototype.setProperty=
function(b,a,c){this.wgt&&this.wgt.setProperty(b,a,c)};N.prototype.getWidget=function(b){(b=this.wgt.getWidget(b,!0,this.isTemplate))&&(b=new N(b));return b};N.prototype.__implementsProperty=function(b,a){this.wgt.__implementsProperty&&this.wgt.__implementsProperty(b,a)};N.prototype.update=function(){this.wgt&&this.wgt.update()};f.addWidgetDefinition("hmiIWidget",N);X.prototype=Object.create(N.prototype);X.prototype.constructor=X;Object.defineProperty(X.prototype,"backgroundColor",{get:function(){return this.wgt.getValue("backgroundColor")},
set:function(b){this.wgt.setValue("color",b)}});Object.defineProperty(X.prototype,"width",{get:function(){return this.wgt.getValue("width")}});Object.defineProperty(X.prototype,"height",{get:function(){return this.wgt.getValue("height")}});X.prototype.setTimeout=function(b,a){"string"==typeof b&&(b=-1!=b.indexOf("(")&&b.indexOf("(")?this.wgt.__eval__(b.split("(")[0]):this.wgt.__eval__(b));var c=setTimeout(b,a);this._timeoutIDs[c]=1;return c};X.prototype.clearTimeout=function(b){clearTimeout(b);delete this._timeoutIDs[b]};
X.prototype.setInterval=function(b,a){"string"==typeof b&&(b=-1!=b.indexOf("(")&&b.indexOf("(")?this.__eval__(b.split("(")[0]):this.__eval__(b));var c=setInterval(b,a);this._timeoutIDs[c]=1;return c};X.prototype.clearInterval=function(b){clearInterval(b);delete this._timeoutIDs[b]};X.prototype.clearAllTimeouts=function(){for(var b in this._timeoutIDs)clearTimeout(b),clearInterval(b)};X.prototype.getWidget=function(b){(b=this.wgt.getWidget(b,!0,this.isTemplate))&&(b=new N(b));return b};X.prototype.getProperty=
function(b,a){return this[b]?this[b]:this.wgt.getValue(b)};X.prototype.bindJSCallback=function(b){this.wgt.bindJSCallback(b)};f.addWidgetDefinition("hmiIPage",X);K.prototype=Object.create(X.prototype);K.prototype.constructor=K;K.prototype._doAction=function(b,a,c){f.isProjectReady&&(c?b.execute(a,c):b.execute(a))};K.prototype.nextPage=function(){var b=f.getAction("hmiActionNextPage");this._doAction(b,f.getFocusPage().wgtId)};K.prototype.prevPage=function(){var b=f.getAction("hmiActionPrevPage");this._doAction(b,
f.getFocusPage().wgtId)};K.prototype.homePage=function(){var b=f.getAction("hmiActionHomePage");this._doAction(b,f.getFocusPage().wgtId)};K.prototype.loadPage=function(b){var a=f.getAction("hmiActionLoadPage");b=b.split(".jmx")[0].toLowerCase();var c=f.getActiveProject().getPageMgr();a.setOptions({c:"LoadPage",p:{pg:c.map[b]}});f.doAction(f.getFocusPage().wgtId,a,{})};K.prototype.showDialog=function(b){var a=f.getAction("hmiActionShowDialog"),c=f.getActiveProject().getPageMgr();b=b.split(".jmx")[0].toLowerCase();
c=c.getWebPage(b)||b;this._doAction(a,null,{pg:c})};K.prototype.showMessage=function(b){var a=f.getAction("hmiActionShowMessage");this._doAction(a,null,{msg:b})};K.prototype.closeDialog=function(b){b=f.getAction("hmiActionCloseDialog");this._doAction(b,null,{pg:f.getFocusPage().studioId.toLowerCase()})};K.prototype.lastVisitedPage=function(){var b=f.getAction("hmiActionLastPage");b.execute(f.getFocusPage().wgtId);this._doAction(b,f.getFocusPage().wgtId)};K.prototype.ackAlarms=function(){f.getAction("hmiActionAckAlarm").execute()};
K.prototype.enableAlarms=function(){f.getAction("hmiActionEnableAlarms").execute()};K.prototype.downloadRecipe=function(b,a){var c=f.getAction("hmiActionDownLoadRecipe");this._doAction(c,f.getFocusPage().wgtId,{r:b,s:a})};K.prototype.uploadRecipe=function(b,a){var c=f.getAction("hmiActionUpLoadRecipe");this._doAction(c,f.getFocusPage().wgtId,{r:b,s:a})};K.prototype.getRecipeItem=function(b,a,c){return this.wgt.getWidget("_RecipeMgr",!0).getValue(b+"."+a+"."+c+".Value")};K.prototype.setRecipeItem=
function(b,a,c,e){return this.wgt.getWidget("_RecipeMgr",!0).setValue(b+"."+a+"."+c+".Value",e)};K.prototype.selectAllAlarms=function(b){var a=f.getAction("hmiActionSelectAllAlarms"),c;"undefined"!=typeof b&&(c={enable:b});a.execute(null,c)};K.prototype.resetAlarms=function(){f.getAction("hmiActionResetAlarm").execute()};K.prototype.getTag=function(b,a,c,e,f){return this.wgt.getTag(b,a,c,e,f)};K.prototype.setTag=function(b,a,c,e){if("string"!==typeof a&&a instanceof Array){var f;f="[";for(var d=0;d<
a.length;d++)0<d&&(f+=","),f+="number"===typeof a[d]?a[d].toString():a[d];a=f+"]"}return e?this.wgt.setTag(b,a,c,e)?0:-1:this.wgt.setTag(b,a,c,e)};K.prototype.getGroup=function(b,a,c){return this.wgt.getGroup(b,a,c)};K.prototype.getClientType=function(){return this.wgt.getClientType()};K.prototype.on=function(b,a){return this.wgt.on(b,a)};K.prototype.off=function(b){return this.wgt.off(b)};K.prototype.changePageAnimation=function(b){this.wgt.changePageAnimation(b)};K.prototype.bindJSCallback=function(b){this.wgt.bindJSCallback(b)};
f.addWidgetDefinition("hmiIProject",K);return f}();
